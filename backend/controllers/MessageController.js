'use strict';const a22_0x1176e2=a22_0x3f06;(function(_0x5cba98,_0x44b98d){const _0x83235a=a22_0x3f06,_0x369d25=_0x5cba98();while(!![]){try{const _0x2f16b0=-parseInt(_0x83235a(0x1a4))/0x1*(-parseInt(_0x83235a(0x1ae))/0x2)+parseInt(_0x83235a(0x1e4))/0x3+parseInt(_0x83235a(0x182))/0x4+-parseInt(_0x83235a(0x1b2))/0x5+parseInt(_0x83235a(0x1c8))/0x6*(-parseInt(_0x83235a(0x1ca))/0x7)+parseInt(_0x83235a(0x1f3))/0x8+-parseInt(_0x83235a(0x1e9))/0x9;if(_0x2f16b0===_0x44b98d)break;else _0x369d25['push'](_0x369d25['shift']());}catch(_0x24b20e){_0x369d25['push'](_0x369d25['shift']());}}}(a22_0x2632,0x1d4ce));var __createBinding=this&&this[a22_0x1176e2(0x196)]||(Object[a22_0x1176e2(0x183)]?function(_0x2c1d56,_0x1301b5,_0x1aa6af,_0x3a560e){const _0x401ca7=a22_0x1176e2;if(_0x3a560e===undefined)_0x3a560e=_0x1aa6af;var _0x527976=Object[_0x401ca7(0x1cd)](_0x1301b5,_0x1aa6af);(!_0x527976||(_0x401ca7(0x1ea)in _0x527976?!_0x1301b5[_0x401ca7(0x1cf)]:_0x527976[_0x401ca7(0x180)]||_0x527976[_0x401ca7(0x191)]))&&(_0x527976={'enumerable':!![],'get':function(){return _0x1301b5[_0x1aa6af];}}),Object[_0x401ca7(0x19f)](_0x2c1d56,_0x3a560e,_0x527976);}:function(_0x4162fe,_0x1b8578,_0x2ef36e,_0x29ae14){if(_0x29ae14===undefined)_0x29ae14=_0x2ef36e;_0x4162fe[_0x29ae14]=_0x1b8578[_0x2ef36e];}),__setModuleDefault=this&&this[a22_0x1176e2(0x1ba)]||(Object[a22_0x1176e2(0x183)]?function(_0x2bb64f,_0x267cdf){const _0x38f46f=a22_0x1176e2;Object[_0x38f46f(0x19f)](_0x2bb64f,_0x38f46f(0x19b),{'enumerable':!![],'value':_0x267cdf});}:function(_0x4683c4,_0xd7e80e){const _0x511fdf=a22_0x1176e2;_0x4683c4[_0x511fdf(0x19b)]=_0xd7e80e;}),__importStar=this&&this[a22_0x1176e2(0x1eb)]||function(_0x328668){const _0x3f8179=a22_0x1176e2;if(_0x328668&&_0x328668[_0x3f8179(0x1cf)])return _0x328668;var _0xf25b3={};if(_0x328668!=null){for(var _0x3f9af9 in _0x328668)if(_0x3f9af9!=='default'&&Object['prototype'][_0x3f8179(0x1e2)]['call'](_0x328668,_0x3f9af9))__createBinding(_0xf25b3,_0x328668,_0x3f9af9);}return __setModuleDefault(_0xf25b3,_0x328668),_0xf25b3;},__importDefault=this&&this[a22_0x1176e2(0x1c1)]||function(_0x220da5){const _0x3b44bc=a22_0x1176e2;return _0x220da5&&_0x220da5[_0x3b44bc(0x1cf)]?_0x220da5:{'default':_0x220da5};};Object['defineProperty'](exports,a22_0x1176e2(0x1cf),{'value':!![]}),exports[a22_0x1176e2(0x1e7)]=exports['allMe']=exports[a22_0x1176e2(0x1e8)]=exports[a22_0x1176e2(0x1f2)]=exports[a22_0x1176e2(0x1d4)]=exports['store']=exports[a22_0x1176e2(0x187)]=void 0x0;const AppError_1=__importDefault(require(a22_0x1176e2(0x1de))),SetTicketMessagesAsRead_1=__importDefault(require(a22_0x1176e2(0x1df))),socket_1=require(a22_0x1176e2(0x1e6)),Message_1=__importDefault(require(a22_0x1176e2(0x1aa))),Queue_1=__importDefault(require(a22_0x1176e2(0x1bd))),User_1=__importDefault(require(a22_0x1176e2(0x192))),Whatsapp_1=__importDefault(require(a22_0x1176e2(0x19a))),jsonwebtoken_1=require(a22_0x1176e2(0x1f1)),auth_1=__importDefault(require(a22_0x1176e2(0x1c9))),path_1=__importDefault(require(a22_0x1176e2(0x1fc))),lodash_1=require(a22_0x1176e2(0x1f5)),ListMessagesService_1=__importDefault(require(a22_0x1176e2(0x185))),ShowTicketService_1=__importDefault(require(a22_0x1176e2(0x1a9))),DeleteWhatsAppMessage_1=__importDefault(require(a22_0x1176e2(0x18e))),SendWhatsAppMedia_1=__importDefault(require(a22_0x1176e2(0x1b6))),SendWhatsAppMessage_1=__importDefault(require(a22_0x1176e2(0x1a5))),CreateMessageService_1=__importDefault(require(a22_0x1176e2(0x1bf))),sendFacebookMessageMedia_1=__importDefault(require(a22_0x1176e2(0x1e1))),sendFacebookMessage_1=__importDefault(require('../services/FacebookServices/sendFacebookMessage')),ShowPlanCompanyService_1=__importDefault(require(a22_0x1176e2(0x1d9))),ListMessagesServiceAll_1=__importDefault(require(a22_0x1176e2(0x1d6))),ShowContactService_1=__importDefault(require('../services/ContactServices/ShowContactService')),FindOrCreateTicketService_1=__importDefault(require(a22_0x1176e2(0x1c5))),UpdateTicketService_1=__importDefault(require('../services/TicketServices/UpdateTicketService')),ListSettingsService_1=__importDefault(require(a22_0x1176e2(0x1a6))),ShowMessageService_1=__importStar(require('../services/MessageServices/ShowMessageService')),index=async(_0x2f39d4,_0x309275)=>{const _0x1bc388=a22_0x1176e2,{ticketId:_0x57bfa6}=_0x2f39d4[_0x1bc388(0x1a3)],{pageNumber:_0x25100c,selectedQueues:_0x5eed77}=_0x2f39d4['query'],{companyId:_0x49f3e0,profile:_0x3e83e5}=_0x2f39d4['user'];let _0x156d5b=[];const _0xa843b6=await User_1[_0x1bc388(0x19b)][_0x1bc388(0x1d2)](_0x2f39d4['user']['id'],{'include':[{'model':Queue_1[_0x1bc388(0x19b)],'as':'queues'}]});_0x5eed77?_0x156d5b=JSON[_0x1bc388(0x1f8)](_0x5eed77):_0xa843b6[_0x1bc388(0x1d0)][_0x1bc388(0x184)](_0x6a9321=>{const _0x16b5e7=_0x1bc388;_0x156d5b[_0x16b5e7(0x1c7)](_0x6a9321['id']);});const {count:_0x31bb2e,messages:_0x16f434,ticket:_0x196b13,hasMore:_0x5319be}=await(0x0,ListMessagesService_1[_0x1bc388(0x19b)])({'pageNumber':_0x25100c,'ticketId':_0x57bfa6,'companyId':_0x49f3e0,'queues':_0x156d5b,'user':_0xa843b6});return _0x196b13[_0x1bc388(0x1fd)]===_0x1bc388(0x195)&&(0x0,SetTicketMessagesAsRead_1[_0x1bc388(0x19b)])(_0x196b13),_0x309275['json']({'count':_0x31bb2e,'messages':_0x16f434,'ticket':_0x196b13,'hasMore':_0x5319be});};exports[a22_0x1176e2(0x187)]=index;function obterNomeEExtensaoDoArquivo(_0x3b1b43){const _0x22fd0a=a22_0x1176e2;var _0x3878b3=new URL(_0x3b1b43),_0x17589e=_0x3878b3[_0x22fd0a(0x19c)],_0x56b389=_0x17589e[_0x22fd0a(0x1c6)]('/')['pop'](),_0x51571f=_0x56b389[_0x22fd0a(0x1c6)]('.'),_0x27bc06=_0x51571f[0x0],_0x2d7369=_0x51571f[0x1];return _0x27bc06+'.'+_0x2d7369;}const store=async(_0x38b5ac,_0x532077)=>{const _0x442678=a22_0x1176e2,{ticketId:_0x4db007}=_0x38b5ac[_0x442678(0x1a3)],{body:_0x45cd91,quotedMsg:_0xd5eb64,isPrivate:_0x27221f,vCard:_0x13688b}=_0x38b5ac[_0x442678(0x1ce)],_0x8a04db=_0x38b5ac[_0x442678(0x1a8)],{companyId:_0x53bcc6}=_0x38b5ac[_0x442678(0x1e3)],_0x50a80a=await(0x0,ShowTicketService_1[_0x442678(0x19b)])(_0x4db007,_0x53bcc6);_0x50a80a[_0x442678(0x1fd)]===_0x442678(0x195)&&(0x0,SetTicketMessagesAsRead_1[_0x442678(0x19b)])(_0x50a80a);try{if(_0x8a04db)await Promise[_0x442678(0x1be)](_0x8a04db[_0x442678(0x202)](async _0x4a586d=>{const _0x19efa1=_0x442678;_0x50a80a[_0x19efa1(0x1fd)]===_0x19efa1(0x195)&&await(0x0,SendWhatsAppMedia_1['default'])({'media':_0x4a586d,'ticket':_0x50a80a,'body':_0x45cd91,'isPrivate':/\u200d/[_0x19efa1(0x1b4)](_0x45cd91)});if(_0x50a80a['channel']===_0x19efa1(0x1f4)||_0x50a80a[_0x19efa1(0x1fd)]===_0x19efa1(0x1ff))try{await(0x0,sendFacebookMessageMedia_1[_0x19efa1(0x19b)])({'media':_0x4a586d,'ticket':_0x50a80a});}catch(_0x1ae4b1){console[_0x19efa1(0x1f7)](_0x1ae4b1);}}));else{_0x50a80a['channel']==='whatsapp'&&!_0x27221f&&await(0x0,SendWhatsAppMessage_1[_0x442678(0x19b)])({'body':_0x45cd91,'ticket':_0x50a80a,'quotedMsg':_0xd5eb64,'isPrivate':_0x27221f,'vCard':_0x13688b});if(_0x50a80a['channel']===_0x442678(0x195)&&_0x27221f){const _0x2de0f0={'wid':_0x442678(0x1b5)+_0x50a80a[_0x442678(0x1c2)]['toString']()['replace']('\x20',''),'ticketId':_0x50a80a['id'],'contactId':undefined,'body':_0x45cd91,'fromMe':!![],'mediaType':!(0x0,lodash_1[_0x442678(0x1f0)])(_0x13688b)?'contactMessage':_0x442678(0x1fb),'read':!![],'quotedMsgId':null,'ack':0x2,'remoteJid':_0x50a80a[_0x442678(0x1e5)]?.[_0x442678(0x204)],'participant':null,'dataJson':null,'ticketTrakingId':null,'isPrivate':_0x27221f};await(0x0,CreateMessageService_1['default'])({'messageData':_0x2de0f0,'companyId':_0x50a80a['companyId']});}(_0x50a80a[_0x442678(0x1fd)]==='facebook'||_0x50a80a[_0x442678(0x1fd)]==='instagram')&&await(0x0,sendFacebookMessage_1[_0x442678(0x19b)])({'body':_0x45cd91,'ticket':_0x50a80a,'quotedMsg':_0xd5eb64});}return _0x532077[_0x442678(0x1e7)]();}catch(_0x57c0e6){return console[_0x442678(0x1f7)](_0x57c0e6),_0x532077[_0x442678(0x1ab)](0x190)['json']({'error':_0x57c0e6[_0x442678(0x1dd)]});}};exports['store']=store;const forwardmessage=async(_0x6b3e68,_0x5d897a)=>{const _0x529849=a22_0x1176e2,_0x33bf9a=_0x6b3e68[_0x529849(0x188)][_0x529849(0x1d8)],[,_0x3de3c6]=_0x33bf9a[_0x529849(0x1c6)]('\x20'),_0x31987b=(0x0,jsonwebtoken_1[_0x529849(0x1cb)])(_0x3de3c6,auth_1[_0x529849(0x19b)][_0x529849(0x1fe)]),{id:_0x2dc410}=_0x6b3e68[_0x529849(0x1e3)],_0x216e66=await User_1['default']['findByPk'](_0x2dc410),{currentContacts:_0xea981,message:_0x6b2c95,signMessage:_0x5e49e5}=_0x6b3e68[_0x529849(0x1ce)],_0x44c8fd=await(0x0,ListSettingsService_1['default'])({'companyId':_0x6b2c95[_0x529849(0x190)]}),_0x1d6ea2=_0x6b2c95[_0x529849(0x1bc)];let _0x803184;return _0xea981['map'](async _0x4d7560=>{const _0x1aedbf=_0x529849,_0x52d7f2=await(0x0,ShowContactService_1[_0x1aedbf(0x19b)])(_0x4d7560['id'],_0x6b2c95['companyId']),_0x412aef=await(0x0,ShowTicketService_1[_0x1aedbf(0x19b)])(_0x6b2c95[_0x1aedbf(0x200)],_0x6b2c95[_0x1aedbf(0x190)]),{ticket:_0xf90cda,isCreated:_0x198551}=await(0x0,FindOrCreateTicketService_1[_0x1aedbf(0x19b)])(_0x52d7f2,_0x412aef?.[_0x1aedbf(0x195)],0x0,_0x412aef[_0x1aedbf(0x190)],_0x412aef[_0x1aedbf(0x1ad)],_0x216e66['id'],_0x52d7f2['isGroup']?_0x52d7f2:null,_0x1aedbf(0x195),null,!![],_0x44c8fd),_0x51c31a={'status':_0xf90cda[_0x1aedbf(0x1b9)]?'group':_0x1aedbf(0x1fa),'userId':_0x216e66['id'],'queueId':_0x412aef[_0x1aedbf(0x1ad)]};await(0x0,UpdateTicketService_1[_0x1aedbf(0x19b)])({'ticketData':_0x51c31a,'ticketId':_0xf90cda['id'],'companyId':_0xf90cda[_0x1aedbf(0x190)]});if(_0x412aef[_0x1aedbf(0x1fd)]===_0x1aedbf(0x195)){if(_0x6b2c95[_0x1aedbf(0x1c4)]){_0x5e49e5&&(_0x803184=_0x1aedbf(0x1d1));const _0x51ff5c=_0x6b2c95[_0x1aedbf(0x1c4)][_0x1aedbf(0x19d)](':'+process[_0x1aedbf(0x205)]['PORT'],''),_0x563160=obterNomeEExtensaoDoArquivo(_0x51ff5c),_0x36fdcf=path_1['default'][_0x1aedbf(0x203)](__dirname,'..','..','..',_0x1aedbf(0x1ef),_0x1aedbf(0x193)),_0x3e0153=path_1[_0x1aedbf(0x19b)][_0x1aedbf(0x203)](_0x36fdcf,_0x1aedbf(0x18b)+_0x412aef[_0x1aedbf(0x190)],_0x563160),_0x1eaed3={'fieldname':_0x1aedbf(0x1b3),'originalname':_0x563160,'encoding':_0x1aedbf(0x1d7),'mimetype':_0x6b2c95[_0x1aedbf(0x189)],'filename':_0x563160,'path':_0x3e0153};await(0x0,SendWhatsAppMedia_1['default'])({'media':_0x1eaed3,'ticket':_0xf90cda,'body':_0x803184});}else _0x5e49e5?_0x803184=_0x1aedbf(0x18d)+_0x216e66[_0x1aedbf(0x1a7)]+_0x1aedbf(0x1a2)+_0x6b2c95[_0x1aedbf(0x1ce)]:_0x803184=''+_0x6b2c95['body'],await(0x0,SendWhatsAppMessage_1['default'])({'body':_0x803184,'ticket':_0xf90cda,'quotedMsg':_0x1d6ea2});}}),_0x5d897a[_0x529849(0x18c)](_0x529849(0x1ec));};function a22_0x2632(){const _0x165c25=['test','PVT','../services/WbotServices/SendWhatsAppMedia','keys','emit','isGroup','__setModuleDefault','Essa\x20empresa\x20não\x20tem\x20permissão\x20para\x20usar\x20a\x20API\x20Externa.\x20Entre\x20em\x20contato\x20com\x20o\x20Suporte\x20para\x20verificar\x20nossos\x20planos!','quotedMsgId','../models/Queue','all','../services/MessageServices/CreateMessageService','app','__importDefault','updatedAt','Não\x20foi\x20possível\x20realizar\x20a\x20operação','mediaUrl','../services/TicketServices/FindOrCreateTicketService','split','push','50406EcPLZo','../config/auth','98pbbMRt','verify','update','getOwnPropertyDescriptor','body','__esModule','queues','_Encaminhada_','findByPk','delete','forwardmessage','PORT','../services/MessageServices/ListMessagesServiceAll','7bit','authorization','../services/CompanyService/ShowPlanCompanyService','-appMessage','GetWhatsAppFromMessage','>>>>>>>>>>>>>>>>>forwardMessage\x20X<<<<<<<<<<<<<<<<<<<','message','../errors/AppError','../helpers/SetTicketMessagesAsRead','useExternalApi','../services/FacebookServices/sendFacebookMessageMedia','hasOwnProperty','user','569289MZcavQ','contact','../libs/socket','send','remove','1874682xMXiBc','get','__importStar','count','SendMessage','messageQueue','backend','isNil','jsonwebtoken','forwardMessage','520312viXOwV','facebook','lodash','Message\x20not\x20found','log','parse','O\x20número\x20é\x20obrigatório','open','extendedTextMessage','path','channel','secret','instagram','ticketId','dateStart','map','join','remoteJid','env','writable','add','639608wKbzJl','create','forEach','../services/MessageServices/ListMessagesService','destroy','index','headers','mediaType','findOne','company','json','*Mensagem\x20encaminhada\x20de\x20','../services/WbotServices/DeleteWhatsAppMessage','allMe','companyId','configurable','../models/User','public','toString','whatsapp','__createBinding','dateEnd','Contact\x20not\x20found','query','../models/Whatsapp','default','pathname','replace','originalname','defineProperty','number','group','*\x0a\x0a','params','362siedZM','../services/WbotServices/SendWhatsAppMessage','../services/SettingServices/ListSettingsService','name','files','../services/TicketServices/ShowTicketService','../models/Message','status','fromMe','queueId','1198JPiiEy','conversation','company-','Mensagem\x20enviada!','928080NXMSGa','medias'];a22_0x2632=function(){return _0x165c25;};return a22_0x2632();}function a22_0x3f06(_0x7d34ce,_0x4c4ea6){const _0x2632bb=a22_0x2632();return a22_0x3f06=function(_0x3f0645,_0x1bb78f){_0x3f0645=_0x3f0645-0x180;let _0x19d9a9=_0x2632bb[_0x3f0645];return _0x19d9a9;},a22_0x3f06(_0x7d34ce,_0x4c4ea6);}exports[a22_0x1176e2(0x1d4)]=forwardmessage;const forwardMessage=async(_0x40ebe7,_0x397502)=>{const _0x33c864=a22_0x1176e2;console[_0x33c864(0x1f7)](_0x33c864(0x1dc));const {quotedMsg:_0x111162,signMessage:_0x29de56,messageId:_0x26d491,contactId:_0x13b9f6}=_0x40ebe7[_0x33c864(0x1ce)],{id:_0x2f4d31,companyId:_0x1acbb0}=_0x40ebe7[_0x33c864(0x1e3)],_0x587b00=await User_1[_0x33c864(0x19b)]['findByPk'](_0x2f4d31);if(!_0x26d491||!_0x13b9f6)return _0x397502[_0x33c864(0x1ab)](0xc8)[_0x33c864(0x1e7)]('MessageId\x20or\x20ContactId\x20not\x20found');const _0xa18f4c=await(0x0,ShowMessageService_1[_0x33c864(0x19b)])(_0x26d491),_0x239c71=await(0x0,ShowContactService_1[_0x33c864(0x19b)])(_0x13b9f6,_0x1acbb0);if(!_0xa18f4c)return _0x397502[_0x33c864(0x1ab)](0x194)['send'](_0x33c864(0x1f6));if(!_0x239c71)return _0x397502[_0x33c864(0x1ab)](0x194)[_0x33c864(0x1e7)](_0x33c864(0x198));const _0x2e2984=await(0x0,ListSettingsService_1['default'])({'companyId':_0xa18f4c['companyId']}),_0x5ca29e=await(0x0,ShowMessageService_1[_0x33c864(0x1db)])(_0xa18f4c);if(!_0x5ca29e)return _0x397502[_0x33c864(0x1ab)](0x194)[_0x33c864(0x1e7)]('Whatsapp\x20from\x20message\x20not\x20found');const _0x37452a=await(0x0,ShowTicketService_1[_0x33c864(0x19b)])(_0xa18f4c[_0x33c864(0x200)],_0xa18f4c[_0x33c864(0x190)]),{ticket:_0x14df7c}=await(0x0,FindOrCreateTicketService_1[_0x33c864(0x19b)])(_0x239c71,_0x37452a?.['whatsapp'],0x0,_0x37452a['companyId'],_0x37452a[_0x33c864(0x1ad)],_0x587b00['id'],_0x239c71['isGroup']?_0x239c71:null,_0x33c864(0x195),null,!![],_0x2e2984),_0x5ddbee={'status':_0x14df7c[_0x33c864(0x1b9)]?_0x33c864(0x1a1):'open','userId':_0x587b00['id'],'queueId':_0x37452a[_0x33c864(0x1ad)]};await(0x0,UpdateTicketService_1[_0x33c864(0x19b)])({'ticketData':_0x5ddbee,'ticketId':_0x14df7c['id'],'companyId':_0x14df7c[_0x33c864(0x190)]});let _0x4d9817='';_0x29de56&&(_0x4d9817=_0x33c864(0x1d1));if(_0xa18f4c[_0x33c864(0x189)]===_0x33c864(0x1af)||_0xa18f4c['mediaType']==='extendedTextMessage')await(0x0,SendWhatsAppMessage_1[_0x33c864(0x19b)])({'body':_0xa18f4c[_0x33c864(0x1ce)],'ticket':_0x14df7c,'quotedMsg':_0x111162});else{const _0x26a7a9=_0xa18f4c[_0x33c864(0x1c4)][_0x33c864(0x19d)](':'+process['env'][_0x33c864(0x1d5)],''),_0x2aa2f4=obterNomeEExtensaoDoArquivo(_0x26a7a9),_0x2d18ce=path_1[_0x33c864(0x19b)][_0x33c864(0x203)](__dirname,'..','..','..',_0x33c864(0x1ef),_0x33c864(0x193)),_0xcc586d=path_1[_0x33c864(0x19b)][_0x33c864(0x203)](_0x2d18ce,_0x33c864(0x18b)+_0x14df7c['companyId'],_0x2aa2f4),_0x1ae9c5={'fieldname':'medias','originalname':_0x2aa2f4,'encoding':_0x33c864(0x1d7),'mimetype':_0xa18f4c[_0x33c864(0x189)],'filename':_0x2aa2f4,'path':_0xcc586d};await(0x0,SendWhatsAppMedia_1[_0x33c864(0x19b)])({'media':_0x1ae9c5,'ticket':_0x14df7c,'body':_0x4d9817});}return _0x397502[_0x33c864(0x1e7)]();};exports[a22_0x1176e2(0x1f2)]=forwardMessage;const remove=async(_0x653c02,_0xdfdaf9)=>{const _0x1f901f=a22_0x1176e2,{messageId:_0x1f3b6c}=_0x653c02[_0x1f901f(0x1a3)],{companyId:_0x2a877d}=_0x653c02['user'],_0x46eefe=await(0x0,DeleteWhatsAppMessage_1[_0x1f901f(0x19b)])(_0x1f3b6c),_0x33620e=(0x0,socket_1['getIO'])();return _0x46eefe['isPrivate']&&(await Message_1[_0x1f901f(0x19b)][_0x1f901f(0x186)]({'where':{'id':_0x46eefe['id']}}),_0x33620e['to'](_0x46eefe['ticketId'][_0x1f901f(0x194)]())[_0x1f901f(0x1b8)](_0x1f901f(0x1b0)+_0x2a877d+_0x1f901f(0x1da),{'action':_0x1f901f(0x1d3),'message':_0x46eefe})),_0x33620e['to'](_0x46eefe[_0x1f901f(0x200)][_0x1f901f(0x194)]())[_0x1f901f(0x1b8)](_0x1f901f(0x1b0)+_0x2a877d+_0x1f901f(0x1da),{'action':_0x1f901f(0x1cc),'message':_0x46eefe}),_0xdfdaf9[_0x1f901f(0x1e7)]();};exports[a22_0x1176e2(0x1e8)]=remove;const allMe=async(_0x2fbcf2,_0x590acf)=>{const _0x3775f2=a22_0x1176e2,_0x46a3b3=_0x2fbcf2[_0x3775f2(0x199)][_0x3775f2(0x201)],_0x19d56f=_0x2fbcf2[_0x3775f2(0x199)][_0x3775f2(0x197)],_0x114520=_0x2fbcf2['query'][_0x3775f2(0x1ac)],{companyId:_0x121365}=_0x2fbcf2[_0x3775f2(0x1e3)],{count:_0x4bb311}=await(0x0,ListMessagesServiceAll_1[_0x3775f2(0x19b)])({'companyId':_0x121365,'fromMe':_0x114520,'dateStart':_0x46a3b3,'dateEnd':_0x19d56f});return _0x590acf[_0x3775f2(0x18c)]({'count':_0x4bb311});};exports[a22_0x1176e2(0x18f)]=allMe;const send=async(_0x17c246,_0x12fd02)=>{const _0x3af111=a22_0x1176e2,_0x261f15=_0x17c246['body'],_0x1ec7bb=_0x17c246[_0x3af111(0x1a8)];try{const _0x5472b9=_0x17c246[_0x3af111(0x188)][_0x3af111(0x1d8)],[,_0x3fb04b]=_0x5472b9['split']('\x20'),_0x5b6bc0=await Whatsapp_1[_0x3af111(0x19b)][_0x3af111(0x18a)]({'where':{'token':_0x3fb04b}}),_0x55de83=_0x5b6bc0[_0x3af111(0x190)],_0x2b2831=await(0x0,ShowPlanCompanyService_1[_0x3af111(0x19b)])(_0x55de83),_0x238a28=_0x2b2831['plan'][_0x3af111(0x1e0)];if(_0x238a28){if(!_0x5b6bc0)throw new Error(_0x3af111(0x1c3));if(_0x261f15[_0x3af111(0x1a0)]===undefined)throw new Error(_0x3af111(0x1f9));const _0x6fe94a=_0x261f15['number'],_0x27ccc0=_0x261f15['body'];return _0x1ec7bb?await Promise[_0x3af111(0x1be)](_0x1ec7bb[_0x3af111(0x202)](async _0x45b782=>{const _0x168204=_0x3af111;_0x17c246[_0x168204(0x1c0)][_0x168204(0x1ea)]('queues')[_0x168204(0x1ee)][_0x168204(0x181)](_0x168204(0x1ed),{'whatsappId':_0x5b6bc0['id'],'data':{'number':_0x6fe94a,'body':_0x45b782[_0x168204(0x19e)][_0x168204(0x19d)]('/','-'),'mediaPath':_0x45b782[_0x168204(0x1fc)]}},{'removeOnComplete':!![],'attempts':0x3});})):_0x17c246[_0x3af111(0x1c0)][_0x3af111(0x1ea)](_0x3af111(0x1d0))[_0x3af111(0x1ee)][_0x3af111(0x181)]('SendMessage',{'whatsappId':_0x5b6bc0['id'],'data':{'number':_0x6fe94a,'body':_0x27ccc0}},{'removeOnComplete':!![],'attempts':0x3}),_0x12fd02[_0x3af111(0x1e7)]({'mensagem':_0x3af111(0x1b1)});}return _0x12fd02[_0x3af111(0x1ab)](0x190)[_0x3af111(0x18c)]({'error':_0x3af111(0x1bb)});}catch(_0x5ea28c){console[_0x3af111(0x1f7)](_0x5ea28c);if(Object[_0x3af111(0x1b7)](_0x5ea28c)['length']===0x0)throw new AppError_1['default']('Não\x20foi\x20possível\x20enviar\x20a\x20mensagem,\x20tente\x20novamente\x20em\x20alguns\x20instantes');else throw new AppError_1['default'](_0x5ea28c[_0x3af111(0x1dd)]);}};exports[a22_0x1176e2(0x1e7)]=send;