'use strict';const a260_0x5b03d0=a260_0xceec;(function(_0x51d785,_0x15cf3c){const _0x55d42c=a260_0xceec,_0xcf97b8=_0x51d785();while(!![]){try{const _0x2c6f7b=parseInt(_0x55d42c(0x87))/0x1+-parseInt(_0x55d42c(0x7c))/0x2*(parseInt(_0x55d42c(0x84))/0x3)+parseInt(_0x55d42c(0x7e))/0x4*(-parseInt(_0x55d42c(0x82))/0x5)+parseInt(_0x55d42c(0x7a))/0x6*(parseInt(_0x55d42c(0x81))/0x7)+parseInt(_0x55d42c(0x86))/0x8*(-parseInt(_0x55d42c(0x77))/0x9)+parseInt(_0x55d42c(0x6e))/0xa+-parseInt(_0x55d42c(0x72))/0xb*(-parseInt(_0x55d42c(0x76))/0xc);if(_0x2c6f7b===_0x15cf3c)break;else _0xcf97b8['push'](_0xcf97b8['shift']());}catch(_0x505783){_0xcf97b8['push'](_0xcf97b8['shift']());}}}(a260_0xcac3,0x354bc));function a260_0xceec(_0x33da86,_0x5d8a81){const _0xcac339=a260_0xcac3();return a260_0xceec=function(_0xceec43,_0x33e26f){_0xceec43=_0xceec43-0x6a;let _0x338f94=_0xcac339[_0xceec43];return _0x338f94;},a260_0xceec(_0x33da86,_0x5d8a81);}var __importDefault=this&&this['__importDefault']||function(_0x6f6dde){return _0x6f6dde&&_0x6f6dde['__esModule']?_0x6f6dde:{'default':_0x6f6dde};};function a260_0xcac3(){const _0xbf3642=['5608avOnQE','253866bsfBJE','jsonwebtoken','__esModule','changed','secret','defineProperty','verify','4221750rWmayE','split','reload','../config/auth','2883716bmnoJx','update','getIO','../services/UserServices/ShowUserService','24wdRnUh','5391wWjpbd','default','message','12LBaCxf','online','874DeOSKr','companyId','4amWJEQ','updatedAt','headers','134099eEGQJX','1505615yijgJy','ERR_SESSION_EXPIRED','2055HKJSGj','Invalid\x20token.\x20We\x27ll\x20try\x20to\x20assign\x20a\x20new\x20one\x20on\x20next\x20request'];a260_0xcac3=function(){return _0xbf3642;};return a260_0xcac3();}Object[a260_0x5b03d0(0x6c)](exports,a260_0x5b03d0(0x89),{'value':!![]});const jsonwebtoken_1=require(a260_0x5b03d0(0x88)),AppError_1=__importDefault(require('../errors/AppError')),auth_1=__importDefault(require(a260_0x5b03d0(0x71))),socket_1=require('../libs/socket'),ShowUserService_1=__importDefault(require(a260_0x5b03d0(0x75))),updateUser=async _0x538451=>{const _0x547c58=a260_0x5b03d0,_0x2f85f0=await(0x0,ShowUserService_1['default'])(_0x538451);_0x2f85f0[_0x547c58(0x6a)](_0x547c58(0x7f),!![]);let _0x5df055=null;_0x5df055={'updatedAt':new Date()};if(!_0x2f85f0[_0x547c58(0x7b)]){_0x5df055={..._0x5df055,'online':!![]},await _0x2f85f0['update'](_0x5df055),await _0x2f85f0[_0x547c58(0x70)]();const _0xb3bd26=(0x0,socket_1[_0x547c58(0x74)])();_0xb3bd26['emit']('user'+_0x2f85f0[_0x547c58(0x7d)],{'action':_0x547c58(0x73),'user':_0x2f85f0});}else await _0x2f85f0[_0x547c58(0x73)](_0x5df055);},isAuth=async(_0x2f372f,_0xca86cf,_0x27507f)=>{const _0x47fbf8=a260_0x5b03d0,_0x2f3afb=_0x2f372f[_0x47fbf8(0x80)]['authorization'];if(!_0x2f3afb)throw new AppError_1[(_0x47fbf8(0x78))]('ERR_SESSION_EXPIRED',0x191);const [,_0x4205d3]=_0x2f3afb[_0x47fbf8(0x6f)]('\x20');try{const _0x37c893=(0x0,jsonwebtoken_1[_0x47fbf8(0x6d)])(_0x4205d3,auth_1[_0x47fbf8(0x78)][_0x47fbf8(0x6b)]),{id:_0x418d23,profile:_0x55069b,companyId:_0xf1ccc1}=_0x37c893;updateUser(_0x418d23),_0x2f372f['user']={'id':_0x418d23,'profile':_0x55069b,'companyId':_0xf1ccc1};}catch(_0x317600){if(_0x317600['message']===_0x47fbf8(0x83)&&_0x317600['statusCode']===0x191)throw new AppError_1['default'](_0x317600[_0x47fbf8(0x79)],0x191);else throw new AppError_1[(_0x47fbf8(0x78))](_0x47fbf8(0x85),0x193);}return _0x27507f();};exports[a260_0x5b03d0(0x78)]=isAuth;