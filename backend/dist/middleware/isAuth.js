'use strict';const a275_0x2a0f79=a275_0x3ddc;function a275_0x3ddc(_0x3924ec,_0x47ec61){const _0x366c30=a275_0x366c();return a275_0x3ddc=function(_0x3ddc77,_0x2aacc6){_0x3ddc77=_0x3ddc77-0x139;let _0x146456=_0x366c30[_0x3ddc77];return _0x146456;},a275_0x3ddc(_0x3924ec,_0x47ec61);}(function(_0x350c52,_0x2168f5){const _0x1664b3=a275_0x3ddc,_0x54de9a=_0x350c52();while(!![]){try{const _0x1cca98=-parseInt(_0x1664b3(0x152))/0x1+-parseInt(_0x1664b3(0x13c))/0x2*(-parseInt(_0x1664b3(0x143))/0x3)+-parseInt(_0x1664b3(0x14c))/0x4+parseInt(_0x1664b3(0x149))/0x5+parseInt(_0x1664b3(0x14d))/0x6+parseInt(_0x1664b3(0x14b))/0x7+-parseInt(_0x1664b3(0x150))/0x8;if(_0x1cca98===_0x2168f5)break;else _0x54de9a['push'](_0x54de9a['shift']());}catch(_0x233010){_0x54de9a['push'](_0x54de9a['shift']());}}}(a275_0x366c,0x997a0));function a275_0x366c(){const _0x33329a=['split','emit','online','919686pFHQwJ','getIO','../libs/socket','headers','verify','../config/auth','6208310wpBHUb','companyId','939862OZcaaL','3490932YlCnJJ','1981086iHKWZq','jsonwebtoken','message','1496904BSdQqw','defineProperty','324185LTkcmt','ERR_SESSION_EXPIRED','update','reload','Invalid\x20token.\x20We\x27ll\x20try\x20to\x20assign\x20a\x20new\x20one\x20on\x20next\x20request','secret','default','2zKyAcI','changed','__importDefault','__esModule'];a275_0x366c=function(){return _0x33329a;};return a275_0x366c();}var __importDefault=this&&this[a275_0x2a0f79(0x13e)]||function(_0x1652e0){const _0x285fc8=a275_0x2a0f79;return _0x1652e0&&_0x1652e0[_0x285fc8(0x13f)]?_0x1652e0:{'default':_0x1652e0};};Object[a275_0x2a0f79(0x151)](exports,a275_0x2a0f79(0x13f),{'value':!![]});const jsonwebtoken_1=require(a275_0x2a0f79(0x14e)),AppError_1=__importDefault(require('../errors/AppError')),auth_1=__importDefault(require(a275_0x2a0f79(0x148))),socket_1=require(a275_0x2a0f79(0x145)),ShowUserService_1=__importDefault(require('../services/UserServices/ShowUserService')),updateUser=async _0x414410=>{const _0x567a38=a275_0x2a0f79,_0x3c4d42=await(0x0,ShowUserService_1['default'])(_0x414410);_0x3c4d42[_0x567a38(0x13d)]('updatedAt',!![]);let _0x563c12=null;_0x563c12={'updatedAt':new Date()};if(!_0x3c4d42[_0x567a38(0x142)]){_0x563c12={..._0x563c12,'online':!![]},await _0x3c4d42[_0x567a38(0x154)](_0x563c12),await _0x3c4d42[_0x567a38(0x155)]();const _0x3b62e1=(0x0,socket_1[_0x567a38(0x144)])();_0x3b62e1[_0x567a38(0x141)]('user'+_0x3c4d42[_0x567a38(0x14a)],{'action':_0x567a38(0x154),'user':_0x3c4d42});}else await _0x3c4d42[_0x567a38(0x154)](_0x563c12);},isAuth=async(_0x3592ca,_0x31bac9,_0x359434)=>{const _0xaace1c=a275_0x2a0f79,_0x59dc23=_0x3592ca[_0xaace1c(0x146)]['authorization'];if(!_0x59dc23)throw new AppError_1[(_0xaace1c(0x13b))](_0xaace1c(0x153),0x191);const [,_0x2195a6]=_0x59dc23[_0xaace1c(0x140)]('\x20');try{const _0x2ded27=(0x0,jsonwebtoken_1[_0xaace1c(0x147)])(_0x2195a6,auth_1[_0xaace1c(0x13b)][_0xaace1c(0x13a)]),{id:_0x319deb,profile:_0x5eddce,companyId:_0x7cac9d}=_0x2ded27;updateUser(_0x319deb),_0x3592ca['user']={'id':_0x319deb,'profile':_0x5eddce,'companyId':_0x7cac9d};}catch(_0x168c38){if(_0x168c38[_0xaace1c(0x14f)]===_0xaace1c(0x153)&&_0x168c38['statusCode']===0x191)throw new AppError_1[(_0xaace1c(0x13b))](_0x168c38['message'],0x191);else throw new AppError_1[(_0xaace1c(0x13b))](_0xaace1c(0x139),0x193);}return _0x359434();};exports[a275_0x2a0f79(0x13b)]=isAuth;