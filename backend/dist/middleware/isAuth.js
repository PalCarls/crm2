'use strict';function a303_0x13eb(_0xc47675,_0xe9a11b){const _0x13458e=a303_0x1345();return a303_0x13eb=function(_0x13eb43,_0x288c82){_0x13eb43=_0x13eb43-0x195;let _0x241ba1=_0x13458e[_0x13eb43];return _0x241ba1;},a303_0x13eb(_0xc47675,_0xe9a11b);}function a303_0x1345(){const _0x430eb2=['defineProperty','2186493UEZblg','1915928IjlVOu','4PCkRfn','authorization','40UBCkaN','754ULGtHE','../libs/socket','reload','4008xqXcPR','../config/auth','secret','online','443172xcviII','jsonwebtoken','5329960eEsYcd','../services/UserServices/ShowUserService','../errors/AppError','ERR_SESSION_EXPIRED','Invalid\x20token.\x20We\x27ll\x20try\x20to\x20assign\x20a\x20new\x20one\x20on\x20next\x20request','statusCode','message','headers','default','5679Czogug','update','14991020fArsMa','1297UIRXVu','updatedAt','__esModule','changed','user'];a303_0x1345=function(){return _0x430eb2;};return a303_0x1345();}const a303_0x10095d=a303_0x13eb;(function(_0x502e8e,_0x5511a7){const _0x499539=a303_0x13eb,_0x5c6c68=_0x502e8e();while(!![]){try{const _0x59d008=-parseInt(_0x499539(0x1a3))/0x1*(-parseInt(_0x499539(0x1ae))/0x2)+parseInt(_0x499539(0x1a9))/0x3*(parseInt(_0x499539(0x1ab))/0x4)+-parseInt(_0x499539(0x1ad))/0x5*(-parseInt(_0x499539(0x195))/0x6)+-parseInt(_0x499539(0x1aa))/0x7+parseInt(_0x499539(0x1b1))/0x8*(-parseInt(_0x499539(0x1a0))/0x9)+parseInt(_0x499539(0x197))/0xa+-parseInt(_0x499539(0x1a2))/0xb;if(_0x59d008===_0x5511a7)break;else _0x5c6c68['push'](_0x5c6c68['shift']());}catch(_0x112b29){_0x5c6c68['push'](_0x5c6c68['shift']());}}}(a303_0x1345,0x5efad));var __importDefault=this&&this['__importDefault']||function(_0x384d79){const _0x4a757b=a303_0x13eb;return _0x384d79&&_0x384d79[_0x4a757b(0x1a5)]?_0x384d79:{'default':_0x384d79};};Object[a303_0x10095d(0x1a8)](exports,'__esModule',{'value':!![]});const jsonwebtoken_1=require(a303_0x10095d(0x196)),AppError_1=__importDefault(require(a303_0x10095d(0x199))),auth_1=__importDefault(require(a303_0x10095d(0x1b2))),socket_1=require(a303_0x10095d(0x1af)),ShowUserService_1=__importDefault(require(a303_0x10095d(0x198))),updateUser=async(_0x2a7b6d,_0xaa0926)=>{const _0x3ec8b6=a303_0x10095d,_0x586933=await(0x0,ShowUserService_1[_0x3ec8b6(0x19f)])(_0x2a7b6d,_0xaa0926);_0x586933[_0x3ec8b6(0x1a6)](_0x3ec8b6(0x1a4),!![]);let _0x44b330=null;_0x44b330={'updatedAt':new Date()};if(!_0x586933[_0x3ec8b6(0x1b4)]){_0x44b330={..._0x44b330,'online':!![]},await _0x586933['update'](_0x44b330),await _0x586933[_0x3ec8b6(0x1b0)]();const _0xab88a1=(0x0,socket_1['getIO'])();_0xab88a1['emit'](_0x3ec8b6(0x1a7)+_0x586933['companyId'],{'action':_0x3ec8b6(0x1a1),'user':_0x586933});}else await _0x586933['update'](_0x44b330);},isAuth=async(_0x238f10,_0x24c0fd,_0x3aadfd)=>{const _0x17e98a=a303_0x10095d,_0x15bcc1=_0x238f10[_0x17e98a(0x19e)][_0x17e98a(0x1ac)];if(!_0x15bcc1)throw new AppError_1[(_0x17e98a(0x19f))](_0x17e98a(0x19a),0x191);const [,_0x447b9f]=_0x15bcc1['split']('\x20');try{const _0x4f3a2a=(0x0,jsonwebtoken_1['verify'])(_0x447b9f,auth_1['default'][_0x17e98a(0x1b3)]),{id:_0x1452d0,profile:_0x204e89,companyId:_0x379773}=_0x4f3a2a;updateUser(_0x1452d0,_0x379773),_0x238f10[_0x17e98a(0x1a7)]={'id':_0x1452d0,'profile':_0x204e89,'companyId':_0x379773};}catch(_0x208d8b){if(_0x208d8b['message']==='ERR_SESSION_EXPIRED'&&_0x208d8b[_0x17e98a(0x19c)]===0x191)throw new AppError_1['default'](_0x208d8b[_0x17e98a(0x19d)],0x191);else throw new AppError_1[(_0x17e98a(0x19f))](_0x17e98a(0x19b),0x193);}return _0x3aadfd();};exports['default']=isAuth;