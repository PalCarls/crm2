'use strict';const a226_0x411ae9=a226_0x2e6d;(function(_0x55ef45,_0x1d0dca){const _0x2ba724=a226_0x2e6d,_0x1bd3ff=_0x55ef45();while(!![]){try{const _0x343dd5=-parseInt(_0x2ba724(0xab))/0x1*(-parseInt(_0x2ba724(0xa4))/0x2)+parseInt(_0x2ba724(0xa5))/0x3*(-parseInt(_0x2ba724(0xa8))/0x4)+-parseInt(_0x2ba724(0x97))/0x5*(parseInt(_0x2ba724(0xa3))/0x6)+parseInt(_0x2ba724(0xa9))/0x7+-parseInt(_0x2ba724(0x92))/0x8*(-parseInt(_0x2ba724(0x9d))/0x9)+parseInt(_0x2ba724(0x99))/0xa*(parseInt(_0x2ba724(0x9e))/0xb)+parseInt(_0x2ba724(0x8d))/0xc;if(_0x343dd5===_0x1d0dca)break;else _0x1bd3ff['push'](_0x1bd3ff['shift']());}catch(_0x5de14f){_0x1bd3ff['push'](_0x1bd3ff['shift']());}}}(a226_0x4a66,0xd4788));function a226_0x4a66(){const _0x11bfac=['4UiVJLU','716534kKRXbc','update','1Lplkjz','DESC','queue','tags','color','getIO','findAndCountAll','number','../models/Queue','toString','../models/Message','extraInfo','forEach','../models/Ticket','createdAt','26407140jYCNBF','../models/Tag','default','like','findOne','1416VQUQVF','updateTicketByRemoteJid','emit','../models/User','__esModule','1510615JvNUBc','user','10cggdmA','name','company-','whatsapp','61974yqbjsx','796675bbfMHd','-ticket','../models/Whatsapp','log','defineProperty','24kWAacK','283702TpBNVQ','4971849outrHC','sequelize','../libs/socket'];a226_0x4a66=function(){return _0x11bfac;};return a226_0x4a66();}function a226_0x2e6d(_0x249ccc,_0x4fe9de){const _0x4a6687=a226_0x4a66();return a226_0x2e6d=function(_0x2e6df0,_0x974779){_0x2e6df0=_0x2e6df0-0x86;let _0x16e5c8=_0x4a6687[_0x2e6df0];return _0x16e5c8;},a226_0x2e6d(_0x249ccc,_0x4fe9de);}var __importDefault=this&&this['__importDefault']||function(_0x564026){const _0x120885=a226_0x2e6d;return _0x564026&&_0x564026[_0x120885(0x96)]?_0x564026:{'default':_0x564026};};Object[a226_0x411ae9(0xa2)](exports,a226_0x411ae9(0x96),{'value':!![]}),exports[a226_0x411ae9(0x93)]=void 0x0;const Message_1=__importDefault(require(a226_0x411ae9(0x88))),Ticket_1=__importDefault(require(a226_0x411ae9(0x8b))),sequelize_1=require(a226_0x411ae9(0xa6)),socket_1=require(a226_0x411ae9(0xa7)),Contact_1=__importDefault(require('../models/Contact')),User_1=__importDefault(require(a226_0x411ae9(0x95))),Queue_1=__importDefault(require(a226_0x411ae9(0x86))),Whatsapp_1=__importDefault(require(a226_0x411ae9(0xa0))),Tag_1=__importDefault(require(a226_0x411ae9(0x8e))),updateTicketByRemoteJid=async(_0x110b8b,_0x2d2728,_0x13315e,_0x5acb58,_0x42ea98)=>{const _0x25ca88=a226_0x411ae9,{rows:_0x2bd9a4}=await Message_1[_0x25ca88(0x8f)][_0x25ca88(0xb1)]({'limit':0x1,'order':[[_0x25ca88(0x8c),_0x25ca88(0xac)]],'where':{'remoteJid':{[sequelize_1['Op'][_0x25ca88(0x90)]]:'%'+_0x110b8b+'%'}}});console[_0x25ca88(0xa1)](_0x2bd9a4),_0x2bd9a4[_0x25ca88(0x8a)](async _0x347981=>{const _0x14e44c=_0x25ca88;let _0x2494bc=_0x347981['ticketId'],_0x2b9740=await Ticket_1[_0x14e44c(0x8f)][_0x14e44c(0x91)]({'where':{'id':_0x2494bc},'include':[{'model':Contact_1['default'],'as':'contact','attributes':['id',_0x14e44c(0x9a),_0x14e44c(0xb2),'profilePicUrl'],'include':[_0x14e44c(0x89)]},{'model':User_1[_0x14e44c(0x8f)],'as':_0x14e44c(0x98),'attributes':['id',_0x14e44c(0x9a)]},{'model':Queue_1[_0x14e44c(0x8f)],'as':_0x14e44c(0xad),'attributes':['id',_0x14e44c(0x9a),'color']},{'model':Whatsapp_1['default'],'as':_0x14e44c(0x9c),'attributes':['name']},{'model':Tag_1['default'],'as':_0x14e44c(0xae),'attributes':['id','name',_0x14e44c(0xaf)]}]});const _0x41e01f=_0x2b9740['status'],_0x44693d=_0x2b9740['user']?.['id'];await _0x2b9740[_0x14e44c(0xaa)]({'status':_0x5acb58,'queueId':_0x2d2728,'userId':_0x13315e,'unreadMessages':_0x42ea98});const _0x375412=(0x0,socket_1[_0x14e44c(0xb0)])();_0x375412['to'](_0x2b9740['id'][_0x14e44c(0x87)]())[_0x14e44c(0x94)](_0x14e44c(0x9b)+_0x2b9740['companyId']+_0x14e44c(0x9f),{'action':_0x14e44c(0xaa),'ticket':_0x2b9740});});return;};exports[a226_0x411ae9(0x93)]=updateTicketByRemoteJid;