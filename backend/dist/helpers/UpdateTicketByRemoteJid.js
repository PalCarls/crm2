'use strict';function a267_0x4108(_0x5d3cb6,_0x5b1273){const _0x1ff69c=a267_0x1ff6();return a267_0x4108=function(_0x410806,_0x24d77c){_0x410806=_0x410806-0x1cf;let _0x38974f=_0x1ff69c[_0x410806];return _0x38974f;},a267_0x4108(_0x5d3cb6,_0x5b1273);}const a267_0x5ed6c6=a267_0x4108;(function(_0x5abb24,_0x199d5f){const _0x421e4c=a267_0x4108,_0x504294=_0x5abb24();while(!![]){try{const _0x3ca03c=-parseInt(_0x421e4c(0x1d1))/0x1*(parseInt(_0x421e4c(0x1d8))/0x2)+-parseInt(_0x421e4c(0x1d0))/0x3*(-parseInt(_0x421e4c(0x1e1))/0x4)+-parseInt(_0x421e4c(0x1fc))/0x5*(parseInt(_0x421e4c(0x1f3))/0x6)+parseInt(_0x421e4c(0x1e5))/0x7+-parseInt(_0x421e4c(0x1e9))/0x8*(-parseInt(_0x421e4c(0x1fa))/0x9)+parseInt(_0x421e4c(0x1f0))/0xa*(parseInt(_0x421e4c(0x1f6))/0xb)+-parseInt(_0x421e4c(0x1f1))/0xc;if(_0x3ca03c===_0x199d5f)break;else _0x504294['push'](_0x504294['shift']());}catch(_0x314206){_0x504294['push'](_0x504294['shift']());}}}(a267_0x1ff6,0x32558));function a267_0x1ff6(){const _0x239dd7=['36644LPzEbc','user','../models/Message','findAndCountAll','../libs/socket','defineProperty','../models/Contact','emit','default','268pzxtEd','toString','name','-ticket','1858325SeUCLj','../models/Tag','../models/Ticket','whatsapp','104WJDJru','profilePicUrl','ticketId','like','queue','update','../models/User','10kUjUIj','5382156pUeQHZ','sequelize','1874646heHOny','forEach','__esModule','3381741VtQUjU','extraInfo','createdAt','number','281997aszKPf','contact','5hryQbS','__importDefault','16641dksqqo','21Tasmtc','updateTicketByRemoteJid','tags','color','../models/Queue','DESC','status'];a267_0x1ff6=function(){return _0x239dd7;};return a267_0x1ff6();}var __importDefault=this&&this[a267_0x5ed6c6(0x1cf)]||function(_0x33511a){const _0x2597e9=a267_0x5ed6c6;return _0x33511a&&_0x33511a[_0x2597e9(0x1f5)]?_0x33511a:{'default':_0x33511a};};Object[a267_0x5ed6c6(0x1dd)](exports,'__esModule',{'value':!![]}),exports[a267_0x5ed6c6(0x1d2)]=void 0x0;const Message_1=__importDefault(require(a267_0x5ed6c6(0x1da))),Ticket_1=__importDefault(require(a267_0x5ed6c6(0x1e7))),sequelize_1=require(a267_0x5ed6c6(0x1f2)),socket_1=require(a267_0x5ed6c6(0x1dc)),Contact_1=__importDefault(require(a267_0x5ed6c6(0x1de))),User_1=__importDefault(require(a267_0x5ed6c6(0x1ef))),Queue_1=__importDefault(require(a267_0x5ed6c6(0x1d5))),Whatsapp_1=__importDefault(require('../models/Whatsapp')),Tag_1=__importDefault(require(a267_0x5ed6c6(0x1e6))),updateTicketByRemoteJid=async(_0x385f9e,_0x3751e1,_0x4d72ec,_0x1c9239,_0xccfbaa)=>{const _0x45dc85=a267_0x5ed6c6,{rows:_0x1bda0f}=await Message_1['default'][_0x45dc85(0x1db)]({'limit':0x1,'order':[[_0x45dc85(0x1f8),_0x45dc85(0x1d6)]],'where':{'remoteJid':{[sequelize_1['Op'][_0x45dc85(0x1ec)]]:'%'+_0x385f9e+'%'}}});_0x1bda0f[_0x45dc85(0x1f4)](async _0x1294b2=>{const _0xd4ceb6=_0x45dc85;let _0x264ddb=_0x1294b2[_0xd4ceb6(0x1eb)],_0x5dbc56=await Ticket_1[_0xd4ceb6(0x1e0)]['findOne']({'where':{'id':_0x264ddb},'include':[{'model':Contact_1['default'],'as':_0xd4ceb6(0x1fb),'attributes':['id',_0xd4ceb6(0x1e3),_0xd4ceb6(0x1f9),_0xd4ceb6(0x1ea)],'include':[_0xd4ceb6(0x1f7)]},{'model':User_1[_0xd4ceb6(0x1e0)],'as':'user','attributes':['id',_0xd4ceb6(0x1e3)]},{'model':Queue_1[_0xd4ceb6(0x1e0)],'as':_0xd4ceb6(0x1ed),'attributes':['id',_0xd4ceb6(0x1e3),_0xd4ceb6(0x1d4)]},{'model':Whatsapp_1['default'],'as':_0xd4ceb6(0x1e8),'attributes':[_0xd4ceb6(0x1e3)]},{'model':Tag_1['default'],'as':_0xd4ceb6(0x1d3),'attributes':['id',_0xd4ceb6(0x1e3),'color']}]});const _0x4c429d=_0x5dbc56[_0xd4ceb6(0x1d7)],_0x23199b=_0x5dbc56[_0xd4ceb6(0x1d9)]?.['id'];await _0x5dbc56[_0xd4ceb6(0x1ee)]({'status':_0x1c9239,'queueId':_0x3751e1,'userId':_0x4d72ec,'unreadMessages':_0xccfbaa});const _0x4d9c55=(0x0,socket_1['getIO'])();_0x4d9c55['to'](_0x5dbc56['id'][_0xd4ceb6(0x1e2)]())[_0xd4ceb6(0x1df)]('company-'+_0x5dbc56['companyId']+_0xd4ceb6(0x1e4),{'action':_0xd4ceb6(0x1ee),'ticket':_0x5dbc56});});return;};exports[a267_0x5ed6c6(0x1d2)]=updateTicketByRemoteJid;