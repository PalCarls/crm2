<<<<<<< HEAD
'use strict';const a280_0x4204c4=a280_0x52eb;(function(_0x1723b1,_0x3ea11a){const _0x28a42=a280_0x52eb,_0x32df89=_0x1723b1();while(!![]){try{const _0x19cd26=parseInt(_0x28a42(0x1f2))/0x1*(-parseInt(_0x28a42(0x1f3))/0x2)+parseInt(_0x28a42(0x1de))/0x3+parseInt(_0x28a42(0x1e9))/0x4*(-parseInt(_0x28a42(0x1ed))/0x5)+parseInt(_0x28a42(0x1db))/0x6*(-parseInt(_0x28a42(0x1f6))/0x7)+-parseInt(_0x28a42(0x1f9))/0x8+-parseInt(_0x28a42(0x1dd))/0x9*(-parseInt(_0x28a42(0x200))/0xa)+parseInt(_0x28a42(0x1dc))/0xb*(parseInt(_0x28a42(0x1ff))/0xc);if(_0x19cd26===_0x3ea11a)break;else _0x32df89['push'](_0x32df89['shift']());}catch(_0xe70150){_0x32df89['push'](_0x32df89['shift']());}}}(a280_0x3cc4,0x4d3f1));var __importDefault=this&&this[a280_0x4204c4(0x1e1)]||function(_0x4eea7a){const _0x40d079=a280_0x4204c4;return _0x4eea7a&&_0x4eea7a[_0x40d079(0x1fa)]?_0x4eea7a:{'default':_0x4eea7a};};Object[a280_0x4204c4(0x1e8)](exports,a280_0x4204c4(0x1fa),{'value':!![]}),exports[a280_0x4204c4(0x1f1)]=void 0x0;function a280_0x52eb(_0x12405f,_0x41ab70){const _0x3cc43a=a280_0x3cc4();return a280_0x52eb=function(_0x52ebc1,_0xcbd752){_0x52ebc1=_0x52ebc1-0x1d8;let _0x1028c9=_0x3cc43a[_0x52ebc1];return _0x1028c9;},a280_0x52eb(_0x12405f,_0x41ab70);}const Message_1=__importDefault(require(a280_0x4204c4(0x1e0))),Ticket_1=__importDefault(require(a280_0x4204c4(0x1f5))),sequelize_1=require(a280_0x4204c4(0x1fe)),socket_1=require(a280_0x4204c4(0x1e2)),Contact_1=__importDefault(require(a280_0x4204c4(0x1ee))),User_1=__importDefault(require(a280_0x4204c4(0x1e4))),Queue_1=__importDefault(require(a280_0x4204c4(0x201))),Whatsapp_1=__importDefault(require('../models/Whatsapp')),Tag_1=__importDefault(require('../models/Tag')),updateTicketByRemoteJid=async(_0x469664,_0x4c2313,_0x23684b,_0xd4cd1a,_0x219afa)=>{const _0x483cb9=a280_0x4204c4,{rows:_0x1c507d}=await Message_1[_0x483cb9(0x1da)][_0x483cb9(0x1d8)]({'limit':0x1,'order':[[_0x483cb9(0x1f0),_0x483cb9(0x1d9)]],'where':{'remoteJid':{[sequelize_1['Op'][_0x483cb9(0x1f8)]]:'%'+_0x469664+'%'}}});_0x1c507d[_0x483cb9(0x202)](async _0x38342e=>{const _0x77363d=_0x483cb9;let _0x55dbfb=_0x38342e['ticketId'],_0x6b56ce=await Ticket_1['default'][_0x77363d(0x1ec)]({'where':{'id':_0x55dbfb},'include':[{'model':Contact_1[_0x77363d(0x1da)],'as':_0x77363d(0x1f4),'attributes':['id',_0x77363d(0x1df),_0x77363d(0x1fb),'profilePicUrl',_0x77363d(0x1e6),_0x77363d(0x1f7)],'include':[_0x77363d(0x1ea),_0x77363d(0x1fd),_0x77363d(0x1e3)]},{'model':User_1[_0x77363d(0x1da)],'as':'user','attributes':['id',_0x77363d(0x1df)]},{'model':Queue_1[_0x77363d(0x1da)],'as':'queue','attributes':['id',_0x77363d(0x1df),_0x77363d(0x1eb)]},{'model':Whatsapp_1['default'],'as':'whatsapp','attributes':[_0x77363d(0x1df)]},{'model':Tag_1[_0x77363d(0x1da)],'as':_0x77363d(0x1e3),'attributes':['id',_0x77363d(0x1df),_0x77363d(0x1eb)]}]});const _0x34a553=_0x6b56ce[_0x77363d(0x1e5)],_0xf8d6cb=_0x6b56ce[_0x77363d(0x1ef)]?.['id'];await _0x6b56ce['update']({'status':_0xd4cd1a,'queueId':_0x4c2313,'userId':_0x23684b,'unreadMessages':_0x219afa});const _0x4fde45=(0x0,socket_1[_0x77363d(0x1fc)])();_0x4fde45['to'](_0x6b56ce['id']['toString']())['emit'](_0x77363d(0x204)+_0x6b56ce['companyId']+_0x77363d(0x203),{'action':_0x77363d(0x1e7),'ticket':_0x6b56ce});});return;};exports[a280_0x4204c4(0x1f1)]=updateTicketByRemoteJid;function a280_0x3cc4(){const _0xb24b49=['../models/Contact','user','createdAt','updateTicketByRemoteJid','151909kqIUxS','6TCEboU','contact','../models/Ticket','10997qivlLg','urlPicture','like','3683192dBFTKF','__esModule','number','getIO','contactTags','sequelize','1046184kFQqUA','3567610gjIgMP','../models/Queue','forEach','-ticket','company-','findAndCountAll','DESC','default','354lFkYFR','77AVjFkJ','9DMwuAn','1233912psrJbY','name','../models/Message','__importDefault','../libs/socket','tags','../models/User','status','companyId','update','defineProperty','28LsgyvM','extraInfo','color','findOne','37945oKcFkA'];a280_0x3cc4=function(){return _0xb24b49;};return a280_0x3cc4();}
=======
'use strict';const a280_0x2d53be=a280_0x1bf8;(function(_0x15877d,_0x29b6d0){const _0x5b71c1=a280_0x1bf8,_0x400611=_0x15877d();while(!![]){try{const _0x2672a1=parseInt(_0x5b71c1(0xb7))/0x1*(-parseInt(_0x5b71c1(0xa4))/0x2)+-parseInt(_0x5b71c1(0xbb))/0x3*(parseInt(_0x5b71c1(0xb1))/0x4)+parseInt(_0x5b71c1(0xc2))/0x5*(parseInt(_0x5b71c1(0xc7))/0x6)+-parseInt(_0x5b71c1(0xac))/0x7*(parseInt(_0x5b71c1(0x9e))/0x8)+-parseInt(_0x5b71c1(0xba))/0x9+-parseInt(_0x5b71c1(0xae))/0xa*(parseInt(_0x5b71c1(0xb4))/0xb)+parseInt(_0x5b71c1(0xa9))/0xc;if(_0x2672a1===_0x29b6d0)break;else _0x400611['push'](_0x400611['shift']());}catch(_0x27279a){_0x400611['push'](_0x400611['shift']());}}}(a280_0x324c,0x67268));var __importDefault=this&&this['__importDefault']||function(_0x520e0c){const _0x753761=a280_0x1bf8;return _0x520e0c&&_0x520e0c[_0x753761(0xb3)]?_0x520e0c:{'default':_0x520e0c};};function a280_0x324c(){const _0x5c953c=['user','2jcUNLK','update','name','number','-ticket','29958444PNvcEN','whatsapp','toString','7QFtoAZ','../models/Ticket','3067300zpBkgM','status','createdAt','4wTrkNM','color','__esModule','11BoHPlG','../models/Tag','urlPicture','196030xzkWNZ','tags','companyId','6159744gfsxnG','1604919ezJDDq','queue','../models/Message','defineProperty','getIO','emit','updateTicketByRemoteJid','857045NFzwUL','ticketId','findOne','like','../models/Contact','6TjllXy','../models/Queue','4186344Xajbks','default','profilePicUrl','../models/Whatsapp','../libs/socket'];a280_0x324c=function(){return _0x5c953c;};return a280_0x324c();}Object[a280_0x2d53be(0xbe)](exports,a280_0x2d53be(0xb3),{'value':!![]}),exports[a280_0x2d53be(0xc1)]=void 0x0;function a280_0x1bf8(_0x4a48ad,_0x3b368a){const _0x324cba=a280_0x324c();return a280_0x1bf8=function(_0x1bf8ef,_0x583e68){_0x1bf8ef=_0x1bf8ef-0x9e;let _0x3c02dc=_0x324cba[_0x1bf8ef];return _0x3c02dc;},a280_0x1bf8(_0x4a48ad,_0x3b368a);}const Message_1=__importDefault(require(a280_0x2d53be(0xbd))),Ticket_1=__importDefault(require(a280_0x2d53be(0xad))),sequelize_1=require('sequelize'),socket_1=require(a280_0x2d53be(0xa2)),Contact_1=__importDefault(require(a280_0x2d53be(0xc6))),User_1=__importDefault(require('../models/User')),Queue_1=__importDefault(require(a280_0x2d53be(0xc8))),Whatsapp_1=__importDefault(require(a280_0x2d53be(0xa1))),Tag_1=__importDefault(require(a280_0x2d53be(0xb5))),updateTicketByRemoteJid=async(_0x572dd2,_0x3e991c,_0x210ee1,_0x450625,_0x1c85d3)=>{const _0x1d3897=a280_0x2d53be,{rows:_0x45c37c}=await Message_1[_0x1d3897(0x9f)]['findAndCountAll']({'limit':0x1,'order':[[_0x1d3897(0xb0),'DESC']],'where':{'remoteJid':{[sequelize_1['Op'][_0x1d3897(0xc5)]]:'%'+_0x572dd2+'%'}}});_0x45c37c['forEach'](async _0x4ddb7b=>{const _0x14fd31=_0x1d3897;let _0x128a9f=_0x4ddb7b[_0x14fd31(0xc3)],_0x6634f9=await Ticket_1[_0x14fd31(0x9f)][_0x14fd31(0xc4)]({'where':{'id':_0x128a9f},'include':[{'model':Contact_1[_0x14fd31(0x9f)],'as':'contact','attributes':['id','name',_0x14fd31(0xa7),_0x14fd31(0xa0),_0x14fd31(0xb9),_0x14fd31(0xb6)],'include':['extraInfo','contactTags','tags']},{'model':User_1[_0x14fd31(0x9f)],'as':_0x14fd31(0xa3),'attributes':['id',_0x14fd31(0xa6)]},{'model':Queue_1[_0x14fd31(0x9f)],'as':_0x14fd31(0xbc),'attributes':['id',_0x14fd31(0xa6),_0x14fd31(0xb2)]},{'model':Whatsapp_1[_0x14fd31(0x9f)],'as':_0x14fd31(0xaa),'attributes':[_0x14fd31(0xa6)]},{'model':Tag_1['default'],'as':_0x14fd31(0xb8),'attributes':['id','name','color']}]});const _0x228dca=_0x6634f9[_0x14fd31(0xaf)],_0xbd96f8=_0x6634f9['user']?.['id'];await _0x6634f9[_0x14fd31(0xa5)]({'status':_0x450625,'queueId':_0x3e991c,'userId':_0x210ee1,'unreadMessages':_0x1c85d3});const _0x186154=(0x0,socket_1[_0x14fd31(0xbf)])();_0x186154['to'](_0x6634f9['id'][_0x14fd31(0xab)]())[_0x14fd31(0xc0)]('company-'+_0x6634f9[_0x14fd31(0xb9)]+_0x14fd31(0xa8),{'action':_0x14fd31(0xa5),'ticket':_0x6634f9});});return;};exports[a280_0x2d53be(0xc1)]=updateTicketByRemoteJid;
>>>>>>> ab722bfbcf394d74dd0b99a984c0dcf6ffbcff7f
