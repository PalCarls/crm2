'use strict';function a262_0xb0de(_0xc4cbf0,_0x3bca37){const _0x1cc823=a262_0x1cc8();return a262_0xb0de=function(_0xb0de9f,_0x4921e2){_0xb0de9f=_0xb0de9f-0x85;let _0x2ea24b=_0x1cc823[_0xb0de9f];return _0x2ea24b;},a262_0xb0de(_0xc4cbf0,_0x3bca37);}const a262_0xe1eea0=a262_0xb0de;(function(_0x4ff7b3,_0x2f4ad2){const _0x43a483=a262_0xb0de,_0x3add08=_0x4ff7b3();while(!![]){try{const _0x4c59d7=-parseInt(_0x43a483(0x8a))/0x1+-parseInt(_0x43a483(0x88))/0x2*(-parseInt(_0x43a483(0xae))/0x3)+parseInt(_0x43a483(0x8f))/0x4+parseInt(_0x43a483(0x9e))/0x5*(parseInt(_0x43a483(0x9b))/0x6)+parseInt(_0x43a483(0x8c))/0x7+parseInt(_0x43a483(0x90))/0x8*(parseInt(_0x43a483(0x9a))/0x9)+-parseInt(_0x43a483(0xad))/0xa*(parseInt(_0x43a483(0xa9))/0xb);if(_0x4c59d7===_0x2f4ad2)break;else _0x3add08['push'](_0x3add08['shift']());}catch(_0x21700e){_0x3add08['push'](_0x3add08['shift']());}}}(a262_0x1cc8,0x255dd));var __importDefault=this&&this[a262_0xe1eea0(0x97)]||function(_0xd92ef4){const _0x5caf76=a262_0xe1eea0;return _0xd92ef4&&_0xd92ef4[_0x5caf76(0xa1)]?_0xd92ef4:{'default':_0xd92ef4};};Object[a262_0xe1eea0(0xa6)](exports,'__esModule',{'value':!![]}),exports['updateTicketByRemoteJid']=void 0x0;function a262_0x1cc8(){const _0x3efb46=['605GtqfXh','user','getIO','__esModule','../models/Queue','forEach','companyId','status','defineProperty','log','queue','1885213rkJcLA','createdAt','toString','DESC','30seKYrt','21TZrnUZ','../models/Whatsapp','name','../models/Tag','extraInfo','37746OobkNh','profilePicUrl','35232fWKRaJ','company-','1001119KBZbKF','../libs/socket','sequelize','534964dOERkU','536YpxMwn','default','update','updateTicketByRemoteJid','../models/User','color','number','__importDefault','tags','../models/Message','1953qWekjf','13836vuwBzg','emit','findOne'];a262_0x1cc8=function(){return _0x3efb46;};return a262_0x1cc8();}const Message_1=__importDefault(require(a262_0xe1eea0(0x99))),Ticket_1=__importDefault(require('../models/Ticket')),sequelize_1=require(a262_0xe1eea0(0x8e)),socket_1=require(a262_0xe1eea0(0x8d)),Contact_1=__importDefault(require('../models/Contact')),User_1=__importDefault(require(a262_0xe1eea0(0x94))),Queue_1=__importDefault(require(a262_0xe1eea0(0xa2))),Whatsapp_1=__importDefault(require(a262_0xe1eea0(0xaf))),Tag_1=__importDefault(require(a262_0xe1eea0(0x86))),updateTicketByRemoteJid=async(_0xeb0ca4,_0x56a4ac,_0x7970c2,_0x1515bf,_0x5196d8)=>{const _0xdd5e19=a262_0xe1eea0,{rows:_0x1dc683}=await Message_1[_0xdd5e19(0x91)]['findAndCountAll']({'limit':0x1,'order':[[_0xdd5e19(0xaa),_0xdd5e19(0xac)]],'where':{'remoteJid':{[sequelize_1['Op']['like']]:'%'+_0xeb0ca4+'%'}}});console[_0xdd5e19(0xa7)](_0x1dc683),_0x1dc683[_0xdd5e19(0xa3)](async _0x4aa642=>{const _0x4584ce=_0xdd5e19;let _0x108d8f=_0x4aa642['ticketId'],_0x379457=await Ticket_1[_0x4584ce(0x91)][_0x4584ce(0x9d)]({'where':{'id':_0x108d8f},'include':[{'model':Contact_1[_0x4584ce(0x91)],'as':'contact','attributes':['id',_0x4584ce(0x85),_0x4584ce(0x96),_0x4584ce(0x89)],'include':[_0x4584ce(0x87)]},{'model':User_1['default'],'as':_0x4584ce(0x9f),'attributes':['id',_0x4584ce(0x85)]},{'model':Queue_1['default'],'as':_0x4584ce(0xa8),'attributes':['id',_0x4584ce(0x85),_0x4584ce(0x95)]},{'model':Whatsapp_1[_0x4584ce(0x91)],'as':'whatsapp','attributes':[_0x4584ce(0x85)]},{'model':Tag_1[_0x4584ce(0x91)],'as':_0x4584ce(0x98),'attributes':['id',_0x4584ce(0x85),'color']}]});const _0x48086a=_0x379457[_0x4584ce(0xa5)],_0x417dd7=_0x379457[_0x4584ce(0x9f)]?.['id'];await _0x379457[_0x4584ce(0x92)]({'status':_0x1515bf,'queueId':_0x56a4ac,'userId':_0x7970c2,'unreadMessages':_0x5196d8});const _0x248585=(0x0,socket_1[_0x4584ce(0xa0)])();_0x248585['to'](_0x379457['id'][_0x4584ce(0xab)]())[_0x4584ce(0x9c)](_0x4584ce(0x8b)+_0x379457[_0x4584ce(0xa4)]+'-ticket',{'action':'update','ticket':_0x379457});});return;};exports[a262_0xe1eea0(0x93)]=updateTicketByRemoteJid;