'use strict';function a288_0x2cdd(){const _0x58af21=['company-','tags','companyId','ticketId','getIO','whatsapp','__importDefault','contactTags','contact','urlPicture','profilePicUrl','updateTicketByRemoteJid','forEach','color','1200XfXlEx','53886CWOZdF','5009022CASPVj','136cDDOpj','22eTDkSr','../models/Whatsapp','defineProperty','status','135195zCGwjB','update','wallets','1059090GZnSmV','user','469888mVWARO','1442590ZjsGSn','../models/Queue','../libs/socket','../models/Contact','like','../models/User','__esModule','name','default','40230zulanu','findAndCountAll','8KiXtbb','toString','sequelize'];a288_0x2cdd=function(){return _0x58af21;};return a288_0x2cdd();}const a288_0x5e923b=a288_0x18cc;function a288_0x18cc(_0x308aed,_0x20ba5a){const _0x2cddf0=a288_0x2cdd();return a288_0x18cc=function(_0x18cc12,_0x5ae33d){_0x18cc12=_0x18cc12-0xee;let _0x22c260=_0x2cddf0[_0x18cc12];return _0x22c260;},a288_0x18cc(_0x308aed,_0x20ba5a);}(function(_0x4bbb36,_0x49b77e){const _0x293bd0=a288_0x18cc,_0x4c4f64=_0x4bbb36();while(!![]){try{const _0x54afb4=-parseInt(_0x293bd0(0xf1))/0x1+parseInt(_0x293bd0(0xfb))/0x2+-parseInt(_0x293bd0(0xef))/0x3+parseInt(_0x293bd0(0x111))/0x4*(parseInt(_0x293bd0(0x116))/0x5)+-parseInt(_0x293bd0(0x10e))/0x6*(-parseInt(_0x293bd0(0x10f))/0x7)+-parseInt(_0x293bd0(0xfd))/0x8*(parseInt(_0x293bd0(0x110))/0x9)+-parseInt(_0x293bd0(0xf2))/0xa*(parseInt(_0x293bd0(0x112))/0xb);if(_0x54afb4===_0x49b77e)break;else _0x4c4f64['push'](_0x4c4f64['shift']());}catch(_0x112f20){_0x4c4f64['push'](_0x4c4f64['shift']());}}}(a288_0x2cdd,0xc6027));var __importDefault=this&&this[a288_0x5e923b(0x106)]||function(_0x23768a){const _0x463fff=a288_0x5e923b;return _0x23768a&&_0x23768a[_0x463fff(0xf8)]?_0x23768a:{'default':_0x23768a};};Object[a288_0x5e923b(0x114)](exports,a288_0x5e923b(0xf8),{'value':!![]}),exports[a288_0x5e923b(0x10b)]=void 0x0;const Message_1=__importDefault(require('../models/Message')),Ticket_1=__importDefault(require('../models/Ticket')),sequelize_1=require(a288_0x5e923b(0xff)),socket_1=require(a288_0x5e923b(0xf4)),Contact_1=__importDefault(require(a288_0x5e923b(0xf5))),User_1=__importDefault(require(a288_0x5e923b(0xf7))),Queue_1=__importDefault(require(a288_0x5e923b(0xf3))),Whatsapp_1=__importDefault(require(a288_0x5e923b(0x113))),Tag_1=__importDefault(require('../models/Tag')),updateTicketByRemoteJid=async(_0x466f51,_0x2af20e,_0x4f8836,_0x21247c,_0x5e0950)=>{const _0x14cd56=a288_0x5e923b,{rows:_0x59ccfd}=await Message_1[_0x14cd56(0xfa)][_0x14cd56(0xfc)]({'limit':0x1,'order':[['createdAt','DESC']],'where':{'remoteJid':{[sequelize_1['Op'][_0x14cd56(0xf6)]]:'%'+_0x466f51+'%'}}});_0x59ccfd[_0x14cd56(0x10c)](async _0x58549d=>{const _0x5e8b69=_0x14cd56;let _0x166230=_0x58549d[_0x5e8b69(0x103)],_0x1638a9=await Ticket_1[_0x5e8b69(0xfa)]['findOne']({'where':{'id':_0x166230},'include':[{'model':Contact_1[_0x5e8b69(0xfa)],'as':_0x5e8b69(0x108),'attributes':['id',_0x5e8b69(0xf9),'number',_0x5e8b69(0x10a),_0x5e8b69(0x102),_0x5e8b69(0x109)],'include':['extraInfo',_0x5e8b69(0x107),'tags',{'association':_0x5e8b69(0xee),'attributes':['id',_0x5e8b69(0xf9)]}]},{'model':User_1[_0x5e8b69(0xfa)],'as':_0x5e8b69(0xf0),'attributes':['id',_0x5e8b69(0xf9)]},{'model':Queue_1[_0x5e8b69(0xfa)],'as':'queue','attributes':['id',_0x5e8b69(0xf9),_0x5e8b69(0x10d)]},{'model':Whatsapp_1[_0x5e8b69(0xfa)],'as':_0x5e8b69(0x105),'attributes':[_0x5e8b69(0xf9)]},{'model':Tag_1[_0x5e8b69(0xfa)],'as':_0x5e8b69(0x101),'attributes':['id',_0x5e8b69(0xf9),'color']}]});const _0x46eb30=_0x1638a9[_0x5e8b69(0x115)],_0x419955=_0x1638a9[_0x5e8b69(0xf0)]?.['id'];await _0x1638a9['update']({'status':_0x21247c,'queueId':_0x2af20e,'userId':_0x4f8836,'unreadMessages':_0x5e0950});const _0x305640=(0x0,socket_1[_0x5e8b69(0x104)])();_0x305640['to'](_0x1638a9['id'][_0x5e8b69(0xfe)]())['emit'](_0x5e8b69(0x100)+_0x1638a9[_0x5e8b69(0x102)]+'-ticket',{'action':_0x5e8b69(0x117),'ticket':_0x1638a9});});return;};exports[a288_0x5e923b(0x10b)]=updateTicketByRemoteJid;