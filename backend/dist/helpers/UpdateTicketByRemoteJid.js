'use strict';const a252_0x9a2fe3=a252_0x401e;function a252_0x401e(_0x41ba0d,_0x3ea971){const _0x50bc66=a252_0x50bc();return a252_0x401e=function(_0x401e4e,_0x261a1d){_0x401e4e=_0x401e4e-0x1c2;let _0x59227e=_0x50bc66[_0x401e4e];return _0x59227e;},a252_0x401e(_0x41ba0d,_0x3ea971);}(function(_0x1acde2,_0x46555c){const _0x54f1fd=a252_0x401e,_0x34815b=_0x1acde2();while(!![]){try{const _0x51d257=-parseInt(_0x54f1fd(0x1e1))/0x1+parseInt(_0x54f1fd(0x1c2))/0x2+parseInt(_0x54f1fd(0x1df))/0x3+parseInt(_0x54f1fd(0x1dc))/0x4+-parseInt(_0x54f1fd(0x1c7))/0x5*(-parseInt(_0x54f1fd(0x1d5))/0x6)+parseInt(_0x54f1fd(0x1c9))/0x7*(-parseInt(_0x54f1fd(0x1e3))/0x8)+parseInt(_0x54f1fd(0x1d4))/0x9;if(_0x51d257===_0x46555c)break;else _0x34815b['push'](_0x34815b['shift']());}catch(_0x27198d){_0x34815b['push'](_0x34815b['shift']());}}}(a252_0x50bc,0x7dea8));var __importDefault=this&&this[a252_0x9a2fe3(0x1c3)]||function(_0x3a25da){const _0x1a0ea8=a252_0x9a2fe3;return _0x3a25da&&_0x3a25da[_0x1a0ea8(0x1ce)]?_0x3a25da:{'default':_0x3a25da};};function a252_0x50bc(){const _0x1f6f16=['updateTicketByRemoteJid','__esModule','../models/User','forEach','name','queue','DESC','4351374QnzySa','314094PjJmUW','status','companyId','log','-ticket','whatsapp','../models/Whatsapp','3587720cAbadO','../models/Contact','company-','53784XviqkC','../models/Message','845401SGcGrF','profilePicUrl','536JTteCC','../models/Queue','defineProperty','findOne','toString','192420JEwVqv','__importDefault','default','ticketId','tags','60AzAvkX','color','79569iHSiio','contact','update','user'];a252_0x50bc=function(){return _0x1f6f16;};return a252_0x50bc();}Object[a252_0x9a2fe3(0x1e5)](exports,'__esModule',{'value':!![]}),exports[a252_0x9a2fe3(0x1cd)]=void 0x0;const Message_1=__importDefault(require(a252_0x9a2fe3(0x1e0))),Ticket_1=__importDefault(require('../models/Ticket')),sequelize_1=require('sequelize'),socket_1=require('../libs/socket'),Contact_1=__importDefault(require(a252_0x9a2fe3(0x1dd))),User_1=__importDefault(require(a252_0x9a2fe3(0x1cf))),Queue_1=__importDefault(require(a252_0x9a2fe3(0x1e4))),Whatsapp_1=__importDefault(require(a252_0x9a2fe3(0x1db))),Tag_1=__importDefault(require('../models/Tag')),updateTicketByRemoteJid=async(_0x20953e,_0x494700,_0x3de798,_0x2e66cb,_0x59dae4)=>{const _0x3f975=a252_0x9a2fe3,{rows:_0x1643d4}=await Message_1['default']['findAndCountAll']({'limit':0x1,'order':[['createdAt',_0x3f975(0x1d3)]],'where':{'remoteJid':{[sequelize_1['Op']['like']]:'%'+_0x20953e+'%'}}});console[_0x3f975(0x1d8)](_0x1643d4),_0x1643d4[_0x3f975(0x1d0)](async _0x16c5f6=>{const _0x2ec348=_0x3f975;let _0x5570b2=_0x16c5f6[_0x2ec348(0x1c5)],_0x1caad3=await Ticket_1[_0x2ec348(0x1c4)][_0x2ec348(0x1e6)]({'where':{'id':_0x5570b2},'include':[{'model':Contact_1[_0x2ec348(0x1c4)],'as':_0x2ec348(0x1ca),'attributes':['id',_0x2ec348(0x1d1),'number',_0x2ec348(0x1e2)],'include':['extraInfo']},{'model':User_1[_0x2ec348(0x1c4)],'as':_0x2ec348(0x1cc),'attributes':['id',_0x2ec348(0x1d1)]},{'model':Queue_1[_0x2ec348(0x1c4)],'as':_0x2ec348(0x1d2),'attributes':['id','name',_0x2ec348(0x1c8)]},{'model':Whatsapp_1[_0x2ec348(0x1c4)],'as':_0x2ec348(0x1da),'attributes':[_0x2ec348(0x1d1)]},{'model':Tag_1[_0x2ec348(0x1c4)],'as':_0x2ec348(0x1c6),'attributes':['id',_0x2ec348(0x1d1),_0x2ec348(0x1c8)]}]});const _0x396fa9=_0x1caad3[_0x2ec348(0x1d6)],_0x3b9835=_0x1caad3[_0x2ec348(0x1cc)]?.['id'];await _0x1caad3[_0x2ec348(0x1cb)]({'status':_0x2e66cb,'queueId':_0x494700,'userId':_0x3de798,'unreadMessages':_0x59dae4});const _0xcfb1d1=(0x0,socket_1['getIO'])();_0xcfb1d1['to'](_0x1caad3['id'][_0x2ec348(0x1e7)]())['emit'](_0x2ec348(0x1de)+_0x1caad3[_0x2ec348(0x1d7)]+_0x2ec348(0x1d9),{'action':'update','ticket':_0x1caad3});});return;};exports[a252_0x9a2fe3(0x1cd)]=updateTicketByRemoteJid;