'use strict';const a288_0x2d2bc8=a288_0x28f0;function a288_0x405c(){const _0x35ae12=['user','default','sequelize','getIO','updateTicketByRemoteJid','DESC','status','queue','forEach','861006uXlJIk','name','3480TwQPqY','__esModule','../models/Contact','color','652212RibLoR','defineProperty','findOne','extraInfo','15hPVneh','ticketId','company-','profilePicUrl','227688sPzkCN','5162028oLSCZm','update','whatsapp','../models/Ticket','../models/User','../models/Tag','tags','emit','companyId','7vYYkhv','833478wfcsAV','8756KZvOun','5618277VjydJu','like','../models/Whatsapp','5TvSsJT','findAndCountAll','number'];a288_0x405c=function(){return _0x35ae12;};return a288_0x405c();}(function(_0x212ff8,_0x30b099){const _0x530882=a288_0x28f0,_0x112c4a=_0x212ff8();while(!![]){try{const _0x2883b6=-parseInt(_0x530882(0x1cd))/0x1+parseInt(_0x530882(0x1bc))/0x2+-parseInt(_0x530882(0x1d7))/0x3*(-parseInt(_0x530882(0x1d3))/0x4)+-parseInt(_0x530882(0x1c1))/0x5*(parseInt(_0x530882(0x1dc))/0x6)+parseInt(_0x530882(0x1bb))/0x7*(parseInt(_0x530882(0x1db))/0x8)+parseInt(_0x530882(0x1be))/0x9+parseInt(_0x530882(0x1cf))/0xa*(parseInt(_0x530882(0x1bd))/0xb);if(_0x2883b6===_0x30b099)break;else _0x112c4a['push'](_0x112c4a['shift']());}catch(_0x2da6b1){_0x112c4a['push'](_0x112c4a['shift']());}}}(a288_0x405c,0x6b83e));var __importDefault=this&&this['__importDefault']||function(_0x43f043){return _0x43f043&&_0x43f043['__esModule']?_0x43f043:{'default':_0x43f043};};function a288_0x28f0(_0x21f39a,_0x2466a4){const _0x405cca=a288_0x405c();return a288_0x28f0=function(_0x28f06e,_0x169f77){_0x28f06e=_0x28f06e-0x1b6;let _0x484b50=_0x405cca[_0x28f06e];return _0x484b50;},a288_0x28f0(_0x21f39a,_0x2466a4);}Object[a288_0x2d2bc8(0x1d4)](exports,a288_0x2d2bc8(0x1d0),{'value':!![]}),exports[a288_0x2d2bc8(0x1c8)]=void 0x0;const Message_1=__importDefault(require('../models/Message')),Ticket_1=__importDefault(require(a288_0x2d2bc8(0x1df))),sequelize_1=require(a288_0x2d2bc8(0x1c6)),socket_1=require('../libs/socket'),Contact_1=__importDefault(require(a288_0x2d2bc8(0x1d1))),User_1=__importDefault(require(a288_0x2d2bc8(0x1b6))),Queue_1=__importDefault(require('../models/Queue')),Whatsapp_1=__importDefault(require(a288_0x2d2bc8(0x1c0))),Tag_1=__importDefault(require(a288_0x2d2bc8(0x1b7))),updateTicketByRemoteJid=async(_0x4540b8,_0x6ceb7e,_0x440858,_0x1ec0b6,_0x4f50b0)=>{const _0xc47937=a288_0x2d2bc8,{rows:_0x428c71}=await Message_1[_0xc47937(0x1c5)][_0xc47937(0x1c2)]({'limit':0x1,'order':[['createdAt',_0xc47937(0x1c9)]],'where':{'remoteJid':{[sequelize_1['Op'][_0xc47937(0x1bf)]]:'%'+_0x4540b8+'%'}}});_0x428c71[_0xc47937(0x1cc)](async _0x1abe02=>{const _0x242100=_0xc47937;let _0x4e213d=_0x1abe02[_0x242100(0x1d8)],_0x96786b=await Ticket_1[_0x242100(0x1c5)][_0x242100(0x1d5)]({'where':{'id':_0x4e213d},'include':[{'model':Contact_1[_0x242100(0x1c5)],'as':'contact','attributes':['id',_0x242100(0x1ce),_0x242100(0x1c3),_0x242100(0x1da),'companyId','urlPicture'],'include':[_0x242100(0x1d6),'contactTags',_0x242100(0x1b8),{'association':'wallets','attributes':['id',_0x242100(0x1ce)]}]},{'model':User_1[_0x242100(0x1c5)],'as':_0x242100(0x1c4),'attributes':['id',_0x242100(0x1ce)]},{'model':Queue_1[_0x242100(0x1c5)],'as':_0x242100(0x1cb),'attributes':['id','name','color']},{'model':Whatsapp_1['default'],'as':_0x242100(0x1de),'attributes':[_0x242100(0x1ce)]},{'model':Tag_1[_0x242100(0x1c5)],'as':_0x242100(0x1b8),'attributes':['id','name',_0x242100(0x1d2)]}]});const _0x4e10be=_0x96786b[_0x242100(0x1ca)],_0x582227=_0x96786b[_0x242100(0x1c4)]?.['id'];await _0x96786b[_0x242100(0x1dd)]({'status':_0x1ec0b6,'queueId':_0x6ceb7e,'userId':_0x440858,'unreadMessages':_0x4f50b0});const _0x3b4681=(0x0,socket_1[_0x242100(0x1c7)])();_0x3b4681['to'](_0x96786b['id']['toString']())[_0x242100(0x1b9)](_0x242100(0x1d9)+_0x96786b[_0x242100(0x1ba)]+'-ticket',{'action':'update','ticket':_0x96786b});});return;};exports[a288_0x2d2bc8(0x1c8)]=updateTicketByRemoteJid;