'use strict';const a252_0x5deee7=a252_0x4290;(function(_0x47409e,_0x293021){const _0x328fae=a252_0x4290,_0x1030db=_0x47409e();while(!![]){try{const _0xab0973=parseInt(_0x328fae(0x118))/0x1+parseInt(_0x328fae(0xfc))/0x2+parseInt(_0x328fae(0x11c))/0x3+-parseInt(_0x328fae(0x10b))/0x4*(-parseInt(_0x328fae(0x10e))/0x5)+parseInt(_0x328fae(0x122))/0x6+parseInt(_0x328fae(0x119))/0x7+-parseInt(_0x328fae(0x105))/0x8;if(_0xab0973===_0x293021)break;else _0x1030db['push'](_0x1030db['shift']());}catch(_0x25ed89){_0x1030db['push'](_0x1030db['shift']());}}}(a252_0x3176,0xae22a));function a252_0x4290(_0x111150,_0x2b0afb){const _0x31766d=a252_0x3176();return a252_0x4290=function(_0x42903f,_0x4a7b2c){_0x42903f=_0x42903f-0xfc;let _0x186a81=_0x31766d[_0x42903f];return _0x186a81;},a252_0x4290(_0x111150,_0x2b0afb);}var __importDefault=this&&this[a252_0x5deee7(0x103)]||function(_0x59d142){const _0x2def78=a252_0x5deee7;return _0x59d142&&_0x59d142[_0x2def78(0x10d)]?_0x59d142:{'default':_0x59d142};};Object[a252_0x5deee7(0x11d)](exports,a252_0x5deee7(0x10d),{'value':!![]}),exports['updateTicketByRemoteJid']=void 0x0;function a252_0x3176(){const _0x10ebf3=['962582VBdkGj','default','log','number','color','../models/Queue','tags','__importDefault','user','22005424PWRhTB','like','DESC','name','companyId','getIO','4sDoPSz','profilePicUrl','__esModule','867745sONkIF','contact','../models/Ticket','../models/Message','createdAt','ticketId','company-','findOne','emit','status','967760MEshFO','5454659kYwvzo','whatsapp','update','634764vXCOKc','defineProperty','../models/User','../models/Tag','toString','queue','5103066jihThH','sequelize','-ticket'];a252_0x3176=function(){return _0x10ebf3;};return a252_0x3176();}const Message_1=__importDefault(require(a252_0x5deee7(0x111))),Ticket_1=__importDefault(require(a252_0x5deee7(0x110))),sequelize_1=require(a252_0x5deee7(0x123)),socket_1=require('../libs/socket'),Contact_1=__importDefault(require('../models/Contact')),User_1=__importDefault(require(a252_0x5deee7(0x11e))),Queue_1=__importDefault(require(a252_0x5deee7(0x101))),Whatsapp_1=__importDefault(require('../models/Whatsapp')),Tag_1=__importDefault(require(a252_0x5deee7(0x11f))),updateTicketByRemoteJid=async(_0x1e7975,_0x68aa8c,_0xdb1864,_0x2ad337,_0x39d8b6)=>{const _0x1b552b=a252_0x5deee7,{rows:_0x308738}=await Message_1['default']['findAndCountAll']({'limit':0x1,'order':[[_0x1b552b(0x112),_0x1b552b(0x107)]],'where':{'remoteJid':{[sequelize_1['Op'][_0x1b552b(0x106)]]:'%'+_0x1e7975+'%'}}});console[_0x1b552b(0xfe)](_0x308738),_0x308738['forEach'](async _0x2e1042=>{const _0x2723d3=_0x1b552b;let _0x5e4f30=_0x2e1042[_0x2723d3(0x113)],_0x45ebb1=await Ticket_1[_0x2723d3(0xfd)][_0x2723d3(0x115)]({'where':{'id':_0x5e4f30},'include':[{'model':Contact_1[_0x2723d3(0xfd)],'as':_0x2723d3(0x10f),'attributes':['id',_0x2723d3(0x108),_0x2723d3(0xff),_0x2723d3(0x10c)],'include':['extraInfo']},{'model':User_1[_0x2723d3(0xfd)],'as':_0x2723d3(0x104),'attributes':['id',_0x2723d3(0x108)]},{'model':Queue_1[_0x2723d3(0xfd)],'as':_0x2723d3(0x121),'attributes':['id',_0x2723d3(0x108),_0x2723d3(0x100)]},{'model':Whatsapp_1[_0x2723d3(0xfd)],'as':_0x2723d3(0x11a),'attributes':[_0x2723d3(0x108)]},{'model':Tag_1[_0x2723d3(0xfd)],'as':_0x2723d3(0x102),'attributes':['id',_0x2723d3(0x108),'color']}]});const _0x55e860=_0x45ebb1[_0x2723d3(0x117)],_0x6381ef=_0x45ebb1[_0x2723d3(0x104)]?.['id'];await _0x45ebb1[_0x2723d3(0x11b)]({'status':_0x2ad337,'queueId':_0x68aa8c,'userId':_0xdb1864,'unreadMessages':_0x39d8b6});const _0x472971=(0x0,socket_1[_0x2723d3(0x10a)])();_0x472971['to'](_0x45ebb1['id'][_0x2723d3(0x120)]())[_0x2723d3(0x116)](_0x2723d3(0x114)+_0x45ebb1[_0x2723d3(0x109)]+_0x2723d3(0x124),{'action':'update','ticket':_0x45ebb1});});return;};exports['updateTicketByRemoteJid']=updateTicketByRemoteJid;