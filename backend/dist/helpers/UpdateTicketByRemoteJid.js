'use strict';const a238_0x556f8d=a238_0x4c6d;(function(_0x1f5d1b,_0x1fce0e){const _0x52227d=a238_0x4c6d,_0x46398e=_0x1f5d1b();while(!![]){try{const _0x276dfe=-parseInt(_0x52227d(0x1a9))/0x1*(-parseInt(_0x52227d(0x1c5))/0x2)+-parseInt(_0x52227d(0x1b8))/0x3+-parseInt(_0x52227d(0x1c3))/0x4*(-parseInt(_0x52227d(0x1c0))/0x5)+parseInt(_0x52227d(0x1c6))/0x6+parseInt(_0x52227d(0x1ad))/0x7+parseInt(_0x52227d(0x1bd))/0x8+-parseInt(_0x52227d(0x1c2))/0x9*(parseInt(_0x52227d(0x1ae))/0xa);if(_0x276dfe===_0x1fce0e)break;else _0x46398e['push'](_0x46398e['shift']());}catch(_0x4bee86){_0x46398e['push'](_0x46398e['shift']());}}}(a238_0x25da,0x8586f));function a238_0x4c6d(_0xb1df23,_0x5ae18a){const _0x25dac6=a238_0x25da();return a238_0x4c6d=function(_0x4c6d2b,_0x32c23d){_0x4c6d2b=_0x4c6d2b-0x1a3;let _0x467272=_0x25dac6[_0x4c6d2b];return _0x467272;},a238_0x4c6d(_0xb1df23,_0x5ae18a);}var __importDefault=this&&this[a238_0x556f8d(0x1bf)]||function(_0x56a523){const _0x569020=a238_0x556f8d;return _0x56a523&&_0x56a523[_0x569020(0x1ba)]?_0x56a523:{'default':_0x56a523};};function a238_0x25da(){const _0x53d7c9=['1970ytlzaw','contact','getIO','../models/Whatsapp','user','toString','color','status','number','../libs/socket','1333587mKWkAn','default','__esModule','DESC','../models/Queue','8038456BHfSJd','sequelize','__importDefault','10ShUmBM','findOne','98199doBFIY','1040552Cxkrek','../models/User','477170RkCGAI','5309790MwQxVW','createdAt','whatsapp','update','../models/Contact','emit','findAndCountAll','../models/Message','2YxaUji','name','tags','profilePicUrl','1775935mNepuh'];a238_0x25da=function(){return _0x53d7c9;};return a238_0x25da();}Object['defineProperty'](exports,a238_0x556f8d(0x1ba),{'value':!![]}),exports['updateTicketByRemoteJid']=void 0x0;const Message_1=__importDefault(require(a238_0x556f8d(0x1a8))),Ticket_1=__importDefault(require('../models/Ticket')),sequelize_1=require(a238_0x556f8d(0x1be)),socket_1=require(a238_0x556f8d(0x1b7)),Contact_1=__importDefault(require(a238_0x556f8d(0x1a5))),User_1=__importDefault(require(a238_0x556f8d(0x1c4))),Queue_1=__importDefault(require(a238_0x556f8d(0x1bc))),Whatsapp_1=__importDefault(require(a238_0x556f8d(0x1b1))),Tag_1=__importDefault(require('../models/Tag')),updateTicketByRemoteJid=async(_0x3302d6,_0x1f7636,_0x81d7cf,_0x9d214a,_0x40c24b)=>{const _0x1c59fa=a238_0x556f8d,{rows:_0x23caf4}=await Message_1[_0x1c59fa(0x1b9)][_0x1c59fa(0x1a7)]({'limit':0x1,'order':[[_0x1c59fa(0x1c7),_0x1c59fa(0x1bb)]],'where':{'remoteJid':{[sequelize_1['Op']['like']]:'%'+_0x3302d6+'%'}}});console['log'](_0x23caf4),_0x23caf4['forEach'](async _0x1e216e=>{const _0x58904e=_0x1c59fa;let _0x1002fa=_0x1e216e['ticketId'],_0x532b50=await Ticket_1[_0x58904e(0x1b9)][_0x58904e(0x1c1)]({'where':{'id':_0x1002fa},'include':[{'model':Contact_1[_0x58904e(0x1b9)],'as':_0x58904e(0x1af),'attributes':['id','name',_0x58904e(0x1b6),_0x58904e(0x1ac)],'include':['extraInfo']},{'model':User_1[_0x58904e(0x1b9)],'as':_0x58904e(0x1b2),'attributes':['id','name']},{'model':Queue_1[_0x58904e(0x1b9)],'as':'queue','attributes':['id',_0x58904e(0x1aa),_0x58904e(0x1b4)]},{'model':Whatsapp_1[_0x58904e(0x1b9)],'as':_0x58904e(0x1a3),'attributes':['name']},{'model':Tag_1[_0x58904e(0x1b9)],'as':_0x58904e(0x1ab),'attributes':['id',_0x58904e(0x1aa),_0x58904e(0x1b4)]}]});const _0x13c808=_0x532b50[_0x58904e(0x1b5)],_0x1f1708=_0x532b50[_0x58904e(0x1b2)]?.['id'];await _0x532b50[_0x58904e(0x1a4)]({'status':_0x9d214a,'queueId':_0x1f7636,'userId':_0x81d7cf,'unreadMessages':_0x40c24b});const _0x4c3d5f=(0x0,socket_1[_0x58904e(0x1b0)])();_0x4c3d5f['to'](_0x532b50['id'][_0x58904e(0x1b3)]())[_0x58904e(0x1a6)]('company-'+_0x532b50['companyId']+'-ticket',{'action':_0x58904e(0x1a4),'ticket':_0x532b50});});return;};exports['updateTicketByRemoteJid']=updateTicketByRemoteJid;