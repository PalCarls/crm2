'use strict';const a286_0x2af901=a286_0x1df3;function a286_0x1df3(_0x51786b,_0xb04477){const _0x36963b=a286_0x3696();return a286_0x1df3=function(_0x1df398,_0x35fd31){_0x1df398=_0x1df398-0x8e;let _0x24eb3a=_0x36963b[_0x1df398];return _0x24eb3a;},a286_0x1df3(_0x51786b,_0xb04477);}function a286_0x3696(){const _0x30e6d7=['createdAt','whatsapp','updateUnread','__importDefault','default','fromMe','userId','../utils/logger','5836992ATOEFX','19940xRJHUZ','486GiVOXZ','261484dRSSAH','6634080UGSDZY','key','contacts:','update','channel','DESC','./GetTicketWbot','__esModule','notification','204708CKiUlz','companyId','emit','../models/Message','status','length',':unreads','1739792fPkCfz','75kYNNTV','9boLXSP','defineProperty','../libs/cache','parse','log','isBot','14885NnoAwZ','forEach','isGroup','contactId','Could\x20not\x20mark\x20messages\x20as\x20read.\x20Maybe\x20whatsapp\x20session\x20disconnected?\x20Err:\x20','getIO','-ticket','set'];a286_0x3696=function(){return _0x30e6d7;};return a286_0x3696();}(function(_0xcfe59d,_0x14ec46){const _0x250dde=a286_0x1df3,_0x5cfec6=_0xcfe59d();while(!![]){try{const _0x367b75=-parseInt(_0x250dde(0x93))/0x1+parseInt(_0x250dde(0xa6))/0x2*(parseInt(_0x250dde(0xb9))/0x3)+-parseInt(_0x250dde(0xb0))/0x4*(-parseInt(_0x250dde(0xb8))/0x5)+-parseInt(_0x250dde(0xa7))/0x6+parseInt(_0x250dde(0xa3))/0x7+-parseInt(_0x250dde(0xb7))/0x8+-parseInt(_0x250dde(0xa5))/0x9*(-parseInt(_0x250dde(0xa4))/0xa);if(_0x367b75===_0x14ec46)break;else _0x5cfec6['push'](_0x5cfec6['shift']());}catch(_0x5a1efe){_0x5cfec6['push'](_0x5cfec6['shift']());}}}(a286_0x3696,0xba5ee));var __importDefault=this&&this[a286_0x2af901(0x9e)]||function(_0xb2eedf){const _0x137d52=a286_0x2af901;return _0xb2eedf&&_0xb2eedf[_0x137d52(0xae)]?_0xb2eedf:{'default':_0xb2eedf};};Object[a286_0x2af901(0x8e)](exports,a286_0x2af901(0xae),{'value':!![]});const cache_1=__importDefault(require(a286_0x2af901(0x8f))),socket_1=require('../libs/socket'),Message_1=__importDefault(require(a286_0x2af901(0xb3))),logger_1=require(a286_0x2af901(0xa2)),GetTicketWbot_1=__importDefault(require(a286_0x2af901(0xad))),SetTicketMessagesAsRead=async _0x1832e3=>{const _0x3f2c1a=a286_0x2af901;!_0x1832e3['isBot']&&(_0x1832e3[_0x3f2c1a(0xa1)]||_0x1832e3['isGroup'])&&(await _0x1832e3[_0x3f2c1a(0xaa)]({'unreadMessages':0x0}),await cache_1[_0x3f2c1a(0x9f)][_0x3f2c1a(0x9a)](_0x3f2c1a(0xa9)+_0x1832e3[_0x3f2c1a(0x96)]+_0x3f2c1a(0xb6),'0'));if(_0x1832e3[_0x3f2c1a(0xab)]===_0x3f2c1a(0x9c))try{const _0x2c6d42=await(0x0,GetTicketWbot_1['default'])(_0x1832e3),_0x389c84=await Message_1[_0x3f2c1a(0x9f)]['findAll']({'where':{'ticketId':_0x1832e3['id'],'fromMe':![],'read':![]},'order':[[_0x3f2c1a(0x9b),_0x3f2c1a(0xac)]]});_0x389c84[_0x3f2c1a(0xb5)]>0x0&&_0x389c84[_0x3f2c1a(0x94)](async _0x600342=>{const _0x52b758=_0x3f2c1a,_0x3253a4=JSON[_0x52b758(0x90)](_0x600342['dataJson']);_0x3253a4[_0x52b758(0xa8)]&&_0x3253a4[_0x52b758(0xa8)][_0x52b758(0xa0)]===![]&&!_0x1832e3['isBot']&&(_0x1832e3[_0x52b758(0xa1)]||_0x1832e3[_0x52b758(0x95)])&&await _0x2c6d42['readMessages']([_0x3253a4['key']]);}),!_0x1832e3[_0x3f2c1a(0x92)]&&(_0x1832e3[_0x3f2c1a(0xa1)]||_0x1832e3['isGroup'])&&await Message_1[_0x3f2c1a(0x9f)][_0x3f2c1a(0xaa)]({'read':!![]},{'where':{'ticketId':_0x1832e3['id'],'read':![]}});}catch(_0x20494c){console[_0x3f2c1a(0x91)](_0x20494c),logger_1['logger']['warn'](_0x3f2c1a(0x97)+_0x20494c);}const _0x1a1c02=(0x0,socket_1[_0x3f2c1a(0x98)])();_0x1a1c02['to'](_0x1832e3[_0x3f2c1a(0xb4)])['to'](_0x3f2c1a(0xaf))[_0x3f2c1a(0xb2)]('company-'+_0x1832e3[_0x3f2c1a(0xb1)]+_0x3f2c1a(0x99),{'action':_0x3f2c1a(0x9d),'ticketId':_0x1832e3['id']});};exports[a286_0x2af901(0x9f)]=SetTicketMessagesAsRead;