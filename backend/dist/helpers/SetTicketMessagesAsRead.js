'use strict';const a250_0x5354bf=a250_0x8b75;(function(_0x954a4c,_0xe531ff){const _0x536496=a250_0x8b75,_0x5c4050=_0x954a4c();while(!![]){try{const _0x15d0a6=-parseInt(_0x536496(0x188))/0x1*(-parseInt(_0x536496(0x18a))/0x2)+-parseInt(_0x536496(0x184))/0x3+-parseInt(_0x536496(0x1a1))/0x4*(-parseInt(_0x536496(0x1a5))/0x5)+parseInt(_0x536496(0x1ac))/0x6+-parseInt(_0x536496(0x19c))/0x7+-parseInt(_0x536496(0x1a4))/0x8+parseInt(_0x536496(0x19d))/0x9;if(_0x15d0a6===_0xe531ff)break;else _0x5c4050['push'](_0x5c4050['shift']());}catch(_0x3703c6){_0x5c4050['push'](_0x5c4050['shift']());}}}(a250_0x376f,0x65327));function a250_0x376f(){const _0x5e8d20=['10jVrtoB','../models/Message','findAll','forEach','channel','logger','fromMe','2017704ttMRCG','-ticket','1890591DZqblX','./GetTicketWbot','defineProperty','length','2JgUCtX','default','771690tQgMeK','readMessages','warn','whatsapp','companyId','userId','createdAt','__esModule','dataJson','Could\x20not\x20mark\x20messages\x20as\x20read.\x20Maybe\x20whatsapp\x20session\x20disconnected?\x20Err:\x20','status','../libs/cache','DESC','contacts:','update','key','emit','updateUnread','71540zEdBex','350487QIOkBw','../utils/logger','getIO','isBot','342044HDPPuR','log','notification','2104152CeIycm'];a250_0x376f=function(){return _0x5e8d20;};return a250_0x376f();}function a250_0x8b75(_0x38ff6f,_0x134124){const _0x376fde=a250_0x376f();return a250_0x8b75=function(_0x8b75bb,_0x3b9cbf){_0x8b75bb=_0x8b75bb-0x183;let _0xbd7f4a=_0x376fde[_0x8b75bb];return _0xbd7f4a;},a250_0x8b75(_0x38ff6f,_0x134124);}var __importDefault=this&&this['__importDefault']||function(_0x3f3439){const _0x16d0e5=a250_0x8b75;return _0x3f3439&&_0x3f3439[_0x16d0e5(0x191)]?_0x3f3439:{'default':_0x3f3439};};Object[a250_0x5354bf(0x186)](exports,a250_0x5354bf(0x191),{'value':!![]});const cache_1=__importDefault(require(a250_0x5354bf(0x195))),socket_1=require('../libs/socket'),Message_1=__importDefault(require(a250_0x5354bf(0x1a6))),logger_1=require(a250_0x5354bf(0x19e)),GetTicketWbot_1=__importDefault(require(a250_0x5354bf(0x185))),SetTicketMessagesAsRead=async _0x257599=>{const _0x351421=a250_0x5354bf;!_0x257599[_0x351421(0x1a0)]&&_0x257599[_0x351421(0x18f)]&&(await _0x257599[_0x351421(0x198)]({'unreadMessages':0x0}),await cache_1[_0x351421(0x189)]['set'](_0x351421(0x197)+_0x257599['contactId']+':unreads','0'));if(_0x257599[_0x351421(0x1a9)]===_0x351421(0x18d))try{const _0x209f42=await(0x0,GetTicketWbot_1[_0x351421(0x189)])(_0x257599),_0x50260f=await Message_1[_0x351421(0x189)][_0x351421(0x1a7)]({'where':{'ticketId':_0x257599['id'],'fromMe':![],'read':![]},'order':[[_0x351421(0x190),_0x351421(0x196)]]});_0x50260f[_0x351421(0x187)]>0x0&&_0x50260f[_0x351421(0x1a8)](async _0x172a3c=>{const _0x3aecb3=_0x351421,_0x517f62=JSON['parse'](_0x172a3c[_0x3aecb3(0x192)]);_0x517f62[_0x3aecb3(0x199)]&&_0x517f62[_0x3aecb3(0x199)][_0x3aecb3(0x1ab)]===![]&&!_0x257599['isBot']&&_0x257599['userId']&&await _0x209f42[_0x3aecb3(0x18b)]([_0x517f62[_0x3aecb3(0x199)]]);}),!_0x257599[_0x351421(0x1a0)]&&_0x257599['userId']&&await Message_1[_0x351421(0x189)][_0x351421(0x198)]({'read':!![]},{'where':{'ticketId':_0x257599['id'],'read':![]}});}catch(_0x55c600){console[_0x351421(0x1a2)](_0x55c600),logger_1[_0x351421(0x1aa)][_0x351421(0x18c)](_0x351421(0x193)+_0x55c600);}const _0x20c9be=(0x0,socket_1[_0x351421(0x19f)])();_0x20c9be['to'](_0x257599[_0x351421(0x194)])['to'](_0x351421(0x1a3))[_0x351421(0x19a)]('company-'+_0x257599[_0x351421(0x18e)]+_0x351421(0x183),{'action':_0x351421(0x19b),'ticketId':_0x257599['id']});};exports[a250_0x5354bf(0x189)]=SetTicketMessagesAsRead;