'use strict';function a223_0x10d9(){const _0x37770a=['userId','DESC','company-','5184823tZpvvw','length','9103798OfnYpp','17382jOwYZX','184eNWASS','12yEiWXo','6746600HINcUL','logger','readMessages','emit','key','2CzjlPu','warn','notification','1122600fxUhoB','isBot','update','whatsapp','299457zSgFYe','default','status','__esModule','updateUnread','channel','createdAt','612swgKYV','848765KBvExw','getIO','defineProperty','./GetTicketWbot','Could\x20not\x20mark\x20messages\x20as\x20read.\x20Maybe\x20whatsapp\x20session\x20disconnected?\x20Err:\x20','../utils/logger'];a223_0x10d9=function(){return _0x37770a;};return a223_0x10d9();}const a223_0x5b5ef0=a223_0x2d77;(function(_0x5bbc9b,_0x427d34){const _0x1123d2=a223_0x2d77,_0x22a7d4=_0x5bbc9b();while(!![]){try{const _0x4c16c7=parseInt(_0x1123d2(0xa7))/0x1*(parseInt(_0x1123d2(0xa4))/0x2)+-parseInt(_0x1123d2(0xbf))/0x3*(parseInt(_0x1123d2(0xb2))/0x4)+-parseInt(_0x1123d2(0xb3))/0x5*(-parseInt(_0x1123d2(0xc1))/0x6)+parseInt(_0x1123d2(0xbc))/0x7+-parseInt(_0x1123d2(0xc0))/0x8*(-parseInt(_0x1123d2(0xab))/0x9)+-parseInt(_0x1123d2(0xc2))/0xa+-parseInt(_0x1123d2(0xbe))/0xb;if(_0x4c16c7===_0x427d34)break;else _0x22a7d4['push'](_0x22a7d4['shift']());}catch(_0x23002b){_0x22a7d4['push'](_0x22a7d4['shift']());}}}(a223_0x10d9,0x8d6f2));function a223_0x2d77(_0x319394,_0x16980b){const _0x10d98a=a223_0x10d9();return a223_0x2d77=function(_0x2d77fa,_0x13f711){_0x2d77fa=_0x2d77fa-0xa3;let _0x34d234=_0x10d98a[_0x2d77fa];return _0x34d234;},a223_0x2d77(_0x319394,_0x16980b);}var __importDefault=this&&this['__importDefault']||function(_0x2fb8ff){const _0x381ef6=a223_0x2d77;return _0x2fb8ff&&_0x2fb8ff[_0x381ef6(0xae)]?_0x2fb8ff:{'default':_0x2fb8ff};};Object[a223_0x5b5ef0(0xb5)](exports,a223_0x5b5ef0(0xae),{'value':!![]});const socket_1=require('../libs/socket'),Message_1=__importDefault(require('../models/Message')),logger_1=require(a223_0x5b5ef0(0xb8)),GetTicketWbot_1=__importDefault(require(a223_0x5b5ef0(0xb6))),SetTicketMessagesAsRead=async _0x5788f1=>{const _0x3c5ec7=a223_0x5b5ef0;!_0x5788f1['isBot']&&_0x5788f1[_0x3c5ec7(0xb9)]&&await _0x5788f1[_0x3c5ec7(0xa9)]({'unreadMessages':0x0});if(_0x5788f1[_0x3c5ec7(0xb0)]===_0x3c5ec7(0xaa))try{const _0xeec32d=await(0x0,GetTicketWbot_1['default'])(_0x5788f1),_0x71d237=await Message_1[_0x3c5ec7(0xac)]['findAll']({'where':{'ticketId':_0x5788f1['id'],'fromMe':![],'read':![]},'order':[[_0x3c5ec7(0xb1),_0x3c5ec7(0xba)]]});_0x71d237[_0x3c5ec7(0xbd)]>0x0&&_0x71d237['forEach'](async _0x29f20b=>{const _0x2d6438=_0x3c5ec7,_0x3f9bc0=JSON['parse'](_0x29f20b['dataJson']);_0x3f9bc0['key']&&_0x3f9bc0[_0x2d6438(0xa3)]['fromMe']===![]&&!_0x5788f1[_0x2d6438(0xa8)]&&_0x5788f1[_0x2d6438(0xb9)]&&await _0xeec32d[_0x2d6438(0xc4)]([_0x3f9bc0['key']]);}),!_0x5788f1[_0x3c5ec7(0xa8)]&&_0x5788f1[_0x3c5ec7(0xb9)]&&await Message_1[_0x3c5ec7(0xac)][_0x3c5ec7(0xa9)]({'read':!![]},{'where':{'ticketId':_0x5788f1['id'],'read':![]}});}catch(_0x418c79){console['log'](_0x418c79),logger_1[_0x3c5ec7(0xc3)][_0x3c5ec7(0xa5)](_0x3c5ec7(0xb7)+_0x418c79);}const _0x38d884=(0x0,socket_1[_0x3c5ec7(0xb4)])();_0x38d884['to'](_0x5788f1[_0x3c5ec7(0xad)])['to'](_0x3c5ec7(0xa6))[_0x3c5ec7(0xc5)](_0x3c5ec7(0xbb)+_0x5788f1['companyId']+'-ticket',{'action':_0x3c5ec7(0xaf),'ticketId':_0x5788f1['id']});};exports[a223_0x5b5ef0(0xac)]=SetTicketMessagesAsRead;