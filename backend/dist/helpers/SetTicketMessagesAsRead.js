'use strict';const a235_0x2f5601=a235_0x2221;(function(_0x19c4c7,_0x134ede){const _0x3046d0=a235_0x2221,_0x2a074b=_0x19c4c7();while(!![]){try{const _0x581839=-parseInt(_0x3046d0(0x99))/0x1*(parseInt(_0x3046d0(0x96))/0x2)+parseInt(_0x3046d0(0x9e))/0x3*(-parseInt(_0x3046d0(0xb6))/0x4)+parseInt(_0x3046d0(0x95))/0x5+parseInt(_0x3046d0(0xa6))/0x6+parseInt(_0x3046d0(0x91))/0x7+parseInt(_0x3046d0(0xa4))/0x8*(parseInt(_0x3046d0(0xaf))/0x9)+parseInt(_0x3046d0(0xae))/0xa*(-parseInt(_0x3046d0(0x97))/0xb);if(_0x581839===_0x134ede)break;else _0x2a074b['push'](_0x2a074b['shift']());}catch(_0x258a69){_0x2a074b['push'](_0x2a074b['shift']());}}}(a235_0xbb6b,0x52052));var __importDefault=this&&this[a235_0x2f5601(0xa8)]||function(_0x7b6e77){const _0x4dd4a1=a235_0x2f5601;return _0x7b6e77&&_0x7b6e77[_0x4dd4a1(0xb3)]?_0x7b6e77:{'default':_0x7b6e77};};function a235_0x2221(_0x5b4329,_0x1eda25){const _0xbb6be1=a235_0xbb6b();return a235_0x2221=function(_0x222172,_0x53b15c){_0x222172=_0x222172-0x91;let _0x5bd0db=_0xbb6be1[_0x222172];return _0x5bd0db;},a235_0x2221(_0x5b4329,_0x1eda25);}function a235_0xbb6b(){const _0x405714=['__importDefault','company-','../libs/socket','key','channel','findAll','21950YsZfap','5679DZdBWv','warn','updateUnread','fromMe','__esModule','forEach','getIO','80wbjecp','status','1830591aEHfzg','isBot','log','default','2486715tfqUlp','176ZRpoPD','1023wesdDS','defineProperty','4870pBeQMA','createdAt','../utils/logger','length','../models/Message','71007MQZtRN','-ticket','Could\x20not\x20mark\x20messages\x20as\x20read.\x20Maybe\x20whatsapp\x20session\x20disconnected?\x20Err:\x20','dataJson','emit','update','7848XOWFIc','logger','384972QPNatV','userId'];a235_0xbb6b=function(){return _0x405714;};return a235_0xbb6b();}Object[a235_0x2f5601(0x98)](exports,a235_0x2f5601(0xb3),{'value':!![]});const socket_1=require(a235_0x2f5601(0xaa)),Message_1=__importDefault(require(a235_0x2f5601(0x9d))),logger_1=require(a235_0x2f5601(0x9b)),GetTicketWbot_1=__importDefault(require('./GetTicketWbot')),SetTicketMessagesAsRead=async _0x392ada=>{const _0x562b7c=a235_0x2f5601;!_0x392ada[_0x562b7c(0x92)]&&_0x392ada['userId']&&await _0x392ada[_0x562b7c(0xa3)]({'unreadMessages':0x0});if(_0x392ada[_0x562b7c(0xac)]==='whatsapp')try{const _0x5b9bfc=await(0x0,GetTicketWbot_1[_0x562b7c(0x94)])(_0x392ada),_0x4d8a1a=await Message_1[_0x562b7c(0x94)][_0x562b7c(0xad)]({'where':{'ticketId':_0x392ada['id'],'fromMe':![],'read':![]},'order':[[_0x562b7c(0x9a),'DESC']]});_0x4d8a1a[_0x562b7c(0x9c)]>0x0&&_0x4d8a1a[_0x562b7c(0xb4)](async _0x24a771=>{const _0x3fd92c=_0x562b7c,_0x43a255=JSON['parse'](_0x24a771[_0x3fd92c(0xa1)]);_0x43a255[_0x3fd92c(0xab)]&&_0x43a255[_0x3fd92c(0xab)][_0x3fd92c(0xb2)]===![]&&!_0x392ada[_0x3fd92c(0x92)]&&_0x392ada[_0x3fd92c(0xa7)]&&await _0x5b9bfc['readMessages']([_0x43a255['key']]);}),!_0x392ada['isBot']&&_0x392ada[_0x562b7c(0xa7)]&&await Message_1[_0x562b7c(0x94)][_0x562b7c(0xa3)]({'read':!![]},{'where':{'ticketId':_0x392ada['id'],'read':![]}});}catch(_0x59bb69){console[_0x562b7c(0x93)](_0x59bb69),logger_1[_0x562b7c(0xa5)][_0x562b7c(0xb0)](_0x562b7c(0xa0)+_0x59bb69);}const _0x27ef43=(0x0,socket_1[_0x562b7c(0xb5)])();_0x27ef43['to'](_0x392ada[_0x562b7c(0xb7)])['to']('notification')[_0x562b7c(0xa2)](_0x562b7c(0xa9)+_0x392ada['companyId']+_0x562b7c(0x9f),{'action':_0x562b7c(0xb1),'ticketId':_0x392ada['id']});};exports[a235_0x2f5601(0x94)]=SetTicketMessagesAsRead;