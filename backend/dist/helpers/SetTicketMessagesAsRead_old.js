'use strict';const a224_0x2dec7b=a224_0x49fb;(function(_0x53555f,_0x331e73){const _0x52bd1f=a224_0x49fb,_0x4ff259=_0x53555f();while(!![]){try{const _0xe2795=-parseInt(_0x52bd1f(0xca))/0x1+-parseInt(_0x52bd1f(0xae))/0x2*(-parseInt(_0x52bd1f(0xb0))/0x3)+-parseInt(_0x52bd1f(0xc0))/0x4*(-parseInt(_0x52bd1f(0xb1))/0x5)+-parseInt(_0x52bd1f(0xbc))/0x6+parseInt(_0x52bd1f(0xcb))/0x7*(-parseInt(_0x52bd1f(0xb7))/0x8)+parseInt(_0x52bd1f(0xa7))/0x9*(-parseInt(_0x52bd1f(0xb5))/0xa)+parseInt(_0x52bd1f(0xb9))/0xb;if(_0xe2795===_0x331e73)break;else _0x4ff259['push'](_0x4ff259['shift']());}catch(_0x25939b){_0x4ff259['push'](_0x4ff259['shift']());}}}(a224_0x26c3,0x2c4a4));var __importDefault=this&&this[a224_0x2dec7b(0xa9)]||function(_0x52d1dc){const _0x378e19=a224_0x2dec7b;return _0x52d1dc&&_0x52d1dc[_0x378e19(0xb3)]?_0x52d1dc:{'default':_0x52d1dc};};function a224_0x26c3(){const _0x5a9a44=['__importDefault','forEach','notification',':unreads','createdAt','560hULVdO','Could\x20not\x20mark\x20messages\x20as\x20read.\x20Maybe\x20whatsapp\x20session\x20disconnected?\x20Err:\x20','2112WDpRtH','77010KMMCug','key','__esModule','./GetTicketWbot','31880kuMabj','contactId','8OFSgvh','cacheLayer','7497666ezhLRF','default','company-','1857960FsjVom','emit','warn','log','36pFDvBl','contacts:','findAll','companyId','../models/Message','../libs/cache','fromMe','logger','DESC','defineProperty','88541UbFDVf','2483901VBlPgv','getIO','-ticket','dataJson','set','length','updateUnread','234YYsSeu','../utils/logger'];a224_0x26c3=function(){return _0x5a9a44;};return a224_0x26c3();}function a224_0x49fb(_0x65658f,_0x7bf98f){const _0x26c3b4=a224_0x26c3();return a224_0x49fb=function(_0x49fb6a,_0x2950fd){_0x49fb6a=_0x49fb6a-0xa2;let _0x2748f3=_0x26c3b4[_0x49fb6a];return _0x2748f3;},a224_0x49fb(_0x65658f,_0x7bf98f);}Object[a224_0x2dec7b(0xc9)](exports,a224_0x2dec7b(0xb3),{'value':!![]});const cache_1=require(a224_0x2dec7b(0xc5)),socket_1=require('../libs/socket'),Message_1=__importDefault(require(a224_0x2dec7b(0xc4))),logger_1=require(a224_0x2dec7b(0xa8)),GetTicketWbot_1=__importDefault(require(a224_0x2dec7b(0xb4))),SetTicketMessagesAsRead=async _0x5ad126=>{const _0x264bec=a224_0x2dec7b;await _0x5ad126['update']({'unreadMessages':0x0}),await cache_1[_0x264bec(0xb8)][_0x264bec(0xa4)](_0x264bec(0xc1)+_0x5ad126[_0x264bec(0xb6)]+_0x264bec(0xac),'0');if(_0x5ad126['channel']==='whatsapp')try{const _0x341c9d=await(0x0,GetTicketWbot_1[_0x264bec(0xba)])(_0x5ad126),_0x15ba15=await Message_1['default'][_0x264bec(0xc2)]({'where':{'ticketId':_0x5ad126['id'],'fromMe':![],'read':![]},'order':[[_0x264bec(0xad),_0x264bec(0xc8)]]});_0x15ba15[_0x264bec(0xa5)]>0x0&&_0x15ba15[_0x264bec(0xaa)](async _0x38fdb9=>{const _0x54d0f5=_0x264bec,_0x4d6d40=JSON['parse'](_0x38fdb9[_0x54d0f5(0xa3)]);_0x4d6d40[_0x54d0f5(0xb2)]&&_0x4d6d40['key'][_0x54d0f5(0xc6)]===![]&&await _0x341c9d['readMessages']([_0x4d6d40[_0x54d0f5(0xb2)]]);}),await Message_1[_0x264bec(0xba)]['update']({'read':!![]},{'where':{'ticketId':_0x5ad126['id'],'read':![]}});}catch(_0x37dd33){console[_0x264bec(0xbf)](_0x37dd33),logger_1[_0x264bec(0xc7)][_0x264bec(0xbe)](_0x264bec(0xaf)+_0x37dd33);}const _0x482de8=(0x0,socket_1[_0x264bec(0xcc)])();_0x482de8['to'](_0x5ad126['status'])['to'](_0x264bec(0xab))[_0x264bec(0xbd)](_0x264bec(0xbb)+_0x5ad126[_0x264bec(0xc3)]+_0x264bec(0xa2),{'action':_0x264bec(0xa6),'ticketId':_0x5ad126['id']});};exports[a224_0x2dec7b(0xba)]=SetTicketMessagesAsRead;