'use strict';const a409_0x42c307=a409_0x3859;(function(_0x43eda4,_0x4e1ec0){const _0x4e9022=a409_0x3859,_0x1bf8fa=_0x43eda4();while(!![]){try{const _0x1ba818=parseInt(_0x4e9022(0x14f))/0x1*(-parseInt(_0x4e9022(0x159))/0x2)+parseInt(_0x4e9022(0x14c))/0x3*(parseInt(_0x4e9022(0x14a))/0x4)+-parseInt(_0x4e9022(0x152))/0x5+parseInt(_0x4e9022(0x15a))/0x6*(-parseInt(_0x4e9022(0x151))/0x7)+parseInt(_0x4e9022(0x153))/0x8*(-parseInt(_0x4e9022(0x158))/0x9)+parseInt(_0x4e9022(0x147))/0xa+parseInt(_0x4e9022(0x15b))/0xb*(-parseInt(_0x4e9022(0x15c))/0xc);if(_0x1ba818===_0x4e1ec0)break;else _0x1bf8fa['push'](_0x1bf8fa['shift']());}catch(_0x17ffe6){_0x1bf8fa['push'](_0x1bf8fa['shift']());}}}(a409_0x4c74,0xb8211));var __importDefault=this&&this[a409_0x42c307(0x156)]||function(_0x598407){const _0x2bed2e=a409_0x42c307;return _0x598407&&_0x598407[_0x2bed2e(0x148)]?_0x598407:{'default':_0x598407};};function a409_0x3859(_0x1f8aeb,_0x19b090){const _0x4c7425=a409_0x4c74();return a409_0x3859=function(_0x38593c,_0x2eb46b){_0x38593c=_0x38593c-0x142;let _0x16b761=_0x4c7425[_0x38593c];return _0x16b761;},a409_0x3859(_0x1f8aeb,_0x19b090);}function a409_0x4c74(){const _0xcf4986=['update','__importDefault','name','18haaJqg','6Zzpkoq','6zChxSb','191807RcYLGi','48bETCYe','unreads','create','findAll','sender','chat','../../models/Chat','../../models/ChatUser','../../models/ChatMessage','14690550xKksDn','__esModule','users','5756068gOPrXN','default','3PEYwsB','../../models/User','defineProperty','273555HdnCGB','reload','6661179Qcvjtm','850325OQzRGu','567216KBQXyM','userId'];a409_0x4c74=function(){return _0xcf4986;};return a409_0x4c74();}Object[a409_0x42c307(0x14e)](exports,a409_0x42c307(0x148),{'value':!![]});const Chat_1=__importDefault(require(a409_0x42c307(0x144))),ChatMessage_1=__importDefault(require(a409_0x42c307(0x146))),ChatUser_1=__importDefault(require(a409_0x42c307(0x145))),User_1=__importDefault(require(a409_0x42c307(0x14d)));async function CreateMessageService({senderId:_0xee0d47,chatId:_0x497849,message:_0x13efb7}){const _0x4c3a95=a409_0x42c307,_0x5df725=await ChatMessage_1[_0x4c3a95(0x14b)][_0x4c3a95(0x15e)]({'senderId':_0xee0d47,'chatId':_0x497849,'message':_0x13efb7});await _0x5df725[_0x4c3a95(0x150)]({'include':[{'model':User_1[_0x4c3a95(0x14b)],'as':_0x4c3a95(0x142),'attributes':['id',_0x4c3a95(0x157)]},{'model':Chat_1[_0x4c3a95(0x14b)],'as':_0x4c3a95(0x143),'include':[{'model':ChatUser_1[_0x4c3a95(0x14b)],'as':_0x4c3a95(0x149)}]}]});const _0x58a4b5=await User_1['default']['findByPk'](_0xee0d47);await _0x5df725['chat'][_0x4c3a95(0x155)]({'lastMessage':_0x58a4b5[_0x4c3a95(0x157)]+':\x20'+_0x13efb7});const _0x4c2a53=await ChatUser_1['default'][_0x4c3a95(0x15f)]({'where':{'chatId':_0x497849}});for(let _0x41fca0 of _0x4c2a53){_0x41fca0[_0x4c3a95(0x154)]===_0xee0d47?await _0x41fca0['update']({'unreads':0x0}):await _0x41fca0[_0x4c3a95(0x155)]({'unreads':_0x41fca0[_0x4c3a95(0x15d)]+0x1});}return _0x5df725;}exports[a409_0x42c307(0x14b)]=CreateMessageService;