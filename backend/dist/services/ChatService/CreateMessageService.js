'use strict';const a418_0x1c8abd=a418_0xa534;function a418_0xa534(_0x2c2a16,_0x21009d){const _0x3921b3=a418_0x3921();return a418_0xa534=function(_0xa5340d,_0x4b9c09){_0xa5340d=_0xa5340d-0x95;let _0x44ad85=_0x3921b3[_0xa5340d];return _0x44ad85;},a418_0xa534(_0x2c2a16,_0x21009d);}(function(_0x277994,_0x1751af){const _0x648519=a418_0xa534,_0x59e6cc=_0x277994();while(!![]){try{const _0x5f4b7b=parseInt(_0x648519(0xad))/0x1*(parseInt(_0x648519(0x9f))/0x2)+-parseInt(_0x648519(0xa6))/0x3+-parseInt(_0x648519(0x98))/0x4+-parseInt(_0x648519(0xa9))/0x5+parseInt(_0x648519(0x96))/0x6*(-parseInt(_0x648519(0x95))/0x7)+-parseInt(_0x648519(0x9c))/0x8+parseInt(_0x648519(0xa1))/0x9;if(_0x5f4b7b===_0x1751af)break;else _0x59e6cc['push'](_0x59e6cc['shift']());}catch(_0x559b97){_0x59e6cc['push'](_0x59e6cc['shift']());}}}(a418_0x3921,0x2ea39));var __importDefault=this&&this[a418_0x1c8abd(0x9a)]||function(_0x26ead3){const _0x33d6ce=a418_0x1c8abd;return _0x26ead3&&_0x26ead3[_0x33d6ce(0xa8)]?_0x26ead3:{'default':_0x26ead3};};Object[a418_0x1c8abd(0xa7)](exports,'__esModule',{'value':!![]});const Chat_1=__importDefault(require(a418_0x1c8abd(0x99))),ChatMessage_1=__importDefault(require(a418_0x1c8abd(0x9e))),ChatUser_1=__importDefault(require(a418_0x1c8abd(0xae))),User_1=__importDefault(require(a418_0x1c8abd(0xa5)));async function CreateMessageService({senderId:_0x2cab9f,chatId:_0x1c668b,message:_0x5bc0fd}){const _0xf810fa=a418_0x1c8abd,_0x19be47=await ChatMessage_1[_0xf810fa(0x97)][_0xf810fa(0xa0)]({'senderId':_0x2cab9f,'chatId':_0x1c668b,'message':_0x5bc0fd});await _0x19be47[_0xf810fa(0xab)]({'include':[{'model':User_1[_0xf810fa(0x97)],'as':_0xf810fa(0xa4),'attributes':['id',_0xf810fa(0xaf)]},{'model':Chat_1['default'],'as':_0xf810fa(0x9d),'include':[{'model':ChatUser_1[_0xf810fa(0x97)],'as':_0xf810fa(0xa3)}]}]});const _0x457586=await User_1[_0xf810fa(0x97)][_0xf810fa(0xa2)](_0x2cab9f);await _0x19be47[_0xf810fa(0x9d)][_0xf810fa(0xaa)]({'lastMessage':_0x457586['name']+':\x20'+_0x5bc0fd});const _0x44340e=await ChatUser_1[_0xf810fa(0x97)][_0xf810fa(0xac)]({'where':{'chatId':_0x1c668b}});for(let _0x557b1a of _0x44340e){_0x557b1a[_0xf810fa(0x9b)]===_0x2cab9f?await _0x557b1a[_0xf810fa(0xaa)]({'unreads':0x0}):await _0x557b1a[_0xf810fa(0xaa)]({'unreads':_0x557b1a['unreads']+0x1});}return _0x19be47;}function a418_0x3921(){const _0x179b56=['454134TCUReb','default','202748aTGUGY','../../models/Chat','__importDefault','userId','2368488BTmbfw','chat','../../models/ChatMessage','10666JMvpgO','create','6395571gMHpCI','findByPk','users','sender','../../models/User','422424FyLbDc','defineProperty','__esModule','741645WLPCgC','update','reload','findAll','36rmEEgh','../../models/ChatUser','name','7dHiMYX'];a418_0x3921=function(){return _0x179b56;};return a418_0x3921();}exports['default']=CreateMessageService;