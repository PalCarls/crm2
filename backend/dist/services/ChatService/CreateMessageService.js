'use strict';const a374_0x48cd8e=a374_0x3c52;(function(_0x3c58c4,_0x2f17e4){const _0x867bc8=a374_0x3c52,_0x34c694=_0x3c58c4();while(!![]){try{const _0x5086e6=parseInt(_0x867bc8(0x169))/0x1*(parseInt(_0x867bc8(0x15c))/0x2)+parseInt(_0x867bc8(0x163))/0x3*(parseInt(_0x867bc8(0x15f))/0x4)+-parseInt(_0x867bc8(0x161))/0x5+parseInt(_0x867bc8(0x167))/0x6+-parseInt(_0x867bc8(0x172))/0x7*(-parseInt(_0x867bc8(0x173))/0x8)+parseInt(_0x867bc8(0x168))/0x9+-parseInt(_0x867bc8(0x164))/0xa;if(_0x5086e6===_0x2f17e4)break;else _0x34c694['push'](_0x34c694['shift']());}catch(_0x28ad31){_0x34c694['push'](_0x34c694['shift']());}}}(a374_0x44fb,0x1b4b7));function a374_0x3c52(_0x32e12b,_0x428f5a){const _0x44fb36=a374_0x44fb();return a374_0x3c52=function(_0x3c5278,_0x1fe430){_0x3c5278=_0x3c5278-0x15a;let _0x3cc697=_0x44fb36[_0x3c5278];return _0x3cc697;},a374_0x3c52(_0x32e12b,_0x428f5a);}var __importDefault=this&&this[a374_0x48cd8e(0x165)]||function(_0x390823){const _0x360df5=a374_0x48cd8e;return _0x390823&&_0x390823[_0x360df5(0x171)]?_0x390823:{'default':_0x390823};};Object[a374_0x48cd8e(0x16a)](exports,'__esModule',{'value':!![]});const Chat_1=__importDefault(require(a374_0x48cd8e(0x16c))),ChatMessage_1=__importDefault(require(a374_0x48cd8e(0x16d))),ChatUser_1=__importDefault(require('../../models/ChatUser')),User_1=__importDefault(require(a374_0x48cd8e(0x170)));async function CreateMessageService({senderId:_0x1569b1,chatId:_0x574e45,message:_0x41749e}){const _0x15c5fc=a374_0x48cd8e,_0x1ca8c8=await ChatMessage_1[_0x15c5fc(0x15d)][_0x15c5fc(0x16b)]({'senderId':_0x1569b1,'chatId':_0x574e45,'message':_0x41749e});await _0x1ca8c8[_0x15c5fc(0x16f)]({'include':[{'model':User_1[_0x15c5fc(0x15d)],'as':_0x15c5fc(0x166),'attributes':['id',_0x15c5fc(0x16e)]},{'model':Chat_1[_0x15c5fc(0x15d)],'as':_0x15c5fc(0x15b),'include':[{'model':ChatUser_1[_0x15c5fc(0x15d)],'as':_0x15c5fc(0x15e)}]}]});const _0xfd8f9f=await User_1['default']['findByPk'](_0x1569b1);await _0x1ca8c8[_0x15c5fc(0x15b)][_0x15c5fc(0x160)]({'lastMessage':_0xfd8f9f[_0x15c5fc(0x16e)]+':\x20'+_0x41749e});const _0x53d794=await ChatUser_1[_0x15c5fc(0x15d)][_0x15c5fc(0x15a)]({'where':{'chatId':_0x574e45}});for(let _0x34a360 of _0x53d794){_0x34a360['userId']===_0x1569b1?await _0x34a360['update']({'unreads':0x0}):await _0x34a360['update']({'unreads':_0x34a360[_0x15c5fc(0x162)]+0x1});}return _0x1ca8c8;}exports[a374_0x48cd8e(0x15d)]=CreateMessageService;function a374_0x44fb(){const _0x46418e=['chat','678lqeOsA','default','users','873396EekOdS','update','1078840izFIBv','unreads','3PQTkWq','3141100rAQZsr','__importDefault','sender','537114NTblFO','846657mulOFw','409oSTuIL','defineProperty','create','../../models/Chat','../../models/ChatMessage','name','reload','../../models/User','__esModule','707595kGvObK','8yVYeBp','findAll'];a374_0x44fb=function(){return _0x46418e;};return a374_0x44fb();}