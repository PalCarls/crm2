'use strict';const a418_0x16a702=a418_0x1e89;(function(_0x1cd357,_0x1b649a){const _0x1f35ac=a418_0x1e89,_0x214911=_0x1cd357();while(!![]){try{const _0x3077a3=parseInt(_0x1f35ac(0x168))/0x1+-parseInt(_0x1f35ac(0x165))/0x2+parseInt(_0x1f35ac(0x158))/0x3*(-parseInt(_0x1f35ac(0x15a))/0x4)+-parseInt(_0x1f35ac(0x164))/0x5+parseInt(_0x1f35ac(0x15f))/0x6*(-parseInt(_0x1f35ac(0x16d))/0x7)+-parseInt(_0x1f35ac(0x16b))/0x8+-parseInt(_0x1f35ac(0x15e))/0x9*(-parseInt(_0x1f35ac(0x156))/0xa);if(_0x3077a3===_0x1b649a)break;else _0x214911['push'](_0x214911['shift']());}catch(_0x308c7e){_0x214911['push'](_0x214911['shift']());}}}(a418_0x1c49,0x5950d));var __importDefault=this&&this['__importDefault']||function(_0xeeaf62){const _0x2d7364=a418_0x1e89;return _0xeeaf62&&_0xeeaf62[_0x2d7364(0x16a)]?_0xeeaf62:{'default':_0xeeaf62};};Object[a418_0x16a702(0x166)](exports,a418_0x16a702(0x16a),{'value':!![]});function a418_0x1c49(){const _0x3deff6=['5088288Dkxutx','users','681093WDbTFS','22171990DLcQxL','sender','186gUGCTe','chat','27532kGAZIm','default','name','create','9VHiCJa','6vjHxtl','update','unreads','findByPk','../../models/Chat','3320625ZBmJrp','1340786wsBEMP','defineProperty','../../models/ChatUser','643237gVXAeK','findAll','__esModule'];a418_0x1c49=function(){return _0x3deff6;};return a418_0x1c49();}const Chat_1=__importDefault(require(a418_0x16a702(0x163))),ChatMessage_1=__importDefault(require('../../models/ChatMessage')),ChatUser_1=__importDefault(require(a418_0x16a702(0x167))),User_1=__importDefault(require('../../models/User'));async function CreateMessageService({senderId:_0x36700f,chatId:_0x5391f7,message:_0x4c7f29}){const _0x2e8f4c=a418_0x16a702,_0x5f742a=await ChatMessage_1[_0x2e8f4c(0x15b)][_0x2e8f4c(0x15d)]({'senderId':_0x36700f,'chatId':_0x5391f7,'message':_0x4c7f29});await _0x5f742a['reload']({'include':[{'model':User_1[_0x2e8f4c(0x15b)],'as':_0x2e8f4c(0x157),'attributes':['id',_0x2e8f4c(0x15c)]},{'model':Chat_1[_0x2e8f4c(0x15b)],'as':_0x2e8f4c(0x159),'include':[{'model':ChatUser_1[_0x2e8f4c(0x15b)],'as':_0x2e8f4c(0x16c)}]}]});const _0x1b2909=await User_1[_0x2e8f4c(0x15b)][_0x2e8f4c(0x162)](_0x36700f);await _0x5f742a[_0x2e8f4c(0x159)]['update']({'lastMessage':_0x1b2909[_0x2e8f4c(0x15c)]+':\x20'+_0x4c7f29});const _0x3ce5e9=await ChatUser_1[_0x2e8f4c(0x15b)][_0x2e8f4c(0x169)]({'where':{'chatId':_0x5391f7}});for(let _0x6b0661 of _0x3ce5e9){_0x6b0661['userId']===_0x36700f?await _0x6b0661[_0x2e8f4c(0x160)]({'unreads':0x0}):await _0x6b0661[_0x2e8f4c(0x160)]({'unreads':_0x6b0661[_0x2e8f4c(0x161)]+0x1});}return _0x5f742a;}function a418_0x1e89(_0x42f6fe,_0x4080d7){const _0x1c4965=a418_0x1c49();return a418_0x1e89=function(_0x1e89f5,_0x4326b3){_0x1e89f5=_0x1e89f5-0x156;let _0x380bfe=_0x1c4965[_0x1e89f5];return _0x380bfe;},a418_0x1e89(_0x42f6fe,_0x4080d7);}exports[a418_0x16a702(0x15b)]=CreateMessageService;