<<<<<<< HEAD
'use strict';const a494_0x216f4e=a494_0x1098;function a494_0x1098(_0xa66832,_0x4178f2){const _0x1ad3d4=a494_0x1ad3();return a494_0x1098=function(_0x109884,_0x569f44){_0x109884=_0x109884-0x18b;let _0x1a5461=_0x1ad3d4[_0x109884];return _0x1a5461;},a494_0x1098(_0xa66832,_0x4178f2);}(function(_0x13cd84,_0x1661d2){const _0x42251b=a494_0x1098,_0x2f6a27=_0x13cd84();while(!![]){try{const _0x523690=-parseInt(_0x42251b(0x196))/0x1+-parseInt(_0x42251b(0x19c))/0x2+parseInt(_0x42251b(0x1a9))/0x3*(parseInt(_0x42251b(0x1a3))/0x4)+-parseInt(_0x42251b(0x1a6))/0x5*(parseInt(_0x42251b(0x1a0))/0x6)+-parseInt(_0x42251b(0x192))/0x7*(parseInt(_0x42251b(0x1aa))/0x8)+parseInt(_0x42251b(0x18f))/0x9*(-parseInt(_0x42251b(0x19e))/0xa)+parseInt(_0x42251b(0x1ae))/0xb*(parseInt(_0x42251b(0x18c))/0xc);if(_0x523690===_0x1661d2)break;else _0x2f6a27['push'](_0x2f6a27['shift']());}catch(_0x1f496a){_0x2f6a27['push'](_0x2f6a27['shift']());}}}(a494_0x1ad3,0x450e3));function a494_0x1ad3(){const _0x187ed0=['../../errors/AppError','4103jQDaMO','profile','../TicketServices/ShowTicketService','whatsappId','54180uVibUx','ERR_NO_TICKET_FOUND','__esModule','36pohRsu','queue','sequelize','547939DOxZBh','DESC','map','quotedMsg','207049BqsDSi','intersection','isGroup','createdAt','lodash','reverse','579604ixEwPz','default','722350erwZOw','lte','60NBFpNo','contact','findAll','413580xwfcUI','../../models/Message','companyId','202870qlJbTG','findAndCountAll','../../models/Ticket','3jDEFan','32mwzLWb','contactId','enable'];a494_0x1ad3=function(){return _0x187ed0;};return a494_0x1ad3();}var __importDefault=this&&this['__importDefault']||function(_0x4f4216){return _0x4f4216&&_0x4f4216['__esModule']?_0x4f4216:{'default':_0x4f4216};};Object['defineProperty'](exports,a494_0x216f4e(0x18e),{'value':!![]});const AppError_1=__importDefault(require(a494_0x216f4e(0x1ad))),Message_1=__importDefault(require(a494_0x216f4e(0x1a4))),Ticket_1=__importDefault(require(a494_0x216f4e(0x1a8))),ShowTicketService_1=__importDefault(require(a494_0x216f4e(0x1b0))),sequelize_1=require(a494_0x216f4e(0x191)),lodash_1=require(a494_0x216f4e(0x19a)),isQueueIdHistoryBlocked_1=__importDefault(require('../UserServices/isQueueIdHistoryBlocked')),ListMessagesService=async({pageNumber:pageNumber='1',ticketId:_0x2a393c,companyId:_0x5a48d1,queues:queues=[],user:_0x3c5eec})=>{const _0x5d799f=a494_0x216f4e,_0x45b2f8=await(0x0,ShowTicketService_1['default'])(_0x2a393c,_0x5a48d1),_0x402494=[],_0x5dcf99=await(0x0,isQueueIdHistoryBlocked_1['default'])({'userRequest':_0x3c5eec['id']});let _0x597108=[];!_0x5dcf99?_0x597108=await Ticket_1['default'][_0x5d799f(0x1a2)]({'where':{'id':{[sequelize_1['Op'][_0x5d799f(0x19f)]]:_0x45b2f8['id']},'companyId':_0x45b2f8[_0x5d799f(0x1a5)],'contactId':_0x45b2f8[_0x5d799f(0x1ab)],'whatsappId':_0x45b2f8[_0x5d799f(0x18b)],'isGroup':_0x45b2f8[_0x5d799f(0x198)],'queueId':_0x3c5eec[_0x5d799f(0x1af)]==='admin'||_0x3c5eec['allTicket']===_0x5d799f(0x1ac)?{[sequelize_1['Op']['or']]:[queues,null]}:{[sequelize_1['Op']['in']]:queues}},'attributes':['id']}):_0x597108=await Ticket_1['default'][_0x5d799f(0x1a2)]({'where':{'id':{[sequelize_1['Op'][_0x5d799f(0x19f)]]:_0x45b2f8['id']},'companyId':_0x45b2f8[_0x5d799f(0x1a5)],'contactId':_0x45b2f8[_0x5d799f(0x1ab)],'whatsappId':_0x45b2f8[_0x5d799f(0x18b)],'isGroup':_0x45b2f8['isGroup']},'attributes':['id']});_0x597108&&_0x402494['push'](_0x597108[_0x5d799f(0x194)](_0x1434a6=>_0x1434a6['id']));const _0x38ad07=(0x0,lodash_1[_0x5d799f(0x197)])(..._0x402494);if(!_0x38ad07)throw new AppError_1[(_0x5d799f(0x19d))](_0x5d799f(0x18d),0x194);const _0x2c6bee=0x14,_0x1d09a1=_0x2c6bee*(+pageNumber-0x1),{count:_0x1ce4a4,rows:_0x456788}=await Message_1[_0x5d799f(0x19d)][_0x5d799f(0x1a7)]({'where':{'ticketId':_0x38ad07,'companyId':_0x5a48d1},'limit':_0x2c6bee,'include':[_0x5d799f(0x1a1),{'model':Message_1[_0x5d799f(0x19d)],'as':_0x5d799f(0x195),'include':[_0x5d799f(0x1a1)]},{'model':Ticket_1[_0x5d799f(0x19d)],'required':!![],'include':[_0x5d799f(0x190)]}],'distinct':!![],'offset':_0x1d09a1,'order':[[_0x5d799f(0x199),_0x5d799f(0x193)]]}),_0x2ef137=_0x1ce4a4>_0x1d09a1+_0x456788['length'];return{'messages':_0x456788[_0x5d799f(0x19b)](),'ticket':_0x45b2f8,'count':_0x1ce4a4,'hasMore':_0x2ef137};};exports['default']=ListMessagesService;
=======
'use strict';function a494_0x3bbe(){const _0x411469=['DESC','../../errors/AppError','250075PyqGKn','../../models/Ticket','../../models/Message','findAndCountAll','allTicket','queue','defineProperty','1470692NfPHuy','../UserServices/isQueueIdHistoryBlocked','sequelize','isGroup','default','findAll','297738SCsgpN','contactId','ERR_NO_TICKET_FOUND','__importDefault','../TicketServices/ShowTicketService','106435QlUDdX','profile','13342RTmzle','222gQgaxo','7712648YvkwlH','length','contact','companyId','quotedMsg','map','__esModule','reverse','lte','lodash','653394qsSpbH','createdAt','intersection'];a494_0x3bbe=function(){return _0x411469;};return a494_0x3bbe();}const a494_0xa01202=a494_0x25a4;(function(_0x461b3e,_0xe5bffa){const _0x23318c=a494_0x25a4,_0x21b3df=_0x461b3e();while(!![]){try{const _0x48d0e5=-parseInt(_0x23318c(0x96))/0x1+parseInt(_0x23318c(0x7e))/0x2+-parseInt(_0x23318c(0x91))/0x3+-parseInt(_0x23318c(0x78))/0x4+-parseInt(_0x23318c(0x83))/0x5+-parseInt(_0x23318c(0x86))/0x6*(parseInt(_0x23318c(0x85))/0x7)+parseInt(_0x23318c(0x87))/0x8;if(_0x48d0e5===_0xe5bffa)break;else _0x21b3df['push'](_0x21b3df['shift']());}catch(_0x17a1e4){_0x21b3df['push'](_0x21b3df['shift']());}}}(a494_0x3bbe,0x2d4fb));var __importDefault=this&&this[a494_0xa01202(0x81)]||function(_0x94d8fa){const _0x2fd986=a494_0xa01202;return _0x94d8fa&&_0x94d8fa[_0x2fd986(0x8d)]?_0x94d8fa:{'default':_0x94d8fa};};Object[a494_0xa01202(0x77)](exports,a494_0xa01202(0x8d),{'value':!![]});function a494_0x25a4(_0x2d492f,_0x256eb7){const _0x3bbe09=a494_0x3bbe();return a494_0x25a4=function(_0x25a446,_0x336d74){_0x25a446=_0x25a446-0x76;let _0x54191e=_0x3bbe09[_0x25a446];return _0x54191e;},a494_0x25a4(_0x2d492f,_0x256eb7);}const AppError_1=__importDefault(require(a494_0xa01202(0x95))),Message_1=__importDefault(require(a494_0xa01202(0x98))),Ticket_1=__importDefault(require(a494_0xa01202(0x97))),ShowTicketService_1=__importDefault(require(a494_0xa01202(0x82))),sequelize_1=require(a494_0xa01202(0x7a)),lodash_1=require(a494_0xa01202(0x90)),isQueueIdHistoryBlocked_1=__importDefault(require(a494_0xa01202(0x79))),ListMessagesService=async({pageNumber:pageNumber='1',ticketId:_0x5bd35b,companyId:_0x1d35a9,queues:queues=[],user:_0x279c2d})=>{const _0x31c9ed=a494_0xa01202,_0x303da5=await(0x0,ShowTicketService_1['default'])(_0x5bd35b,_0x1d35a9),_0x3fba2c=[],_0x384224=await(0x0,isQueueIdHistoryBlocked_1[_0x31c9ed(0x7c)])({'userRequest':_0x279c2d['id']});let _0x68f446=[];!_0x384224?_0x68f446=await Ticket_1[_0x31c9ed(0x7c)][_0x31c9ed(0x7d)]({'where':{'id':{[sequelize_1['Op'][_0x31c9ed(0x8f)]]:_0x303da5['id']},'companyId':_0x303da5[_0x31c9ed(0x8a)],'contactId':_0x303da5['contactId'],'whatsappId':_0x303da5['whatsappId'],'isGroup':_0x303da5[_0x31c9ed(0x7b)],'queueId':_0x279c2d[_0x31c9ed(0x84)]==='admin'||_0x279c2d[_0x31c9ed(0x9a)]==='enable'?{[sequelize_1['Op']['or']]:[queues,null]}:{[sequelize_1['Op']['in']]:queues}},'attributes':['id']}):_0x68f446=await Ticket_1[_0x31c9ed(0x7c)][_0x31c9ed(0x7d)]({'where':{'id':{[sequelize_1['Op'][_0x31c9ed(0x8f)]]:_0x303da5['id']},'companyId':_0x303da5[_0x31c9ed(0x8a)],'contactId':_0x303da5[_0x31c9ed(0x7f)],'whatsappId':_0x303da5['whatsappId'],'isGroup':_0x303da5['isGroup']},'attributes':['id']});_0x68f446&&_0x3fba2c['push'](_0x68f446[_0x31c9ed(0x8c)](_0x3b4efc=>_0x3b4efc['id']));const _0x544034=(0x0,lodash_1[_0x31c9ed(0x93)])(..._0x3fba2c);if(!_0x544034)throw new AppError_1[(_0x31c9ed(0x7c))](_0x31c9ed(0x80),0x194);const _0x4d0ed5=0x14,_0x554d22=_0x4d0ed5*(+pageNumber-0x1),{count:_0x5c12ff,rows:_0x35d625}=await Message_1[_0x31c9ed(0x7c)][_0x31c9ed(0x99)]({'where':{'ticketId':_0x544034,'companyId':_0x1d35a9},'limit':_0x4d0ed5,'include':[_0x31c9ed(0x89),{'model':Message_1[_0x31c9ed(0x7c)],'as':_0x31c9ed(0x8b),'include':[_0x31c9ed(0x89)]},{'model':Ticket_1[_0x31c9ed(0x7c)],'required':!![],'include':[_0x31c9ed(0x76)]}],'distinct':!![],'offset':_0x554d22,'order':[[_0x31c9ed(0x92),_0x31c9ed(0x94)]]}),_0x4b2fdf=_0x5c12ff>_0x554d22+_0x35d625[_0x31c9ed(0x88)];return{'messages':_0x35d625[_0x31c9ed(0x8e)](),'ticket':_0x303da5,'count':_0x5c12ff,'hasMore':_0x4b2fdf};};exports[a494_0xa01202(0x7c)]=ListMessagesService;
>>>>>>> ab722bfbcf394d74dd0b99a984c0dcf6ffbcff7f
