'use strict';const a440_0x4ed64d=a440_0x4c6e;(function(_0x2944ae,_0x2e21c4){const _0x5e403a=a440_0x4c6e,_0x3a4712=_0x2944ae();while(!![]){try{const _0x1b0930=parseInt(_0x5e403a(0x91))/0x1+-parseInt(_0x5e403a(0x96))/0x2*(parseInt(_0x5e403a(0x9d))/0x3)+parseInt(_0x5e403a(0x97))/0x4+parseInt(_0x5e403a(0x98))/0x5*(-parseInt(_0x5e403a(0x92))/0x6)+parseInt(_0x5e403a(0x8c))/0x7+-parseInt(_0x5e403a(0x9f))/0x8*(parseInt(_0x5e403a(0x8d))/0x9)+parseInt(_0x5e403a(0xa1))/0xa;if(_0x1b0930===_0x2e21c4)break;else _0x3a4712['push'](_0x3a4712['shift']());}catch(_0x4b9659){_0x3a4712['push'](_0x3a4712['shift']());}}}(a440_0xf533,0x699cf));function a440_0x4c6e(_0x52e3b1,_0x18ec66){const _0xf53374=a440_0xf533();return a440_0x4c6e=function(_0x4c6e93,_0x5c89fe){_0x4c6e93=_0x4c6e93-0x81;let _0x21d56f=_0xf53374[_0x4c6e93];return _0x21d56f;},a440_0x4c6e(_0x52e3b1,_0x18ec66);}var __importDefault=this&&this[a440_0x4ed64d(0x8a)]||function(_0x4fa21f){const _0x13aa60=a440_0x4ed64d;return _0x4fa21f&&_0x4fa21f[_0x13aa60(0x81)]?_0x4fa21f:{'default':_0x4fa21f};};Object[a440_0x4ed64d(0x95)](exports,'__esModule',{'value':!![]});function a440_0xf533(){const _0x5b90b5=['22OoaPOX','1088884QHpeHr','45yKAVww','push','contact','isGroup','contactId','52701LDOeAC','quotedMsg','3784ZAxqVb','sequelize','6452810fXlLtk','__esModule','lodash','../../models/Message','../TicketServices/ShowTicketService','queueId','createdAt','map','default','ERR_NO_TICKET_FOUND','__importDefault','../../models/Ticket','346619kyTxMr','9729XJlQdd','whatsappId','DESC','findAll','682105nyWIiv','341322LqHtDW','findAndCountAll','reverse','defineProperty'];a440_0xf533=function(){return _0x5b90b5;};return a440_0xf533();}const AppError_1=__importDefault(require('../../errors/AppError')),Message_1=__importDefault(require(a440_0x4ed64d(0x83))),Ticket_1=__importDefault(require(a440_0x4ed64d(0x8b))),ShowTicketService_1=__importDefault(require(a440_0x4ed64d(0x84))),sequelize_1=require(a440_0x4ed64d(0xa0)),lodash_1=require(a440_0x4ed64d(0x82)),ListMessagesService=async({pageNumber:pageNumber='1',ticketId:_0x21c3b1,companyId:_0x320266,queues:queues=[]})=>{const _0x30c81b=a440_0x4ed64d,_0x3e0325=await(0x0,ShowTicketService_1[_0x30c81b(0x88)])(_0x21c3b1,_0x320266),_0x2f56c2=[],_0x5a9e6b=await Ticket_1['default'][_0x30c81b(0x90)]({'where':{'status':'closed','queueId':_0x3e0325[_0x30c81b(0x85)],'contactId':_0x3e0325['contactId'],'whatsappId':_0x3e0325['whatsappId'],'companyId':_0x320266}});_0x5a9e6b&&_0x2f56c2[_0x30c81b(0x99)](_0x5a9e6b[_0x30c81b(0x87)](_0x52c4c7=>_0x52c4c7['id']));const _0x19e295=(0x0,lodash_1['intersection'])(..._0x2f56c2);if(!_0x3e0325)throw new AppError_1[(_0x30c81b(0x88))](_0x30c81b(0x89),0x194);const _0x5304fb=0x14,_0x18d191=_0x5304fb*(+pageNumber-0x1),{count:_0x409015,rows:_0x37309d}=await Message_1[_0x30c81b(0x88)][_0x30c81b(0x93)]({'limit':_0x5304fb,'include':[_0x30c81b(0x9a),{'model':Message_1['default'],'as':_0x30c81b(0x9e),'include':['contact']},{'model':Ticket_1['default'],'where':{'contactId':_0x3e0325[_0x30c81b(0x9c)],'whatsappId':_0x3e0325[_0x30c81b(0x8e)],'isGroup':_0x3e0325[_0x30c81b(0x9b)],'queueId':{[sequelize_1['Op']['or']]:[_0x3e0325[_0x30c81b(0x85)],null]}},'required':!![]}],'offset':_0x18d191,'order':[[_0x30c81b(0x86),_0x30c81b(0x8f)]]}),_0x1377a4=_0x409015>_0x18d191+_0x37309d['length'];return{'messages':_0x37309d[_0x30c81b(0x94)](),'ticket':_0x3e0325,'count':_0x409015,'hasMore':_0x1377a4};};exports[a440_0x4ed64d(0x88)]=ListMessagesService;