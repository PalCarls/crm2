'use strict';const a457_0x43b8e6=a457_0x3bb2;function a457_0x3d71(){const _0x325e24=['findAndCountAll','3830nyPDOl','626952VCrVFD','profile','length','default','ERR_NO_TICKET_FOUND','__esModule','264OydEoX','../../errors/AppError','admin','queue','contact','3904145WERwFZ','204430dfBIZG','9IirhrC','DESC','contactId','10838187YujNSC','isGroup','sequelize','4142872qjgsJV','quotedMsg','whatsappId','enable','reverse','20Soxdin','474365zeDPad','__importDefault','../TicketServices/ShowTicketService'];a457_0x3d71=function(){return _0x325e24;};return a457_0x3d71();}function a457_0x3bb2(_0x31a582,_0x3ecc40){const _0x3d7147=a457_0x3d71();return a457_0x3bb2=function(_0x3bb223,_0x3f9b39){_0x3bb223=_0x3bb223-0x122;let _0x4d946b=_0x3d7147[_0x3bb223];return _0x4d946b;},a457_0x3bb2(_0x31a582,_0x3ecc40);}(function(_0x11a6ee,_0x5e4ff1){const _0x368543=a457_0x3bb2,_0x35f301=_0x11a6ee();while(!![]){try{const _0x25a5bc=-parseInt(_0x368543(0x12f))/0x1+-parseInt(_0x368543(0x122))/0x2+parseInt(_0x368543(0x123))/0x3*(-parseInt(_0x368543(0x134))/0x4)+parseInt(_0x368543(0x133))/0x5*(parseInt(_0x368543(0x13a))/0x6)+-parseInt(_0x368543(0x13f))/0x7+-parseInt(_0x368543(0x129))/0x8+-parseInt(_0x368543(0x126))/0x9*(-parseInt(_0x368543(0x12e))/0xa);if(_0x25a5bc===_0x5e4ff1)break;else _0x35f301['push'](_0x35f301['shift']());}catch(_0x12d0dc){_0x35f301['push'](_0x35f301['shift']());}}}(a457_0x3d71,0x4e13a));var __importDefault=this&&this[a457_0x43b8e6(0x130)]||function(_0x4a68e9){const _0x2145ca=a457_0x43b8e6;return _0x4a68e9&&_0x4a68e9[_0x2145ca(0x139)]?_0x4a68e9:{'default':_0x4a68e9};};Object['defineProperty'](exports,a457_0x43b8e6(0x139),{'value':!![]});const AppError_1=__importDefault(require(a457_0x43b8e6(0x13b))),Message_1=__importDefault(require('../../models/Message')),Ticket_1=__importDefault(require('../../models/Ticket')),ShowTicketService_1=__importDefault(require(a457_0x43b8e6(0x131))),sequelize_1=require(a457_0x43b8e6(0x128)),ListMessagesService=async({pageNumber:pageNumber='1',ticketId:_0x242af0,companyId:_0x1c5ae6,queues:queues=[],user:_0x1fcc79})=>{const _0x343c0e=a457_0x43b8e6,_0x3dba21=await(0x0,ShowTicketService_1[_0x343c0e(0x137)])(_0x242af0,_0x1c5ae6);if(!_0x3dba21)throw new AppError_1[(_0x343c0e(0x137))](_0x343c0e(0x138),0x194);const _0x57e78f=0x14,_0x3c3fac=_0x57e78f*(+pageNumber-0x1),{count:_0x3ef3e8,rows:_0x4dfe0f}=await Message_1[_0x343c0e(0x137)][_0x343c0e(0x132)]({'limit':_0x57e78f,'include':[_0x343c0e(0x13e),{'model':Message_1[_0x343c0e(0x137)],'as':_0x343c0e(0x12a),'include':['contact']},{'model':Ticket_1['default'],'where':{'contactId':_0x3dba21[_0x343c0e(0x125)],'whatsappId':_0x3dba21[_0x343c0e(0x12b)],'isGroup':_0x3dba21[_0x343c0e(0x127)],'queueId':_0x1fcc79[_0x343c0e(0x135)]===_0x343c0e(0x13c)||_0x1fcc79['allTicket']===_0x343c0e(0x12c)?{[sequelize_1['Op']['or']]:{[sequelize_1['Op']['in']]:queues,[sequelize_1['Op']['eq']]:null}}:{[sequelize_1['Op']['in']]:queues}},'required':!![],'include':[_0x343c0e(0x13d)]}],'offset':_0x3c3fac,'order':[['createdAt',_0x343c0e(0x124)]]}),_0x3905a2=_0x3ef3e8>_0x3c3fac+_0x4dfe0f[_0x343c0e(0x136)];return{'messages':_0x4dfe0f[_0x343c0e(0x12d)](),'ticket':_0x3dba21,'count':_0x3ef3e8,'hasMore':_0x3905a2};};exports[a457_0x43b8e6(0x137)]=ListMessagesService;