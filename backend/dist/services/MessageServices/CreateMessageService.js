'use strict';const a438_0x2224ff=a438_0x3519;(function(_0x2ad949,_0x1015c3){const _0x4297d7=a438_0x3519,_0x17f0bd=_0x2ad949();while(!![]){try{const _0x2ef410=-parseInt(_0x4297d7(0xf7))/0x1+parseInt(_0x4297d7(0x102))/0x2*(-parseInt(_0x4297d7(0xfe))/0x3)+-parseInt(_0x4297d7(0xfa))/0x4*(parseInt(_0x4297d7(0xe7))/0x5)+parseInt(_0x4297d7(0xee))/0x6*(parseInt(_0x4297d7(0xea))/0x7)+-parseInt(_0x4297d7(0xf6))/0x8*(-parseInt(_0x4297d7(0xe5))/0x9)+parseInt(_0x4297d7(0xdf))/0xa+parseInt(_0x4297d7(0xf5))/0xb;if(_0x2ef410===_0x1015c3)break;else _0x17f0bd['push'](_0x17f0bd['shift']());}catch(_0x3c0c78){_0x17f0bd['push'](_0x17f0bd['shift']());}}}(a438_0x4376,0xe19df));var __importDefault=this&&this['__importDefault']||function(_0x2a2048){const _0x374699=a438_0x3519;return _0x2a2048&&_0x2a2048[_0x374699(0xff)]?_0x2a2048:{'default':_0x2a2048};};function a438_0x4376(){const _0x467e52=['default','wid','../../models/Message','status','isPrivate','391050OwgqIR','ERR_CREATING_MESSAGE','1435DeYfCN','company-','getIO','462RbTiaW','quotedMsg','ticket','ticketImported','63822eOvOGZ','queue','toString','notification','../../models/Ticket','create','PVT','23217359AuuUue','176cyNhtJ','753671zUEYuo','queueId','ticketId','11768YzgqCq','emit','../../libs/socket','-appMessage','144zPPtnY','__esModule','contact','update','55834bxsGoX','935570LUUtbp'];a438_0x4376=function(){return _0x467e52;};return a438_0x4376();}function a438_0x3519(_0x1ab8e6,_0x2e9c0d){const _0x4376d9=a438_0x4376();return a438_0x3519=function(_0x351991,_0x7117eb){_0x351991=_0x351991-0xdf;let _0x192968=_0x4376d9[_0x351991];return _0x192968;},a438_0x3519(_0x1ab8e6,_0x2e9c0d);}Object['defineProperty'](exports,a438_0x2224ff(0xff),{'value':!![]});const socket_1=require(a438_0x2224ff(0xfc)),Message_1=__importDefault(require(a438_0x2224ff(0xe2))),Ticket_1=__importDefault(require(a438_0x2224ff(0xf2))),CreateMessageService=async({messageData:_0x3fce3b,companyId:_0x1fcaff})=>{const _0x83fd32=a438_0x2224ff;await Message_1[_0x83fd32(0xe0)]['upsert']({..._0x3fce3b,'companyId':_0x1fcaff});const _0x3c2028=await Message_1[_0x83fd32(0xe0)]['findOne']({'where':{'wid':_0x3fce3b[_0x83fd32(0xe1)],'companyId':_0x1fcaff},'include':['contact',{'model':Ticket_1[_0x83fd32(0xe0)],'as':_0x83fd32(0xec),'include':[_0x83fd32(0x100),_0x83fd32(0xef)]},{'model':Message_1[_0x83fd32(0xe0)],'as':_0x83fd32(0xeb),'include':['contact']}]});_0x3c2028['ticket'][_0x83fd32(0xf8)]!==null&&_0x3c2028['queueId']===null&&await _0x3c2028['update']({'queueId':_0x3c2028[_0x83fd32(0xec)][_0x83fd32(0xf8)]});_0x3c2028[_0x83fd32(0xe4)]&&await _0x3c2028[_0x83fd32(0x101)]({'wid':_0x83fd32(0xf4)+_0x3c2028['id']});if(!_0x3c2028)throw new Error(_0x83fd32(0xe6));const _0x98b41d=(0x0,socket_1[_0x83fd32(0xe9)])();return!_0x3fce3b?.[_0x83fd32(0xed)]&&_0x98b41d['to'](_0x3c2028[_0x83fd32(0xf9)][_0x83fd32(0xf0)]())['to'](_0x3c2028[_0x83fd32(0xec)][_0x83fd32(0xe3)])['to'](_0x83fd32(0xf1))[_0x83fd32(0xfb)](_0x83fd32(0xe8)+_0x1fcaff+_0x83fd32(0xfd),{'action':_0x83fd32(0xf3),'message':_0x3c2028,'ticket':_0x3c2028['ticket'],'contact':_0x3c2028[_0x83fd32(0xec)][_0x83fd32(0x100)]}),_0x3c2028;};exports[a438_0x2224ff(0xe0)]=CreateMessageService;