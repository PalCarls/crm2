'use strict';function a454_0x258c(){const _0x43c471=['ERR_CREATING_MESSAGE','findOne','create','wid','emit','6805BSfHXf','default','upsert','queue','defineProperty','804MxvkdD','ticketImported','9hNZvkj','78503WppOUA','contact','8ILAjnD','4498176SNhlOg','quotedMsg','914800WTYNul','isPrivate','3189340LqfbBT','__importDefault','ticket','-appMessage','company-','notification','2120265RpVwte','ticketId','../../models/Ticket','8937010hegvEP','toString','update','__esModule','../../models/Message'];a454_0x258c=function(){return _0x43c471;};return a454_0x258c();}const a454_0xc6edf3=a454_0x52fc;function a454_0x52fc(_0x378b81,_0x1fd47f){const _0x258c2a=a454_0x258c();return a454_0x52fc=function(_0x52fc7e,_0x320e46){_0x52fc7e=_0x52fc7e-0xe1;let _0x4e0838=_0x258c2a[_0x52fc7e];return _0x4e0838;},a454_0x52fc(_0x378b81,_0x1fd47f);}(function(_0x1f1e9c,_0x22475c){const _0x27642b=a454_0x52fc,_0x109dd0=_0x1f1e9c();while(!![]){try{const _0x56cd08=parseInt(_0x27642b(0xe7))/0x1*(-parseInt(_0x27642b(0xe9))/0x2)+parseInt(_0x27642b(0xf4))/0x3+-parseInt(_0x27642b(0xe4))/0x4*(parseInt(_0x27642b(0x101))/0x5)+parseInt(_0x27642b(0xea))/0x6+parseInt(_0x27642b(0xee))/0x7+parseInt(_0x27642b(0xec))/0x8+parseInt(_0x27642b(0xe6))/0x9*(-parseInt(_0x27642b(0xf7))/0xa);if(_0x56cd08===_0x22475c)break;else _0x109dd0['push'](_0x109dd0['shift']());}catch(_0x4f0627){_0x109dd0['push'](_0x109dd0['shift']());}}}(a454_0x258c,0x8517b));var __importDefault=this&&this[a454_0xc6edf3(0xef)]||function(_0x3ae29b){const _0x14df82=a454_0xc6edf3;return _0x3ae29b&&_0x3ae29b[_0x14df82(0xfa)]?_0x3ae29b:{'default':_0x3ae29b};};Object[a454_0xc6edf3(0xe3)](exports,'__esModule',{'value':!![]});const socket_1=require('../../libs/socket'),Message_1=__importDefault(require(a454_0xc6edf3(0xfb))),Ticket_1=__importDefault(require(a454_0xc6edf3(0xf6))),CreateMessageService=async({messageData:_0x282dc3,companyId:_0x4200f4})=>{const _0x3ca38a=a454_0xc6edf3;await Message_1[_0x3ca38a(0x102)][_0x3ca38a(0xe1)]({..._0x282dc3,'companyId':_0x4200f4});const _0x287bc4=await Message_1[_0x3ca38a(0x102)][_0x3ca38a(0xfd)]({'where':{'wid':_0x282dc3[_0x3ca38a(0xff)],'companyId':_0x4200f4},'include':['contact',{'model':Ticket_1[_0x3ca38a(0x102)],'as':_0x3ca38a(0xf0),'include':[_0x3ca38a(0xe8),_0x3ca38a(0xe2)]},{'model':Message_1[_0x3ca38a(0x102)],'as':_0x3ca38a(0xeb),'include':[_0x3ca38a(0xe8)]}]});_0x287bc4[_0x3ca38a(0xf0)]['queueId']!==null&&_0x287bc4['queueId']===null&&await _0x287bc4[_0x3ca38a(0xf9)]({'queueId':_0x287bc4[_0x3ca38a(0xf0)]['queueId']});_0x287bc4[_0x3ca38a(0xed)]&&await _0x287bc4[_0x3ca38a(0xf9)]({'wid':'PVT'+_0x287bc4['id']});if(!_0x287bc4)throw new Error(_0x3ca38a(0xfc));const _0x6c721b=(0x0,socket_1['getIO'])();return!_0x282dc3?.[_0x3ca38a(0xe5)]&&_0x6c721b['to'](_0x287bc4[_0x3ca38a(0xf5)][_0x3ca38a(0xf8)]())['to'](_0x287bc4[_0x3ca38a(0xf0)]['status'])['to'](_0x3ca38a(0xf3))[_0x3ca38a(0x100)](_0x3ca38a(0xf2)+_0x4200f4+_0x3ca38a(0xf1),{'action':_0x3ca38a(0xfe),'message':_0x287bc4,'ticket':_0x287bc4[_0x3ca38a(0xf0)],'contact':_0x287bc4[_0x3ca38a(0xf0)][_0x3ca38a(0xe8)]}),_0x287bc4;};exports[a454_0xc6edf3(0x102)]=CreateMessageService;