'use strict';const a469_0x440855=a469_0x1f74;(function(_0x235813,_0x30be93){const _0xa90268=a469_0x1f74,_0x4cc95c=_0x235813();while(!![]){try{const _0x1bbe44=parseInt(_0xa90268(0x173))/0x1*(-parseInt(_0xa90268(0x174))/0x2)+-parseInt(_0xa90268(0x16f))/0x3*(parseInt(_0xa90268(0x16d))/0x4)+-parseInt(_0xa90268(0x161))/0x5+-parseInt(_0xa90268(0x16e))/0x6*(-parseInt(_0xa90268(0x169))/0x7)+parseInt(_0xa90268(0x15b))/0x8*(-parseInt(_0xa90268(0x175))/0x9)+parseInt(_0xa90268(0x157))/0xa*(-parseInt(_0xa90268(0x15e))/0xb)+parseInt(_0xa90268(0x15f))/0xc*(parseInt(_0xa90268(0x159))/0xd);if(_0x1bbe44===_0x30be93)break;else _0x4cc95c['push'](_0x4cc95c['shift']());}catch(_0x4d8efe){_0x4cc95c['push'](_0x4cc95c['shift']());}}}(a469_0xdb54,0x6f2c5));function a469_0xdb54(){const _0x572460=['6966WPQSFu','ticket','../../models/Ticket','__esModule','3GIhvMM','549462oupjpV','72OPReYj','queueId','findOne','110nSWXeG','default','13IsFiek','contact','149528ceBLGU','ticketImported','__importDefault','137819gGfsGi','26392584vQnLEF','status','2512075bEwglR','queue','notification','defineProperty','getIO','isPrivate','toString','create','336zWWiwc','update','wid','emit','1500kUdohE','92586nkrjvK'];a469_0xdb54=function(){return _0x572460;};return a469_0xdb54();}var __importDefault=this&&this[a469_0x440855(0x15d)]||function(_0x2e4c92){const _0x24f260=a469_0x440855;return _0x2e4c92&&_0x2e4c92[_0x24f260(0x172)]?_0x2e4c92:{'default':_0x2e4c92};};Object[a469_0x440855(0x164)](exports,a469_0x440855(0x172),{'value':!![]});function a469_0x1f74(_0x4c2b51,_0xdc5d2){const _0xdb54f1=a469_0xdb54();return a469_0x1f74=function(_0x1f74d6,_0x47c3d0){_0x1f74d6=_0x1f74d6-0x156;let _0x259b2c=_0xdb54f1[_0x1f74d6];return _0x259b2c;},a469_0x1f74(_0x4c2b51,_0xdc5d2);}const socket_1=require('../../libs/socket'),Message_1=__importDefault(require('../../models/Message')),Ticket_1=__importDefault(require(a469_0x440855(0x171))),CreateMessageService=async({messageData:_0x3423b4,companyId:_0x390507})=>{const _0x41211c=a469_0x440855;await Message_1[_0x41211c(0x158)]['upsert']({..._0x3423b4,'companyId':_0x390507});const _0x2e071e=await Message_1[_0x41211c(0x158)][_0x41211c(0x156)]({'where':{'wid':_0x3423b4[_0x41211c(0x16b)],'companyId':_0x390507},'include':[_0x41211c(0x15a),{'model':Ticket_1[_0x41211c(0x158)],'as':_0x41211c(0x170),'include':[_0x41211c(0x15a),_0x41211c(0x162)]},{'model':Message_1[_0x41211c(0x158)],'as':'quotedMsg','include':[_0x41211c(0x15a)]}]});_0x2e071e[_0x41211c(0x170)][_0x41211c(0x176)]!==null&&_0x2e071e[_0x41211c(0x176)]===null&&await _0x2e071e[_0x41211c(0x16a)]({'queueId':_0x2e071e[_0x41211c(0x170)]['queueId']});_0x2e071e[_0x41211c(0x166)]&&await _0x2e071e[_0x41211c(0x16a)]({'wid':'PVT'+_0x2e071e['id']});if(!_0x2e071e)throw new Error('ERR_CREATING_MESSAGE');const _0x32231c=(0x0,socket_1[_0x41211c(0x165)])();return!_0x3423b4?.[_0x41211c(0x15c)]&&_0x32231c['to'](_0x2e071e['ticketId'][_0x41211c(0x167)]())['to'](_0x2e071e[_0x41211c(0x170)][_0x41211c(0x160)])['to'](_0x41211c(0x163))[_0x41211c(0x16c)]('company-'+_0x390507+'-appMessage',{'action':_0x41211c(0x168),'message':_0x2e071e,'ticket':_0x2e071e[_0x41211c(0x170)],'contact':_0x2e071e['ticket'][_0x41211c(0x15a)]}),_0x2e071e;};exports[a469_0x440855(0x158)]=CreateMessageService;