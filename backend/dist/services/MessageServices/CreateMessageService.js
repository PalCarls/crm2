'use strict';function a492_0x2636(){const _0x307bbe=['-appMessage','ERR_CREATING_MESSAGE','PVT','ticketId','10784334zbXEZE','update','2625789LgPwTE','findOne','wid','240TvKKvN','../../libs/socket','1607255DTjFMc','isPrivate','../../models/Message','default','47672WVMoXD','2MsdYqQ','defineProperty','toString','ticket','status','getIO','contact','70dPepuZ','1730355wWrZWz','__importDefault','3408232vHPIZl','889263bpIJxf','notification','queueId','quotedMsg','ticketImported','../../models/Ticket','__esModule','create','queue','upsert'];a492_0x2636=function(){return _0x307bbe;};return a492_0x2636();}const a492_0x29b70f=a492_0x2fad;(function(_0x53a497,_0x44f2f4){const _0x16432c=a492_0x2fad,_0x460c2d=_0x53a497();while(!![]){try{const _0x75b2ff=-parseInt(_0x16432c(0x1f7))/0x1+parseInt(_0x16432c(0x1ef))/0x2*(-parseInt(_0x16432c(0x20a))/0x3)+-parseInt(_0x16432c(0x1f9))/0x4+parseInt(_0x16432c(0x1ea))/0x5+parseInt(_0x16432c(0x208))/0x6+parseInt(_0x16432c(0x1f6))/0x7*(-parseInt(_0x16432c(0x1ee))/0x8)+-parseInt(_0x16432c(0x1fa))/0x9*(-parseInt(_0x16432c(0x1e8))/0xa);if(_0x75b2ff===_0x44f2f4)break;else _0x460c2d['push'](_0x460c2d['shift']());}catch(_0x50ec24){_0x460c2d['push'](_0x460c2d['shift']());}}}(a492_0x2636,0xed88e));function a492_0x2fad(_0x58a799,_0x1df613){const _0x263684=a492_0x2636();return a492_0x2fad=function(_0x2fad26,_0x1a9311){_0x2fad26=_0x2fad26-0x1e7;let _0x1496bc=_0x263684[_0x2fad26];return _0x1496bc;},a492_0x2fad(_0x58a799,_0x1df613);}var __importDefault=this&&this[a492_0x29b70f(0x1f8)]||function(_0x51a687){const _0x42d60e=a492_0x29b70f;return _0x51a687&&_0x51a687[_0x42d60e(0x200)]?_0x51a687:{'default':_0x51a687};};Object[a492_0x29b70f(0x1f0)](exports,a492_0x29b70f(0x200),{'value':!![]});const socket_1=require(a492_0x29b70f(0x1e9)),Message_1=__importDefault(require(a492_0x29b70f(0x1ec))),Ticket_1=__importDefault(require(a492_0x29b70f(0x1ff))),CreateMessageService=async({messageData:_0x3057a1,companyId:_0x185bfe})=>{const _0xa0ef5a=a492_0x29b70f;await Message_1[_0xa0ef5a(0x1ed)][_0xa0ef5a(0x203)]({..._0x3057a1,'companyId':_0x185bfe});const _0x52eec6=await Message_1[_0xa0ef5a(0x1ed)][_0xa0ef5a(0x20b)]({'where':{'wid':_0x3057a1[_0xa0ef5a(0x1e7)],'companyId':_0x185bfe},'include':['contact',{'model':Ticket_1['default'],'as':_0xa0ef5a(0x1f2),'include':[_0xa0ef5a(0x1f5),_0xa0ef5a(0x202),'whatsapp']},{'model':Message_1[_0xa0ef5a(0x1ed)],'as':_0xa0ef5a(0x1fd),'include':['contact']}]});_0x52eec6[_0xa0ef5a(0x1f2)][_0xa0ef5a(0x1fc)]!==null&&_0x52eec6[_0xa0ef5a(0x1fc)]===null&&await _0x52eec6[_0xa0ef5a(0x209)]({'queueId':_0x52eec6['ticket'][_0xa0ef5a(0x1fc)]});_0x52eec6[_0xa0ef5a(0x1eb)]&&await _0x52eec6[_0xa0ef5a(0x209)]({'wid':_0xa0ef5a(0x206)+_0x52eec6['id']});if(!_0x52eec6)throw new Error(_0xa0ef5a(0x205));const _0x3ba37a=(0x0,socket_1[_0xa0ef5a(0x1f4)])();return!_0x3057a1?.[_0xa0ef5a(0x1fe)]&&_0x3ba37a['to'](_0x52eec6[_0xa0ef5a(0x207)][_0xa0ef5a(0x1f1)]())['to'](_0x52eec6[_0xa0ef5a(0x1f2)][_0xa0ef5a(0x1f3)])['to'](_0xa0ef5a(0x1fb))['emit']('company-'+_0x185bfe+_0xa0ef5a(0x204),{'action':_0xa0ef5a(0x201),'message':_0x52eec6,'ticket':_0x52eec6[_0xa0ef5a(0x1f2)],'contact':_0x52eec6[_0xa0ef5a(0x1f2)][_0xa0ef5a(0x1f5)]}),_0x52eec6;};exports[a492_0x29b70f(0x1ed)]=CreateMessageService;