'use strict';const a469_0x5310bb=a469_0x4ff1;(function(_0x1cfeb8,_0x346dd5){const _0x29dd0d=a469_0x4ff1,_0x3e96ac=_0x1cfeb8();while(!![]){try{const _0x26a49a=-parseInt(_0x29dd0d(0x1ae))/0x1*(parseInt(_0x29dd0d(0x1b0))/0x2)+-parseInt(_0x29dd0d(0x1b5))/0x3+parseInt(_0x29dd0d(0x1b3))/0x4*(parseInt(_0x29dd0d(0x1ac))/0x5)+-parseInt(_0x29dd0d(0x19b))/0x6*(parseInt(_0x29dd0d(0x1b1))/0x7)+parseInt(_0x29dd0d(0x1aa))/0x8*(-parseInt(_0x29dd0d(0x19c))/0x9)+parseInt(_0x29dd0d(0x1b4))/0xa+parseInt(_0x29dd0d(0x1a7))/0xb;if(_0x26a49a===_0x346dd5)break;else _0x3e96ac['push'](_0x3e96ac['shift']());}catch(_0x5d6124){_0x3e96ac['push'](_0x3e96ac['shift']());}}}(a469_0x3f8a,0xa0f7f));var __importDefault=this&&this['__importDefault']||function(_0x41f152){const _0x425677=a469_0x4ff1;return _0x41f152&&_0x41f152[_0x425677(0x19d)]?_0x41f152:{'default':_0x41f152};};function a469_0x3f8a(){const _0x5186e8=['ticketImported','company-','12Hjvqjv','486rZEoUQ','__esModule','contact','ticketId','../../models/Ticket','../../libs/socket','quotedMsg','queue','status','upsert','ticket','14031083JVTuga','create','toString','82056prSwrE','wid','53025qRXhKs','notification','72644YKJsqN','ERR_CREATING_MESSAGE','2BrexvK','615251yqQNYD','default','8iNZLrs','2422390yQGFDh','232101kNXrOF','queueId','../../models/Message','isPrivate'];a469_0x3f8a=function(){return _0x5186e8;};return a469_0x3f8a();}function a469_0x4ff1(_0x13124e,_0x41f4da){const _0x3f8a36=a469_0x3f8a();return a469_0x4ff1=function(_0x4ff135,_0x527ddf){_0x4ff135=_0x4ff135-0x19a;let _0x1a0e42=_0x3f8a36[_0x4ff135];return _0x1a0e42;},a469_0x4ff1(_0x13124e,_0x41f4da);}Object['defineProperty'](exports,a469_0x5310bb(0x19d),{'value':!![]});const socket_1=require(a469_0x5310bb(0x1a1)),Message_1=__importDefault(require(a469_0x5310bb(0x1b7))),Ticket_1=__importDefault(require(a469_0x5310bb(0x1a0))),CreateMessageService=async({messageData:_0x45e35e,companyId:_0x1b11b9})=>{const _0x14ebe4=a469_0x5310bb;await Message_1[_0x14ebe4(0x1b2)][_0x14ebe4(0x1a5)]({..._0x45e35e,'companyId':_0x1b11b9});const _0x5a11d6=await Message_1[_0x14ebe4(0x1b2)]['findOne']({'where':{'wid':_0x45e35e[_0x14ebe4(0x1ab)],'companyId':_0x1b11b9},'include':['contact',{'model':Ticket_1[_0x14ebe4(0x1b2)],'as':'ticket','include':[_0x14ebe4(0x19e),_0x14ebe4(0x1a3)]},{'model':Message_1['default'],'as':_0x14ebe4(0x1a2),'include':[_0x14ebe4(0x19e)]}]});_0x5a11d6['ticket'][_0x14ebe4(0x1b6)]!==null&&_0x5a11d6['queueId']===null&&await _0x5a11d6['update']({'queueId':_0x5a11d6[_0x14ebe4(0x1a6)][_0x14ebe4(0x1b6)]});_0x5a11d6[_0x14ebe4(0x1b8)]&&await _0x5a11d6['update']({'wid':'PVT'+_0x5a11d6['id']});if(!_0x5a11d6)throw new Error(_0x14ebe4(0x1af));const _0x5e6440=(0x0,socket_1['getIO'])();return!_0x45e35e?.[_0x14ebe4(0x1b9)]&&_0x5e6440['to'](_0x5a11d6[_0x14ebe4(0x19f)][_0x14ebe4(0x1a9)]())['to'](_0x5a11d6[_0x14ebe4(0x1a6)][_0x14ebe4(0x1a4)])['to'](_0x14ebe4(0x1ad))['emit'](_0x14ebe4(0x19a)+_0x1b11b9+'-appMessage',{'action':_0x14ebe4(0x1a8),'message':_0x5a11d6,'ticket':_0x5a11d6[_0x14ebe4(0x1a6)],'contact':_0x5a11d6[_0x14ebe4(0x1a6)][_0x14ebe4(0x19e)]}),_0x5a11d6;};exports[a469_0x5310bb(0x1b2)]=CreateMessageService;