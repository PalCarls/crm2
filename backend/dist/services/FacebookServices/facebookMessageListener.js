'use strict';const a415_0x34b993=a415_0x19fd;(function(_0xf01055,_0x35779b){const _0x21426c=a415_0x19fd,_0x370ab7=_0xf01055();while(!![]){try{const _0xb368a5=-parseInt(_0x21426c(0x18a))/0x1*(parseInt(_0x21426c(0x1ae))/0x2)+parseInt(_0x21426c(0x18e))/0x3*(parseInt(_0x21426c(0x1af))/0x4)+-parseInt(_0x21426c(0x1c4))/0x5+parseInt(_0x21426c(0x1b2))/0x6+parseInt(_0x21426c(0x199))/0x7*(parseInt(_0x21426c(0x1b7))/0x8)+-parseInt(_0x21426c(0x1ab))/0x9*(-parseInt(_0x21426c(0x1a0))/0xa)+parseInt(_0x21426c(0x1a8))/0xb*(parseInt(_0x21426c(0x191))/0xc);if(_0xb368a5===_0x35779b)break;else _0x370ab7['push'](_0x370ab7['shift']());}catch(_0x4a30eb){_0x370ab7['push'](_0x370ab7['shift']());}}}(a415_0x341e,0xede54));function a415_0x19fd(_0x11d56a,_0x515a11){const _0x341e2d=a415_0x341e();return a415_0x19fd=function(_0x19fdbd,_0x4884fd){_0x19fdbd=_0x19fdbd-0x186;let _0x43d29c=_0x341e2d[_0x19fdbd];return _0x43d29c;},a415_0x19fd(_0x11d56a,_0x515a11);}var __importDefault=this&&this[a415_0x34b993(0x1d9)]||function(_0x5afedb){const _0x18ce3f=a415_0x34b993;return _0x5afedb&&_0x5afedb[_0x18ce3f(0x1a3)]?_0x5afedb:{'default':_0x5afedb};};Object[a415_0x34b993(0x1c2)](exports,a415_0x34b993(0x1a3),{'value':!![]}),exports[a415_0x34b993(0x1cc)]=exports[a415_0x34b993(0x1b4)]=exports['verifyMessage']=void 0x0;const fs_1=require('fs'),fs_2=__importDefault(require('fs')),axios_1=__importDefault(require(a415_0x34b993(0x18b))),moment_1=__importDefault(require(a415_0x34b993(0x19c))),path_1=require('path'),CreateOrUpdateContactService_1=__importDefault(require(a415_0x34b993(0x1b9))),CreateMessageService_1=__importDefault(require(a415_0x34b993(0x1dd))),FindOrCreateTicketService_1=__importDefault(require(a415_0x34b993(0x1ee))),graphAPI_1=require(a415_0x34b993(0x1a1)),Whatsapp_1=__importDefault(require(a415_0x34b993(0x1d1))),UpdateTicketService_1=__importDefault(require(a415_0x34b993(0x1d6))),Debounce_1=require(a415_0x34b993(0x194)),ShowWhatsAppService_1=__importDefault(require(a415_0x34b993(0x1de))),Mustache_1=__importDefault(require(a415_0x34b993(0x1ec))),Queue_1=__importDefault(require(a415_0x34b993(0x18f))),Chatbot_1=__importDefault(require(a415_0x34b993(0x1f2))),Message_1=__importDefault(require(a415_0x34b993(0x1a4))),ChatbotListenerFacebook_1=require(a415_0x34b993(0x190)),ListSettingsService_1=__importDefault(require(a415_0x34b993(0x1d5))),lodash_1=require('lodash'),FindOrCreateATicketTrakingService_1=__importDefault(require(a415_0x34b993(0x19b))),wbotMessageListener_1=require(a415_0x34b993(0x1cb)),verifyContact=async(_0x3495cc,_0x13b16d,_0x7d4c0b)=>{const _0x28cfa2=a415_0x34b993;if(!_0x3495cc)return null;const _0x4a3fb2={'name':_0x3495cc?.['name']||_0x3495cc?.[_0x28cfa2(0x196)]+'\x20'+_0x3495cc?.['last_name'],'number':_0x3495cc['id'],'profilePicUrl':'','isGroup':![],'companyId':_0x7d4c0b,'channel':_0x13b16d},_0x6459b0=(0x0,CreateOrUpdateContactService_1[_0x28cfa2(0x18d)])(_0x4a3fb2);return _0x6459b0;},verifyMessage=async(_0x448b74,_0x22d7fa,_0x2ab07a,_0x5d2012)=>{const _0x3fa85d=a415_0x34b993,_0x531b16=await verifyQuotedMessage(_0x448b74),_0x3e0b90={'wid':_0x448b74[_0x3fa85d(0x188)]||_0x448b74[_0x3fa85d(0x1d2)],'ticketId':_0x2ab07a['id'],'contactId':_0x448b74[_0x3fa85d(0x1ed)]?undefined:_0x5d2012['id'],'body':_0x448b74[_0x3fa85d(0x1c5)]||_0x22d7fa,'fromMe':_0x448b74[_0x3fa85d(0x1ed)],'read':_0x448b74?.[_0x3fa85d(0x1ed)],'quotedMsgId':_0x531b16?.['id'],'ack':0x3,'dataJson':JSON[_0x3fa85d(0x189)](_0x448b74)};await(0x0,CreateMessageService_1[_0x3fa85d(0x18d)])({'messageData':_0x3e0b90,'companyId':_0x2ab07a[_0x3fa85d(0x19f)]}),await _0x2ab07a[_0x3fa85d(0x1e0)]({'lastMessage':_0x448b74[_0x3fa85d(0x1c5)]});};exports['verifyMessage']=verifyMessage;const verifyMessageMedia=async(_0x4dd6d6,_0x28b527,_0x5d9cc0)=>{const _0x5aea43=a415_0x34b993,{data:_0x35d100}=await axios_1[_0x5aea43(0x18d)][_0x5aea43(0x1cd)](_0x4dd6d6[_0x5aea43(0x1e2)][0x0][_0x5aea43(0x1c0)]['url'],{'responseType':_0x5aea43(0x1d7)}),{fileTypeFromBuffer:_0x147af6}=await eval('const _0x45ad7d = _0x5aea43;import(_0x45ad7d(485));'),_0x18a065=await _0x147af6(_0x35d100),_0x14240b=new Date()[_0x5aea43(0x1bd)]()+'.'+_0x18a065[_0x5aea43(0x1e7)],_0x572c73='public/company'+_0x28b527[_0x5aea43(0x19f)];!fs_2['default'][_0x5aea43(0x1e3)](_0x572c73)&&(fs_2[_0x5aea43(0x18d)][_0x5aea43(0x19a)](_0x572c73),fs_2['default'][_0x5aea43(0x1c6)](_0x572c73,0x1ff));(0x0,fs_1[_0x5aea43(0x197)])((0x0,path_1[_0x5aea43(0x1ac)])(__dirname,'..','..','..',_0x572c73,_0x14240b),_0x35d100,_0x5aea43(0x1bf));const _0x36491f={'wid':_0x4dd6d6[_0x5aea43(0x188)],'ticketId':_0x28b527['id'],'contactId':_0x4dd6d6[_0x5aea43(0x1ed)]?undefined:_0x5d9cc0['id'],'body':_0x4dd6d6['text']||_0x14240b,'fromMe':_0x4dd6d6[_0x5aea43(0x1ed)],'mediaType':_0x4dd6d6[_0x5aea43(0x1e2)][0x0]['type'],'mediaUrl':_0x14240b,'read':_0x4dd6d6['is_echo'],'quotedMsgId':null,'ack':0x3,'dataJson':JSON[_0x5aea43(0x189)](_0x4dd6d6)};await(0x0,CreateMessageService_1[_0x5aea43(0x18d)])({'messageData':_0x36491f,'companyId':_0x28b527['companyId']}),await _0x28b527[_0x5aea43(0x1e0)]({'lastMessage':_0x4dd6d6['text']});};exports['verifyMessageMedia']=verifyMessageMedia;const verifyQuotedMessage=async _0x30e370=>{const _0x3bdf12=a415_0x34b993;if(!_0x30e370)return null;const _0x586787=_0x30e370?.[_0x3bdf12(0x198)]?.[_0x3bdf12(0x188)];if(!_0x586787)return null;const _0x16ef92=await Message_1[_0x3bdf12(0x18d)][_0x3bdf12(0x193)]({'where':{'id':_0x586787}});if(!_0x16ef92)return null;return _0x16ef92;},handleMessage=async(_0x143431,_0x336b91,_0x243e7d,_0x3b167f)=>{const _0x23a6dd=a415_0x34b993;try{if(_0x336b91['message']){let _0xd90c2d,_0x4099a5=null;const _0x1a4a8e=_0x336b91['sender']['id'],_0x182171=_0x336b91[_0x23a6dd(0x1eb)]['id'],{message:_0x1779de}=_0x336b91,_0x23928e=_0x1779de['is_echo'];let _0x2bf8a4=_0x1779de[_0x23a6dd(0x1c5)];if(_0x23928e){if(/\u200e/[_0x23a6dd(0x1c9)](_0x1779de[_0x23a6dd(0x1c5)]))return;_0xd90c2d=await(0x0,graphAPI_1['profilePsid'])(_0x182171,_0x143431[_0x23a6dd(0x1f4)]);}else _0xd90c2d=await(0x0,graphAPI_1[_0x23a6dd(0x19e)])(_0x1a4a8e,_0x143431[_0x23a6dd(0x1f4)]);const _0x37ae97=await verifyContact(_0xd90c2d,_0x243e7d,_0x3b167f),_0x237fb9=_0x23928e?0x0:0x1,_0x4f4fec=await Whatsapp_1['default'][_0x23a6dd(0x193)]({'where':{'facebookPageUserId':_0x143431[_0x23a6dd(0x19d)]},'include':[{'model':Queue_1[_0x23a6dd(0x18d)],'as':_0x23a6dd(0x1f1),'attributes':['id',_0x23a6dd(0x187),_0x23a6dd(0x1b5),_0x23a6dd(0x1b6)],'include':[{'model':Chatbot_1['default'],'as':_0x23a6dd(0x1bc),'attributes':['id',_0x23a6dd(0x187),'greetingMessage']}]}],'order':[[_0x23a6dd(0x1f1),'id',_0x23a6dd(0x1d4)],[_0x23a6dd(0x1f1),_0x23a6dd(0x1bc),'id',_0x23a6dd(0x1d4)]]}),_0x2b6b4a=await(0x0,ListSettingsService_1['default'])({'companyId':_0x3b167f}),_0xc24a3=_0x2b6b4a['find'](_0x5dc524=>_0x5dc524[_0x23a6dd(0x1ba)]==='enableLGPD'),_0x13305c=_0x2b6b4a[_0x23a6dd(0x1ef)](_0x1a4bd8=>_0x1a4bd8['key']===_0x23a6dd(0x1d3)),_0x15e24c=_0x2b6b4a[_0x23a6dd(0x1ef)](_0x4b1ca3=>_0x4b1ca3['key']==='lgpdLink'),_0x441308=_0x2b6b4a['find'](_0x392f71=>_0x392f71[_0x23a6dd(0x1ba)]===_0x23a6dd(0x1e4)),{ticket:_0x31df04}=await(0x0,FindOrCreateTicketService_1['default'])(_0x37ae97,_0x4f4fec,_0x237fb9,_0x3b167f,0x0,0x0,null,_0x243e7d,null,![],_0x2b6b4a);_0x4099a5=_0x31df04;const _0x585ed5=await(0x0,FindOrCreateATicketTrakingService_1[_0x23a6dd(0x18d)])({'ticketId':_0x4099a5['id'],'companyId':_0x3b167f,'whatsappId':_0x4f4fec?.['id']});if(_0x4f4fec['farewellMessage']&&(0x0,Mustache_1[_0x23a6dd(0x18d)])(_0x4f4fec['farewellMessage'],_0x4099a5)===_0x1779de[_0x23a6dd(0x1c5)])return;await _0x4099a5[_0x23a6dd(0x1e0)]({'lastMessage':_0x1779de[_0x23a6dd(0x1c5)]});try{if(!_0x23928e){if(_0x4099a5[_0x23a6dd(0x1e9)]==='nps'&&_0x585ed5!==null&&(0x0,wbotMessageListener_1[_0x23a6dd(0x1f3)])(_0x585ed5)){if(!isNaN(parseFloat(_0x2bf8a4))){(0x0,wbotMessageListener_1['handleRating'])(parseFloat(_0x2bf8a4),_0x4099a5,_0x585ed5),await _0x585ed5[_0x23a6dd(0x1e0)]({'ratingAt':(0x0,moment_1[_0x23a6dd(0x18d)])()[_0x23a6dd(0x1da)](),'finishedAt':(0x0,moment_1[_0x23a6dd(0x18d)])()[_0x23a6dd(0x1da)](),'rated':!![]});return;}else{if(_0x4099a5[_0x23a6dd(0x1a5)]<_0x4f4fec[_0x23a6dd(0x195)]){let _0x38c832=_0x23a6dd(0x1e1);const _0x5b838b=await(0x0,graphAPI_1[_0x23a6dd(0x1d8)])(_0x37ae97[_0x23a6dd(0x1a7)],_0x38c832,_0x4099a5[_0x23a6dd(0x1db)][_0x23a6dd(0x1f4)]);await(0x0,exports['verifyMessage'])(_0x5b838b,_0x38c832,_0x4099a5,_0x37ae97);let _0x2148ec='‎'+_0x4f4fec[_0x23a6dd(0x1cf)]+'\x0a';const _0x221cd2=await(0x0,graphAPI_1[_0x23a6dd(0x1d8)])(_0x37ae97['number'],_0x2148ec,_0x4099a5[_0x23a6dd(0x1db)][_0x23a6dd(0x1f4)]);await(0x0,exports['verifyMessage'])(_0x5b838b,_0x2148ec,_0x4099a5,_0x37ae97),await _0x4099a5['update']({'amountUseBotQueuesNPS':_0x4099a5[_0x23a6dd(0x1a5)]+0x1});}return;}}if(!(0x0,lodash_1[_0x23a6dd(0x1b1)])(_0xc24a3[_0x23a6dd(0x18c)])&&_0xc24a3[_0x23a6dd(0x18c)]===_0x23a6dd(0x1f0)){if(_0x4099a5['status']===_0x23a6dd(0x192)&&(0x0,lodash_1['isNil'])(_0x4099a5['lgpdAcceptedAt'])&&!(0x0,lodash_1[_0x23a6dd(0x1b1)])(_0x4099a5[_0x23a6dd(0x1ea)])){let _0x3c4d67=null;!isNaN(parseFloat(_0x2bf8a4))&&(_0x3c4d67=parseFloat(_0x2bf8a4));if(!Number['isNaN'](_0x3c4d67)&&Number[_0x23a6dd(0x1ad)](_0x3c4d67)&&!(0x0,lodash_1['isNull'])(_0x3c4d67)&&_0x3c4d67>0x0){if(_0x3c4d67===0x1)await _0x37ae97[_0x23a6dd(0x1e0)]({'lgpdAcceptedAt':(0x0,moment_1[_0x23a6dd(0x18d)])()[_0x23a6dd(0x1da)]()}),await _0x4099a5[_0x23a6dd(0x1e0)]({'lgpdAcceptedAt':(0x0,moment_1[_0x23a6dd(0x18d)])()[_0x23a6dd(0x1da)](),'amountUsedBotQueues':0x0});else{if(_0x3c4d67===0x2){if(_0x4f4fec['complationMessage']!==''&&_0x4f4fec[_0x23a6dd(0x1df)]!==undefined){const _0x4acf73=await(0x0,graphAPI_1[_0x23a6dd(0x1d8)])(_0x37ae97[_0x23a6dd(0x1a7)],'‎'+_0x4f4fec['complationMessage'],_0x4099a5[_0x23a6dd(0x1db)]['facebookUserToken']);(0x0,exports[_0x23a6dd(0x1bb)])(_0x4acf73,'‎'+_0x4f4fec[_0x23a6dd(0x1df)],_0x4099a5,_0x37ae97);}await _0x4099a5['update']({'status':_0x23a6dd(0x1d0),'amountUsedBotQueues':0x0}),await _0x585ed5[_0x23a6dd(0x1be)];return;}else _0x4099a5['amountUsedBotQueues']<_0x4f4fec['maxUseBotQueues']&&await _0x4099a5[_0x23a6dd(0x1e0)]({'amountUsedBotQueues':_0x4099a5[_0x23a6dd(0x1ce)]+0x1,'lgpdSendMessageAt':null});}}else _0x4099a5[_0x23a6dd(0x1ce)]<_0x4f4fec[_0x23a6dd(0x1ca)]&&await _0x4099a5[_0x23a6dd(0x1e0)]({'amountUsedBotQueues':_0x4099a5[_0x23a6dd(0x1ce)]+0x1,'lgpdSendMessageAt':null});}if((_0x37ae97[_0x23a6dd(0x1aa)]===null||_0x441308['value']===_0x23a6dd(0x1f0))&&!_0x37ae97['isGroup']&&(_0x4099a5['status']==='lgpd'&&(0x0,lodash_1[_0x23a6dd(0x1b1)])(_0x4099a5[_0x23a6dd(0x1ea)]))&&_0x4099a5[_0x23a6dd(0x1ce)]<=_0x4f4fec[_0x23a6dd(0x1ca)]&&!(0x0,lodash_1[_0x23a6dd(0x1b1)])(_0x13305c[_0x23a6dd(0x18c)])&&!(0x0,lodash_1[_0x23a6dd(0x1b1)])(_0x15e24c[_0x23a6dd(0x18c)])){_0x1779de['attachments']?await(0x0,exports[_0x23a6dd(0x1b4)])(_0x1779de,_0x4099a5,_0x37ae97):await(0x0,exports['verifyMessage'])(_0x1779de,_0x1779de['text'],_0x4099a5,_0x37ae97);if(_0x13305c[_0x23a6dd(0x18c)]!==undefined&&_0x13305c[_0x23a6dd(0x18c)]!==''){const _0x312ca2=(0x0,Mustache_1[_0x23a6dd(0x18d)])('‎'+_0x13305c[_0x23a6dd(0x18c)],_0x4099a5),_0x325b25=await(0x0,graphAPI_1[_0x23a6dd(0x1d8)])(_0x37ae97[_0x23a6dd(0x1a7)],_0x312ca2,_0x4099a5[_0x23a6dd(0x1db)][_0x23a6dd(0x1f4)]);(0x0,exports['verifyMessage'])(_0x325b25,_0x312ca2,_0x4099a5,_0x37ae97);}if(_0x15e24c[_0x23a6dd(0x18c)]!==undefined&&_0x15e24c[_0x23a6dd(0x18c)]!==''){const _0x2ef86d=(0x0,Mustache_1[_0x23a6dd(0x18d)])('‎'+_0x15e24c['value'],_0x4099a5),_0x21a459=await(0x0,graphAPI_1[_0x23a6dd(0x1d8)])(_0x37ae97['number'],_0x2ef86d,_0x4099a5['getSession']['facebookUserToken']);(0x0,exports[_0x23a6dd(0x1bb)])(_0x21a459,_0x2ef86d,_0x4099a5,_0x37ae97);};const _0x26e573=(0x0,Mustache_1[_0x23a6dd(0x18d)])(_0x23a6dd(0x1b8),_0x4099a5),_0x3bef19=await(0x0,graphAPI_1[_0x23a6dd(0x1d8)])(_0x37ae97['number'],_0x26e573,_0x4099a5[_0x23a6dd(0x1db)]['facebookUserToken']);(0x0,exports['verifyMessage'])(_0x3bef19,_0x26e573,_0x4099a5,_0x37ae97),await _0x4099a5['update']({'lgpdSendMessageAt':(0x0,moment_1['default'])()['toDate'](),'amountUsedBotQueues':_0x4099a5[_0x23a6dd(0x1ce)]+0x1}),await _0x4099a5[_0x23a6dd(0x1b0)]();return;};if(!(0x0,lodash_1['isNil'])(_0x4099a5[_0x23a6dd(0x1ea)])&&(0x0,lodash_1[_0x23a6dd(0x1b1)])(_0x4099a5['lgpdAcceptedAt']))return;}}}catch(_0x39458c){throw new Error(_0x39458c);console[_0x23a6dd(0x186)](_0x39458c);}_0x1779de[_0x23a6dd(0x1e2)]?await(0x0,exports[_0x23a6dd(0x1b4)])(_0x1779de,_0x4099a5,_0x37ae97):await(0x0,exports[_0x23a6dd(0x1bb)])(_0x1779de,_0x1779de['text'],_0x4099a5,_0x37ae97),!_0x4099a5[_0x23a6dd(0x1a9)]&&!_0x23928e&&!_0x4099a5[_0x23a6dd(0x1b3)]&&_0x4f4fec[_0x23a6dd(0x1f1)][_0x23a6dd(0x1a6)]>=0x1&&await verifyQueue(_0x4f4fec,_0x1779de,_0x4099a5,_0x37ae97),_0x4099a5[_0x23a6dd(0x1a9)]&&_0x4099a5['queueId']&&(!_0x4099a5[_0x23a6dd(0x1a2)]&&await(0x0,ChatbotListenerFacebook_1['sayChatbot'])(_0x4099a5[_0x23a6dd(0x1c8)],_0x4f4fec,_0x4099a5,_0x37ae97,_0x1779de));}return;}catch(_0x3de888){throw new Error(_0x3de888);}};function a415_0x341e(){const _0x173d6f=['color','greetingMessage','154632eBYwrq','‎Estou\x20ciente\x20sobre\x20o\x20tratamento\x20dos\x20meus\x20dados\x20pessoais.\x20\x0a\x0a*[1]*\x20Sim\x0a*[2]*\x20Não','../ContactServices/CreateOrUpdateContactService','key','verifyMessage','chatbots','getTime','destroy','base64','payload','debounce','defineProperty','whatsapp','2062430mMOxFw','text','chmodSync','\x0a*#*\x20Voltar\x20para\x20o\x20menu\x20principal','queueId','test','maxUseBotQueues','../WbotServices/wbotMessageListener','handleMessage','get','amountUsedBotQueues','ratingMessage','closed','../../models/Whatsapp','message_id','lgpdMessage','ASC','../SettingServices/ListSettingsService','../TicketServices/UpdateTicketService','arraybuffer','sendText','__importDefault','toDate','getSession','pending','../MessageServices/CreateMessageService','../WhatsappService/ShowWhatsAppService','complationMessage','update','‎Opção\x20inválida,\x20tente\x20novamente.\x0a','attachments','existsSync','lgpdConsent','file-type','forEach','ext',']\x20-\x20','status','lgpdSendMessageAt','recipient','../../helpers/Mustache','is_echo','../TicketServices/FindOrCreateTicketService','find','enabled','queues','../../models/Chatbot','verifyRating','facebookUserToken','log','name','mid','stringify','412CjFtOw','axios','value','default','120489XIMLjH','../../models/Queue','../WbotServices/ChatbotListenerFacebook','288ARzkSt','lgpd','findOne','../../helpers/Debounce','maxUseBotQueuesNPS','first_name','writeFileSync','reply_to','182ovJUTj','mkdirSync','../TicketServices/FindOrCreateATicketTrakingService','moment','facebookPageUserId','profilePsid','companyId','3824210JmVTAZ','./graphAPI','user','__esModule','../../models/Message','amountUseBotQueuesNPS','length','number','423907HsuxUT','queue','lgpdAcceptedAt','9LUAxLn','join','isInteger','7204dijsWG','20dzItYg','reload','isNil','5161512mFObmT','userId','verifyMessageMedia'];a415_0x341e=function(){return _0x173d6f;};return a415_0x341e();}exports[a415_0x34b993(0x1cc)]=handleMessage;const verifyQueue=async(_0x672915,_0x53e472,_0x5303ae,_0x16f6df)=>{const _0x3283cb=a415_0x34b993,{queues:_0x49ed3c,greetingMessage:_0x44a456}=await(0x0,ShowWhatsAppService_1['default'])(_0x672915['id'],_0x5303ae['companyId']);if(_0x49ed3c[_0x3283cb(0x1a6)]===0x1){await(0x0,UpdateTicketService_1[_0x3283cb(0x18d)])({'ticketData':{'queueId':_0x49ed3c[0x0]['id']},'ticketId':_0x5303ae['id'],'companyId':_0x5303ae[_0x3283cb(0x19f)]});return;}let _0x2ea6f9='';if(_0x5303ae['status']!==_0x3283cb(0x192))_0x2ea6f9=_0x53e472[_0x3283cb(0x1c5)];else{if(!(0x0,lodash_1[_0x3283cb(0x1b1)])(_0x5303ae['lgpdAcceptedAt']))await _0x5303ae[_0x3283cb(0x1e0)]({'status':_0x3283cb(0x1dc)});await _0x5303ae[_0x3283cb(0x1b0)]();}const _0x1702d2=_0x49ed3c[+_0x2ea6f9-0x1];if(_0x1702d2){await(0x0,UpdateTicketService_1[_0x3283cb(0x18d)])({'ticketData':{'queueId':_0x1702d2['id']},'ticketId':_0x5303ae['id'],'companyId':_0x5303ae[_0x3283cb(0x19f)]});if(_0x1702d2['chatbots'][_0x3283cb(0x1a6)]>0x0){let _0x1ae0eb='';_0x1702d2['chatbots']['forEach']((_0x1a6c9c,_0x393612)=>{const _0x527b64=_0x3283cb;_0x1ae0eb+='['+(_0x393612+0x1)+_0x527b64(0x1e8)+_0x1a6c9c[_0x527b64(0x187)]+'\x0a';});const _0x5f0a70=(0x0,Mustache_1['default'])('‎'+_0x1702d2[_0x3283cb(0x1b6)]+'\x0a\x0a'+_0x1ae0eb+_0x3283cb(0x1c7),_0x5303ae);return(0x0,graphAPI_1[_0x3283cb(0x1d8)])(_0x16f6df['number'],(0x0,Mustache_1[_0x3283cb(0x18d)])(_0x5f0a70,_0x5303ae),_0x5303ae['whatsapp']['facebookUserToken']),await(0x0,exports['verifyMessage'])(_0x53e472,_0x5f0a70,_0x5303ae,_0x16f6df);}if(!_0x1702d2[_0x3283cb(0x1bc)]['length']){const _0x265292=(0x0,Mustache_1[_0x3283cb(0x18d)])('‎'+_0x1702d2['greetingMessage'],_0x5303ae);return(0x0,graphAPI_1[_0x3283cb(0x1d8)])(_0x16f6df['number'],(0x0,Mustache_1[_0x3283cb(0x18d)])(_0x265292,_0x5303ae),_0x5303ae[_0x3283cb(0x1c3)][_0x3283cb(0x1f4)]),await(0x0,exports[_0x3283cb(0x1bb)])(_0x53e472,_0x265292,_0x5303ae,_0x16f6df);}}else{let _0x129b27='';_0x49ed3c[_0x3283cb(0x1e6)]((_0x19d381,_0x399589)=>{const _0x11cb26=_0x3283cb;_0x129b27+='['+(_0x399589+0x1)+']\x20-\x20'+_0x19d381[_0x11cb26(0x187)]+'\x0a';});const _0x1af872=(0x0,Mustache_1[_0x3283cb(0x18d)])('‎'+_0x44a456+'\x0a\x0a'+_0x129b27,_0x5303ae),_0x5e892c=(0x0,Debounce_1[_0x3283cb(0x1c1)])(async()=>{const _0x1034a9=_0x3283cb;return(0x0,graphAPI_1['sendText'])(_0x16f6df[_0x1034a9(0x1a7)],(0x0,Mustache_1[_0x1034a9(0x18d)])(_0x1af872,_0x5303ae),_0x5303ae[_0x1034a9(0x1c3)][_0x1034a9(0x1f4)]),(0x0,exports[_0x1034a9(0x1bb)])(_0x53e472,_0x1af872,_0x5303ae,_0x16f6df);},0xbb8,_0x5303ae['id']);_0x5e892c();}};