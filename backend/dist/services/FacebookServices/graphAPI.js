'use strict';const a433_0x1dcad1=a433_0x4117;(function(_0x16c529,_0x3565e7){const _0x308318=a433_0x4117,_0x53f764=_0x16c529();while(!![]){try{const _0x1112b2=parseInt(_0x308318(0x106))/0x1*(parseInt(_0x308318(0x141))/0x2)+-parseInt(_0x308318(0x11c))/0x3*(-parseInt(_0x308318(0x135))/0x4)+parseInt(_0x308318(0x103))/0x5*(-parseInt(_0x308318(0x10f))/0x6)+parseInt(_0x308318(0x138))/0x7+-parseInt(_0x308318(0x113))/0x8*(-parseInt(_0x308318(0x139))/0x9)+parseInt(_0x308318(0x129))/0xa*(-parseInt(_0x308318(0x13a))/0xb)+parseInt(_0x308318(0x100))/0xc*(parseInt(_0x308318(0x112))/0xd);if(_0x1112b2===_0x3565e7)break;else _0x53f764['push'](_0x53f764['shift']());}catch(_0x66c609){_0x53f764['push'](_0x53f764['shift']());}}}(a433_0x4b64,0xcc9a6));var __importDefault=this&&this['__importDefault']||function(_0x1cb8db){const _0x5d5a4d=a433_0x4117;return _0x1cb8db&&_0x1cb8db[_0x5d5a4d(0x131)]?_0x1cb8db:{'default':_0x1cb8db};};Object[a433_0x1dcad1(0x101)](exports,a433_0x1dcad1(0x131),{'value':!![]}),exports[a433_0x1dcad1(0x128)]=exports[a433_0x1dcad1(0x125)]=exports['getSubscribedApps']=exports[a433_0x1dcad1(0x115)]=exports[a433_0x1dcad1(0x124)]=exports['profilePsid']=exports['getPageProfile']=exports[a433_0x1dcad1(0x114)]=exports[a433_0x1dcad1(0x133)]=exports[a433_0x1dcad1(0x111)]=exports['sendAttachmentFromUrl']=exports[a433_0x1dcad1(0x10c)]=exports[a433_0x1dcad1(0x109)]=exports[a433_0x1dcad1(0x130)]=void 0x0;const axios_1=__importDefault(require(a433_0x1dcad1(0x118))),form_data_1=__importDefault(require(a433_0x1dcad1(0x11b))),fs_1=require('fs'),logger_1=require(a433_0x1dcad1(0x102)),formData=new form_data_1['default'](),apiBase=_0xba207c=>axios_1[a433_0x1dcad1(0x12b)][a433_0x1dcad1(0x12d)]({'baseURL':'https://graph.facebook.com/v13.0/','params':{'access_token':_0xba207c}}),getAccessToken=async()=>{const _0x336e77=a433_0x1dcad1,{data:_0x52f3bf}=await axios_1['default']['get'](_0x336e77(0x120),{'params':{'client_id':process['env'][_0x336e77(0x11e)],'client_secret':process[_0x336e77(0x137)]['FACEBOOK_APP_SECRET'],'grant_type':_0x336e77(0x13b)}});return _0x52f3bf[_0x336e77(0x142)];};exports[a433_0x1dcad1(0x130)]=getAccessToken;const markSeen=async(_0x307043,_0x345f32)=>{const _0x390e09=a433_0x1dcad1;await apiBase(_0x345f32)[_0x390e09(0x13f)](_0x307043+_0x390e09(0x122),{'recipient':{'id':_0x307043},'sender_action':'mark_seen'});};function a433_0x4117(_0x1057d5,_0x2e1bcd){const _0x4b6465=a433_0x4b64();return a433_0x4117=function(_0x411766,_0x528024){_0x411766=_0x411766-0x100;let _0x4627e7=_0x4b6465[_0x411766];return _0x4627e7;},a433_0x4117(_0x1057d5,_0x2e1bcd);}exports[a433_0x1dcad1(0x109)]=markSeen;const sendText=async(_0xea3964,_0x4af445,_0xf7c379)=>{const _0x340e70=a433_0x1dcad1;try{const {data:_0x59e7e0}=await apiBase(_0xf7c379)[_0x340e70(0x13f)](_0x340e70(0x10d),{'recipient':{'id':_0xea3964},'message':{'text':''+_0x4af445}});return _0x59e7e0;}catch(_0x42217c){console[_0x340e70(0x127)](_0x42217c);}};exports[a433_0x1dcad1(0x10c)]=sendText;const sendAttachmentFromUrl=async(_0x5dbdc9,_0x545b16,_0x12e327,_0x106892)=>{const _0x317257=a433_0x1dcad1;try{const {data:_0xa87ee}=await apiBase(_0x106892)[_0x317257(0x13f)]('me/messages',{'recipient':{'id':_0x5dbdc9},'message':{'attachment':{'type':_0x12e327,'payload':{'url':_0x545b16}}}});return _0xa87ee;}catch(_0x569f9d){console[_0x317257(0x127)](_0x569f9d);}};exports[a433_0x1dcad1(0x104)]=sendAttachmentFromUrl;const sendAttachment=async(_0xe68693,_0xd1e840,_0x537df7,_0x50c888)=>{const _0x275a0f=a433_0x1dcad1;formData[_0x275a0f(0x12f)](_0x275a0f(0x10a),JSON['stringify']({'id':_0xe68693})),formData[_0x275a0f(0x12f)](_0x275a0f(0x11f),JSON[_0x275a0f(0x108)]({'attachment':{'type':_0x537df7,'payload':{'is_reusable':!![]}}}));const _0x366dd4=(0x0,fs_1[_0x275a0f(0x126)])(_0xd1e840[_0x275a0f(0x143)]);formData[_0x275a0f(0x12f)]('filedata',_0x366dd4);try{await apiBase(_0x50c888)[_0x275a0f(0x13f)](_0x275a0f(0x10d),formData,{'headers':{...formData['getHeaders']()}});}catch(_0xae61ed){throw new Error(_0xae61ed);}};exports[a433_0x1dcad1(0x111)]=sendAttachment;const genText=_0x3ee089=>{const _0x365bed={'text':_0x3ee089};return _0x365bed;};exports[a433_0x1dcad1(0x133)]=genText;const getProfile=async(_0x57efcf,_0x88fd07)=>{const _0x4b3867=a433_0x1dcad1;try{const {data:_0x33bbb9}=await apiBase(_0x88fd07)[_0x4b3867(0x110)](_0x57efcf);return _0x33bbb9;}catch(_0x43e988){console[_0x4b3867(0x127)](_0x43e988);throw new Error(_0x4b3867(0x134));}};exports['getProfile']=getProfile;function a433_0x4b64(){const _0x3ebf60=['logger','post','ERR_UNSUBSCRIBING_PAGE_TO_MESSAGE_WEBHOOKS','30854RAddWH','access_token','path','111756BjCZrh','defineProperty','../../utils/logger','10ELGHLb','sendAttachmentFromUrl','message_deliveries','23wAdnxo','fb_exchange_token','stringify','markSeen','recipient','data','sendText','me/messages','ERR_FETCHING_FB_USER_TOKEN','4039458jMrvab','get','sendAttachment','1534YXcfec','648632NPtLmU','getProfile','unsubscribeApp','message_echoes','FACEBOOK_APP_SECRET','axios','ERR_FETCHING_FB_PAGES','ERR_REMOVING_APP_FROM_PAGE','form-data','1482429DsPwmP','getSubscribedApps','FACEBOOK_APP_ID','message','https://graph.facebook.com/v13.0/oauth/access_token','/subscribed_apps?access_token=','/messages','profilePsid','subscribeApp','getAccessTokenFromPage','createReadStream','log','removeApplcation','10PYAIIm','/subscribed_apps','default','error','create','messages','append','getAccessToken','__esModule','/permissions','genText','ERR_FETCHING_FB_USER_PROFILE_2','4VeAGNI','message_reads','env','5017285lQqBDT','99RhPlgk','15091802gACLFm','client_credentials','ERR_SUBSCRIBING_PAGE_TO_MESSAGE_WEBHOOKS','https://graph.facebook.com/v13.0/'];a433_0x4b64=function(){return _0x3ebf60;};return a433_0x4b64();}const getPageProfile=async(_0x29cfe3,_0x10766b)=>{const _0x103abf=a433_0x1dcad1;try{const {data:_0x594f69}=await apiBase(_0x10766b)[_0x103abf(0x110)](_0x29cfe3+'/accounts?fields=name,access_token,instagram_business_account{id,username,profile_picture_url,name}');return _0x594f69;}catch(_0x2db42b){console[_0x103abf(0x127)](_0x2db42b);throw new Error(_0x103abf(0x119));}};exports['getPageProfile']=getPageProfile;const profilePsid=async(_0x34c044,_0x11c530)=>{const _0x4fdd83=a433_0x1dcad1;try{const {data:_0x567957}=await axios_1[_0x4fdd83(0x12b)]['get']('https://graph.facebook.com/v13.0/'+_0x34c044+'?access_token='+_0x11c530);return _0x567957;}catch(_0x45f8e8){console[_0x4fdd83(0x127)](_0x45f8e8),await(0x0,exports[_0x4fdd83(0x114)])(_0x34c044,_0x11c530);}};exports[a433_0x1dcad1(0x123)]=profilePsid;const subscribeApp=async(_0x178d01,_0xe14220)=>{const _0x4a683b=a433_0x1dcad1;try{const {data:_0x52fcec}=await axios_1['default'][_0x4a683b(0x13f)](_0x4a683b(0x13d)+_0x178d01+_0x4a683b(0x121)+_0xe14220,{'subscribed_fields':[_0x4a683b(0x12e),'messaging_postbacks',_0x4a683b(0x105),_0x4a683b(0x136),_0x4a683b(0x116)]});return _0x52fcec;}catch(_0x45a903){console[_0x4a683b(0x127)](_0x45a903);throw new Error(_0x4a683b(0x13c));}};exports[a433_0x1dcad1(0x124)]=subscribeApp;const unsubscribeApp=async(_0x516b29,_0x46e302)=>{const _0x11f50e=a433_0x1dcad1;try{const {data:_0x2a75c9}=await axios_1['default']['delete'](_0x11f50e(0x13d)+_0x516b29+_0x11f50e(0x121)+_0x46e302);return _0x2a75c9;}catch(_0x2cd5bf){throw new Error(_0x11f50e(0x140));}};exports['unsubscribeApp']=unsubscribeApp;const getSubscribedApps=async(_0x124f57,_0x1c7034)=>{const _0xe9659f=a433_0x1dcad1;try{const {data:_0x36e5d1}=await apiBase(_0x1c7034)['get'](_0x124f57+_0xe9659f(0x12a));return _0x36e5d1;}catch(_0x361788){throw new Error('ERR_GETTING_SUBSCRIBED_APPS');}};exports[a433_0x1dcad1(0x11d)]=getSubscribedApps;const getAccessTokenFromPage=async _0xa068d4=>{const _0x1e712e=a433_0x1dcad1;try{if(!_0xa068d4)throw new Error(_0x1e712e(0x10e));const _0x466f44=await axios_1['default'][_0x1e712e(0x110)](_0x1e712e(0x120),{'params':{'client_id':process[_0x1e712e(0x137)]['FACEBOOK_APP_ID'],'client_secret':process[_0x1e712e(0x137)][_0x1e712e(0x117)],'grant_type':_0x1e712e(0x107),'fb_exchange_token':_0xa068d4}});return _0x466f44[_0x1e712e(0x10b)][_0x1e712e(0x142)];}catch(_0x797e0e){console['log'](_0x797e0e);throw new Error(_0x1e712e(0x10e));}};exports[a433_0x1dcad1(0x125)]=getAccessTokenFromPage;const removeApplcation=async(_0xd1122f,_0x2b72f3)=>{const _0x59e2c8=a433_0x1dcad1;try{await axios_1[_0x59e2c8(0x12b)]['delete'](_0x59e2c8(0x13d)+_0xd1122f+_0x59e2c8(0x132),{'params':{'access_token':_0x2b72f3}});}catch(_0x2cc4ef){logger_1[_0x59e2c8(0x13e)][_0x59e2c8(0x12c)](_0x59e2c8(0x11a));}};exports['removeApplcation']=removeApplcation;