'use strict';const a432_0x3470c2=a432_0xf9a1;(function(_0x36b59e,_0xd53d30){const _0x4cf656=a432_0xf9a1,_0x1fe987=_0x36b59e();while(!![]){try{const _0x2ac798=-parseInt(_0x4cf656(0xc7))/0x1+parseInt(_0x4cf656(0xc9))/0x2*(parseInt(_0x4cf656(0xee))/0x3)+parseInt(_0x4cf656(0xf7))/0x4*(-parseInt(_0x4cf656(0xe9))/0x5)+parseInt(_0x4cf656(0xe1))/0x6+parseInt(_0x4cf656(0xeb))/0x7+-parseInt(_0x4cf656(0xf2))/0x8*(-parseInt(_0x4cf656(0xc4))/0x9)+-parseInt(_0x4cf656(0xdf))/0xa;if(_0x2ac798===_0xd53d30)break;else _0x1fe987['push'](_0x1fe987['shift']());}catch(_0x5b86ff){_0x1fe987['push'](_0x1fe987['shift']());}}}(a432_0x20b4,0x83682));function a432_0xf9a1(_0x33dc8d,_0x5665cd){const _0x20b493=a432_0x20b4();return a432_0xf9a1=function(_0xf9a1f9,_0x47320a){_0xf9a1f9=_0xf9a1f9-0xbc;let _0x9415e8=_0x20b493[_0xf9a1f9];return _0x9415e8;},a432_0xf9a1(_0x33dc8d,_0x5665cd);}var __importDefault=this&&this[a432_0x3470c2(0xf6)]||function(_0x5739a8){const _0x28d678=a432_0x3470c2;return _0x5739a8&&_0x5739a8[_0x28d678(0xe4)]?_0x5739a8:{'default':_0x5739a8};};Object['defineProperty'](exports,a432_0x3470c2(0xe4),{'value':!![]}),exports[a432_0x3470c2(0xdd)]=exports['getAccessTokenFromPage']=exports[a432_0x3470c2(0xd1)]=exports[a432_0x3470c2(0x100)]=exports[a432_0x3470c2(0xfa)]=exports[a432_0x3470c2(0xe7)]=exports[a432_0x3470c2(0xbe)]=exports[a432_0x3470c2(0xbc)]=exports[a432_0x3470c2(0xde)]=exports['sendAttachment']=exports[a432_0x3470c2(0xcf)]=exports[a432_0x3470c2(0xcd)]=exports[a432_0x3470c2(0xcb)]=exports[a432_0x3470c2(0xc3)]=void 0x0;const axios_1=__importDefault(require(a432_0x3470c2(0xbf))),form_data_1=__importDefault(require(a432_0x3470c2(0xe8))),fs_1=require('fs'),logger_1=require(a432_0x3470c2(0xfb)),formData=new form_data_1['default'](),apiBase=_0x43ab5e=>axios_1[a432_0x3470c2(0xed)][a432_0x3470c2(0xca)]({'baseURL':a432_0x3470c2(0x101),'params':{'access_token':_0x43ab5e}}),getAccessToken=async()=>{const _0x514b5d=a432_0x3470c2,{data:_0x354708}=await axios_1[_0x514b5d(0xed)][_0x514b5d(0xdb)](_0x514b5d(0xc6),{'params':{'client_id':process[_0x514b5d(0xec)][_0x514b5d(0xf0)],'client_secret':process[_0x514b5d(0xec)][_0x514b5d(0xd2)],'grant_type':_0x514b5d(0xe3)}});return _0x354708[_0x514b5d(0xd9)];};exports[a432_0x3470c2(0xc3)]=getAccessToken;const markSeen=async(_0x23777e,_0x2a48d7)=>{const _0x2657ce=a432_0x3470c2;await apiBase(_0x2a48d7)[_0x2657ce(0xc5)](_0x23777e+_0x2657ce(0xd5),{'recipient':{'id':_0x23777e},'sender_action':_0x2657ce(0xfd)});};exports[a432_0x3470c2(0xcb)]=markSeen;const sendText=async(_0x51a53c,_0x71a6c6,_0x5d834d)=>{const _0x3cdab4=a432_0x3470c2;try{const {data:_0x582b63}=await apiBase(_0x5d834d)[_0x3cdab4(0xc5)](_0x3cdab4(0xe5),{'recipient':{'id':_0x51a53c},'message':{'text':''+_0x71a6c6}});return _0x582b63;}catch(_0x4a5042){console[_0x3cdab4(0xc1)](_0x4a5042);}};exports['sendText']=sendText;const sendAttachmentFromUrl=async(_0x2ad2b8,_0x300c22,_0x5e07d8,_0x16b7e4)=>{const _0x287a00=a432_0x3470c2;try{const {data:_0x2149ab}=await apiBase(_0x16b7e4)[_0x287a00(0xc5)](_0x287a00(0xe5),{'recipient':{'id':_0x2ad2b8},'message':{'attachment':{'type':_0x5e07d8,'payload':{'url':_0x300c22}}}});return _0x2149ab;}catch(_0x45ece4){console['log'](_0x45ece4);}};exports['sendAttachmentFromUrl']=sendAttachmentFromUrl;const sendAttachment=async(_0x2ddf35,_0x4bdf03,_0x102589,_0x5bbd42)=>{const _0x54d4c1=a432_0x3470c2;formData[_0x54d4c1(0xe2)](_0x54d4c1(0xdc),JSON['stringify']({'id':_0x2ddf35})),formData[_0x54d4c1(0xe2)](_0x54d4c1(0xfe),JSON['stringify']({'attachment':{'type':_0x102589,'payload':{'is_reusable':!![]}}}));const _0x56d5c9=(0x0,fs_1[_0x54d4c1(0xea)])(_0x4bdf03[_0x54d4c1(0xe0)]);formData[_0x54d4c1(0xe2)](_0x54d4c1(0xf1),_0x56d5c9);try{await apiBase(_0x5bbd42)[_0x54d4c1(0xc5)](_0x54d4c1(0xe5),formData,{'headers':{...formData[_0x54d4c1(0xc8)]()}});}catch(_0x5dfb6e){throw new Error(_0x5dfb6e);}};exports[a432_0x3470c2(0xcc)]=sendAttachment;const genText=_0x4333d8=>{const _0x2668d4={'text':_0x4333d8};return _0x2668d4;};exports['genText']=genText;const getProfile=async(_0xca6bce,_0x451d1d)=>{const _0x1c412f=a432_0x3470c2;try{const {data:_0x2f395b}=await apiBase(_0x451d1d)[_0x1c412f(0xdb)](_0xca6bce);return _0x2f395b;}catch(_0x28b9dd){console[_0x1c412f(0xc1)](_0x28b9dd);throw new Error(_0x1c412f(0xd4));}};exports['getProfile']=getProfile;const getPageProfile=async(_0x43bdc5,_0x4b7128)=>{const _0x276180=a432_0x3470c2;try{const {data:_0x1c3872}=await apiBase(_0x4b7128)['get'](_0x43bdc5+_0x276180(0xd7));return _0x1c3872;}catch(_0x30bed8){console[_0x276180(0xc1)](_0x30bed8);throw new Error(_0x276180(0xf5));}};exports[a432_0x3470c2(0xbe)]=getPageProfile;const profilePsid=async(_0x2c52c5,_0x5bf874)=>{const _0x3b0e93=a432_0x3470c2;try{const {data:_0x96f66}=await axios_1['default']['get'](_0x3b0e93(0x101)+_0x2c52c5+'?access_token='+_0x5bf874);return _0x96f66;}catch(_0x3db146){console[_0x3b0e93(0xc1)](_0x3db146),await(0x0,exports['getProfile'])(_0x2c52c5,_0x5bf874);}};exports['profilePsid']=profilePsid;const subscribeApp=async(_0x12942f,_0x44f07d)=>{const _0x5926c6=a432_0x3470c2;try{const {data:_0x46dee0}=await axios_1[_0x5926c6(0xed)]['post']('https://graph.facebook.com/v13.0/'+_0x12942f+_0x5926c6(0xe6)+_0x44f07d,{'subscribed_fields':[_0x5926c6(0xff),'messaging_postbacks',_0x5926c6(0xd8),_0x5926c6(0xbd),_0x5926c6(0xc0)]});return _0x46dee0;}catch(_0x2abd63){console[_0x5926c6(0xc1)](_0x2abd63);throw new Error(_0x5926c6(0xd6));}};function a432_0x20b4(){const _0x157fbf=['https://graph.facebook.com/v13.0/','getProfile','message_reads','getPageProfile','axios','message_echoes','log','ERR_UNSUBSCRIBING_PAGE_TO_MESSAGE_WEBHOOKS','getAccessToken','18bvHbwh','post','https://graph.facebook.com/v13.0/oauth/access_token','161873pGssUa','getHeaders','110068OLlvux','create','markSeen','sendAttachment','sendText','getAccessTokenFromPage','sendAttachmentFromUrl','/subscribed_apps','getSubscribedApps','FACEBOOK_APP_SECRET','fb_exchange_token','ERR_FETCHING_FB_USER_PROFILE_2','/messages','ERR_SUBSCRIBING_PAGE_TO_MESSAGE_WEBHOOKS','/accounts?fields=name,access_token,instagram_business_account{id,username,profile_picture_url,name}','message_deliveries','access_token','ERR_GETTING_SUBSCRIBED_APPS','get','recipient','removeApplcation','genText','11874140ELzxnt','path','2655894IGyYGB','append','client_credentials','__esModule','me/messages','/subscribed_apps?access_token=','profilePsid','form-data','15pxgHVH','createReadStream','5805905FfusWL','env','default','15vPAgMX','delete','FACEBOOK_APP_ID','filedata','2203352vhyiFr','logger','ERR_FETCHING_FB_USER_TOKEN','ERR_FETCHING_FB_PAGES','__importDefault','280724GRSGOA','error','ERR_REMOVING_APP_FROM_PAGE','subscribeApp','../../utils/logger','data','mark_seen','message','messages','unsubscribeApp'];a432_0x20b4=function(){return _0x157fbf;};return a432_0x20b4();}exports['subscribeApp']=subscribeApp;const unsubscribeApp=async(_0x340854,_0x3291fb)=>{const _0x28a337=a432_0x3470c2;try{const {data:_0xfbfcaf}=await axios_1[_0x28a337(0xed)][_0x28a337(0xef)](_0x28a337(0x101)+_0x340854+_0x28a337(0xe6)+_0x3291fb);return _0xfbfcaf;}catch(_0x45045a){throw new Error(_0x28a337(0xc2));}};exports[a432_0x3470c2(0x100)]=unsubscribeApp;const getSubscribedApps=async(_0x4ad84d,_0x1c8c93)=>{const _0x21041f=a432_0x3470c2;try{const {data:_0x277fef}=await apiBase(_0x1c8c93)[_0x21041f(0xdb)](_0x4ad84d+_0x21041f(0xd0));return _0x277fef;}catch(_0xfb4f7b){throw new Error(_0x21041f(0xda));}};exports['getSubscribedApps']=getSubscribedApps;const getAccessTokenFromPage=async _0x2e1c53=>{const _0x23fc1f=a432_0x3470c2;try{if(!_0x2e1c53)throw new Error(_0x23fc1f(0xf4));const _0x53db1e=await axios_1['default'][_0x23fc1f(0xdb)]('https://graph.facebook.com/v13.0/oauth/access_token',{'params':{'client_id':process['env'][_0x23fc1f(0xf0)],'client_secret':process['env'][_0x23fc1f(0xd2)],'grant_type':_0x23fc1f(0xd3),'fb_exchange_token':_0x2e1c53}});return _0x53db1e[_0x23fc1f(0xfc)][_0x23fc1f(0xd9)];}catch(_0xbf391e){console[_0x23fc1f(0xc1)](_0xbf391e);throw new Error(_0x23fc1f(0xf4));}};exports[a432_0x3470c2(0xce)]=getAccessTokenFromPage;const removeApplcation=async(_0x29787f,_0x3c41d9)=>{const _0x3d7534=a432_0x3470c2;try{await axios_1[_0x3d7534(0xed)][_0x3d7534(0xef)]('https://graph.facebook.com/v13.0/'+_0x29787f+'/permissions',{'params':{'access_token':_0x3c41d9}});}catch(_0x5e8b99){logger_1[_0x3d7534(0xf3)][_0x3d7534(0xf8)](_0x3d7534(0xf9));}};exports[a432_0x3470c2(0xdd)]=removeApplcation;