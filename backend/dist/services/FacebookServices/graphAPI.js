'use strict';const a487_0x46de1f=a487_0x4e0a;(function(_0x7b94b0,_0x11f879){const _0x17c8fb=a487_0x4e0a,_0x352ddb=_0x7b94b0();while(!![]){try{const _0x509314=parseInt(_0x17c8fb(0xa5))/0x1+parseInt(_0x17c8fb(0xc3))/0x2+-parseInt(_0x17c8fb(0xb3))/0x3*(parseInt(_0x17c8fb(0xc4))/0x4)+parseInt(_0x17c8fb(0xb4))/0x5*(-parseInt(_0x17c8fb(0xcc))/0x6)+-parseInt(_0x17c8fb(0xab))/0x7+-parseInt(_0x17c8fb(0xba))/0x8+parseInt(_0x17c8fb(0xc8))/0x9*(parseInt(_0x17c8fb(0xcf))/0xa);if(_0x509314===_0x11f879)break;else _0x352ddb['push'](_0x352ddb['shift']());}catch(_0xe869f8){_0x352ddb['push'](_0x352ddb['shift']());}}}(a487_0x621c,0x719f0));function a487_0x621c(){const _0x27101e=['632521JmZleK','message_deliveries','/messages','/accounts?fields=name,access_token,instagram_business_account{id,username,profile_picture_url,name}','getAccessToken','FACEBOOK_APP_ID','2334668mGPtRa','profilePsid','append','message_reads','log','ERR_SUBSCRIBING_PAGE_TO_MESSAGE_WEBHOOKS','create','delete','935502SrtROf','150TxJHXL','getAccessTokenFromPage','axios','https://graph.facebook.com/v13.0/','path','https://graph.facebook.com/v13.0/oauth/access_token','4035104fehGNK','message_echoes','sendText','stringify','env','data','access_token','unsubscribeApp','sendAttachmentFromUrl','1123400OflBXA','4pBOfxG','me/messages','logger','/subscribed_apps','9LpXSDn','defineProperty','mark_seen','removeApplcation','47046JrUHGm','messaging_postbacks','client_credentials','6561470gbWtXl','post','default','subscribeApp','getPageProfile','message','getProfile','../../utils/logger','__esModule','get','fb_exchange_token','FACEBOOK_APP_SECRET','sendAttachment','recipient','genText','form-data','ERR_FETCHING_FB_PAGES','?access_token=','ERR_FETCHING_FB_USER_TOKEN','/subscribed_apps?access_token='];a487_0x621c=function(){return _0x27101e;};return a487_0x621c();}var __importDefault=this&&this['__importDefault']||function(_0x5afcb9){const _0x52f2c5=a487_0x4e0a;return _0x5afcb9&&_0x5afcb9[_0x52f2c5(0x99)]?_0x5afcb9:{'default':_0x5afcb9};};Object[a487_0x46de1f(0xc9)](exports,'__esModule',{'value':!![]}),exports[a487_0x46de1f(0xcb)]=exports[a487_0x46de1f(0xb5)]=exports['getSubscribedApps']=exports['unsubscribeApp']=exports[a487_0x46de1f(0x94)]=exports[a487_0x46de1f(0xac)]=exports[a487_0x46de1f(0x95)]=exports['getProfile']=exports[a487_0x46de1f(0x9f)]=exports[a487_0x46de1f(0x9d)]=exports[a487_0x46de1f(0xc2)]=exports[a487_0x46de1f(0xbc)]=exports['markSeen']=exports[a487_0x46de1f(0xa9)]=void 0x0;function a487_0x4e0a(_0x25493f,_0x1f56e6){const _0x621cf7=a487_0x621c();return a487_0x4e0a=function(_0x4e0ada,_0x44dff3){_0x4e0ada=_0x4e0ada-0x94;let _0x47a470=_0x621cf7[_0x4e0ada];return _0x47a470;},a487_0x4e0a(_0x25493f,_0x1f56e6);}const axios_1=__importDefault(require(a487_0x46de1f(0xb6))),form_data_1=__importDefault(require(a487_0x46de1f(0xa0))),fs_1=require('fs'),logger_1=require(a487_0x46de1f(0x98)),formData=new form_data_1[(a487_0x46de1f(0xd1))](),apiBase=_0x1c4ec5=>axios_1[a487_0x46de1f(0xd1)][a487_0x46de1f(0xb1)]({'baseURL':a487_0x46de1f(0xb7),'params':{'access_token':_0x1c4ec5}}),getAccessToken=async()=>{const _0x2b4269=a487_0x46de1f,{data:_0x4cab90}=await axios_1[_0x2b4269(0xd1)][_0x2b4269(0x9a)](_0x2b4269(0xb9),{'params':{'client_id':process[_0x2b4269(0xbe)][_0x2b4269(0xaa)],'client_secret':process[_0x2b4269(0xbe)][_0x2b4269(0x9c)],'grant_type':_0x2b4269(0xce)}});return _0x4cab90[_0x2b4269(0xc0)];};exports['getAccessToken']=getAccessToken;const markSeen=async(_0xcb2096,_0x357750)=>{const _0x118529=a487_0x46de1f;await apiBase(_0x357750)[_0x118529(0xd0)](_0xcb2096+_0x118529(0xa7),{'recipient':{'id':_0xcb2096},'sender_action':_0x118529(0xca)});};exports['markSeen']=markSeen;const sendText=async(_0x589dc7,_0x2a48fa,_0x535d11)=>{const _0x5e11c1=a487_0x46de1f;try{const {data:_0xc4fd4d}=await apiBase(_0x535d11)[_0x5e11c1(0xd0)](_0x5e11c1(0xc5),{'recipient':{'id':_0x589dc7},'message':{'text':''+_0x2a48fa}});return _0xc4fd4d;}catch(_0x5513b1){console[_0x5e11c1(0xaf)](_0x5513b1);}};exports['sendText']=sendText;const sendAttachmentFromUrl=async(_0x1739e9,_0x3ab10c,_0x5ee8cb,_0x3121d8)=>{const _0x3e599e=a487_0x46de1f;try{const {data:_0x41f825}=await apiBase(_0x3121d8)[_0x3e599e(0xd0)]('me/messages',{'recipient':{'id':_0x1739e9},'message':{'attachment':{'type':_0x5ee8cb,'payload':{'url':_0x3ab10c}}}});return _0x41f825;}catch(_0x463dc5){console['log'](_0x463dc5);}};exports[a487_0x46de1f(0xc2)]=sendAttachmentFromUrl;const sendAttachment=async(_0x3b1946,_0x53f3da,_0x518343,_0xdaf8fe)=>{const _0x549679=a487_0x46de1f;formData[_0x549679(0xad)](_0x549679(0x9e),JSON[_0x549679(0xbd)]({'id':_0x3b1946})),formData[_0x549679(0xad)](_0x549679(0x96),JSON[_0x549679(0xbd)]({'attachment':{'type':_0x518343,'payload':{'is_reusable':!![]}}}));const _0x34ba31=(0x0,fs_1['createReadStream'])(_0x53f3da[_0x549679(0xb8)]);formData[_0x549679(0xad)]('filedata',_0x34ba31);try{await apiBase(_0xdaf8fe)[_0x549679(0xd0)](_0x549679(0xc5),formData,{'headers':{...formData['getHeaders']()}});}catch(_0x1c8419){throw new Error(_0x1c8419);}};exports[a487_0x46de1f(0x9d)]=sendAttachment;const genText=_0x381e1a=>{const _0x3aabb8={'text':_0x381e1a};return _0x3aabb8;};exports[a487_0x46de1f(0x9f)]=genText;const getProfile=async(_0xebb153,_0x2a12c9)=>{const _0x50c2c9=a487_0x46de1f;try{const {data:_0x15fdce}=await apiBase(_0x2a12c9)[_0x50c2c9(0x9a)](_0xebb153);return _0x15fdce;}catch(_0x566c86){console[_0x50c2c9(0xaf)](_0x566c86);throw new Error('ERR_FETCHING_FB_USER_PROFILE_2');}};exports[a487_0x46de1f(0x97)]=getProfile;const getPageProfile=async(_0x1cd5d1,_0x2c060e)=>{const _0x533576=a487_0x46de1f;try{const {data:_0x5b821e}=await apiBase(_0x2c060e)[_0x533576(0x9a)](_0x1cd5d1+_0x533576(0xa8));return _0x5b821e;}catch(_0x1eba18){console['log'](_0x1eba18);throw new Error(_0x533576(0xa1));}};exports['getPageProfile']=getPageProfile;const profilePsid=async(_0x564fbd,_0x201472)=>{const _0x5ca792=a487_0x46de1f;try{const {data:_0x46a241}=await axios_1[_0x5ca792(0xd1)][_0x5ca792(0x9a)](_0x5ca792(0xb7)+_0x564fbd+_0x5ca792(0xa2)+_0x201472);return _0x46a241;}catch(_0x4a39e8){console[_0x5ca792(0xaf)](_0x4a39e8),await(0x0,exports[_0x5ca792(0x97)])(_0x564fbd,_0x201472);}};exports[a487_0x46de1f(0xac)]=profilePsid;const subscribeApp=async(_0x1ccdbe,_0x297e79)=>{const _0x1df759=a487_0x46de1f;try{const {data:_0x1700a4}=await axios_1[_0x1df759(0xd1)][_0x1df759(0xd0)](_0x1df759(0xb7)+_0x1ccdbe+_0x1df759(0xa4)+_0x297e79,{'subscribed_fields':['messages',_0x1df759(0xcd),_0x1df759(0xa6),_0x1df759(0xae),_0x1df759(0xbb)]});return _0x1700a4;}catch(_0x29870a){console[_0x1df759(0xaf)](_0x29870a);throw new Error(_0x1df759(0xb0));}};exports[a487_0x46de1f(0x94)]=subscribeApp;const unsubscribeApp=async(_0x520c48,_0x2982d7)=>{const _0x2b9c9f=a487_0x46de1f;try{const {data:_0x4e515d}=await axios_1[_0x2b9c9f(0xd1)][_0x2b9c9f(0xb2)]('https://graph.facebook.com/v13.0/'+_0x520c48+_0x2b9c9f(0xa4)+_0x2982d7);return _0x4e515d;}catch(_0x34e361){throw new Error('ERR_UNSUBSCRIBING_PAGE_TO_MESSAGE_WEBHOOKS');}};exports[a487_0x46de1f(0xc1)]=unsubscribeApp;const getSubscribedApps=async(_0x346408,_0xb743e1)=>{const _0x32e2d7=a487_0x46de1f;try{const {data:_0x36e719}=await apiBase(_0xb743e1)[_0x32e2d7(0x9a)](_0x346408+_0x32e2d7(0xc7));return _0x36e719;}catch(_0x2cecd2){throw new Error('ERR_GETTING_SUBSCRIBED_APPS');}};exports['getSubscribedApps']=getSubscribedApps;const getAccessTokenFromPage=async _0x15fea4=>{const _0x49005e=a487_0x46de1f;try{if(!_0x15fea4)throw new Error(_0x49005e(0xa3));const _0x4685de=await axios_1[_0x49005e(0xd1)][_0x49005e(0x9a)](_0x49005e(0xb9),{'params':{'client_id':process[_0x49005e(0xbe)][_0x49005e(0xaa)],'client_secret':process[_0x49005e(0xbe)][_0x49005e(0x9c)],'grant_type':_0x49005e(0x9b),'fb_exchange_token':_0x15fea4}});return _0x4685de[_0x49005e(0xbf)][_0x49005e(0xc0)];}catch(_0x489c91){console[_0x49005e(0xaf)](_0x489c91);throw new Error(_0x49005e(0xa3));}};exports[a487_0x46de1f(0xb5)]=getAccessTokenFromPage;const removeApplcation=async(_0x58154d,_0x695a77)=>{const _0x6180db=a487_0x46de1f;try{await axios_1[_0x6180db(0xd1)][_0x6180db(0xb2)](_0x6180db(0xb7)+_0x58154d+'/permissions',{'params':{'access_token':_0x695a77}});}catch(_0x51f472){logger_1[_0x6180db(0xc6)]['error']('ERR_REMOVING_APP_FROM_PAGE');}};exports['removeApplcation']=removeApplcation;