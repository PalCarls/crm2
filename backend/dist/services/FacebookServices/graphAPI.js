'use strict';const a432_0x27b065=a432_0x209b;(function(_0x5e0504,_0x108bca){const _0x5e0080=a432_0x209b,_0x24db43=_0x5e0504();while(!![]){try{const _0x2ae20d=parseInt(_0x5e0080(0x202))/0x1+-parseInt(_0x5e0080(0x1ec))/0x2+parseInt(_0x5e0080(0x1fc))/0x3*(parseInt(_0x5e0080(0x1d5))/0x4)+-parseInt(_0x5e0080(0x1e6))/0x5*(parseInt(_0x5e0080(0x207))/0x6)+parseInt(_0x5e0080(0x1d6))/0x7*(parseInt(_0x5e0080(0x20a))/0x8)+parseInt(_0x5e0080(0x1fa))/0x9*(-parseInt(_0x5e0080(0x1d9))/0xa)+parseInt(_0x5e0080(0x1da))/0xb;if(_0x2ae20d===_0x108bca)break;else _0x24db43['push'](_0x24db43['shift']());}catch(_0xb4c37f){_0x24db43['push'](_0x24db43['shift']());}}}(a432_0x4122,0x2150e));var __importDefault=this&&this['__importDefault']||function(_0x46c3f9){const _0xa6ffa5=a432_0x209b;return _0x46c3f9&&_0x46c3f9[_0xa6ffa5(0x1fd)]?_0x46c3f9:{'default':_0x46c3f9};};Object['defineProperty'](exports,a432_0x27b065(0x1fd),{'value':!![]}),exports[a432_0x27b065(0x1cd)]=exports['getAccessTokenFromPage']=exports[a432_0x27b065(0x209)]=exports[a432_0x27b065(0x1f5)]=exports[a432_0x27b065(0x200)]=exports[a432_0x27b065(0x1e1)]=exports[a432_0x27b065(0x204)]=exports['getProfile']=exports[a432_0x27b065(0x1ed)]=exports[a432_0x27b065(0x1e2)]=exports[a432_0x27b065(0x1f9)]=exports[a432_0x27b065(0x1dc)]=exports[a432_0x27b065(0x203)]=exports[a432_0x27b065(0x1d8)]=void 0x0;const axios_1=__importDefault(require('axios')),form_data_1=__importDefault(require(a432_0x27b065(0x1f3))),fs_1=require('fs'),logger_1=require(a432_0x27b065(0x1eb)),formData=new form_data_1['default'](),apiBase=_0x279a9e=>axios_1[a432_0x27b065(0x1e9)][a432_0x27b065(0x1f0)]({'baseURL':'https://graph.facebook.com/v13.0/','params':{'access_token':_0x279a9e}}),getAccessToken=async()=>{const _0x5a0d60=a432_0x27b065,{data:_0x5e37c5}=await axios_1['default'][_0x5a0d60(0x1f6)](_0x5a0d60(0x1fe),{'params':{'client_id':process['env']['FACEBOOK_APP_ID'],'client_secret':process['env'][_0x5a0d60(0x1ce)],'grant_type':_0x5a0d60(0x1db)}});return _0x5e37c5[_0x5a0d60(0x1d7)];};exports[a432_0x27b065(0x1d8)]=getAccessToken;const markSeen=async(_0x327c23,_0x1c29b4)=>{const _0x1338cb=a432_0x27b065;await apiBase(_0x1c29b4)[_0x1338cb(0x1f1)](_0x327c23+_0x1338cb(0x206),{'recipient':{'id':_0x327c23},'sender_action':'mark_seen'});};exports[a432_0x27b065(0x203)]=markSeen;const sendText=async(_0x514340,_0x5936c3,_0x2ba418)=>{const _0x27b5fe=a432_0x27b065;try{const {data:_0x1d2f7d}=await apiBase(_0x2ba418)[_0x27b5fe(0x1f1)]('me/messages',{'recipient':{'id':_0x514340},'message':{'text':''+_0x5936c3}});return _0x1d2f7d;}catch(_0x3e9033){console['log'](_0x3e9033);}};function a432_0x209b(_0x2ca652,_0x3bff16){const _0x412218=a432_0x4122();return a432_0x209b=function(_0x209bd8,_0x5ac7a0){_0x209bd8=_0x209bd8-0x1cc;let _0x399dff=_0x412218[_0x209bd8];return _0x399dff;},a432_0x209b(_0x2ca652,_0x3bff16);}exports[a432_0x27b065(0x1dc)]=sendText;const sendAttachmentFromUrl=async(_0x7e6d73,_0x43fd71,_0xb65024,_0x234ec2)=>{const _0x17e1f3=a432_0x27b065;try{const {data:_0x53489c}=await apiBase(_0x234ec2)['post'](_0x17e1f3(0x1f7),{'recipient':{'id':_0x7e6d73},'message':{'attachment':{'type':_0xb65024,'payload':{'url':_0x43fd71}}}});return _0x53489c;}catch(_0xfb1279){console['log'](_0xfb1279);}};exports[a432_0x27b065(0x1f9)]=sendAttachmentFromUrl;const sendAttachment=async(_0x5a60ad,_0x82a1fe,_0x4fbb65,_0x3a8131)=>{const _0x52105b=a432_0x27b065;formData[_0x52105b(0x1d2)](_0x52105b(0x1e4),JSON[_0x52105b(0x1de)]({'id':_0x5a60ad})),formData[_0x52105b(0x1d2)]('message',JSON[_0x52105b(0x1de)]({'attachment':{'type':_0x4fbb65,'payload':{'is_reusable':!![]}}}));const _0x1a8311=(0x0,fs_1['createReadStream'])(_0x82a1fe[_0x52105b(0x1ef)]);formData['append'](_0x52105b(0x1dd),_0x1a8311);try{await apiBase(_0x3a8131)[_0x52105b(0x1f1)](_0x52105b(0x1f7),formData,{'headers':{...formData[_0x52105b(0x1d1)]()}});}catch(_0xd5f7d3){throw new Error(_0xd5f7d3);}};exports[a432_0x27b065(0x1e2)]=sendAttachment;const genText=_0x4b52c=>{const _0x44352e={'text':_0x4b52c};return _0x44352e;};exports[a432_0x27b065(0x1ed)]=genText;const getProfile=async(_0x16adb3,_0x5ddbc0)=>{const _0x8b715f=a432_0x27b065;try{const {data:_0x40315}=await apiBase(_0x5ddbc0)['get'](_0x16adb3);return _0x40315;}catch(_0x5d81e9){console[_0x8b715f(0x1cf)](_0x5d81e9);throw new Error(_0x8b715f(0x208));}};exports[a432_0x27b065(0x1df)]=getProfile;const getPageProfile=async(_0xef6c31,_0x4899a6)=>{const _0x28314d=a432_0x27b065;try{const {data:_0x38cb3c}=await apiBase(_0x4899a6)[_0x28314d(0x1f6)](_0xef6c31+_0x28314d(0x1e0));return _0x38cb3c;}catch(_0x3ad734){console[_0x28314d(0x1cf)](_0x3ad734);throw new Error(_0x28314d(0x1e3));}};exports[a432_0x27b065(0x204)]=getPageProfile;const profilePsid=async(_0x4066e3,_0x269984)=>{const _0x1d711e=a432_0x27b065;try{const {data:_0x48475c}=await axios_1[_0x1d711e(0x1e9)][_0x1d711e(0x1f6)](_0x1d711e(0x205)+_0x4066e3+_0x1d711e(0x1f2)+_0x269984);return _0x48475c;}catch(_0x53822d){console['log'](_0x53822d),await(0x0,exports[_0x1d711e(0x1df)])(_0x4066e3,_0x269984);}};exports[a432_0x27b065(0x1e1)]=profilePsid;const subscribeApp=async(_0x493f35,_0x44023e)=>{const _0x4065cd=a432_0x27b065;try{const {data:_0x451603}=await axios_1[_0x4065cd(0x1e9)]['post'](_0x4065cd(0x205)+_0x493f35+_0x4065cd(0x1d3)+_0x44023e,{'subscribed_fields':['messages','messaging_postbacks',_0x4065cd(0x1ee),_0x4065cd(0x1f8),_0x4065cd(0x1ea)]});return _0x451603;}catch(_0x416e76){console[_0x4065cd(0x1cf)](_0x416e76);throw new Error(_0x4065cd(0x1fb));}};exports[a432_0x27b065(0x200)]=subscribeApp;const unsubscribeApp=async(_0x828988,_0x55bebb)=>{const _0x46daa6=a432_0x27b065;try{const {data:_0x5cd2ba}=await axios_1['default']['delete'](_0x46daa6(0x205)+_0x828988+_0x46daa6(0x1d3)+_0x55bebb);return _0x5cd2ba;}catch(_0x4cef54){throw new Error('ERR_UNSUBSCRIBING_PAGE_TO_MESSAGE_WEBHOOKS');}};exports[a432_0x27b065(0x1f5)]=unsubscribeApp;const getSubscribedApps=async(_0x399f7b,_0x29cebb)=>{const _0x2759e4=a432_0x27b065;try{const {data:_0x59feac}=await apiBase(_0x29cebb)['get'](_0x399f7b+'/subscribed_apps');return _0x59feac;}catch(_0x327a33){throw new Error(_0x2759e4(0x1d0));}};function a432_0x4122(){const _0x489fe8=['9YgNUka','ERR_SUBSCRIBING_PAGE_TO_MESSAGE_WEBHOOKS','594iaRkRm','__esModule','https://graph.facebook.com/v13.0/oauth/access_token','error','subscribeApp','FACEBOOK_APP_ID','102542oxwvwT','markSeen','getPageProfile','https://graph.facebook.com/v13.0/','/messages','6hTEpxc','ERR_FETCHING_FB_USER_PROFILE_2','getSubscribedApps','4648WSlNjj','ERR_FETCHING_FB_USER_TOKEN','removeApplcation','FACEBOOK_APP_SECRET','log','ERR_GETTING_SUBSCRIBED_APPS','getHeaders','append','/subscribed_apps?access_token=','fb_exchange_token','1948XDHvLW','875eylyVx','access_token','getAccessToken','1143820dvNVSM','3068296uHVVpy','client_credentials','sendText','filedata','stringify','getProfile','/accounts?fields=name,access_token,instagram_business_account{id,username,profile_picture_url,name}','profilePsid','sendAttachment','ERR_FETCHING_FB_PAGES','recipient','/permissions','591755RfBpyF','delete','data','default','message_echoes','../../utils/logger','362668VgkWXj','genText','message_deliveries','path','create','post','?access_token=','form-data','env','unsubscribeApp','get','me/messages','message_reads','sendAttachmentFromUrl'];a432_0x4122=function(){return _0x489fe8;};return a432_0x4122();}exports['getSubscribedApps']=getSubscribedApps;const getAccessTokenFromPage=async _0x416693=>{const _0x36706b=a432_0x27b065;try{if(!_0x416693)throw new Error(_0x36706b(0x1cc));const _0x548c02=await axios_1[_0x36706b(0x1e9)]['get'](_0x36706b(0x1fe),{'params':{'client_id':process[_0x36706b(0x1f4)][_0x36706b(0x201)],'client_secret':process[_0x36706b(0x1f4)][_0x36706b(0x1ce)],'grant_type':_0x36706b(0x1d4),'fb_exchange_token':_0x416693}});return _0x548c02[_0x36706b(0x1e8)][_0x36706b(0x1d7)];}catch(_0x514b59){console[_0x36706b(0x1cf)](_0x514b59);throw new Error('ERR_FETCHING_FB_USER_TOKEN');}};exports['getAccessTokenFromPage']=getAccessTokenFromPage;const removeApplcation=async(_0x17f26f,_0x1ce93e)=>{const _0x5e9c79=a432_0x27b065;try{await axios_1[_0x5e9c79(0x1e9)][_0x5e9c79(0x1e7)](_0x5e9c79(0x205)+_0x17f26f+_0x5e9c79(0x1e5),{'params':{'access_token':_0x1ce93e}});}catch(_0x53bcc3){logger_1['logger'][_0x5e9c79(0x1ff)]('ERR_REMOVING_APP_FROM_PAGE');}};exports[a432_0x27b065(0x1cd)]=removeApplcation;