'use strict';const a447_0x1726c8=a447_0x5a1c;(function(_0x20458d,_0x2495fa){const _0x39f860=a447_0x5a1c,_0x3f62b0=_0x20458d();while(!![]){try{const _0xfd5d4=parseInt(_0x39f860(0x160))/0x1+parseInt(_0x39f860(0x17c))/0x2*(parseInt(_0x39f860(0x17f))/0x3)+-parseInt(_0x39f860(0x16e))/0x4*(parseInt(_0x39f860(0x186))/0x5)+parseInt(_0x39f860(0x14a))/0x6*(parseInt(_0x39f860(0x172))/0x7)+parseInt(_0x39f860(0x181))/0x8*(parseInt(_0x39f860(0x155))/0x9)+-parseInt(_0x39f860(0x14f))/0xa+parseInt(_0x39f860(0x15a))/0xb*(parseInt(_0x39f860(0x187))/0xc);if(_0xfd5d4===_0x2495fa)break;else _0x3f62b0['push'](_0x3f62b0['shift']());}catch(_0x22cd3c){_0x3f62b0['push'](_0x3f62b0['shift']());}}}(a447_0xa35d,0x81c34));var __importDefault=this&&this[a447_0x1726c8(0x182)]||function(_0x1f290f){const _0x3874fa=a447_0x1726c8;return _0x1f290f&&_0x1f290f[_0x3874fa(0x167)]?_0x1f290f:{'default':_0x1f290f};};Object[a447_0x1726c8(0x170)](exports,a447_0x1726c8(0x167),{'value':!![]}),exports['removeApplcation']=exports[a447_0x1726c8(0x161)]=exports[a447_0x1726c8(0x17b)]=exports['unsubscribeApp']=exports[a447_0x1726c8(0x152)]=exports['profilePsid']=exports[a447_0x1726c8(0x178)]=exports[a447_0x1726c8(0x163)]=exports[a447_0x1726c8(0x158)]=exports[a447_0x1726c8(0x156)]=exports[a447_0x1726c8(0x162)]=exports[a447_0x1726c8(0x184)]=exports[a447_0x1726c8(0x185)]=exports[a447_0x1726c8(0x14c)]=void 0x0;const axios_1=__importDefault(require(a447_0x1726c8(0x17a))),form_data_1=__importDefault(require(a447_0x1726c8(0x174))),fs_1=require('fs'),logger_1=require(a447_0x1726c8(0x154)),formData=new form_data_1[(a447_0x1726c8(0x16b))](),apiBase=_0x229095=>axios_1[a447_0x1726c8(0x16b)][a447_0x1726c8(0x18c)]({'baseURL':a447_0x1726c8(0x14b),'params':{'access_token':_0x229095}}),getAccessToken=async()=>{const _0x19bdc2=a447_0x1726c8,{data:_0x1451a4}=await axios_1[_0x19bdc2(0x16b)][_0x19bdc2(0x16a)](_0x19bdc2(0x176),{'params':{'client_id':process[_0x19bdc2(0x15b)][_0x19bdc2(0x15c)],'client_secret':process[_0x19bdc2(0x15b)][_0x19bdc2(0x153)],'grant_type':_0x19bdc2(0x189)}});return _0x1451a4[_0x19bdc2(0x17d)];};function a447_0xa35d(){const _0x36a6d2=['recipient','/permissions','842336OlUvlE','mark_seen','defineProperty','logger','14Egwacj','/messages','form-data','/subscribed_apps','https://graph.facebook.com/v13.0/oauth/access_token','stringify','getPageProfile','append','axios','getSubscribedApps','2iQdqik','access_token','ERR_FETCHING_FB_USER_PROFILE_2','184011jNiLQc','ERR_UNSUBSCRIBING_PAGE_TO_MESSAGE_WEBHOOKS','8HwDxzq','__importDefault','me/messages','sendText','markSeen','20GgsdvK','69612buibFl','messaging_postbacks','client_credentials','path','getHeaders','create','fb_exchange_token','data','/subscribed_apps?access_token=','?access_token=','1240284VAKsOB','https://graph.facebook.com/v13.0/','getAccessToken','delete','message','5903290FduYCJ','profilePsid','ERR_REMOVING_APP_FROM_PAGE','subscribeApp','FACEBOOK_APP_SECRET','../../utils/logger','7786404qGXRCz','sendAttachment','ERR_GETTING_SUBSCRIBED_APPS','genText','message_echoes','649gXQCny','env','FACEBOOK_APP_ID','error','filedata','post','281993XbtNmN','getAccessTokenFromPage','sendAttachmentFromUrl','getProfile','ERR_SUBSCRIBING_PAGE_TO_MESSAGE_WEBHOOKS','/accounts?fields=name,access_token,instagram_business_account{id,username,profile_picture_url,name}','log','__esModule','removeApplcation','createReadStream','get','default'];a447_0xa35d=function(){return _0x36a6d2;};return a447_0xa35d();}exports[a447_0x1726c8(0x14c)]=getAccessToken;const markSeen=async(_0x444560,_0x5424fb)=>{const _0x50efa8=a447_0x1726c8;await apiBase(_0x5424fb)['post'](_0x444560+_0x50efa8(0x173),{'recipient':{'id':_0x444560},'sender_action':_0x50efa8(0x16f)});};exports[a447_0x1726c8(0x185)]=markSeen;const sendText=async(_0x490ca1,_0x19d478,_0x42e631)=>{const _0x3351bd=a447_0x1726c8;try{const {data:_0x215959}=await apiBase(_0x42e631)[_0x3351bd(0x15f)]('me/messages',{'recipient':{'id':_0x490ca1},'message':{'text':''+_0x19d478}});return _0x215959;}catch(_0x1d8392){console[_0x3351bd(0x166)](_0x1d8392);}};exports['sendText']=sendText;const sendAttachmentFromUrl=async(_0x1f4c62,_0x54ced5,_0x4e3a9f,_0x133df6)=>{const _0x274386=a447_0x1726c8;try{const {data:_0x30c1e0}=await apiBase(_0x133df6)[_0x274386(0x15f)](_0x274386(0x183),{'recipient':{'id':_0x1f4c62},'message':{'attachment':{'type':_0x4e3a9f,'payload':{'url':_0x54ced5}}}});return _0x30c1e0;}catch(_0x218096){console[_0x274386(0x166)](_0x218096);}};exports[a447_0x1726c8(0x162)]=sendAttachmentFromUrl;const sendAttachment=async(_0xbb071c,_0x3f8b22,_0x1c2f2a,_0x177dd9)=>{const _0x15cee1=a447_0x1726c8;formData[_0x15cee1(0x179)](_0x15cee1(0x16c),JSON[_0x15cee1(0x177)]({'id':_0xbb071c})),formData['append'](_0x15cee1(0x14e),JSON['stringify']({'attachment':{'type':_0x1c2f2a,'payload':{'is_reusable':!![]}}}));const _0x47cf6d=(0x0,fs_1[_0x15cee1(0x169)])(_0x3f8b22[_0x15cee1(0x18a)]);formData[_0x15cee1(0x179)](_0x15cee1(0x15e),_0x47cf6d);try{await apiBase(_0x177dd9)['post'](_0x15cee1(0x183),formData,{'headers':{...formData[_0x15cee1(0x18b)]()}});}catch(_0x384c74){throw new Error(_0x384c74);}};exports[a447_0x1726c8(0x156)]=sendAttachment;const genText=_0x5c323b=>{const _0x518fba={'text':_0x5c323b};return _0x518fba;};exports['genText']=genText;const getProfile=async(_0x5af271,_0x4e4df1)=>{const _0x2e3caa=a447_0x1726c8;try{const {data:_0x2941b6}=await apiBase(_0x4e4df1)[_0x2e3caa(0x16a)](_0x5af271);return _0x2941b6;}catch(_0x24bf12){console['log'](_0x24bf12);throw new Error(_0x2e3caa(0x17e));}};function a447_0x5a1c(_0x57a989,_0x13dffc){const _0xa35d91=a447_0xa35d();return a447_0x5a1c=function(_0x5a1c93,_0x21e666){_0x5a1c93=_0x5a1c93-0x148;let _0x525f54=_0xa35d91[_0x5a1c93];return _0x525f54;},a447_0x5a1c(_0x57a989,_0x13dffc);}exports['getProfile']=getProfile;const getPageProfile=async(_0x5de564,_0x236f6b)=>{const _0x3f8e4d=a447_0x1726c8;try{const {data:_0x4e618e}=await apiBase(_0x236f6b)[_0x3f8e4d(0x16a)](_0x5de564+_0x3f8e4d(0x165));return _0x4e618e;}catch(_0x48caa7){console[_0x3f8e4d(0x166)](_0x48caa7);throw new Error('ERR_FETCHING_FB_PAGES');}};exports[a447_0x1726c8(0x178)]=getPageProfile;const profilePsid=async(_0x2aba01,_0x3bdfd8)=>{const _0xd241c=a447_0x1726c8;try{const {data:_0x27c2cd}=await axios_1['default'][_0xd241c(0x16a)](_0xd241c(0x14b)+_0x2aba01+_0xd241c(0x149)+_0x3bdfd8);return _0x27c2cd;}catch(_0x2b43db){console[_0xd241c(0x166)](_0x2b43db),await(0x0,exports[_0xd241c(0x163)])(_0x2aba01,_0x3bdfd8);}};exports[a447_0x1726c8(0x150)]=profilePsid;const subscribeApp=async(_0x4035e,_0x215108)=>{const _0x5ae7fb=a447_0x1726c8;try{const {data:_0xc95886}=await axios_1[_0x5ae7fb(0x16b)]['post'](_0x5ae7fb(0x14b)+_0x4035e+_0x5ae7fb(0x148)+_0x215108,{'subscribed_fields':['messages',_0x5ae7fb(0x188),'message_deliveries','message_reads',_0x5ae7fb(0x159)]});return _0xc95886;}catch(_0x189a84){console[_0x5ae7fb(0x166)](_0x189a84);throw new Error(_0x5ae7fb(0x164));}};exports[a447_0x1726c8(0x152)]=subscribeApp;const unsubscribeApp=async(_0x430e0d,_0x2df7f9)=>{const _0x265d4b=a447_0x1726c8;try{const {data:_0xdf04ce}=await axios_1[_0x265d4b(0x16b)][_0x265d4b(0x14d)]('https://graph.facebook.com/v13.0/'+_0x430e0d+_0x265d4b(0x148)+_0x2df7f9);return _0xdf04ce;}catch(_0x275ab7){throw new Error(_0x265d4b(0x180));}};exports['unsubscribeApp']=unsubscribeApp;const getSubscribedApps=async(_0x1d5e7c,_0x39364c)=>{const _0x44d4c6=a447_0x1726c8;try{const {data:_0x46edb1}=await apiBase(_0x39364c)[_0x44d4c6(0x16a)](_0x1d5e7c+_0x44d4c6(0x175));return _0x46edb1;}catch(_0x55655f){throw new Error(_0x44d4c6(0x157));}};exports[a447_0x1726c8(0x17b)]=getSubscribedApps;const getAccessTokenFromPage=async _0x1de815=>{const _0xbb304a=a447_0x1726c8;try{if(!_0x1de815)throw new Error('ERR_FETCHING_FB_USER_TOKEN');const _0x39ac06=await axios_1[_0xbb304a(0x16b)][_0xbb304a(0x16a)](_0xbb304a(0x176),{'params':{'client_id':process['env']['FACEBOOK_APP_ID'],'client_secret':process[_0xbb304a(0x15b)][_0xbb304a(0x153)],'grant_type':_0xbb304a(0x18d),'fb_exchange_token':_0x1de815}});return _0x39ac06[_0xbb304a(0x18e)][_0xbb304a(0x17d)];}catch(_0x273c11){console[_0xbb304a(0x166)](_0x273c11);throw new Error('ERR_FETCHING_FB_USER_TOKEN');}};exports[a447_0x1726c8(0x161)]=getAccessTokenFromPage;const removeApplcation=async(_0x5de441,_0x327a03)=>{const _0x3ff60f=a447_0x1726c8;try{await axios_1[_0x3ff60f(0x16b)][_0x3ff60f(0x14d)](_0x3ff60f(0x14b)+_0x5de441+_0x3ff60f(0x16d),{'params':{'access_token':_0x327a03}});}catch(_0x11f148){logger_1[_0x3ff60f(0x171)][_0x3ff60f(0x15d)](_0x3ff60f(0x151));}};exports[a447_0x1726c8(0x168)]=removeApplcation;