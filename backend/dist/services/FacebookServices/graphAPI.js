<<<<<<< HEAD
'use strict';const a470_0x3dd0f2=a470_0x2ee9;function a470_0x2b70(){const _0x348b20=['sendText','path','message_reads','getProfile','logger','sendAttachment','ERR_FETCHING_FB_USER_PROFILE_2','log','genText','../../utils/logger','access_token','delete','getAccessToken','1347525zehSri','get','axios','646371zRJkFM','recipient','defineProperty','default','ERR_SUBSCRIBING_PAGE_TO_MESSAGE_WEBHOOKS','profilePsid','getPageProfile','318224oYVbAa','getAccessTokenFromPage','create','2064060uNWGlF','https://graph.facebook.com/v13.0/','FACEBOOK_APP_SECRET','client_credentials','getSubscribedApps','/messages','message','message_echoes','messages','https://graph.facebook.com/v13.0/oauth/access_token','ERR_GETTING_SUBSCRIBED_APPS','message_deliveries','env','removeApplcation','1342334RCaWeu','post','subscribeApp','append','ERR_UNSUBSCRIBING_PAGE_TO_MESSAGE_WEBHOOKS','ERR_FETCHING_FB_USER_TOKEN','3154036HqGFQR','5uhVhrB','filedata','/subscribed_apps','2Anjhxj','sendAttachmentFromUrl','unsubscribeApp','getHeaders','stringify','/subscribed_apps?access_token=','FACEBOOK_APP_ID','me/messages','form-data','data','markSeen','/accounts?fields=name,access_token,instagram_business_account{id,username,profile_picture_url,name}','messaging_postbacks','/permissions','fb_exchange_token','createReadStream','__esModule','1127220ibTatZ'];a470_0x2b70=function(){return _0x348b20;};return a470_0x2b70();}(function(_0xf9fc8d,_0x48e7ab){const _0x3bfbf2=a470_0x2ee9,_0x1a01e5=_0xf9fc8d();while(!![]){try{const _0xdc0399=-parseInt(_0x3bfbf2(0x164))/0x1+-parseInt(_0x3bfbf2(0x186))/0x2*(-parseInt(_0x3bfbf2(0x197))/0x3)+parseInt(_0x3bfbf2(0x182))/0x4+-parseInt(_0x3bfbf2(0x183))/0x5*(parseInt(_0x3bfbf2(0x16e))/0x6)+parseInt(_0x3bfbf2(0x17c))/0x7+-parseInt(_0x3bfbf2(0x16b))/0x8+parseInt(_0x3bfbf2(0x161))/0x9;if(_0xdc0399===_0x48e7ab)break;else _0x1a01e5['push'](_0x1a01e5['shift']());}catch(_0x5289fa){_0x1a01e5['push'](_0x1a01e5['shift']());}}}(a470_0x2b70,0x741b9));var __importDefault=this&&this['__importDefault']||function(_0xf10d08){const _0x1f3146=a470_0x2ee9;return _0xf10d08&&_0xf10d08[_0x1f3146(0x196)]?_0xf10d08:{'default':_0xf10d08};};Object[a470_0x3dd0f2(0x166)](exports,a470_0x3dd0f2(0x196),{'value':!![]}),exports[a470_0x3dd0f2(0x17b)]=exports[a470_0x3dd0f2(0x16c)]=exports[a470_0x3dd0f2(0x172)]=exports[a470_0x3dd0f2(0x188)]=exports[a470_0x3dd0f2(0x17e)]=exports[a470_0x3dd0f2(0x169)]=exports[a470_0x3dd0f2(0x16a)]=exports[a470_0x3dd0f2(0x157)]=exports[a470_0x3dd0f2(0x15c)]=exports[a470_0x3dd0f2(0x159)]=exports[a470_0x3dd0f2(0x187)]=exports[a470_0x3dd0f2(0x198)]=exports[a470_0x3dd0f2(0x190)]=exports[a470_0x3dd0f2(0x160)]=void 0x0;const axios_1=__importDefault(require(a470_0x3dd0f2(0x163))),form_data_1=__importDefault(require(a470_0x3dd0f2(0x18e))),fs_1=require('fs'),logger_1=require(a470_0x3dd0f2(0x15d)),formData=new form_data_1['default'](),apiBase=_0x3643c1=>axios_1[a470_0x3dd0f2(0x167)][a470_0x3dd0f2(0x16d)]({'baseURL':a470_0x3dd0f2(0x16f),'params':{'access_token':_0x3643c1}}),getAccessToken=async()=>{const _0x53eacb=a470_0x3dd0f2,{data:_0x35c892}=await axios_1[_0x53eacb(0x167)][_0x53eacb(0x162)](_0x53eacb(0x177),{'params':{'client_id':process['env'][_0x53eacb(0x18c)],'client_secret':process[_0x53eacb(0x17a)][_0x53eacb(0x170)],'grant_type':_0x53eacb(0x171)}});return _0x35c892[_0x53eacb(0x15e)];};exports[a470_0x3dd0f2(0x160)]=getAccessToken;const markSeen=async(_0x23b389,_0x52fcec)=>{const _0x22d3d1=a470_0x3dd0f2;await apiBase(_0x52fcec)[_0x22d3d1(0x17d)](_0x23b389+_0x22d3d1(0x173),{'recipient':{'id':_0x23b389},'sender_action':'mark_seen'});};exports[a470_0x3dd0f2(0x190)]=markSeen;const sendText=async(_0x1d0654,_0x302809,_0xa4e92d)=>{const _0x1cbf47=a470_0x3dd0f2;try{const {data:_0x374376}=await apiBase(_0xa4e92d)[_0x1cbf47(0x17d)]('me/messages',{'recipient':{'id':_0x1d0654},'message':{'text':''+_0x302809}});return _0x374376;}catch(_0x4f6735){console[_0x1cbf47(0x15b)](_0x4f6735);}};function a470_0x2ee9(_0xe2ebf3,_0x2fdcca){const _0x2b70c3=a470_0x2b70();return a470_0x2ee9=function(_0x2ee91a,_0x572711){_0x2ee91a=_0x2ee91a-0x155;let _0x410dda=_0x2b70c3[_0x2ee91a];return _0x410dda;},a470_0x2ee9(_0xe2ebf3,_0x2fdcca);}exports[a470_0x3dd0f2(0x198)]=sendText;const sendAttachmentFromUrl=async(_0x207af5,_0x282ac0,_0x57575a,_0x356c9d)=>{const _0x18d121=a470_0x3dd0f2;try{const {data:_0x5a0efc}=await apiBase(_0x356c9d)[_0x18d121(0x17d)]('me/messages',{'recipient':{'id':_0x207af5},'message':{'attachment':{'type':_0x57575a,'payload':{'url':_0x282ac0}}}});return _0x5a0efc;}catch(_0x585a7b){console[_0x18d121(0x15b)](_0x585a7b);}};exports[a470_0x3dd0f2(0x187)]=sendAttachmentFromUrl;const sendAttachment=async(_0x35f84d,_0x516bdd,_0xabee93,_0x1d5bcb)=>{const _0x14d51c=a470_0x3dd0f2;formData['append'](_0x14d51c(0x165),JSON[_0x14d51c(0x18a)]({'id':_0x35f84d})),formData['append'](_0x14d51c(0x174),JSON[_0x14d51c(0x18a)]({'attachment':{'type':_0xabee93,'payload':{'is_reusable':!![]}}}));const _0xf5c64a=(0x0,fs_1[_0x14d51c(0x195)])(_0x516bdd[_0x14d51c(0x155)]);formData[_0x14d51c(0x17f)](_0x14d51c(0x184),_0xf5c64a);try{await apiBase(_0x1d5bcb)[_0x14d51c(0x17d)](_0x14d51c(0x18d),formData,{'headers':{...formData[_0x14d51c(0x189)]()}});}catch(_0x24c1b3){throw new Error(_0x24c1b3);}};exports[a470_0x3dd0f2(0x159)]=sendAttachment;const genText=_0x4e9a24=>{const _0xfa4faf={'text':_0x4e9a24};return _0xfa4faf;};exports[a470_0x3dd0f2(0x15c)]=genText;const getProfile=async(_0x38cec9,_0x1a2ee3)=>{const _0x37afff=a470_0x3dd0f2;try{const {data:_0x4c62f8}=await apiBase(_0x1a2ee3)[_0x37afff(0x162)](_0x38cec9);return _0x4c62f8;}catch(_0x51ab51){console[_0x37afff(0x15b)](_0x51ab51);throw new Error(_0x37afff(0x15a));}};exports[a470_0x3dd0f2(0x157)]=getProfile;const getPageProfile=async(_0x218bf5,_0xcac8e1)=>{const _0x300034=a470_0x3dd0f2;try{const {data:_0x455f88}=await apiBase(_0xcac8e1)['get'](_0x218bf5+_0x300034(0x191));return _0x455f88;}catch(_0x4c2916){console[_0x300034(0x15b)](_0x4c2916);throw new Error('ERR_FETCHING_FB_PAGES');}};exports[a470_0x3dd0f2(0x16a)]=getPageProfile;const profilePsid=async(_0x4a8360,_0x4d2e9b)=>{const _0x29b3a8=a470_0x3dd0f2;try{const {data:_0xfc97b3}=await axios_1[_0x29b3a8(0x167)]['get'](_0x29b3a8(0x16f)+_0x4a8360+'?access_token='+_0x4d2e9b);return _0xfc97b3;}catch(_0x38188f){console['log'](_0x38188f),await(0x0,exports[_0x29b3a8(0x157)])(_0x4a8360,_0x4d2e9b);}};exports[a470_0x3dd0f2(0x169)]=profilePsid;const subscribeApp=async(_0x44571d,_0x4735e8)=>{const _0x9c8315=a470_0x3dd0f2;try{const {data:_0x735ba2}=await axios_1[_0x9c8315(0x167)][_0x9c8315(0x17d)](_0x9c8315(0x16f)+_0x44571d+_0x9c8315(0x18b)+_0x4735e8,{'subscribed_fields':[_0x9c8315(0x176),_0x9c8315(0x192),_0x9c8315(0x179),_0x9c8315(0x156),_0x9c8315(0x175)]});return _0x735ba2;}catch(_0x2f3e59){console['log'](_0x2f3e59);throw new Error(_0x9c8315(0x168));}};exports[a470_0x3dd0f2(0x17e)]=subscribeApp;const unsubscribeApp=async(_0x5806ea,_0x51b296)=>{const _0x2c2f57=a470_0x3dd0f2;try{const {data:_0x100a61}=await axios_1[_0x2c2f57(0x167)][_0x2c2f57(0x15f)]('https://graph.facebook.com/v13.0/'+_0x5806ea+_0x2c2f57(0x18b)+_0x51b296);return _0x100a61;}catch(_0x521c61){throw new Error(_0x2c2f57(0x180));}};exports[a470_0x3dd0f2(0x188)]=unsubscribeApp;const getSubscribedApps=async(_0x25a50e,_0x5ef009)=>{const _0x337570=a470_0x3dd0f2;try{const {data:_0x58755a}=await apiBase(_0x5ef009)[_0x337570(0x162)](_0x25a50e+_0x337570(0x185));return _0x58755a;}catch(_0x55b25f){throw new Error(_0x337570(0x178));}};exports['getSubscribedApps']=getSubscribedApps;const getAccessTokenFromPage=async _0x15dcf0=>{const _0x579e15=a470_0x3dd0f2;try{if(!_0x15dcf0)throw new Error(_0x579e15(0x181));const _0x2a4898=await axios_1['default'][_0x579e15(0x162)](_0x579e15(0x177),{'params':{'client_id':process[_0x579e15(0x17a)][_0x579e15(0x18c)],'client_secret':process['env'][_0x579e15(0x170)],'grant_type':_0x579e15(0x194),'fb_exchange_token':_0x15dcf0}});return _0x2a4898[_0x579e15(0x18f)][_0x579e15(0x15e)];}catch(_0xf3a432){console[_0x579e15(0x15b)](_0xf3a432);throw new Error(_0x579e15(0x181));}};exports[a470_0x3dd0f2(0x16c)]=getAccessTokenFromPage;const removeApplcation=async(_0x624a49,_0x16e231)=>{const _0xdc5540=a470_0x3dd0f2;try{await axios_1[_0xdc5540(0x167)][_0xdc5540(0x15f)](_0xdc5540(0x16f)+_0x624a49+_0xdc5540(0x193),{'params':{'access_token':_0x16e231}});}catch(_0x35b532){logger_1[_0xdc5540(0x158)]['error']('ERR_REMOVING_APP_FROM_PAGE');}};exports[a470_0x3dd0f2(0x17b)]=removeApplcation;
=======
'use strict';const a470_0x41299d=a470_0x2385;function a470_0x2385(_0x4fd505,_0x316dbc){const _0x52ccd8=a470_0x52cc();return a470_0x2385=function(_0x238538,_0x5ac8d2){_0x238538=_0x238538-0x1de;let _0x4a9497=_0x52ccd8[_0x238538];return _0x4a9497;},a470_0x2385(_0x4fd505,_0x316dbc);}(function(_0xe3d8d1,_0x1205c5){const _0x590e7e=a470_0x2385,_0x5136d7=_0xe3d8d1();while(!![]){try{const _0x51be86=-parseInt(_0x590e7e(0x217))/0x1+parseInt(_0x590e7e(0x219))/0x2+-parseInt(_0x590e7e(0x1e6))/0x3*(parseInt(_0x590e7e(0x1de))/0x4)+parseInt(_0x590e7e(0x210))/0x5+-parseInt(_0x590e7e(0x21e))/0x6*(parseInt(_0x590e7e(0x1f4))/0x7)+-parseInt(_0x590e7e(0x216))/0x8*(parseInt(_0x590e7e(0x1ef))/0x9)+-parseInt(_0x590e7e(0x20a))/0xa*(-parseInt(_0x590e7e(0x1f9))/0xb);if(_0x51be86===_0x1205c5)break;else _0x5136d7['push'](_0x5136d7['shift']());}catch(_0x22f4ac){_0x5136d7['push'](_0x5136d7['shift']());}}}(a470_0x52cc,0x56013));var __importDefault=this&&this[a470_0x41299d(0x21c)]||function(_0x477362){const _0xdfa825=a470_0x41299d;return _0x477362&&_0x477362[_0xdfa825(0x222)]?_0x477362:{'default':_0x477362};};Object[a470_0x41299d(0x215)](exports,'__esModule',{'value':!![]}),exports['removeApplcation']=exports[a470_0x41299d(0x1f0)]=exports[a470_0x41299d(0x21d)]=exports[a470_0x41299d(0x1e1)]=exports[a470_0x41299d(0x20b)]=exports['profilePsid']=exports['getPageProfile']=exports['getProfile']=exports['genText']=exports[a470_0x41299d(0x1ed)]=exports['sendAttachmentFromUrl']=exports[a470_0x41299d(0x21a)]=exports[a470_0x41299d(0x1ec)]=exports[a470_0x41299d(0x1f2)]=void 0x0;const axios_1=__importDefault(require(a470_0x41299d(0x1e8))),form_data_1=__importDefault(require(a470_0x41299d(0x214))),fs_1=require('fs'),logger_1=require('../../utils/logger'),formData=new form_data_1[(a470_0x41299d(0x1ff))](),apiBase=_0x299a89=>axios_1[a470_0x41299d(0x1ff)][a470_0x41299d(0x208)]({'baseURL':a470_0x41299d(0x1ee),'params':{'access_token':_0x299a89}}),getAccessToken=async()=>{const _0x3fbfc8=a470_0x41299d,{data:_0x2ed0e3}=await axios_1[_0x3fbfc8(0x1ff)]['get'](_0x3fbfc8(0x1e4),{'params':{'client_id':process['env'][_0x3fbfc8(0x20c)],'client_secret':process[_0x3fbfc8(0x1f1)][_0x3fbfc8(0x206)],'grant_type':_0x3fbfc8(0x204)}});return _0x2ed0e3[_0x3fbfc8(0x1fc)];};exports['getAccessToken']=getAccessToken;const markSeen=async(_0x1e5e95,_0x416f8b)=>{const _0xc47b2f=a470_0x41299d;await apiBase(_0x416f8b)[_0xc47b2f(0x1f3)](_0x1e5e95+'/messages',{'recipient':{'id':_0x1e5e95},'sender_action':_0xc47b2f(0x1f8)});};exports[a470_0x41299d(0x1ec)]=markSeen;const sendText=async(_0x2d758b,_0x5d6a92,_0x590d60)=>{const _0x2fe868=a470_0x41299d;try{const {data:_0xd5dc82}=await apiBase(_0x590d60)[_0x2fe868(0x1f3)](_0x2fe868(0x1e7),{'recipient':{'id':_0x2d758b},'message':{'text':''+_0x5d6a92}});return _0xd5dc82;}catch(_0x34ba87){console['log'](_0x34ba87);}};exports[a470_0x41299d(0x21a)]=sendText;const sendAttachmentFromUrl=async(_0xc93d74,_0x208437,_0x2f5fb3,_0x1c8ff6)=>{const _0x53faed=a470_0x41299d;try{const {data:_0x2d63df}=await apiBase(_0x1c8ff6)[_0x53faed(0x1f3)]('me/messages',{'recipient':{'id':_0xc93d74},'message':{'attachment':{'type':_0x2f5fb3,'payload':{'url':_0x208437}}}});return _0x2d63df;}catch(_0x49ceb2){console[_0x53faed(0x220)](_0x49ceb2);}};exports[a470_0x41299d(0x1e3)]=sendAttachmentFromUrl;const sendAttachment=async(_0x2d84cb,_0x4e59b3,_0x1eabce,_0x4146c8)=>{const _0x4567b0=a470_0x41299d;formData[_0x4567b0(0x218)](_0x4567b0(0x1fe),JSON[_0x4567b0(0x1eb)]({'id':_0x2d84cb})),formData[_0x4567b0(0x218)](_0x4567b0(0x202),JSON[_0x4567b0(0x1eb)]({'attachment':{'type':_0x1eabce,'payload':{'is_reusable':!![]}}}));const _0x21b606=(0x0,fs_1[_0x4567b0(0x1f5)])(_0x4e59b3[_0x4567b0(0x1fa)]);formData['append']('filedata',_0x21b606);try{await apiBase(_0x4146c8)[_0x4567b0(0x1f3)](_0x4567b0(0x1e7),formData,{'headers':{...formData[_0x4567b0(0x201)]()}});}catch(_0x1172b5){throw new Error(_0x1172b5);}};exports[a470_0x41299d(0x1ed)]=sendAttachment;const genText=_0x1a6848=>{const _0x21c36d={'text':_0x1a6848};return _0x21c36d;};exports[a470_0x41299d(0x21b)]=genText;const getProfile=async(_0x37e082,_0x263ee2)=>{const _0x1a165f=a470_0x41299d;try{const {data:_0x23ffad}=await apiBase(_0x263ee2)[_0x1a165f(0x1e5)](_0x37e082);return _0x23ffad;}catch(_0x16749e){console[_0x1a165f(0x220)](_0x16749e);throw new Error(_0x1a165f(0x1df));}};exports[a470_0x41299d(0x209)]=getProfile;const getPageProfile=async(_0x2f1da6,_0x24f7b9)=>{const _0x2cf604=a470_0x41299d;try{const {data:_0x299e4c}=await apiBase(_0x24f7b9)['get'](_0x2f1da6+_0x2cf604(0x205));return _0x299e4c;}catch(_0x4fbe50){console[_0x2cf604(0x220)](_0x4fbe50);throw new Error(_0x2cf604(0x211));}};exports[a470_0x41299d(0x213)]=getPageProfile;const profilePsid=async(_0x492c74,_0x368edc)=>{const _0x4ab4f5=a470_0x41299d;try{const {data:_0xb491bd}=await axios_1[_0x4ab4f5(0x1ff)][_0x4ab4f5(0x1e5)]('https://graph.facebook.com/v13.0/'+_0x492c74+_0x4ab4f5(0x21f)+_0x368edc);return _0xb491bd;}catch(_0x320d53){console[_0x4ab4f5(0x220)](_0x320d53),await(0x0,exports[_0x4ab4f5(0x209)])(_0x492c74,_0x368edc);}};function a470_0x52cc(){const _0x15cf34=['585440EorMLE','46204UFvtMQ','append','268934lebkaF','sendText','genText','__importDefault','getSubscribedApps','6srcTsy','?access_token=','log','/subscribed_apps?access_token=','__esModule','72hyZNVY','ERR_FETCHING_FB_USER_PROFILE_2','removeApplcation','unsubscribeApp','ERR_UNSUBSCRIBING_PAGE_TO_MESSAGE_WEBHOOKS','sendAttachmentFromUrl','https://graph.facebook.com/v13.0/oauth/access_token','get','27801bOpeQC','me/messages','axios','message_echoes','messaging_postbacks','stringify','markSeen','sendAttachment','https://graph.facebook.com/v13.0/','63VRvMMz','getAccessTokenFromPage','env','getAccessToken','post','2549197ssCyQO','createReadStream','profilePsid','fb_exchange_token','mark_seen','429YVKWvZ','path','message_deliveries','access_token','messages','recipient','default','ERR_FETCHING_FB_USER_TOKEN','getHeaders','message','logger','client_credentials','/accounts?fields=name,access_token,instagram_business_account{id,username,profile_picture_url,name}','FACEBOOK_APP_SECRET','/subscribed_apps','create','getProfile','175790SStuBX','subscribeApp','FACEBOOK_APP_ID','data','ERR_GETTING_SUBSCRIBED_APPS','delete','3108340Sxjpud','ERR_FETCHING_FB_PAGES','ERR_SUBSCRIBING_PAGE_TO_MESSAGE_WEBHOOKS','getPageProfile','form-data','defineProperty'];a470_0x52cc=function(){return _0x15cf34;};return a470_0x52cc();}exports[a470_0x41299d(0x1f6)]=profilePsid;const subscribeApp=async(_0xf2d182,_0x3ac9c5)=>{const _0x4ee6a4=a470_0x41299d;try{const {data:_0x3a58d7}=await axios_1[_0x4ee6a4(0x1ff)][_0x4ee6a4(0x1f3)](_0x4ee6a4(0x1ee)+_0xf2d182+_0x4ee6a4(0x221)+_0x3ac9c5,{'subscribed_fields':[_0x4ee6a4(0x1fd),_0x4ee6a4(0x1ea),_0x4ee6a4(0x1fb),'message_reads',_0x4ee6a4(0x1e9)]});return _0x3a58d7;}catch(_0x482edc){console['log'](_0x482edc);throw new Error(_0x4ee6a4(0x212));}};exports[a470_0x41299d(0x20b)]=subscribeApp;const unsubscribeApp=async(_0x4e7531,_0x2f32df)=>{const _0xc3456=a470_0x41299d;try{const {data:_0x22b337}=await axios_1[_0xc3456(0x1ff)][_0xc3456(0x20f)](_0xc3456(0x1ee)+_0x4e7531+_0xc3456(0x221)+_0x2f32df);return _0x22b337;}catch(_0x180dc3){throw new Error(_0xc3456(0x1e2));}};exports['unsubscribeApp']=unsubscribeApp;const getSubscribedApps=async(_0x1e252a,_0x47658c)=>{const _0x522a20=a470_0x41299d;try{const {data:_0x579a12}=await apiBase(_0x47658c)[_0x522a20(0x1e5)](_0x1e252a+_0x522a20(0x207));return _0x579a12;}catch(_0x44d1c2){throw new Error(_0x522a20(0x20e));}};exports[a470_0x41299d(0x21d)]=getSubscribedApps;const getAccessTokenFromPage=async _0x4e1240=>{const _0x28d47c=a470_0x41299d;try{if(!_0x4e1240)throw new Error(_0x28d47c(0x200));const _0x4b6ad3=await axios_1['default'][_0x28d47c(0x1e5)](_0x28d47c(0x1e4),{'params':{'client_id':process['env']['FACEBOOK_APP_ID'],'client_secret':process['env'][_0x28d47c(0x206)],'grant_type':_0x28d47c(0x1f7),'fb_exchange_token':_0x4e1240}});return _0x4b6ad3[_0x28d47c(0x20d)][_0x28d47c(0x1fc)];}catch(_0x2258c4){console['log'](_0x2258c4);throw new Error(_0x28d47c(0x200));}};exports['getAccessTokenFromPage']=getAccessTokenFromPage;const removeApplcation=async(_0x31d90b,_0x3c8c45)=>{const _0x4f84cc=a470_0x41299d;try{await axios_1['default'][_0x4f84cc(0x20f)](_0x4f84cc(0x1ee)+_0x31d90b+'/permissions',{'params':{'access_token':_0x3c8c45}});}catch(_0x5616d5){logger_1[_0x4f84cc(0x203)]['error']('ERR_REMOVING_APP_FROM_PAGE');}};exports[a470_0x41299d(0x1e0)]=removeApplcation;
>>>>>>> ab722bfbcf394d74dd0b99a984c0dcf6ffbcff7f
