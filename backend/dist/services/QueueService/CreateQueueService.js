'use strict';const a538_0x3675d8=a538_0x4080;(function(_0x21a263,_0x3f4243){const _0x5a3fb7=a538_0x4080,_0x31ac41=_0x21a263();while(!![]){try{const _0x3a0856=-parseInt(_0x5a3fb7(0x132))/0x1+parseInt(_0x5a3fb7(0x139))/0x2*(parseInt(_0x5a3fb7(0x136))/0x3)+-parseInt(_0x5a3fb7(0x159))/0x4*(parseInt(_0x5a3fb7(0x15c))/0x5)+parseInt(_0x5a3fb7(0x13f))/0x6+-parseInt(_0x5a3fb7(0x15a))/0x7*(-parseInt(_0x5a3fb7(0x13a))/0x8)+parseInt(_0x5a3fb7(0x138))/0x9+-parseInt(_0x5a3fb7(0x134))/0xa;if(_0x3a0856===_0x3f4243)break;else _0x31ac41['push'](_0x31ac41['shift']());}catch(_0x2574fa){_0x31ac41['push'](_0x31ac41['shift']());}}}(a538_0x455c,0xdba59));function a538_0x4080(_0x49728c,_0x22c4bd){const _0x455c12=a538_0x455c();return a538_0x4080=function(_0x4080cc,_0x4b35f2){_0x4080cc=_0x4080cc-0x12d;let _0x5d227f=_0x455c12[_0x4080cc];return _0x5d227f;},a538_0x4080(_0x49728c,_0x22c4bd);}function a538_0x455c(){const _0x3a4b39=['default','configurable','count','__importDefault','4981808MYmiQx','127183vYBRkK','ERR_QUEUE_COLOR_ALREADY_EXISTS','5NRcnCk','prototype','message','hasOwnProperty','Check-color-exists','__setModuleDefault','997695MVpLlq','findOne','18871590XtxRTN','call','316821tHHtjr','required','7103313YzPVNi','24FxYVYA','592NIyPHc','queues','shape','../../models/Queue','defineProperty','9773592XEErYi','__esModule','ERR_QUEUE_NAME_ALREADY_EXISTS','chatbots','ERR_QUEUE_INVALID_NAME','plan','../../errors/AppError','writable','string','ERR_QUEUE_INVALID_COLOR','test','__importStar','Check-unique-name','user','Check-color','../../models/Company','getOwnPropertyDescriptor','create','../../models/Plan','min','yup','object'];a538_0x455c=function(){return _0x3a4b39;};return a538_0x455c();}var __createBinding=this&&this['__createBinding']||(Object[a538_0x3675d8(0x150)]?function(_0x8abcfc,_0x4bd4f6,_0x507fc5,_0x36701f){const _0x5493ad=a538_0x3675d8;if(_0x36701f===undefined)_0x36701f=_0x507fc5;var _0x4c4509=Object[_0x5493ad(0x14f)](_0x4bd4f6,_0x507fc5);(!_0x4c4509||('get'in _0x4c4509?!_0x4bd4f6[_0x5493ad(0x140)]:_0x4c4509[_0x5493ad(0x146)]||_0x4c4509[_0x5493ad(0x156)]))&&(_0x4c4509={'enumerable':!![],'get':function(){return _0x4bd4f6[_0x507fc5];}}),Object['defineProperty'](_0x8abcfc,_0x36701f,_0x4c4509);}:function(_0x1ebbe5,_0x26bce9,_0x323367,_0x32111a){if(_0x32111a===undefined)_0x32111a=_0x323367;_0x1ebbe5[_0x32111a]=_0x26bce9[_0x323367];}),__setModuleDefault=this&&this[a538_0x3675d8(0x131)]||(Object[a538_0x3675d8(0x150)]?function(_0x2035a0,_0x14d2a1){const _0x1c80e5=a538_0x3675d8;Object['defineProperty'](_0x2035a0,_0x1c80e5(0x155),{'enumerable':!![],'value':_0x14d2a1});}:function(_0x6d7586,_0xa60cfa){const _0x1dd7bf=a538_0x3675d8;_0x6d7586[_0x1dd7bf(0x155)]=_0xa60cfa;}),__importStar=this&&this[a538_0x3675d8(0x14a)]||function(_0x13f4ce){const _0x3c1f9b=a538_0x3675d8;if(_0x13f4ce&&_0x13f4ce[_0x3c1f9b(0x140)])return _0x13f4ce;var _0x18c21b={};if(_0x13f4ce!=null){for(var _0x1990bc in _0x13f4ce)if(_0x1990bc!=='default'&&Object[_0x3c1f9b(0x12d)][_0x3c1f9b(0x12f)][_0x3c1f9b(0x135)](_0x13f4ce,_0x1990bc))__createBinding(_0x18c21b,_0x13f4ce,_0x1990bc);}return __setModuleDefault(_0x18c21b,_0x13f4ce),_0x18c21b;},__importDefault=this&&this[a538_0x3675d8(0x158)]||function(_0x1e5760){return _0x1e5760&&_0x1e5760['__esModule']?_0x1e5760:{'default':_0x1e5760};};Object[a538_0x3675d8(0x13e)](exports,a538_0x3675d8(0x140),{'value':!![]});const Yup=__importStar(require(a538_0x3675d8(0x153))),AppError_1=__importDefault(require(a538_0x3675d8(0x145))),Queue_1=__importDefault(require(a538_0x3675d8(0x13d))),Company_1=__importDefault(require(a538_0x3675d8(0x14e))),Plan_1=__importDefault(require(a538_0x3675d8(0x151))),Chatbot_1=__importDefault(require('../../models/Chatbot')),User_1=__importDefault(require('../../models/User')),CreateQueueService=async _0x5cdf2c=>{const _0x504185=a538_0x3675d8,{color:_0x261155,name:_0x566151,companyId:_0x335a1d}=_0x5cdf2c,_0x5a3c27=await Company_1[_0x504185(0x155)][_0x504185(0x133)]({'where':{'id':_0x335a1d},'include':[{'model':Plan_1[_0x504185(0x155)],'as':'plan'}]});if(_0x5a3c27!==null){const _0x4ffc37=await Queue_1[_0x504185(0x155)][_0x504185(0x157)]({'where':{'companyId':_0x335a1d}});if(_0x4ffc37>=_0x5a3c27[_0x504185(0x144)][_0x504185(0x13b)])throw new AppError_1[(_0x504185(0x155))]('Número\x20máximo\x20de\x20filas\x20já\x20alcançado:\x20'+_0x4ffc37);}const _0x4b4021=Yup[_0x504185(0x154)]()[_0x504185(0x13c)]({'name':Yup['string']()[_0x504185(0x152)](0x2,_0x504185(0x143))['required']('ERR_QUEUE_INVALID_NAME')[_0x504185(0x149)](_0x504185(0x14b),_0x504185(0x141),async _0x28cbd8=>{const _0x4067c2=_0x504185;if(_0x28cbd8){const _0x365e4d=await Queue_1[_0x4067c2(0x155)]['findOne']({'where':{'name':_0x28cbd8,'companyId':_0x335a1d}});return!_0x365e4d;}return![];}),'color':Yup[_0x504185(0x147)]()[_0x504185(0x137)](_0x504185(0x148))[_0x504185(0x149)](_0x504185(0x14d),_0x504185(0x148),async _0x17a700=>{const _0x38c8e5=_0x504185;if(_0x17a700){const _0x54d095=/^#[0-9a-f]{3,6}$/i;return _0x54d095[_0x38c8e5(0x149)](_0x17a700);}return![];})['test'](_0x504185(0x130),_0x504185(0x15b),async _0x2ad256=>{const _0x59274b=_0x504185;if(_0x2ad256){const _0x3c1ea9=await Queue_1[_0x59274b(0x155)][_0x59274b(0x133)]({'where':{'color':_0x2ad256,'companyId':_0x335a1d}});return!_0x3c1ea9;}return![];})});try{await _0x4b4021['validate']({'color':_0x261155,'name':_0x566151});}catch(_0x1312af){throw new AppError_1['default'](_0x1312af[_0x504185(0x12e)]);}const _0x2ceff4=await Queue_1[_0x504185(0x155)][_0x504185(0x150)](_0x5cdf2c,{'include':[{'model':Chatbot_1[_0x504185(0x155)],'as':_0x504185(0x142),'include':[{'model':User_1['default'],'as':_0x504185(0x14c)}],'order':[[{'model':Chatbot_1['default'],'as':_0x504185(0x142)},'id','asc']]}]});return _0x2ceff4;};exports[a538_0x3675d8(0x155)]=CreateQueueService;