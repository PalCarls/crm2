'use strict';const a499_0x5092cd=a499_0x3f96;(function(_0x2b395f,_0xa39122){const _0x2770e0=a499_0x3f96,_0x17ff11=_0x2b395f();while(!![]){try{const _0x246efe=parseInt(_0x2770e0(0xc2))/0x1*(-parseInt(_0x2770e0(0xa0))/0x2)+-parseInt(_0x2770e0(0xb1))/0x3+-parseInt(_0x2770e0(0xb8))/0x4*(-parseInt(_0x2770e0(0xc7))/0x5)+-parseInt(_0x2770e0(0xc4))/0x6*(parseInt(_0x2770e0(0xc0))/0x7)+-parseInt(_0x2770e0(0xb0))/0x8*(-parseInt(_0x2770e0(0xc5))/0x9)+-parseInt(_0x2770e0(0xbe))/0xa*(-parseInt(_0x2770e0(0xba))/0xb)+parseInt(_0x2770e0(0xac))/0xc;if(_0x246efe===_0xa39122)break;else _0x17ff11['push'](_0x17ff11['shift']());}catch(_0x1a4754){_0x17ff11['push'](_0x17ff11['shift']());}}}(a499_0x4b8d,0xbadb7));var __createBinding=this&&this[a499_0x5092cd(0xa3)]||(Object[a499_0x5092cd(0xae)]?function(_0x145ab6,_0x2dd7e0,_0x56cb38,_0x5e72c3){const _0x2fa37a=a499_0x5092cd;if(_0x5e72c3===undefined)_0x5e72c3=_0x56cb38;var _0x2e87ff=Object[_0x2fa37a(0xbc)](_0x2dd7e0,_0x56cb38);(!_0x2e87ff||('get'in _0x2e87ff?!_0x2dd7e0[_0x2fa37a(0xab)]:_0x2e87ff[_0x2fa37a(0x9f)]||_0x2e87ff[_0x2fa37a(0xbb)]))&&(_0x2e87ff={'enumerable':!![],'get':function(){return _0x2dd7e0[_0x56cb38];}}),Object[_0x2fa37a(0xa1)](_0x145ab6,_0x5e72c3,_0x2e87ff);}:function(_0x214e35,_0x2aec9f,_0x4eee51,_0x2fbacf){if(_0x2fbacf===undefined)_0x2fbacf=_0x4eee51;_0x214e35[_0x2fbacf]=_0x2aec9f[_0x4eee51];}),__setModuleDefault=this&&this[a499_0x5092cd(0xb4)]||(Object['create']?function(_0x433fdf,_0x4fda34){const _0x2a25a4=a499_0x5092cd;Object[_0x2a25a4(0xa1)](_0x433fdf,_0x2a25a4(0xbd),{'enumerable':!![],'value':_0x4fda34});}:function(_0x618daa,_0x153ab6){const _0xcf2309=a499_0x5092cd;_0x618daa[_0xcf2309(0xbd)]=_0x153ab6;}),__importStar=this&&this[a499_0x5092cd(0xb6)]||function(_0x26b868){const _0x589b8f=a499_0x5092cd;if(_0x26b868&&_0x26b868[_0x589b8f(0xab)])return _0x26b868;var _0x1ab535={};if(_0x26b868!=null){for(var _0x4bc1ab in _0x26b868)if(_0x4bc1ab!==_0x589b8f(0xbd)&&Object[_0x589b8f(0xaf)][_0x589b8f(0x9d)][_0x589b8f(0xb9)](_0x26b868,_0x4bc1ab))__createBinding(_0x1ab535,_0x26b868,_0x4bc1ab);}return __setModuleDefault(_0x1ab535,_0x26b868),_0x1ab535;},__importDefault=this&&this[a499_0x5092cd(0xb2)]||function(_0x5f2e23){return _0x5f2e23&&_0x5f2e23['__esModule']?_0x5f2e23:{'default':_0x5f2e23};};function a499_0x3f96(_0x3e3e57,_0x7c8663){const _0x4b8d0f=a499_0x4b8d();return a499_0x3f96=function(_0x3f966f,_0xe7c0d1){_0x3f966f=_0x3f966f-0x9d;let _0x207ed0=_0x4b8d0f[_0x3f966f];return _0x207ed0;},a499_0x3f96(_0x3e3e57,_0x7c8663);}Object['defineProperty'](exports,a499_0x5092cd(0xab),{'value':!![]});const Yup=__importStar(require(a499_0x5092cd(0xc1))),AppError_1=__importDefault(require('../../errors/AppError')),Queue_1=__importDefault(require('../../models/Queue')),Company_1=__importDefault(require(a499_0x5092cd(0xc3))),Plan_1=__importDefault(require('../../models/Plan')),Chatbot_1=__importDefault(require('../../models/Chatbot')),CreateQueueService=async _0x22d45f=>{const _0x25bde3=a499_0x5092cd,{color:_0x3befec,name:_0x18fb7a,companyId:_0x5882ed}=_0x22d45f,_0x50f761=await Company_1[_0x25bde3(0xbd)]['findOne']({'where':{'id':_0x5882ed},'include':[{'model':Plan_1[_0x25bde3(0xbd)],'as':'plan'}]});if(_0x50f761!==null){const _0x9d9d33=await Queue_1[_0x25bde3(0xbd)][_0x25bde3(0xa5)]({'where':{'companyId':_0x5882ed}});if(_0x9d9d33>=_0x50f761[_0x25bde3(0xa9)][_0x25bde3(0x9e)])throw new AppError_1[(_0x25bde3(0xbd))](_0x25bde3(0xb5)+_0x9d9d33);}const _0x32638c=Yup['object']()['shape']({'name':Yup[_0x25bde3(0xbf)]()['min'](0x2,'ERR_QUEUE_INVALID_NAME')[_0x25bde3(0xa7)](_0x25bde3(0xaa))['test'](_0x25bde3(0xc6),'ERR_QUEUE_NAME_ALREADY_EXISTS',async _0xc18e42=>{const _0x2b18ae=_0x25bde3;if(_0xc18e42){const _0x11a1a4=await Queue_1[_0x2b18ae(0xbd)]['findOne']({'where':{'name':_0xc18e42,'companyId':_0x5882ed}});return!_0x11a1a4;}return![];}),'color':Yup[_0x25bde3(0xbf)]()[_0x25bde3(0xa7)](_0x25bde3(0xa2))[_0x25bde3(0xa8)](_0x25bde3(0xa4),_0x25bde3(0xa2),async _0x54fa22=>{if(_0x54fa22){const _0x18f945=/^#[0-9a-f]{3,6}$/i;return _0x18f945['test'](_0x54fa22);}return![];})[_0x25bde3(0xa8)](_0x25bde3(0xb7),_0x25bde3(0xad),async _0x14bafc=>{if(_0x14bafc){const _0x2b72ef=await Queue_1['default']['findOne']({'where':{'color':_0x14bafc,'companyId':_0x5882ed}});return!_0x2b72ef;}return![];})});try{await _0x32638c[_0x25bde3(0xa6)]({'color':_0x3befec,'name':_0x18fb7a});}catch(_0x3a59b4){throw new AppError_1['default'](_0x3a59b4['message']);}const _0x20bfc5=await Queue_1[_0x25bde3(0xbd)]['create'](_0x22d45f,{'include':[{'model':Chatbot_1[_0x25bde3(0xbd)],'as':_0x25bde3(0xb3),'order':[[{'model':Chatbot_1[_0x25bde3(0xbd)],'as':_0x25bde3(0xb3)},'id','asc']]}]});return _0x20bfc5;};function a499_0x4b8d(){const _0x428df3=['call','30019juxMSw','configurable','getOwnPropertyDescriptor','default','2770FrbgsU','string','333361PeuNOR','yup','10954vCnLkw','../../models/Company','42jnTwyr','10926fwXaGi','Check-unique-name','30QjtPYd','hasOwnProperty','queues','writable','218WyBLVP','defineProperty','ERR_QUEUE_INVALID_COLOR','__createBinding','Check-color','count','validate','required','test','plan','ERR_QUEUE_INVALID_NAME','__esModule','21119988hCNyGc','ERR_QUEUE_COLOR_ALREADY_EXISTS','create','prototype','152DVQPvW','4090506DBQlSk','__importDefault','chatbots','__setModuleDefault','Número\x20máximo\x20de\x20filas\x20já\x20alcançado:\x20','__importStar','Check-color-exists','744812xTMrxc'];a499_0x4b8d=function(){return _0x428df3;};return a499_0x4b8d();}exports['default']=CreateQueueService;