'use strict';const a478_0x2922a8=a478_0x314f;function a478_0x29ad(){const _0x3d7035=['findOne','ERR_QUEUE_COLOR_ALREADY_EXISTS','plan','configurable','required','__createBinding','string','object','message','../../models/Company','Check-unique-name','458697WHQPQk','get','__setModuleDefault','2FxgTSp','defineProperty','Número\x20máximo\x20de\x20filas\x20já\x20alcançado:\x20','../../errors/AppError','prototype','yup','min','queues','1095215OMjWBH','ERR_QUEUE_NAME_ALREADY_EXISTS','call','asc','71031jObrgd','__importStar','42btZjky','Check-color-exists','1610672pSXQDG','test','10UFdMZb','create','21246ODToOV','1016472PxeElF','ERR_QUEUE_INVALID_COLOR','default','../../models/Plan','__importDefault','__esModule','count','1926927uuiCuq'];a478_0x29ad=function(){return _0x3d7035;};return a478_0x29ad();}(function(_0x375212,_0x1238c7){const _0x43fac2=a478_0x314f,_0x524965=_0x375212();while(!![]){try{const _0x21e3d6=parseInt(_0x43fac2(0x72))/0x1*(-parseInt(_0x43fac2(0x91))/0x2)+parseInt(_0x43fac2(0x8e))/0x3+-parseInt(_0x43fac2(0x76))/0x4+parseInt(_0x43fac2(0x6e))/0x5+-parseInt(_0x43fac2(0x7a))/0x6*(-parseInt(_0x43fac2(0x74))/0x7)+parseInt(_0x43fac2(0x7b))/0x8+parseInt(_0x43fac2(0x82))/0x9*(parseInt(_0x43fac2(0x78))/0xa);if(_0x21e3d6===_0x1238c7)break;else _0x524965['push'](_0x524965['shift']());}catch(_0x4f5903){_0x524965['push'](_0x524965['shift']());}}}(a478_0x29ad,0x3fa2b));var __createBinding=this&&this[a478_0x2922a8(0x88)]||(Object[a478_0x2922a8(0x79)]?function(_0x4c7c8f,_0x56f4eb,_0x59725d,_0x2f79d6){const _0x430abb=a478_0x2922a8;if(_0x2f79d6===undefined)_0x2f79d6=_0x59725d;var _0x301d29=Object['getOwnPropertyDescriptor'](_0x56f4eb,_0x59725d);(!_0x301d29||(_0x430abb(0x8f)in _0x301d29?!_0x56f4eb['__esModule']:_0x301d29['writable']||_0x301d29[_0x430abb(0x86)]))&&(_0x301d29={'enumerable':!![],'get':function(){return _0x56f4eb[_0x59725d];}}),Object[_0x430abb(0x92)](_0x4c7c8f,_0x2f79d6,_0x301d29);}:function(_0x33b441,_0x4b3c33,_0x354475,_0x40d84b){if(_0x40d84b===undefined)_0x40d84b=_0x354475;_0x33b441[_0x40d84b]=_0x4b3c33[_0x354475];}),__setModuleDefault=this&&this[a478_0x2922a8(0x90)]||(Object['create']?function(_0x9b4c05,_0x32eec6){const _0x4f0ce9=a478_0x2922a8;Object[_0x4f0ce9(0x92)](_0x9b4c05,_0x4f0ce9(0x7d),{'enumerable':!![],'value':_0x32eec6});}:function(_0x34d777,_0x2b091f){const _0x3e6e12=a478_0x2922a8;_0x34d777[_0x3e6e12(0x7d)]=_0x2b091f;}),__importStar=this&&this[a478_0x2922a8(0x73)]||function(_0x34be9a){const _0x264407=a478_0x2922a8;if(_0x34be9a&&_0x34be9a['__esModule'])return _0x34be9a;var _0x5718f3={};if(_0x34be9a!=null){for(var _0x3cde2f in _0x34be9a)if(_0x3cde2f!==_0x264407(0x7d)&&Object[_0x264407(0x6a)]['hasOwnProperty'][_0x264407(0x70)](_0x34be9a,_0x3cde2f))__createBinding(_0x5718f3,_0x34be9a,_0x3cde2f);}return __setModuleDefault(_0x5718f3,_0x34be9a),_0x5718f3;},__importDefault=this&&this[a478_0x2922a8(0x7f)]||function(_0x8f9ce1){const _0x21a32b=a478_0x2922a8;return _0x8f9ce1&&_0x8f9ce1[_0x21a32b(0x80)]?_0x8f9ce1:{'default':_0x8f9ce1};};Object['defineProperty'](exports,a478_0x2922a8(0x80),{'value':!![]});function a478_0x314f(_0x2ecce5,_0x249293){const _0x29ad3c=a478_0x29ad();return a478_0x314f=function(_0x314fd4,_0xf36ebd){_0x314fd4=_0x314fd4-0x6a;let _0x836644=_0x29ad3c[_0x314fd4];return _0x836644;},a478_0x314f(_0x2ecce5,_0x249293);}const Yup=__importStar(require(a478_0x2922a8(0x6b))),AppError_1=__importDefault(require(a478_0x2922a8(0x94))),Queue_1=__importDefault(require('../../models/Queue')),Company_1=__importDefault(require(a478_0x2922a8(0x8c))),Plan_1=__importDefault(require(a478_0x2922a8(0x7e))),Chatbot_1=__importDefault(require('../../models/Chatbot')),CreateQueueService=async _0x30c31d=>{const _0x53c68e=a478_0x2922a8,{color:_0x2ad1b3,name:_0x3ba0a4,companyId:_0x34dc1e,ativarRoteador:_0x5f12ed,tempoRoteador:_0x4dbcee}=_0x30c31d,_0x5d0fb3=await Company_1['default'][_0x53c68e(0x83)]({'where':{'id':_0x34dc1e},'include':[{'model':Plan_1[_0x53c68e(0x7d)],'as':_0x53c68e(0x85)}]});if(_0x5d0fb3!==null){const _0x124129=await Queue_1[_0x53c68e(0x7d)][_0x53c68e(0x81)]({'where':{'companyId':_0x34dc1e}});if(_0x124129>=_0x5d0fb3['plan'][_0x53c68e(0x6d)])throw new AppError_1['default'](_0x53c68e(0x93)+_0x124129);}const _0x198f92=Yup[_0x53c68e(0x8a)]()['shape']({'name':Yup[_0x53c68e(0x89)]()[_0x53c68e(0x6c)](0x2,'ERR_QUEUE_INVALID_NAME')['required']('ERR_QUEUE_INVALID_NAME')[_0x53c68e(0x77)](_0x53c68e(0x8d),_0x53c68e(0x6f),async _0x97f5d=>{const _0x1085b5=_0x53c68e;if(_0x97f5d){const _0x1a85e7=await Queue_1[_0x1085b5(0x7d)][_0x1085b5(0x83)]({'where':{'name':_0x97f5d,'companyId':_0x34dc1e}});return!_0x1a85e7;}return![];}),'color':Yup[_0x53c68e(0x89)]()[_0x53c68e(0x87)](_0x53c68e(0x7c))[_0x53c68e(0x77)]('Check-color',_0x53c68e(0x7c),async _0x113e58=>{if(_0x113e58){const _0x1d86ab=/^#[0-9a-f]{3,6}$/i;return _0x1d86ab['test'](_0x113e58);}return![];})[_0x53c68e(0x77)](_0x53c68e(0x75),_0x53c68e(0x84),async _0x341d4a=>{const _0x1735bb=_0x53c68e;if(_0x341d4a){const _0x3eb1d1=await Queue_1[_0x1735bb(0x7d)][_0x1735bb(0x83)]({'where':{'color':_0x341d4a,'companyId':_0x34dc1e}});return!_0x3eb1d1;}return![];})});try{await _0x198f92['validate']({'color':_0x2ad1b3,'name':_0x3ba0a4});}catch(_0x4557fe){throw new AppError_1[(_0x53c68e(0x7d))](_0x4557fe[_0x53c68e(0x8b)]);}const _0xf5335d=await Queue_1[_0x53c68e(0x7d)]['create'](_0x30c31d,{'include':[{'model':Chatbot_1[_0x53c68e(0x7d)],'as':'chatbots','order':[[{'model':Chatbot_1[_0x53c68e(0x7d)],'as':'chatbots'},'id',_0x53c68e(0x71)]]}]});return _0xf5335d;};exports[a478_0x2922a8(0x7d)]=CreateQueueService;