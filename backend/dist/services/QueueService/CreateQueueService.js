'use strict';const a478_0x28e406=a478_0x2ecb;function a478_0x4dd3(){const _0x42761d=['__esModule','Check-unique-name','../../models/Chatbot','shape','2EPhEsD','defineProperty','1614915IhAqko','40143cnjxHB','788262oAFtqn','get','object','ERR_QUEUE_INVALID_COLOR','string','Número\x20máximo\x20de\x20filas\x20já\x20alcançado:\x20','test','28trYgjC','call','validate','__createBinding','chatbots','6705195BSpqyF','min','11461632bzYWJy','__importDefault','hasOwnProperty','writable','ERR_QUEUE_COLOR_ALREADY_EXISTS','../../models/Company','../../errors/AppError','count','ERR_QUEUE_INVALID_NAME','required','../../models/Plan','412375qOupUi','configurable','findOne','../../models/Queue','message','Check-color','plan','6167732WuLtTx','create','queues','ERR_QUEUE_NAME_ALREADY_EXISTS','default'];a478_0x4dd3=function(){return _0x42761d;};return a478_0x4dd3();}(function(_0x5dbf7d,_0x50e722){const _0x362e06=a478_0x2ecb,_0x6b2c23=_0x5dbf7d();while(!![]){try{const _0x333f77=-parseInt(_0x362e06(0x145))/0x1+parseInt(_0x362e06(0x128))/0x2*(-parseInt(_0x362e06(0x12b))/0x3)+parseInt(_0x362e06(0x11f))/0x4+-parseInt(_0x362e06(0x138))/0x5+-parseInt(_0x362e06(0x12c))/0x6*(parseInt(_0x362e06(0x133))/0x7)+parseInt(_0x362e06(0x13a))/0x8+parseInt(_0x362e06(0x12a))/0x9;if(_0x333f77===_0x50e722)break;else _0x6b2c23['push'](_0x6b2c23['shift']());}catch(_0xfd9a6f){_0x6b2c23['push'](_0x6b2c23['shift']());}}}(a478_0x4dd3,0xd2649));var __createBinding=this&&this[a478_0x28e406(0x136)]||(Object['create']?function(_0xb1b9b3,_0x478e91,_0x518c8f,_0x375091){const _0x40d9af=a478_0x28e406;if(_0x375091===undefined)_0x375091=_0x518c8f;var _0x5b819d=Object['getOwnPropertyDescriptor'](_0x478e91,_0x518c8f);(!_0x5b819d||(_0x40d9af(0x12d)in _0x5b819d?!_0x478e91[_0x40d9af(0x124)]:_0x5b819d[_0x40d9af(0x13d)]||_0x5b819d[_0x40d9af(0x146)]))&&(_0x5b819d={'enumerable':!![],'get':function(){return _0x478e91[_0x518c8f];}}),Object[_0x40d9af(0x129)](_0xb1b9b3,_0x375091,_0x5b819d);}:function(_0x41269c,_0x4940fd,_0xb827cb,_0x51ce5b){if(_0x51ce5b===undefined)_0x51ce5b=_0xb827cb;_0x41269c[_0x51ce5b]=_0x4940fd[_0xb827cb];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a478_0x28e406(0x120)]?function(_0x5667d1,_0x5df9ec){const _0x579ecf=a478_0x28e406;Object[_0x579ecf(0x129)](_0x5667d1,'default',{'enumerable':!![],'value':_0x5df9ec});}:function(_0x17b016,_0x3c715b){const _0x3d45ed=a478_0x28e406;_0x17b016[_0x3d45ed(0x123)]=_0x3c715b;}),__importStar=this&&this['__importStar']||function(_0x19d14a){const _0x2f8b1e=a478_0x28e406;if(_0x19d14a&&_0x19d14a['__esModule'])return _0x19d14a;var _0x55f8f2={};if(_0x19d14a!=null){for(var _0x456b89 in _0x19d14a)if(_0x456b89!==_0x2f8b1e(0x123)&&Object['prototype'][_0x2f8b1e(0x13c)][_0x2f8b1e(0x134)](_0x19d14a,_0x456b89))__createBinding(_0x55f8f2,_0x19d14a,_0x456b89);}return __setModuleDefault(_0x55f8f2,_0x19d14a),_0x55f8f2;},__importDefault=this&&this[a478_0x28e406(0x13b)]||function(_0x168a76){return _0x168a76&&_0x168a76['__esModule']?_0x168a76:{'default':_0x168a76};};Object[a478_0x28e406(0x129)](exports,'__esModule',{'value':!![]});const Yup=__importStar(require('yup')),AppError_1=__importDefault(require(a478_0x28e406(0x140))),Queue_1=__importDefault(require(a478_0x28e406(0x148))),Company_1=__importDefault(require(a478_0x28e406(0x13f))),Plan_1=__importDefault(require(a478_0x28e406(0x144))),Chatbot_1=__importDefault(require(a478_0x28e406(0x126))),CreateQueueService=async _0x59d15b=>{const _0x2fc408=a478_0x28e406,{color:_0x5d70be,name:_0xb0c870,companyId:_0x5a97eb,ativarRoteador:_0x1d68e5,tempoRoteador:_0x53987e}=_0x59d15b,_0x13b9e6=await Company_1[_0x2fc408(0x123)][_0x2fc408(0x147)]({'where':{'id':_0x5a97eb},'include':[{'model':Plan_1[_0x2fc408(0x123)],'as':_0x2fc408(0x11e)}]});if(_0x13b9e6!==null){const _0x530cf=await Queue_1[_0x2fc408(0x123)][_0x2fc408(0x141)]({'where':{'companyId':_0x5a97eb}});if(_0x530cf>=_0x13b9e6[_0x2fc408(0x11e)][_0x2fc408(0x121)])throw new AppError_1[(_0x2fc408(0x123))](_0x2fc408(0x131)+_0x530cf);}const _0x58219b=Yup[_0x2fc408(0x12e)]()[_0x2fc408(0x127)]({'name':Yup['string']()[_0x2fc408(0x139)](0x2,_0x2fc408(0x142))[_0x2fc408(0x143)]('ERR_QUEUE_INVALID_NAME')[_0x2fc408(0x132)](_0x2fc408(0x125),_0x2fc408(0x122),async _0x49ad44=>{const _0x41adbe=_0x2fc408;if(_0x49ad44){const _0x31fc7f=await Queue_1['default'][_0x41adbe(0x147)]({'where':{'name':_0x49ad44,'companyId':_0x5a97eb}});return!_0x31fc7f;}return![];}),'color':Yup[_0x2fc408(0x130)]()[_0x2fc408(0x143)](_0x2fc408(0x12f))['test'](_0x2fc408(0x14a),_0x2fc408(0x12f),async _0x2f572a=>{if(_0x2f572a){const _0x16198e=/^#[0-9a-f]{3,6}$/i;return _0x16198e['test'](_0x2f572a);}return![];})[_0x2fc408(0x132)]('Check-color-exists',_0x2fc408(0x13e),async _0x3059f4=>{const _0xe52a33=_0x2fc408;if(_0x3059f4){const _0x6f4f8d=await Queue_1['default'][_0xe52a33(0x147)]({'where':{'color':_0x3059f4,'companyId':_0x5a97eb}});return!_0x6f4f8d;}return![];})});try{await _0x58219b[_0x2fc408(0x135)]({'color':_0x5d70be,'name':_0xb0c870});}catch(_0x1e3a5c){throw new AppError_1[(_0x2fc408(0x123))](_0x1e3a5c[_0x2fc408(0x149)]);}const _0x2c8d77=await Queue_1[_0x2fc408(0x123)][_0x2fc408(0x120)](_0x59d15b,{'include':[{'model':Chatbot_1[_0x2fc408(0x123)],'as':_0x2fc408(0x137),'order':[[{'model':Chatbot_1[_0x2fc408(0x123)],'as':_0x2fc408(0x137)},'id','asc']]}]});return _0x2c8d77;};function a478_0x2ecb(_0xb47a51,_0x2d8802){const _0x4dd391=a478_0x4dd3();return a478_0x2ecb=function(_0x2ecb5e,_0x5265ed){_0x2ecb5e=_0x2ecb5e-0x11e;let _0x290b02=_0x4dd391[_0x2ecb5e];return _0x290b02;},a478_0x2ecb(_0xb47a51,_0x2d8802);}exports[a478_0x28e406(0x123)]=CreateQueueService;