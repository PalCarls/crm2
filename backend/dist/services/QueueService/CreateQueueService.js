'use strict';const a493_0x2570d7=a493_0x4301;(function(_0x1310a4,_0x44b5f2){const _0x1c2595=a493_0x4301,_0x1811f1=_0x1310a4();while(!![]){try{const _0x2837d3=parseInt(_0x1c2595(0x19e))/0x1*(-parseInt(_0x1c2595(0x191))/0x2)+-parseInt(_0x1c2595(0x189))/0x3+-parseInt(_0x1c2595(0x1a1))/0x4*(-parseInt(_0x1c2595(0x196))/0x5)+parseInt(_0x1c2595(0x192))/0x6*(-parseInt(_0x1c2595(0x19f))/0x7)+-parseInt(_0x1c2595(0x18c))/0x8*(parseInt(_0x1c2595(0x18b))/0x9)+-parseInt(_0x1c2595(0x19a))/0xa+parseInt(_0x1c2595(0x195))/0xb*(parseInt(_0x1c2595(0x1a3))/0xc);if(_0x2837d3===_0x44b5f2)break;else _0x1811f1['push'](_0x1811f1['shift']());}catch(_0x5dcbfb){_0x1811f1['push'](_0x1811f1['shift']());}}}(a493_0x3a91,0x4dde1));var __createBinding=this&&this[a493_0x2570d7(0x18d)]||(Object[a493_0x2570d7(0x181)]?function(_0x45e60b,_0x43bbfe,_0x4998ea,_0x37fd1e){const _0x1f6e3b=a493_0x2570d7;if(_0x37fd1e===undefined)_0x37fd1e=_0x4998ea;var _0xedd681=Object['getOwnPropertyDescriptor'](_0x43bbfe,_0x4998ea);(!_0xedd681||(_0x1f6e3b(0x1ad)in _0xedd681?!_0x43bbfe[_0x1f6e3b(0x18a)]:_0xedd681[_0x1f6e3b(0x1a4)]||_0xedd681[_0x1f6e3b(0x1a7)]))&&(_0xedd681={'enumerable':!![],'get':function(){return _0x43bbfe[_0x4998ea];}}),Object[_0x1f6e3b(0x190)](_0x45e60b,_0x37fd1e,_0xedd681);}:function(_0x36e386,_0x2a3eeb,_0xb2a202,_0x17d0f6){if(_0x17d0f6===undefined)_0x17d0f6=_0xb2a202;_0x36e386[_0x17d0f6]=_0x2a3eeb[_0xb2a202];}),__setModuleDefault=this&&this[a493_0x2570d7(0x184)]||(Object[a493_0x2570d7(0x181)]?function(_0x352c9e,_0x29c78a){const _0xc5c355=a493_0x2570d7;Object[_0xc5c355(0x190)](_0x352c9e,_0xc5c355(0x1ac),{'enumerable':!![],'value':_0x29c78a});}:function(_0x141c82,_0x407af5){_0x141c82['default']=_0x407af5;}),__importStar=this&&this[a493_0x2570d7(0x193)]||function(_0x1ee78b){const _0x1c4338=a493_0x2570d7;if(_0x1ee78b&&_0x1ee78b[_0x1c4338(0x18a)])return _0x1ee78b;var _0x537f63={};if(_0x1ee78b!=null){for(var _0x349420 in _0x1ee78b)if(_0x349420!==_0x1c4338(0x1ac)&&Object[_0x1c4338(0x1a2)][_0x1c4338(0x1a6)][_0x1c4338(0x183)](_0x1ee78b,_0x349420))__createBinding(_0x537f63,_0x1ee78b,_0x349420);}return __setModuleDefault(_0x537f63,_0x1ee78b),_0x537f63;},__importDefault=this&&this['__importDefault']||function(_0x192239){const _0x575712=a493_0x2570d7;return _0x192239&&_0x192239[_0x575712(0x18a)]?_0x192239:{'default':_0x192239};};Object['defineProperty'](exports,a493_0x2570d7(0x18a),{'value':!![]});function a493_0x4301(_0xdc2f5d,_0x3a8d4f){const _0x3a911b=a493_0x3a91();return a493_0x4301=function(_0x4301b8,_0x11abd2){_0x4301b8=_0x4301b8-0x181;let _0xb57594=_0x3a911b[_0x4301b8];return _0xb57594;},a493_0x4301(_0xdc2f5d,_0x3a8d4f);}function a493_0x3a91(){const _0x38603c=['3643044dNNHuz','writable','message','hasOwnProperty','configurable','object','required','count','Número\x20máximo\x20de\x20filas\x20já\x20alcançado:\x20','default','get','plan','../../models/Company','create','chatbots','call','__setModuleDefault','yup','Check-color-exists','Check-color','ERR_QUEUE_COLOR_ALREADY_EXISTS','1085880TtqLUh','__esModule','2577213slcFpD','16xIifrF','__createBinding','shape','ERR_QUEUE_INVALID_COLOR','defineProperty','651074CRKtHp','747438KYovhn','__importStar','test','66PjkkjR','10635nVsTmT','ERR_QUEUE_INVALID_NAME','string','../../errors/AppError','4016040Lehwbk','validate','findOne','Check-unique-name','1oLPJLO','14QYAXJk','../../models/Queue','768UYXfmG','prototype'];a493_0x3a91=function(){return _0x38603c;};return a493_0x3a91();}const Yup=__importStar(require(a493_0x2570d7(0x185))),AppError_1=__importDefault(require(a493_0x2570d7(0x199))),Queue_1=__importDefault(require(a493_0x2570d7(0x1a0))),Company_1=__importDefault(require(a493_0x2570d7(0x1af))),Plan_1=__importDefault(require('../../models/Plan')),Chatbot_1=__importDefault(require('../../models/Chatbot')),CreateQueueService=async _0x3b1b98=>{const _0x34fb0d=a493_0x2570d7,{color:_0x1532dc,name:_0x5b4554,companyId:_0x4c83c2,ativarRoteador:_0x3d8587,tempoRoteador:_0x1595f9}=_0x3b1b98,_0x29526e=await Company_1['default'][_0x34fb0d(0x19c)]({'where':{'id':_0x4c83c2},'include':[{'model':Plan_1[_0x34fb0d(0x1ac)],'as':_0x34fb0d(0x1ae)}]});if(_0x29526e!==null){const _0x5ed184=await Queue_1['default'][_0x34fb0d(0x1aa)]({'where':{'companyId':_0x4c83c2}});if(_0x5ed184>=_0x29526e[_0x34fb0d(0x1ae)]['queues'])throw new AppError_1[(_0x34fb0d(0x1ac))](_0x34fb0d(0x1ab)+_0x5ed184);}const _0x16e534=Yup[_0x34fb0d(0x1a8)]()[_0x34fb0d(0x18e)]({'name':Yup[_0x34fb0d(0x198)]()['min'](0x2,'ERR_QUEUE_INVALID_NAME')[_0x34fb0d(0x1a9)](_0x34fb0d(0x197))[_0x34fb0d(0x194)](_0x34fb0d(0x19d),'ERR_QUEUE_NAME_ALREADY_EXISTS',async _0x1bfe24=>{const _0x4e2ce5=_0x34fb0d;if(_0x1bfe24){const _0x366646=await Queue_1[_0x4e2ce5(0x1ac)][_0x4e2ce5(0x19c)]({'where':{'name':_0x1bfe24,'companyId':_0x4c83c2}});return!_0x366646;}return![];}),'color':Yup[_0x34fb0d(0x198)]()[_0x34fb0d(0x1a9)](_0x34fb0d(0x18f))['test'](_0x34fb0d(0x187),_0x34fb0d(0x18f),async _0x3664ea=>{const _0x1ae19c=_0x34fb0d;if(_0x3664ea){const _0x8ed108=/^#[0-9a-f]{3,6}$/i;return _0x8ed108[_0x1ae19c(0x194)](_0x3664ea);}return![];})['test'](_0x34fb0d(0x186),_0x34fb0d(0x188),async _0x3d0220=>{const _0x602456=_0x34fb0d;if(_0x3d0220){const _0x2814c2=await Queue_1[_0x602456(0x1ac)]['findOne']({'where':{'color':_0x3d0220,'companyId':_0x4c83c2}});return!_0x2814c2;}return![];})});try{await _0x16e534[_0x34fb0d(0x19b)]({'color':_0x1532dc,'name':_0x5b4554});}catch(_0xf1bd3c){throw new AppError_1[(_0x34fb0d(0x1ac))](_0xf1bd3c[_0x34fb0d(0x1a5)]);}const _0x54aa90=await Queue_1[_0x34fb0d(0x1ac)][_0x34fb0d(0x181)](_0x3b1b98,{'include':[{'model':Chatbot_1['default'],'as':_0x34fb0d(0x182),'order':[[{'model':Chatbot_1[_0x34fb0d(0x1ac)],'as':_0x34fb0d(0x182)},'id','asc']]}]});return _0x54aa90;};exports['default']=CreateQueueService;