'use strict';function a538_0x9d30(){const _0x44e613=['__setModuleDefault','queues','test','698016aAMIMZ','defineProperty','message','plan','126582lGwvlJ','chatbots','../../models/Chatbot','__createBinding','__importStar','user','string','ERR_QUEUE_NAME_ALREADY_EXISTS','Check-unique-name','../../models/Plan','30fgnozi','12dJPwde','ERR_QUEUE_INVALID_NAME','53415risSli','prototype','16641oRFvgK','../../models/User','default','configurable','required','shape','validate','get','8gCCwTp','2468411jvPGUx','../../models/Company','ERR_QUEUE_COLOR_ALREADY_EXISTS','830CPggZX','ERR_QUEUE_INVALID_COLOR','writable','152747mHWwyW','count','Número\x20máximo\x20de\x20filas\x20já\x20alcançado:\x20','hasOwnProperty','create','../../models/Queue','../../errors/AppError','findOne','Check-color-exists','102ZHXxVe','470880tLiBXC','__esModule'];a538_0x9d30=function(){return _0x44e613;};return a538_0x9d30();}function a538_0x46aa(_0x20c64e,_0x5305cf){const _0x9d30c9=a538_0x9d30();return a538_0x46aa=function(_0x46aa89,_0x10ee07){_0x46aa89=_0x46aa89-0x96;let _0x6886a7=_0x9d30c9[_0x46aa89];return _0x6886a7;},a538_0x46aa(_0x20c64e,_0x5305cf);}const a538_0x339a17=a538_0x46aa;(function(_0x3b4884,_0x2ca305){const _0x4bb2ef=a538_0x46aa,_0x12e13f=_0x3b4884();while(!![]){try{const _0xcc41df=-parseInt(_0x4bb2ef(0xa2))/0x1*(parseInt(_0x4bb2ef(0xb9))/0x2)+-parseInt(_0x4bb2ef(0xb1))/0x3+parseInt(_0x4bb2ef(0x99))/0x4*(parseInt(_0x4bb2ef(0xac))/0x5)+-parseInt(_0x4bb2ef(0x98))/0x6*(-parseInt(_0x4bb2ef(0xc0))/0x7)+parseInt(_0x4bb2ef(0x9e))/0x8+parseInt(_0x4bb2ef(0xaf))/0x9*(-parseInt(_0x4bb2ef(0xbd))/0xa)+parseInt(_0x4bb2ef(0xba))/0xb*(parseInt(_0x4bb2ef(0xad))/0xc);if(_0xcc41df===_0x2ca305)break;else _0x12e13f['push'](_0x12e13f['shift']());}catch(_0x5badd2){_0x12e13f['push'](_0x12e13f['shift']());}}}(a538_0x9d30,0x5ddc2));var __createBinding=this&&this[a538_0x339a17(0xa5)]||(Object[a538_0x339a17(0xc4)]?function(_0x552a4b,_0x3ca76e,_0x31deaa,_0x1828cd){const _0x50360f=a538_0x339a17;if(_0x1828cd===undefined)_0x1828cd=_0x31deaa;var _0x4211f7=Object['getOwnPropertyDescriptor'](_0x3ca76e,_0x31deaa);(!_0x4211f7||(_0x50360f(0xb8)in _0x4211f7?!_0x3ca76e[_0x50360f(0x9a)]:_0x4211f7[_0x50360f(0xbf)]||_0x4211f7[_0x50360f(0xb4)]))&&(_0x4211f7={'enumerable':!![],'get':function(){return _0x3ca76e[_0x31deaa];}}),Object[_0x50360f(0x9f)](_0x552a4b,_0x1828cd,_0x4211f7);}:function(_0x351741,_0xdcce45,_0x36e50d,_0x38bad9){if(_0x38bad9===undefined)_0x38bad9=_0x36e50d;_0x351741[_0x38bad9]=_0xdcce45[_0x36e50d];}),__setModuleDefault=this&&this[a538_0x339a17(0x9b)]||(Object[a538_0x339a17(0xc4)]?function(_0x5753f5,_0x7ffdb9){const _0x250ca2=a538_0x339a17;Object[_0x250ca2(0x9f)](_0x5753f5,_0x250ca2(0xb3),{'enumerable':!![],'value':_0x7ffdb9});}:function(_0x58de44,_0x895651){const _0x15519a=a538_0x339a17;_0x58de44[_0x15519a(0xb3)]=_0x895651;}),__importStar=this&&this[a538_0x339a17(0xa6)]||function(_0x245d5b){const _0x1d9ae5=a538_0x339a17;if(_0x245d5b&&_0x245d5b['__esModule'])return _0x245d5b;var _0x58a8ce={};if(_0x245d5b!=null){for(var _0x14c433 in _0x245d5b)if(_0x14c433!=='default'&&Object[_0x1d9ae5(0xb0)][_0x1d9ae5(0xc3)]['call'](_0x245d5b,_0x14c433))__createBinding(_0x58a8ce,_0x245d5b,_0x14c433);}return __setModuleDefault(_0x58a8ce,_0x245d5b),_0x58a8ce;},__importDefault=this&&this['__importDefault']||function(_0x4f0595){const _0x1527d1=a538_0x339a17;return _0x4f0595&&_0x4f0595[_0x1527d1(0x9a)]?_0x4f0595:{'default':_0x4f0595};};Object['defineProperty'](exports,a538_0x339a17(0x9a),{'value':!![]});const Yup=__importStar(require('yup')),AppError_1=__importDefault(require(a538_0x339a17(0xc6))),Queue_1=__importDefault(require(a538_0x339a17(0xc5))),Company_1=__importDefault(require(a538_0x339a17(0xbb))),Plan_1=__importDefault(require(a538_0x339a17(0xab))),Chatbot_1=__importDefault(require(a538_0x339a17(0xa4))),User_1=__importDefault(require(a538_0x339a17(0xb2))),CreateQueueService=async _0x187d35=>{const _0x2aaabc=a538_0x339a17,{color:_0x4d76b7,name:_0x1e2f16,companyId:_0x266d4c}=_0x187d35,_0x2fadd7=await Company_1[_0x2aaabc(0xb3)][_0x2aaabc(0x96)]({'where':{'id':_0x266d4c},'include':[{'model':Plan_1[_0x2aaabc(0xb3)],'as':_0x2aaabc(0xa1)}]});if(_0x2fadd7!==null){const _0x68d6e9=await Queue_1[_0x2aaabc(0xb3)][_0x2aaabc(0xc1)]({'where':{'companyId':_0x266d4c}});if(_0x68d6e9>=_0x2fadd7[_0x2aaabc(0xa1)][_0x2aaabc(0x9c)])throw new AppError_1[(_0x2aaabc(0xb3))](_0x2aaabc(0xc2)+_0x68d6e9);}const _0x13ef2f=Yup['object']()[_0x2aaabc(0xb6)]({'name':Yup[_0x2aaabc(0xa8)]()['min'](0x2,_0x2aaabc(0xae))[_0x2aaabc(0xb5)]('ERR_QUEUE_INVALID_NAME')[_0x2aaabc(0x9d)](_0x2aaabc(0xaa),_0x2aaabc(0xa9),async _0x546f56=>{const _0x3bd027=_0x2aaabc;if(_0x546f56){const _0x54845d=await Queue_1['default'][_0x3bd027(0x96)]({'where':{'name':_0x546f56,'companyId':_0x266d4c}});return!_0x54845d;}return![];}),'color':Yup[_0x2aaabc(0xa8)]()[_0x2aaabc(0xb5)](_0x2aaabc(0xbe))[_0x2aaabc(0x9d)]('Check-color',_0x2aaabc(0xbe),async _0x36fc72=>{if(_0x36fc72){const _0x18bbe6=/^#[0-9a-f]{3,6}$/i;return _0x18bbe6['test'](_0x36fc72);}return![];})[_0x2aaabc(0x9d)](_0x2aaabc(0x97),_0x2aaabc(0xbc),async _0x3ded64=>{const _0x2ee349=_0x2aaabc;if(_0x3ded64){const _0x2c2d1=await Queue_1[_0x2ee349(0xb3)][_0x2ee349(0x96)]({'where':{'color':_0x3ded64,'companyId':_0x266d4c}});return!_0x2c2d1;}return![];})});try{await _0x13ef2f[_0x2aaabc(0xb7)]({'color':_0x4d76b7,'name':_0x1e2f16});}catch(_0x222fb8){throw new AppError_1['default'](_0x222fb8[_0x2aaabc(0xa0)]);}const _0x2c3a4c=await Queue_1['default'][_0x2aaabc(0xc4)](_0x187d35,{'include':[{'model':Chatbot_1[_0x2aaabc(0xb3)],'as':_0x2aaabc(0xa3),'include':[{'model':User_1[_0x2aaabc(0xb3)],'as':_0x2aaabc(0xa7)}],'order':[[{'model':Chatbot_1[_0x2aaabc(0xb3)],'as':_0x2aaabc(0xa3)},'id','asc']]}]});return _0x2c3a4c;};exports[a538_0x339a17(0xb3)]=CreateQueueService;