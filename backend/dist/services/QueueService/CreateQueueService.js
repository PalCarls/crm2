'use strict';const a528_0x586464=a528_0x26ad;function a528_0x26ad(_0x14d555,_0x1253a6){const _0x49f091=a528_0x49f0();return a528_0x26ad=function(_0x26ada9,_0x54eefb){_0x26ada9=_0x26ada9-0xd7;let _0x5e1e14=_0x49f091[_0x26ada9];return _0x5e1e14;},a528_0x26ad(_0x14d555,_0x1253a6);}function a528_0x49f0(){const _0x550c29=['ERR_QUEUE_COLOR_ALREADY_EXISTS','3100881VXRnBm','asc','yup','chatbots','test','user','getOwnPropertyDescriptor','get','min','31970710fpuUie','object','validate','ERR_QUEUE_INVALID_COLOR','message','__createBinding','ERR_QUEUE_INVALID_NAME','../../models/Queue','Check-unique-name','__esModule','../../models/Company','../../models/User','../../models/Plan','197336NylhxT','../../models/Chatbot','prototype','__setModuleDefault','defineProperty','60xeQrDI','2145wiBBys','create','1524798XztLRw','__importDefault','default','configurable','writable','356436sQDzhd','45Urfxwv','2732iqhzau','__importStar','findOne','443090WbBZmh','../../errors/AppError','Número\x20máximo\x20de\x20filas\x20já\x20alcançado:\x20'];a528_0x49f0=function(){return _0x550c29;};return a528_0x49f0();}(function(_0x4ffa99,_0x367d61){const _0x804e30=a528_0x26ad,_0xda92ff=_0x4ffa99();while(!![]){try{const _0x3cb622=-parseInt(_0x804e30(0xf4))/0x1+-parseInt(_0x804e30(0xea))/0x2+-parseInt(_0x804e30(0xe8))/0x3*(parseInt(_0x804e30(0xf1))/0x4)+-parseInt(_0x804e30(0xe7))/0x5*(parseInt(_0x804e30(0xef))/0x6)+-parseInt(_0x804e30(0xf8))/0x7+parseInt(_0x804e30(0xe2))/0x8*(parseInt(_0x804e30(0xf0))/0x9)+parseInt(_0x804e30(0x101))/0xa;if(_0x3cb622===_0x367d61)break;else _0xda92ff['push'](_0xda92ff['shift']());}catch(_0x555638){_0xda92ff['push'](_0xda92ff['shift']());}}}(a528_0x49f0,0x72ebd));var __createBinding=this&&this[a528_0x586464(0xda)]||(Object[a528_0x586464(0xe9)]?function(_0x3eb2e7,_0x1ac95a,_0x3d33b2,_0x274e35){const _0x3a9649=a528_0x586464;if(_0x274e35===undefined)_0x274e35=_0x3d33b2;var _0x4d7f37=Object[_0x3a9649(0xfe)](_0x1ac95a,_0x3d33b2);(!_0x4d7f37||(_0x3a9649(0xff)in _0x4d7f37?!_0x1ac95a['__esModule']:_0x4d7f37[_0x3a9649(0xee)]||_0x4d7f37[_0x3a9649(0xed)]))&&(_0x4d7f37={'enumerable':!![],'get':function(){return _0x1ac95a[_0x3d33b2];}}),Object[_0x3a9649(0xe6)](_0x3eb2e7,_0x274e35,_0x4d7f37);}:function(_0x3541e4,_0x1128a6,_0x98b565,_0x4795bd){if(_0x4795bd===undefined)_0x4795bd=_0x98b565;_0x3541e4[_0x4795bd]=_0x1128a6[_0x98b565];}),__setModuleDefault=this&&this[a528_0x586464(0xe5)]||(Object[a528_0x586464(0xe9)]?function(_0x5cbab9,_0x3a8fb8){const _0x115295=a528_0x586464;Object[_0x115295(0xe6)](_0x5cbab9,_0x115295(0xec),{'enumerable':!![],'value':_0x3a8fb8});}:function(_0x54b20b,_0x42870c){const _0x94616=a528_0x586464;_0x54b20b[_0x94616(0xec)]=_0x42870c;}),__importStar=this&&this[a528_0x586464(0xf2)]||function(_0x467b92){const _0x118a3c=a528_0x586464;if(_0x467b92&&_0x467b92[_0x118a3c(0xde)])return _0x467b92;var _0x273fcf={};if(_0x467b92!=null){for(var _0x1fea45 in _0x467b92)if(_0x1fea45!==_0x118a3c(0xec)&&Object[_0x118a3c(0xe4)]['hasOwnProperty']['call'](_0x467b92,_0x1fea45))__createBinding(_0x273fcf,_0x467b92,_0x1fea45);}return __setModuleDefault(_0x273fcf,_0x467b92),_0x273fcf;},__importDefault=this&&this[a528_0x586464(0xeb)]||function(_0x4e0941){const _0x4bceaf=a528_0x586464;return _0x4e0941&&_0x4e0941[_0x4bceaf(0xde)]?_0x4e0941:{'default':_0x4e0941};};Object[a528_0x586464(0xe6)](exports,a528_0x586464(0xde),{'value':!![]});const Yup=__importStar(require(a528_0x586464(0xfa))),AppError_1=__importDefault(require(a528_0x586464(0xf5))),Queue_1=__importDefault(require(a528_0x586464(0xdc))),Company_1=__importDefault(require(a528_0x586464(0xdf))),Plan_1=__importDefault(require(a528_0x586464(0xe1))),Chatbot_1=__importDefault(require(a528_0x586464(0xe3))),User_1=__importDefault(require(a528_0x586464(0xe0))),CreateQueueService=async _0xb22d4e=>{const _0x223440=a528_0x586464,{color:_0x4dffa0,name:_0x56b010,companyId:_0x5e62ec}=_0xb22d4e,_0x2ddc2c=await Company_1[_0x223440(0xec)][_0x223440(0xf3)]({'where':{'id':_0x5e62ec},'include':[{'model':Plan_1[_0x223440(0xec)],'as':'plan'}]});if(_0x2ddc2c!==null){const _0x5440e7=await Queue_1['default']['count']({'where':{'companyId':_0x5e62ec}});if(_0x5440e7>=_0x2ddc2c['plan']['queues'])throw new AppError_1['default'](_0x223440(0xf6)+_0x5440e7);}const _0x418334=Yup[_0x223440(0x102)]()['shape']({'name':Yup['string']()[_0x223440(0x100)](0x2,_0x223440(0xdb))['required']('ERR_QUEUE_INVALID_NAME')['test'](_0x223440(0xdd),'ERR_QUEUE_NAME_ALREADY_EXISTS',async _0x527b3a=>{const _0x5c4992=_0x223440;if(_0x527b3a){const _0x43096c=await Queue_1[_0x5c4992(0xec)][_0x5c4992(0xf3)]({'where':{'name':_0x527b3a,'companyId':_0x5e62ec}});return!_0x43096c;}return![];}),'color':Yup['string']()['required'](_0x223440(0xd8))[_0x223440(0xfc)]('Check-color','ERR_QUEUE_INVALID_COLOR',async _0x56a70f=>{const _0x17ad6c=_0x223440;if(_0x56a70f){const _0xf3a0ba=/^#[0-9a-f]{3,6}$/i;return _0xf3a0ba[_0x17ad6c(0xfc)](_0x56a70f);}return![];})[_0x223440(0xfc)]('Check-color-exists',_0x223440(0xf7),async _0x424ef5=>{const _0x135474=_0x223440;if(_0x424ef5){const _0xcbe17d=await Queue_1[_0x135474(0xec)][_0x135474(0xf3)]({'where':{'color':_0x424ef5,'companyId':_0x5e62ec}});return!_0xcbe17d;}return![];})});try{await _0x418334[_0x223440(0xd7)]({'color':_0x4dffa0,'name':_0x56b010});}catch(_0xca9028){throw new AppError_1[(_0x223440(0xec))](_0xca9028[_0x223440(0xd9)]);}const _0x507b65=await Queue_1['default'][_0x223440(0xe9)](_0xb22d4e,{'include':[{'model':Chatbot_1[_0x223440(0xec)],'as':_0x223440(0xfb),'include':[{'model':User_1[_0x223440(0xec)],'as':_0x223440(0xfd)}],'order':[[{'model':Chatbot_1['default'],'as':_0x223440(0xfb)},'id',_0x223440(0xf9)]]}]});return _0x507b65;};exports[a528_0x586464(0xec)]=CreateQueueService;