'use strict';const a545_0x227bca=a545_0x7bb3;(function(_0x5aabb1,_0x46d9e7){const _0x4783a2=a545_0x7bb3,_0x4afbff=_0x5aabb1();while(!![]){try{const _0xd6636=-parseInt(_0x4783a2(0xf1))/0x1*(parseInt(_0x4783a2(0x108))/0x2)+-parseInt(_0x4783a2(0xed))/0x3+-parseInt(_0x4783a2(0x10b))/0x4+parseInt(_0x4783a2(0x101))/0x5+parseInt(_0x4783a2(0x10a))/0x6+parseInt(_0x4783a2(0xf2))/0x7+parseInt(_0x4783a2(0x10e))/0x8;if(_0xd6636===_0x46d9e7)break;else _0x4afbff['push'](_0x4afbff['shift']());}catch(_0x427d48){_0x4afbff['push'](_0x4afbff['shift']());}}}(a545_0x21da,0x54b84));function a545_0x7bb3(_0x4b8af0,_0x1f0831){const _0x21daf4=a545_0x21da();return a545_0x7bb3=function(_0x7bb306,_0x4fc165){_0x7bb306=_0x7bb306-0xe3;let _0x165d2f=_0x21daf4[_0x7bb306];return _0x165d2f;},a545_0x7bb3(_0x4b8af0,_0x1f0831);}var __createBinding=this&&this['__createBinding']||(Object[a545_0x227bca(0xe8)]?function(_0x3a2488,_0xa1cbba,_0xb97d80,_0x573a39){const _0x5cce74=a545_0x227bca;if(_0x573a39===undefined)_0x573a39=_0xb97d80;var _0xdc1e6a=Object[_0x5cce74(0xfc)](_0xa1cbba,_0xb97d80);(!_0xdc1e6a||(_0x5cce74(0xe6)in _0xdc1e6a?!_0xa1cbba[_0x5cce74(0x103)]:_0xdc1e6a[_0x5cce74(0xe4)]||_0xdc1e6a[_0x5cce74(0xf7)]))&&(_0xdc1e6a={'enumerable':!![],'get':function(){return _0xa1cbba[_0xb97d80];}}),Object[_0x5cce74(0x104)](_0x3a2488,_0x573a39,_0xdc1e6a);}:function(_0x1c729b,_0x33dcf9,_0x4e6299,_0x4e221e){if(_0x4e221e===undefined)_0x4e221e=_0x4e6299;_0x1c729b[_0x4e221e]=_0x33dcf9[_0x4e6299];}),__setModuleDefault=this&&this[a545_0x227bca(0x10d)]||(Object[a545_0x227bca(0xe8)]?function(_0x3fb065,_0x23e21c){const _0x78bb44=a545_0x227bca;Object['defineProperty'](_0x3fb065,_0x78bb44(0xf3),{'enumerable':!![],'value':_0x23e21c});}:function(_0x3c6439,_0x4d2994){const _0x3b3d91=a545_0x227bca;_0x3c6439[_0x3b3d91(0xf3)]=_0x4d2994;}),__importStar=this&&this['__importStar']||function(_0x5e897c){const _0x3e5aa5=a545_0x227bca;if(_0x5e897c&&_0x5e897c[_0x3e5aa5(0x103)])return _0x5e897c;var _0x5c095e={};if(_0x5e897c!=null){for(var _0x348c05 in _0x5e897c)if(_0x348c05!==_0x3e5aa5(0xf3)&&Object['prototype'][_0x3e5aa5(0x10c)][_0x3e5aa5(0xf9)](_0x5e897c,_0x348c05))__createBinding(_0x5c095e,_0x5e897c,_0x348c05);}return __setModuleDefault(_0x5c095e,_0x5e897c),_0x5c095e;},__importDefault=this&&this[a545_0x227bca(0xf4)]||function(_0x47f99d){const _0x38a008=a545_0x227bca;return _0x47f99d&&_0x47f99d[_0x38a008(0x103)]?_0x47f99d:{'default':_0x47f99d};};Object[a545_0x227bca(0x104)](exports,a545_0x227bca(0x103),{'value':!![]});function a545_0x21da(){const _0x251823=['plan','configurable','validate','call','../../models/Company','test','getOwnPropertyDescriptor','string','Número\x20máximo\x20de\x20filas\x20já\x20alcançado:\x20','user','ERR_QUEUE_NAME_ALREADY_EXISTS','2768560kPaXhB','Check-unique-name','__esModule','defineProperty','required','Check-color-exists','ERR_QUEUE_COLOR_ALREADY_EXISTS','13894vtfAwn','yup','3198450OtVpJj','918188sQUlnI','hasOwnProperty','__setModuleDefault','1272808LBaxPL','ERR_QUEUE_INVALID_NAME','writable','chatbots','get','findOne','create','../../models/Queue','count','min','ERR_QUEUE_INVALID_COLOR','946053vqhRHM','message','../../models/Chatbot','shape','70VqNzjq','926184WMWESR','default','__importDefault','../../models/User'];a545_0x21da=function(){return _0x251823;};return a545_0x21da();}const Yup=__importStar(require(a545_0x227bca(0x109))),AppError_1=__importDefault(require('../../errors/AppError')),Queue_1=__importDefault(require(a545_0x227bca(0xe9))),Company_1=__importDefault(require(a545_0x227bca(0xfa))),Plan_1=__importDefault(require('../../models/Plan')),Chatbot_1=__importDefault(require(a545_0x227bca(0xef))),User_1=__importDefault(require(a545_0x227bca(0xf5))),CreateQueueService=async _0x403b7e=>{const _0x45c844=a545_0x227bca,{color:_0x37a1e7,name:_0x1ac382,companyId:_0x5d1d71}=_0x403b7e,_0x3e746a=await Company_1[_0x45c844(0xf3)][_0x45c844(0xe7)]({'where':{'id':_0x5d1d71},'include':[{'model':Plan_1[_0x45c844(0xf3)],'as':_0x45c844(0xf6)}]});if(_0x3e746a!==null){const _0x38d64b=await Queue_1[_0x45c844(0xf3)][_0x45c844(0xea)]({'where':{'companyId':_0x5d1d71}});if(_0x38d64b>=_0x3e746a[_0x45c844(0xf6)]['queues'])throw new AppError_1['default'](_0x45c844(0xfe)+_0x38d64b);}const _0x2dd7fe=Yup['object']()[_0x45c844(0xf0)]({'name':Yup[_0x45c844(0xfd)]()[_0x45c844(0xeb)](0x2,_0x45c844(0xe3))[_0x45c844(0x105)](_0x45c844(0xe3))[_0x45c844(0xfb)](_0x45c844(0x102),_0x45c844(0x100),async _0x7f90e4=>{const _0x250626=_0x45c844;if(_0x7f90e4){const _0x4e5802=await Queue_1['default'][_0x250626(0xe7)]({'where':{'name':_0x7f90e4,'companyId':_0x5d1d71}});return!_0x4e5802;}return![];}),'color':Yup[_0x45c844(0xfd)]()[_0x45c844(0x105)](_0x45c844(0xec))[_0x45c844(0xfb)]('Check-color','ERR_QUEUE_INVALID_COLOR',async _0x10196b=>{const _0x5e3934=_0x45c844;if(_0x10196b){const _0x276f6b=/^#[0-9a-f]{3,6}$/i;return _0x276f6b[_0x5e3934(0xfb)](_0x10196b);}return![];})['test'](_0x45c844(0x106),_0x45c844(0x107),async _0x5ae0c5=>{const _0x5e0ce3=_0x45c844;if(_0x5ae0c5){const _0x32ca83=await Queue_1[_0x5e0ce3(0xf3)][_0x5e0ce3(0xe7)]({'where':{'color':_0x5ae0c5,'companyId':_0x5d1d71}});return!_0x32ca83;}return![];})});try{await _0x2dd7fe[_0x45c844(0xf8)]({'color':_0x37a1e7,'name':_0x1ac382});}catch(_0x91967b){throw new AppError_1[(_0x45c844(0xf3))](_0x91967b[_0x45c844(0xee)]);}const _0x5e5987=await Queue_1[_0x45c844(0xf3)][_0x45c844(0xe8)](_0x403b7e,{'include':[{'model':Chatbot_1[_0x45c844(0xf3)],'as':_0x45c844(0xe5),'include':[{'model':User_1[_0x45c844(0xf3)],'as':_0x45c844(0xff)}],'order':[[{'model':Chatbot_1[_0x45c844(0xf3)],'as':_0x45c844(0xe5)},'id','asc']]}]});return _0x5e5987;};exports[a545_0x227bca(0xf3)]=CreateQueueService;