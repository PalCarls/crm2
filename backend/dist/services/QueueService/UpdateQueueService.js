'use strict';const a532_0x13ea27=a532_0x149b;(function(_0x4f1f11,_0x1cafcc){const _0x42b1d4=a532_0x149b,_0x401021=_0x4f1f11();while(!![]){try{const _0x14d54a=parseInt(_0x42b1d4(0x1c5))/0x1+-parseInt(_0x42b1d4(0x1b7))/0x2*(-parseInt(_0x42b1d4(0x19a))/0x3)+parseInt(_0x42b1d4(0x1b6))/0x4+-parseInt(_0x42b1d4(0x19d))/0x5+-parseInt(_0x42b1d4(0x1a1))/0x6+parseInt(_0x42b1d4(0x1c3))/0x7+parseInt(_0x42b1d4(0x1bc))/0x8*(-parseInt(_0x42b1d4(0x1bd))/0x9);if(_0x14d54a===_0x1cafcc)break;else _0x401021['push'](_0x401021['shift']());}catch(_0x4e49a){_0x401021['push'](_0x401021['shift']());}}}(a532_0x4f49,0x3e197));function a532_0x4f49(){const _0x183ca0=['findOne','ERR_QUEUE_COLOR_ALREADY_EXISTS','Não\x20é\x20permitido\x20alterar\x20registros\x20de\x20outra\x20empresa','all','Check-color','../../models/User','chatbots','__esModule','map','./ShowQueueService','reload','message','test','prototype','defineProperty','1313532uqWBfD','2wKazkx','asc','min','default','get','6385712wNDKGy','9nxFkwB','companyId','../../models/Queue','__setModuleDefault','sequelize','upsert','1157156nVPElU','create','504384kbZsLj','Check-unique-name','700026YleNhh','user','object','4865UfWlOW','ASC','ERR_QUEUE_NAME_ALREADY_EXISTS','required','1067226OIIhTg','findIndex','writable','ERR_QUEUE_INVALID_NAME','update','../../errors/AppError'];a532_0x4f49=function(){return _0x183ca0;};return a532_0x4f49();}function a532_0x149b(_0x69d035,_0x46b405){const _0x4f49dc=a532_0x4f49();return a532_0x149b=function(_0x149b0f,_0x295065){_0x149b0f=_0x149b0f-0x199;let _0x18311c=_0x4f49dc[_0x149b0f];return _0x18311c;},a532_0x149b(_0x69d035,_0x46b405);}var __createBinding=this&&this['__createBinding']||(Object[a532_0x13ea27(0x1c4)]?function(_0x19bb8c,_0x1d9d9a,_0x124a3b,_0x903ec){const _0xe33be8=a532_0x13ea27;if(_0x903ec===undefined)_0x903ec=_0x124a3b;var _0x1c3bf1=Object['getOwnPropertyDescriptor'](_0x1d9d9a,_0x124a3b);(!_0x1c3bf1||(_0xe33be8(0x1bb)in _0x1c3bf1?!_0x1d9d9a[_0xe33be8(0x1ae)]:_0x1c3bf1[_0xe33be8(0x1a3)]||_0x1c3bf1['configurable']))&&(_0x1c3bf1={'enumerable':!![],'get':function(){return _0x1d9d9a[_0x124a3b];}}),Object[_0xe33be8(0x1b5)](_0x19bb8c,_0x903ec,_0x1c3bf1);}:function(_0x5e867e,_0x53a8dc,_0x3047b6,_0x1ff4da){if(_0x1ff4da===undefined)_0x1ff4da=_0x3047b6;_0x5e867e[_0x1ff4da]=_0x53a8dc[_0x3047b6];}),__setModuleDefault=this&&this[a532_0x13ea27(0x1c0)]||(Object['create']?function(_0xe4bdf3,_0x1ccddc){const _0xfbe65c=a532_0x13ea27;Object[_0xfbe65c(0x1b5)](_0xe4bdf3,_0xfbe65c(0x1ba),{'enumerable':!![],'value':_0x1ccddc});}:function(_0x4deabb,_0x39b69a){const _0x43f114=a532_0x13ea27;_0x4deabb[_0x43f114(0x1ba)]=_0x39b69a;}),__importStar=this&&this['__importStar']||function(_0x2ce649){const _0x528a01=a532_0x13ea27;if(_0x2ce649&&_0x2ce649[_0x528a01(0x1ae)])return _0x2ce649;var _0x3833f7={};if(_0x2ce649!=null){for(var _0x90a3bd in _0x2ce649)if(_0x90a3bd!=='default'&&Object[_0x528a01(0x1b4)]['hasOwnProperty']['call'](_0x2ce649,_0x90a3bd))__createBinding(_0x3833f7,_0x2ce649,_0x90a3bd);}return __setModuleDefault(_0x3833f7,_0x2ce649),_0x3833f7;},__importDefault=this&&this['__importDefault']||function(_0xc4649b){const _0x2099eb=a532_0x13ea27;return _0xc4649b&&_0xc4649b[_0x2099eb(0x1ae)]?_0xc4649b:{'default':_0xc4649b};};Object[a532_0x13ea27(0x1b5)](exports,a532_0x13ea27(0x1ae),{'value':!![]});const sequelize_1=require(a532_0x13ea27(0x1c1)),Yup=__importStar(require('yup')),AppError_1=__importDefault(require(a532_0x13ea27(0x1a6))),Chatbot_1=__importDefault(require('../../models/Chatbot')),Queue_1=__importDefault(require(a532_0x13ea27(0x1bf))),ShowQueueService_1=__importDefault(require(a532_0x13ea27(0x1b0))),User_1=__importDefault(require(a532_0x13ea27(0x1ac))),UpdateQueueService=async(_0x7910b0,_0x2bdf41,_0x424eb5)=>{const _0x30264d=a532_0x13ea27,{color:_0x1efefd,name:_0x404bc7,chatbots:_0x182de5}=_0x2bdf41,_0x2c6c20=Yup[_0x30264d(0x19c)]()['shape']({'name':Yup['string']()[_0x30264d(0x1b9)](0x2,_0x30264d(0x1a4))['test'](_0x30264d(0x199),_0x30264d(0x19f),async _0x23bc42=>{const _0x18c369=_0x30264d;if(_0x23bc42){const _0x2d9ebd=await Queue_1['default'][_0x18c369(0x1a7)]({'where':{'name':_0x23bc42,'id':{[sequelize_1['Op']['ne']]:_0x7910b0},'companyId':_0x424eb5}});return!_0x2d9ebd;}return!![];}),'color':Yup['string']()[_0x30264d(0x1a0)]('ERR_QUEUE_INVALID_COLOR')[_0x30264d(0x1b3)](_0x30264d(0x1ab),'ERR_QUEUE_INVALID_COLOR',async _0x2b1220=>{if(_0x2b1220){const _0x2e5ad3=/^#[0-9a-f]{3,6}$/i;return _0x2e5ad3['test'](_0x2b1220);}return!![];})[_0x30264d(0x1b3)]('Check-color-exists',_0x30264d(0x1a8),async _0x149c46=>{const _0x3b2606=_0x30264d;if(_0x149c46){const _0x52c2d0=await Queue_1[_0x3b2606(0x1ba)][_0x3b2606(0x1a7)]({'where':{'color':_0x149c46,'id':{[sequelize_1['Op']['ne']]:_0x7910b0},'companyId':_0x424eb5}});return!_0x52c2d0;}return!![];})});try{await _0x2c6c20['validate']({'color':_0x1efefd,'name':_0x404bc7});}catch(_0x1de6a9){throw new AppError_1['default'](_0x1de6a9[_0x30264d(0x1b2)]);}const _0x9aa663=await(0x0,ShowQueueService_1[_0x30264d(0x1ba)])(_0x7910b0,_0x424eb5);if(_0x9aa663[_0x30264d(0x1be)]!==_0x424eb5)throw new AppError_1[(_0x30264d(0x1ba))](_0x30264d(0x1a9));return _0x182de5&&(await Promise[_0x30264d(0x1aa)](_0x182de5[_0x30264d(0x1af)](async _0x2bac14=>{const _0x4f750c=_0x30264d;await Chatbot_1[_0x4f750c(0x1ba)][_0x4f750c(0x1c2)]({..._0x2bac14,'queueId':_0x9aa663['id']});})),await Promise[_0x30264d(0x1aa)](_0x9aa663[_0x30264d(0x1ad)]['map'](async _0x4c880b=>{const _0x262d41=_0x30264d,_0x1cf01b=_0x182de5[_0x262d41(0x1a2)](_0x801e18=>_0x801e18['id']===_0x4c880b['id']);_0x1cf01b===-0x1&&await Chatbot_1[_0x262d41(0x1ba)]['destroy']({'where':{'id':_0x4c880b['id']}});}))),await _0x9aa663[_0x30264d(0x1a5)](_0x2bdf41),await _0x9aa663[_0x30264d(0x1b1)]({'include':[{'model':Chatbot_1[_0x30264d(0x1ba)],'as':_0x30264d(0x1ad),'include':[{'model':User_1[_0x30264d(0x1ba)],'as':_0x30264d(0x19b)}],'order':[[{'model':Chatbot_1[_0x30264d(0x1ba)],'as':_0x30264d(0x1ad)},'id',_0x30264d(0x1b8)],['id',_0x30264d(0x19e)]]}],'order':[[{'model':Chatbot_1['default'],'as':_0x30264d(0x1ad)},'id',_0x30264d(0x1b8)],['id',_0x30264d(0x19e)]]}),_0x9aa663;};exports[a532_0x13ea27(0x1ba)]=UpdateQueueService;