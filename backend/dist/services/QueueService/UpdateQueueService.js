'use strict';const a497_0x173604=a497_0x2666;(function(_0x397556,_0x44502c){const _0x2fa14d=a497_0x2666,_0x19f349=_0x397556();while(!![]){try{const _0x9ddbc2=-parseInt(_0x2fa14d(0xdc))/0x1*(parseInt(_0x2fa14d(0xc5))/0x2)+-parseInt(_0x2fa14d(0xc3))/0x3+-parseInt(_0x2fa14d(0xe0))/0x4*(parseInt(_0x2fa14d(0xda))/0x5)+parseInt(_0x2fa14d(0xeb))/0x6+-parseInt(_0x2fa14d(0xd7))/0x7*(-parseInt(_0x2fa14d(0xd6))/0x8)+parseInt(_0x2fa14d(0xcb))/0x9+-parseInt(_0x2fa14d(0xe2))/0xa*(parseInt(_0x2fa14d(0xc8))/0xb);if(_0x9ddbc2===_0x44502c)break;else _0x19f349['push'](_0x19f349['shift']());}catch(_0x37e642){_0x19f349['push'](_0x19f349['shift']());}}}(a497_0x2b0a,0x2649a));var __createBinding=this&&this[a497_0x173604(0xe1)]||(Object[a497_0x173604(0xc0)]?function(_0x4d84fc,_0x5b5354,_0x30ed12,_0x30fa9a){const _0x1fbdab=a497_0x173604;if(_0x30fa9a===undefined)_0x30fa9a=_0x30ed12;var _0x2e8ea9=Object[_0x1fbdab(0xc7)](_0x5b5354,_0x30ed12);(!_0x2e8ea9||('get'in _0x2e8ea9?!_0x5b5354[_0x1fbdab(0xea)]:_0x2e8ea9[_0x1fbdab(0xb7)]||_0x2e8ea9[_0x1fbdab(0xbb)]))&&(_0x2e8ea9={'enumerable':!![],'get':function(){return _0x5b5354[_0x30ed12];}}),Object[_0x1fbdab(0xce)](_0x4d84fc,_0x30fa9a,_0x2e8ea9);}:function(_0x41bdbc,_0x3553b4,_0x1216f7,_0x32ba03){if(_0x32ba03===undefined)_0x32ba03=_0x1216f7;_0x41bdbc[_0x32ba03]=_0x3553b4[_0x1216f7];}),__setModuleDefault=this&&this[a497_0x173604(0xdb)]||(Object['create']?function(_0x198a29,_0x377138){const _0x2e24c8=a497_0x173604;Object['defineProperty'](_0x198a29,_0x2e24c8(0xcd),{'enumerable':!![],'value':_0x377138});}:function(_0x27c858,_0x35d125){const _0x380837=a497_0x173604;_0x27c858[_0x380837(0xcd)]=_0x35d125;}),__importStar=this&&this[a497_0x173604(0xcf)]||function(_0x403d80){const _0x50a1a1=a497_0x173604;if(_0x403d80&&_0x403d80[_0x50a1a1(0xea)])return _0x403d80;var _0x256688={};if(_0x403d80!=null){for(var _0x34b618 in _0x403d80)if(_0x34b618!=='default'&&Object[_0x50a1a1(0xe3)][_0x50a1a1(0xdd)]['call'](_0x403d80,_0x34b618))__createBinding(_0x256688,_0x403d80,_0x34b618);}return __setModuleDefault(_0x256688,_0x403d80),_0x256688;},__importDefault=this&&this[a497_0x173604(0xe7)]||function(_0x475a28){const _0x28a828=a497_0x173604;return _0x475a28&&_0x475a28[_0x28a828(0xea)]?_0x475a28:{'default':_0x475a28};};Object[a497_0x173604(0xce)](exports,a497_0x173604(0xea),{'value':!![]});const sequelize_1=require('sequelize'),Yup=__importStar(require(a497_0x173604(0xbe))),AppError_1=__importDefault(require(a497_0x173604(0xed))),Chatbot_1=__importDefault(require(a497_0x173604(0xd2))),Queue_1=__importDefault(require(a497_0x173604(0xbf))),ShowQueueService_1=__importDefault(require('./ShowQueueService')),UpdateQueueService=async(_0xd4a4b7,_0x3860b9,_0x45515b)=>{const _0x3ce20b=a497_0x173604,{color:_0x1254fa,name:_0x23fa1a,chatbots:_0xfbbf8d,ativarRoteador:_0x534450,tempoRoteador:_0x18a36d}=_0x3860b9,_0x18a67e=Yup[_0x3ce20b(0xb5)]()[_0x3ce20b(0xbc)]({'name':Yup[_0x3ce20b(0xbd)]()[_0x3ce20b(0xe9)](0x2,_0x3ce20b(0xb6))['test'](_0x3ce20b(0xc2),'ERR_QUEUE_NAME_ALREADY_EXISTS',async _0x56d897=>{const _0x2a8af5=_0x3ce20b;if(_0x56d897){const _0x511e85=await Queue_1['default'][_0x2a8af5(0xc4)]({'where':{'name':_0x56d897,'id':{[sequelize_1['Op']['ne']]:_0xd4a4b7},'companyId':_0x45515b}});return!_0x511e85;}return!![];}),'color':Yup[_0x3ce20b(0xbd)]()[_0x3ce20b(0xd5)](_0x3ce20b(0xcc))[_0x3ce20b(0xd9)](_0x3ce20b(0xe6),_0x3ce20b(0xcc),async _0x112cf2=>{const _0xf7c679=_0x3ce20b;if(_0x112cf2){const _0x5d7516=/^#[0-9a-f]{3,6}$/i;return _0x5d7516[_0xf7c679(0xd9)](_0x112cf2);}return!![];})['test'](_0x3ce20b(0xd0),'ERR_QUEUE_COLOR_ALREADY_EXISTS',async _0x45fe46=>{const _0x35bfff=_0x3ce20b;if(_0x45fe46){const _0x12d387=await Queue_1[_0x35bfff(0xcd)][_0x35bfff(0xc4)]({'where':{'color':_0x45fe46,'id':{[sequelize_1['Op']['ne']]:_0xd4a4b7},'companyId':_0x45515b}});return!_0x12d387;}return!![];})});try{await _0x18a67e[_0x3ce20b(0xb9)]({'color':_0x1254fa,'name':_0x23fa1a});}catch(_0x5a11e1){throw new AppError_1[(_0x3ce20b(0xcd))](_0x5a11e1[_0x3ce20b(0xc1)]);}const _0x40fca9=await(0x0,ShowQueueService_1[_0x3ce20b(0xcd)])(_0xd4a4b7,_0x45515b);if(_0x40fca9[_0x3ce20b(0xe5)]!==_0x45515b)throw new AppError_1[(_0x3ce20b(0xcd))](_0x3ce20b(0xb8));return _0xfbbf8d&&(await Promise[_0x3ce20b(0xe8)](_0xfbbf8d['map'](async _0x4af97a=>{const _0x14c9b9=_0x3ce20b;await Chatbot_1[_0x14c9b9(0xcd)]['upsert']({..._0x4af97a,'queueId':_0x40fca9['id']});})),await Promise['all'](_0x40fca9['chatbots'][_0x3ce20b(0xd8)](async _0x5a150d=>{const _0x48d3fd=_0x3ce20b,_0x4acdec=_0xfbbf8d[_0x48d3fd(0xd1)](_0xa5c7a2=>_0xa5c7a2['id']===_0x5a150d['id']);_0x4acdec===-0x1&&await Chatbot_1[_0x48d3fd(0xcd)][_0x48d3fd(0xec)]({'where':{'id':_0x5a150d['id']}});}))),await _0x40fca9[_0x3ce20b(0xe4)](_0x3860b9),await _0x40fca9[_0x3ce20b(0xc9)]({'attributes':['id',_0x3ce20b(0xde),_0x3ce20b(0xc6),_0x3ce20b(0xba),_0x3ce20b(0xd4)],'include':[{'model':Chatbot_1[_0x3ce20b(0xcd)],'as':'chatbots','order':[[{'model':Chatbot_1['default'],'as':_0x3ce20b(0xd3)},'id',_0x3ce20b(0xca)],['id',_0x3ce20b(0xdf)]]}],'order':[[{'model':Chatbot_1['default'],'as':_0x3ce20b(0xd3)},'id',_0x3ce20b(0xca)],['id',_0x3ce20b(0xdf)]]}),_0x40fca9;};function a497_0x2666(_0x476fdd,_0x216a93){const _0x2b0a78=a497_0x2b0a();return a497_0x2666=function(_0x2666a4,_0x3b3406){_0x2666a4=_0x2666a4-0xb5;let _0x15b86b=_0x2b0a78[_0x2666a4];return _0x15b86b;},a497_0x2666(_0x476fdd,_0x216a93);}function a497_0x2b0a(){const _0xb74a76=['getOwnPropertyDescriptor','33PZfBed','reload','asc','2525220jtnLWm','ERR_QUEUE_INVALID_COLOR','default','defineProperty','__importStar','Check-color-exists','findIndex','../../models/Chatbot','chatbots','schedules','required','2070104zwlAAW','7bzqfXh','map','test','128715kGwDbZ','__setModuleDefault','1FIZoEW','hasOwnProperty','color','ASC','8UaxYDJ','__createBinding','837950rEfnzz','prototype','update','companyId','Check-color','__importDefault','all','min','__esModule','848778OHQeBm','destroy','../../errors/AppError','object','ERR_QUEUE_INVALID_NAME','writable','Não\x20é\x20permitido\x20alterar\x20registros\x20de\x20outra\x20empresa','validate','greetingMessage','configurable','shape','string','yup','../../models/Queue','create','message','Check-unique-name','661614Ouehrk','findOne','1142PddzSG','name'];a497_0x2b0a=function(){return _0xb74a76;};return a497_0x2b0a();}exports[a497_0x173604(0xcd)]=UpdateQueueService;