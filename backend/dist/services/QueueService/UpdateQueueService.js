'use strict';const a465_0x3611b8=a465_0x2f0a;(function(_0x478f4b,_0x567ba1){const _0x3ef5e1=a465_0x2f0a,_0x4c72e8=_0x478f4b();while(!![]){try{const _0x3fd245=-parseInt(_0x3ef5e1(0x81))/0x1*(-parseInt(_0x3ef5e1(0x80))/0x2)+-parseInt(_0x3ef5e1(0x94))/0x3*(-parseInt(_0x3ef5e1(0x9a))/0x4)+-parseInt(_0x3ef5e1(0x7d))/0x5*(parseInt(_0x3ef5e1(0x83))/0x6)+-parseInt(_0x3ef5e1(0x9e))/0x7*(-parseInt(_0x3ef5e1(0x7a))/0x8)+parseInt(_0x3ef5e1(0x75))/0x9*(parseInt(_0x3ef5e1(0x74))/0xa)+parseInt(_0x3ef5e1(0x79))/0xb*(parseInt(_0x3ef5e1(0x85))/0xc)+-parseInt(_0x3ef5e1(0x68))/0xd;if(_0x3fd245===_0x567ba1)break;else _0x4c72e8['push'](_0x4c72e8['shift']());}catch(_0xbd60e1){_0x4c72e8['push'](_0x4c72e8['shift']());}}}(a465_0x35ab,0xb15db));function a465_0x35ab(){const _0x334b7e=['48870419QwRxBp','findOne','greetingMessage','default','min','findIndex','map','string','Check-color-exists','../../models/Queue','destroy','required','4474210hgAPoo','9lrifDa','__importDefault','reload','../../errors/AppError','29425mNlEGK','242600YpVnQq','Check-unique-name','chatbots','895zfcOur','upsert','__importStar','1855558GfHRcu','1qhgtpw','ASC','8310vbTdPx','__createBinding','5604ScRDAB','defineProperty','color','get','prototype','ERR_QUEUE_INVALID_NAME','ERR_QUEUE_INVALID_COLOR','writable','__esModule','message','sequelize','object','hasOwnProperty','all','ERR_QUEUE_NAME_ALREADY_EXISTS','3606MOEJPt','test','name','Check-color','getOwnPropertyDescriptor','create','3588QAtmbN','Não\x20é\x20permitido\x20alterar\x20registros\x20de\x20outra\x20empresa','shape','./ShowQueueService','238RVTjcS','validate','__setModuleDefault'];a465_0x35ab=function(){return _0x334b7e;};return a465_0x35ab();}function a465_0x2f0a(_0x1d9449,_0x30b54d){const _0x35abb6=a465_0x35ab();return a465_0x2f0a=function(_0x2f0a39,_0x392530){_0x2f0a39=_0x2f0a39-0x68;let _0x88d882=_0x35abb6[_0x2f0a39];return _0x88d882;},a465_0x2f0a(_0x1d9449,_0x30b54d);}var __createBinding=this&&this[a465_0x3611b8(0x84)]||(Object[a465_0x3611b8(0x99)]?function(_0x5f4edb,_0x2e07a7,_0x53fa5f,_0x5c4f1f){const _0x5a0235=a465_0x3611b8;if(_0x5c4f1f===undefined)_0x5c4f1f=_0x53fa5f;var _0x17ca02=Object[_0x5a0235(0x98)](_0x2e07a7,_0x53fa5f);(!_0x17ca02||(_0x5a0235(0x88)in _0x17ca02?!_0x2e07a7['__esModule']:_0x17ca02[_0x5a0235(0x8c)]||_0x17ca02['configurable']))&&(_0x17ca02={'enumerable':!![],'get':function(){return _0x2e07a7[_0x53fa5f];}}),Object[_0x5a0235(0x86)](_0x5f4edb,_0x5c4f1f,_0x17ca02);}:function(_0x463bd0,_0x51316e,_0x37ecfe,_0x3db515){if(_0x3db515===undefined)_0x3db515=_0x37ecfe;_0x463bd0[_0x3db515]=_0x51316e[_0x37ecfe];}),__setModuleDefault=this&&this[a465_0x3611b8(0xa0)]||(Object[a465_0x3611b8(0x99)]?function(_0x65d33c,_0x2916de){const _0x54a602=a465_0x3611b8;Object[_0x54a602(0x86)](_0x65d33c,_0x54a602(0x6b),{'enumerable':!![],'value':_0x2916de});}:function(_0x4341c8,_0x245149){const _0x421cd3=a465_0x3611b8;_0x4341c8[_0x421cd3(0x6b)]=_0x245149;}),__importStar=this&&this[a465_0x3611b8(0x7f)]||function(_0x3bdd9b){const _0x2db81f=a465_0x3611b8;if(_0x3bdd9b&&_0x3bdd9b[_0x2db81f(0x8d)])return _0x3bdd9b;var _0x26b783={};if(_0x3bdd9b!=null){for(var _0x47f3ff in _0x3bdd9b)if(_0x47f3ff!==_0x2db81f(0x6b)&&Object[_0x2db81f(0x89)][_0x2db81f(0x91)]['call'](_0x3bdd9b,_0x47f3ff))__createBinding(_0x26b783,_0x3bdd9b,_0x47f3ff);}return __setModuleDefault(_0x26b783,_0x3bdd9b),_0x26b783;},__importDefault=this&&this[a465_0x3611b8(0x76)]||function(_0x5a463d){const _0x5849d7=a465_0x3611b8;return _0x5a463d&&_0x5a463d[_0x5849d7(0x8d)]?_0x5a463d:{'default':_0x5a463d};};Object[a465_0x3611b8(0x86)](exports,'__esModule',{'value':!![]});const sequelize_1=require(a465_0x3611b8(0x8f)),Yup=__importStar(require('yup')),AppError_1=__importDefault(require(a465_0x3611b8(0x78))),Chatbot_1=__importDefault(require('../../models/Chatbot')),Queue_1=__importDefault(require(a465_0x3611b8(0x71))),ShowQueueService_1=__importDefault(require(a465_0x3611b8(0x9d))),UpdateQueueService=async(_0x5a4088,_0x45063e,_0x5db1a5)=>{const _0x231851=a465_0x3611b8,{color:_0x47d28d,name:_0x54833e,chatbots:_0x12b4af}=_0x45063e,_0x263f06=Yup[_0x231851(0x90)]()[_0x231851(0x9c)]({'name':Yup[_0x231851(0x6f)]()[_0x231851(0x6c)](0x2,_0x231851(0x8a))[_0x231851(0x95)](_0x231851(0x7b),_0x231851(0x93),async _0x66e460=>{const _0x37227f=_0x231851;if(_0x66e460){const _0x56ae6c=await Queue_1[_0x37227f(0x6b)][_0x37227f(0x69)]({'where':{'name':_0x66e460,'id':{[sequelize_1['Op']['ne']]:_0x5a4088},'companyId':_0x5db1a5}});return!_0x56ae6c;}return!![];}),'color':Yup[_0x231851(0x6f)]()[_0x231851(0x73)](_0x231851(0x8b))['test'](_0x231851(0x97),_0x231851(0x8b),async _0x4a5c66=>{const _0x447c5f=_0x231851;if(_0x4a5c66){const _0x3fd0f2=/^#[0-9a-f]{3,6}$/i;return _0x3fd0f2[_0x447c5f(0x95)](_0x4a5c66);}return!![];})[_0x231851(0x95)](_0x231851(0x70),'ERR_QUEUE_COLOR_ALREADY_EXISTS',async _0x8857a2=>{const _0x47e9ce=_0x231851;if(_0x8857a2){const _0x48cc0f=await Queue_1[_0x47e9ce(0x6b)][_0x47e9ce(0x69)]({'where':{'color':_0x8857a2,'id':{[sequelize_1['Op']['ne']]:_0x5a4088},'companyId':_0x5db1a5}});return!_0x48cc0f;}return!![];})});try{await _0x263f06[_0x231851(0x9f)]({'color':_0x47d28d,'name':_0x54833e});}catch(_0x3e6ce0){throw new AppError_1[(_0x231851(0x6b))](_0x3e6ce0[_0x231851(0x8e)]);}const _0xf0d171=await(0x0,ShowQueueService_1[_0x231851(0x6b)])(_0x5a4088,_0x5db1a5);if(_0xf0d171['companyId']!==_0x5db1a5)throw new AppError_1[(_0x231851(0x6b))](_0x231851(0x9b));return _0x12b4af&&(await Promise[_0x231851(0x92)](_0x12b4af['map'](async _0x1d6906=>{const _0x4e49f2=_0x231851;await Chatbot_1['default'][_0x4e49f2(0x7e)]({..._0x1d6906,'queueId':_0xf0d171['id']});})),await Promise[_0x231851(0x92)](_0xf0d171[_0x231851(0x7c)][_0x231851(0x6e)](async _0x3ddaf3=>{const _0x3dde12=_0x231851,_0x5b56dc=_0x12b4af[_0x3dde12(0x6d)](_0x15a2e9=>_0x15a2e9['id']===_0x3ddaf3['id']);_0x5b56dc===-0x1&&await Chatbot_1[_0x3dde12(0x6b)][_0x3dde12(0x72)]({'where':{'id':_0x3ddaf3['id']}});}))),await _0xf0d171['update'](_0x45063e),await _0xf0d171[_0x231851(0x77)]({'attributes':['id',_0x231851(0x87),_0x231851(0x96),_0x231851(0x6a),'schedules'],'include':[{'model':Chatbot_1['default'],'as':_0x231851(0x7c),'order':[[{'model':Chatbot_1[_0x231851(0x6b)],'as':'chatbots'},'id','asc'],['id',_0x231851(0x82)]]}],'order':[[{'model':Chatbot_1[_0x231851(0x6b)],'as':_0x231851(0x7c)},'id','asc'],['id',_0x231851(0x82)]]}),_0xf0d171;};exports[a465_0x3611b8(0x6b)]=UpdateQueueService;