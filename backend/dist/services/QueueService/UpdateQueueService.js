'use strict';const a482_0x4f8389=a482_0x2bd5;(function(_0x56fe14,_0x8bf077){const _0x1b040a=a482_0x2bd5,_0x2908d6=_0x56fe14();while(!![]){try{const _0x12473f=parseInt(_0x1b040a(0x13f))/0x1*(parseInt(_0x1b040a(0x13b))/0x2)+-parseInt(_0x1b040a(0x109))/0x3*(parseInt(_0x1b040a(0x114))/0x4)+-parseInt(_0x1b040a(0x11c))/0x5+-parseInt(_0x1b040a(0x126))/0x6+parseInt(_0x1b040a(0x10b))/0x7*(-parseInt(_0x1b040a(0x10f))/0x8)+parseInt(_0x1b040a(0x139))/0x9+-parseInt(_0x1b040a(0x120))/0xa*(-parseInt(_0x1b040a(0x135))/0xb);if(_0x12473f===_0x8bf077)break;else _0x2908d6['push'](_0x2908d6['shift']());}catch(_0x50e35c){_0x2908d6['push'](_0x2908d6['shift']());}}}(a482_0x452a,0xc8e03));function a482_0x452a(){const _0x592d5c=['configurable','min','writable','ERR_QUEUE_NAME_ALREADY_EXISTS','ASC','Check-color','ERR_QUEUE_INVALID_NAME','37929331FBtZob','asc','Não\x20é\x20permitido\x20alterar\x20registros\x20de\x20outra\x20empresa','create','64242vhVJHo','map','124456bPMTMB','Check-unique-name','shape','Check-color-exists','23YcoguY','__esModule','update','3166731QGMqoq','destroy','91728zYeWZN','sequelize','validate','findIndex','920eYWGnS','hasOwnProperty','upsert','prototype','greetingMessage','4apOjnA','test','ERR_QUEUE_COLOR_ALREADY_EXISTS','ERR_QUEUE_INVALID_COLOR','message','getOwnPropertyDescriptor','all','./ShowQueueService','944510dpGXoN','required','reload','chatbots','10GVcaZR','defineProperty','__createBinding','name','findOne','object','7873662ULGaYm','__setModuleDefault','schedules','../../models/Queue','yup','string','default','__importStar'];a482_0x452a=function(){return _0x592d5c;};return a482_0x452a();}var __createBinding=this&&this[a482_0x4f8389(0x122)]||(Object[a482_0x4f8389(0x138)]?function(_0x3cfc0e,_0x2b685f,_0x397a36,_0x2ad824){const _0x2f464d=a482_0x4f8389;if(_0x2ad824===undefined)_0x2ad824=_0x397a36;var _0x4c90f2=Object[_0x2f464d(0x119)](_0x2b685f,_0x397a36);(!_0x4c90f2||('get'in _0x4c90f2?!_0x2b685f['__esModule']:_0x4c90f2[_0x2f464d(0x130)]||_0x4c90f2[_0x2f464d(0x12e)]))&&(_0x4c90f2={'enumerable':!![],'get':function(){return _0x2b685f[_0x397a36];}}),Object['defineProperty'](_0x3cfc0e,_0x2ad824,_0x4c90f2);}:function(_0x3adea0,_0x32c6b9,_0x209b0e,_0x3352f2){if(_0x3352f2===undefined)_0x3352f2=_0x209b0e;_0x3adea0[_0x3352f2]=_0x32c6b9[_0x209b0e];}),__setModuleDefault=this&&this[a482_0x4f8389(0x127)]||(Object[a482_0x4f8389(0x138)]?function(_0x63028a,_0x18546c){const _0x424ad0=a482_0x4f8389;Object['defineProperty'](_0x63028a,_0x424ad0(0x12c),{'enumerable':!![],'value':_0x18546c});}:function(_0xf8506d,_0x139826){const _0x4158fc=a482_0x4f8389;_0xf8506d[_0x4158fc(0x12c)]=_0x139826;}),__importStar=this&&this[a482_0x4f8389(0x12d)]||function(_0x4b5f08){const _0x3f2c26=a482_0x4f8389;if(_0x4b5f08&&_0x4b5f08['__esModule'])return _0x4b5f08;var _0x35e8b={};if(_0x4b5f08!=null){for(var _0x191c06 in _0x4b5f08)if(_0x191c06!==_0x3f2c26(0x12c)&&Object[_0x3f2c26(0x112)][_0x3f2c26(0x110)]['call'](_0x4b5f08,_0x191c06))__createBinding(_0x35e8b,_0x4b5f08,_0x191c06);}return __setModuleDefault(_0x35e8b,_0x4b5f08),_0x35e8b;},__importDefault=this&&this['__importDefault']||function(_0x342790){const _0x93b9d0=a482_0x4f8389;return _0x342790&&_0x342790[_0x93b9d0(0x107)]?_0x342790:{'default':_0x342790};};Object[a482_0x4f8389(0x121)](exports,a482_0x4f8389(0x107),{'value':!![]});function a482_0x2bd5(_0x14c726,_0xe58aa5){const _0x452a6f=a482_0x452a();return a482_0x2bd5=function(_0x2bd5b0,_0x2c48c7){_0x2bd5b0=_0x2bd5b0-0x107;let _0x792253=_0x452a6f[_0x2bd5b0];return _0x792253;},a482_0x2bd5(_0x14c726,_0xe58aa5);}const sequelize_1=require(a482_0x4f8389(0x10c)),Yup=__importStar(require(a482_0x4f8389(0x12a))),AppError_1=__importDefault(require('../../errors/AppError')),Chatbot_1=__importDefault(require('../../models/Chatbot')),Queue_1=__importDefault(require(a482_0x4f8389(0x129))),ShowQueueService_1=__importDefault(require(a482_0x4f8389(0x11b))),UpdateQueueService=async(_0x537c26,_0x1cf3fe,_0x5480ae)=>{const _0x1ace75=a482_0x4f8389,{color:_0x2e572f,name:_0x2816fa,chatbots:_0x5201df,ativarRoteador:_0x34c369,tempoRoteador:_0x111268}=_0x1cf3fe,_0x283fdd=Yup[_0x1ace75(0x125)]()[_0x1ace75(0x13d)]({'name':Yup[_0x1ace75(0x12b)]()[_0x1ace75(0x12f)](0x2,_0x1ace75(0x134))[_0x1ace75(0x115)](_0x1ace75(0x13c),_0x1ace75(0x131),async _0x59b3e9=>{const _0x2e4cb3=_0x1ace75;if(_0x59b3e9){const _0x381800=await Queue_1[_0x2e4cb3(0x12c)][_0x2e4cb3(0x124)]({'where':{'name':_0x59b3e9,'id':{[sequelize_1['Op']['ne']]:_0x537c26},'companyId':_0x5480ae}});return!_0x381800;}return!![];}),'color':Yup[_0x1ace75(0x12b)]()[_0x1ace75(0x11d)](_0x1ace75(0x117))[_0x1ace75(0x115)](_0x1ace75(0x133),_0x1ace75(0x117),async _0x55a266=>{const _0x4383be=_0x1ace75;if(_0x55a266){const _0x2ddd7b=/^#[0-9a-f]{3,6}$/i;return _0x2ddd7b[_0x4383be(0x115)](_0x55a266);}return!![];})['test'](_0x1ace75(0x13e),_0x1ace75(0x116),async _0x2ce01f=>{const _0xf17868=_0x1ace75;if(_0x2ce01f){const _0x2a4a0b=await Queue_1[_0xf17868(0x12c)][_0xf17868(0x124)]({'where':{'color':_0x2ce01f,'id':{[sequelize_1['Op']['ne']]:_0x537c26},'companyId':_0x5480ae}});return!_0x2a4a0b;}return!![];})});try{await _0x283fdd[_0x1ace75(0x10d)]({'color':_0x2e572f,'name':_0x2816fa});}catch(_0x30df00){throw new AppError_1[(_0x1ace75(0x12c))](_0x30df00[_0x1ace75(0x118)]);}const _0x30bb74=await(0x0,ShowQueueService_1[_0x1ace75(0x12c)])(_0x537c26,_0x5480ae);if(_0x30bb74['companyId']!==_0x5480ae)throw new AppError_1['default'](_0x1ace75(0x137));return _0x5201df&&(await Promise['all'](_0x5201df[_0x1ace75(0x13a)](async _0x19be3e=>{const _0x1b1d63=_0x1ace75;await Chatbot_1['default'][_0x1b1d63(0x111)]({..._0x19be3e,'queueId':_0x30bb74['id']});})),await Promise[_0x1ace75(0x11a)](_0x30bb74[_0x1ace75(0x11f)]['map'](async _0x237ee7=>{const _0xee3bb9=_0x1ace75,_0x2509a7=_0x5201df[_0xee3bb9(0x10e)](_0x2f8d8d=>_0x2f8d8d['id']===_0x237ee7['id']);_0x2509a7===-0x1&&await Chatbot_1[_0xee3bb9(0x12c)][_0xee3bb9(0x10a)]({'where':{'id':_0x237ee7['id']}});}))),await _0x30bb74[_0x1ace75(0x108)](_0x1cf3fe),await _0x30bb74[_0x1ace75(0x11e)]({'attributes':['id','color',_0x1ace75(0x123),_0x1ace75(0x113),_0x1ace75(0x128)],'include':[{'model':Chatbot_1[_0x1ace75(0x12c)],'as':_0x1ace75(0x11f),'order':[[{'model':Chatbot_1['default'],'as':_0x1ace75(0x11f)},'id',_0x1ace75(0x136)],['id',_0x1ace75(0x132)]]}],'order':[[{'model':Chatbot_1[_0x1ace75(0x12c)],'as':'chatbots'},'id',_0x1ace75(0x136)],['id',_0x1ace75(0x132)]]}),_0x30bb74;};exports[a482_0x4f8389(0x12c)]=UpdateQueueService;