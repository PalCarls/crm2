'use strict';const a549_0xedc4f8=a549_0x59b4;(function(_0x47ca97,_0x7400c5){const _0x242c48=a549_0x59b4,_0xb01b74=_0x47ca97();while(!![]){try{const _0x5cd350=parseInt(_0x242c48(0xdc))/0x1+-parseInt(_0x242c48(0xbf))/0x2+parseInt(_0x242c48(0xdb))/0x3*(-parseInt(_0x242c48(0xca))/0x4)+parseInt(_0x242c48(0xc2))/0x5+parseInt(_0x242c48(0xc5))/0x6*(-parseInt(_0x242c48(0xed))/0x7)+-parseInt(_0x242c48(0xd8))/0x8+parseInt(_0x242c48(0xdf))/0x9*(parseInt(_0x242c48(0xf3))/0xa);if(_0x5cd350===_0x7400c5)break;else _0xb01b74['push'](_0xb01b74['shift']());}catch(_0x43f705){_0xb01b74['push'](_0xb01b74['shift']());}}}(a549_0xc365,0x74e4c));var __createBinding=this&&this[a549_0xedc4f8(0xc4)]||(Object[a549_0xedc4f8(0xf1)]?function(_0x3b3c25,_0x362a30,_0x102f79,_0x43cc6f){const _0x441c05=a549_0xedc4f8;if(_0x43cc6f===undefined)_0x43cc6f=_0x102f79;var _0x57716d=Object[_0x441c05(0xcc)](_0x362a30,_0x102f79);(!_0x57716d||(_0x441c05(0xe5)in _0x57716d?!_0x362a30[_0x441c05(0xe7)]:_0x57716d[_0x441c05(0xc7)]||_0x57716d[_0x441c05(0xc0)]))&&(_0x57716d={'enumerable':!![],'get':function(){return _0x362a30[_0x102f79];}}),Object[_0x441c05(0xec)](_0x3b3c25,_0x43cc6f,_0x57716d);}:function(_0x8123b6,_0x1fb300,_0x4163a7,_0x245953){if(_0x245953===undefined)_0x245953=_0x4163a7;_0x8123b6[_0x245953]=_0x1fb300[_0x4163a7];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a549_0xedc4f8(0xf1)]?function(_0x5b1b6e,_0x5d0b1a){const _0xf3caa3=a549_0xedc4f8;Object[_0xf3caa3(0xec)](_0x5b1b6e,_0xf3caa3(0xee),{'enumerable':!![],'value':_0x5d0b1a});}:function(_0x385817,_0x4f702e){const _0x5b14ce=a549_0xedc4f8;_0x385817[_0x5b14ce(0xee)]=_0x4f702e;}),__importStar=this&&this[a549_0xedc4f8(0xe0)]||function(_0x10b2ff){const _0x4352f9=a549_0xedc4f8;if(_0x10b2ff&&_0x10b2ff['__esModule'])return _0x10b2ff;var _0x460b57={};if(_0x10b2ff!=null){for(var _0x296bfe in _0x10b2ff)if(_0x296bfe!==_0x4352f9(0xee)&&Object[_0x4352f9(0xd1)]['hasOwnProperty'][_0x4352f9(0xd9)](_0x10b2ff,_0x296bfe))__createBinding(_0x460b57,_0x10b2ff,_0x296bfe);}return __setModuleDefault(_0x460b57,_0x10b2ff),_0x460b57;},__importDefault=this&&this[a549_0xedc4f8(0xc1)]||function(_0x204f3d){const _0x24b515=a549_0xedc4f8;return _0x204f3d&&_0x204f3d[_0x24b515(0xe7)]?_0x204f3d:{'default':_0x204f3d};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const sequelize_1=require(a549_0xedc4f8(0xe1)),Yup=__importStar(require('yup')),AppError_1=__importDefault(require('../../errors/AppError')),Chatbot_1=__importDefault(require('../../models/Chatbot')),Queue_1=__importDefault(require(a549_0xedc4f8(0xcf))),ShowQueueService_1=__importDefault(require(a549_0xedc4f8(0xef))),User_1=__importDefault(require(a549_0xedc4f8(0xeb))),UpdateQueueService=async(_0x32805c,_0x264f8a,_0xe60677)=>{const _0x5c4fc6=a549_0xedc4f8,{color:_0xf60ee5,name:_0x54082b,chatbots:_0x4eeee6}=_0x264f8a,_0x506eb4=Yup[_0x5c4fc6(0xf4)]()[_0x5c4fc6(0xf0)]({'name':Yup['string']()[_0x5c4fc6(0xd5)](0x2,_0x5c4fc6(0xc8))['test'](_0x5c4fc6(0xd3),_0x5c4fc6(0xd2),async _0x479f9d=>{const _0x5e5914=_0x5c4fc6;if(_0x479f9d){const _0x44e93d=await Queue_1['default'][_0x5e5914(0xde)]({'where':{'name':_0x479f9d,'id':{[sequelize_1['Op']['ne']]:_0x32805c},'companyId':_0xe60677}});return!_0x44e93d;}return!![];}),'color':Yup[_0x5c4fc6(0xe6)]()[_0x5c4fc6(0xcb)](_0x5c4fc6(0xe4))['test'](_0x5c4fc6(0xc6),'ERR_QUEUE_INVALID_COLOR',async _0x44841e=>{if(_0x44841e){const _0xd019bf=/^#[0-9a-f]{3,6}$/i;return _0xd019bf['test'](_0x44841e);}return!![];})[_0x5c4fc6(0xe3)]('Check-color-exists',_0x5c4fc6(0xc9),async _0x9d62b4=>{const _0x1c93c5=_0x5c4fc6;if(_0x9d62b4){const _0x5abe25=await Queue_1[_0x1c93c5(0xee)][_0x1c93c5(0xde)]({'where':{'color':_0x9d62b4,'id':{[sequelize_1['Op']['ne']]:_0x32805c},'companyId':_0xe60677}});return!_0x5abe25;}return!![];})});try{await _0x506eb4[_0x5c4fc6(0xd7)]({'color':_0xf60ee5,'name':_0x54082b});}catch(_0x54746c){throw new AppError_1[(_0x5c4fc6(0xee))](_0x54746c[_0x5c4fc6(0xcd)]);}const _0x5ab197=await(0x0,ShowQueueService_1[_0x5c4fc6(0xee)])(_0x32805c,_0xe60677);if(_0x5ab197[_0x5c4fc6(0xdd)]!==_0xe60677)throw new AppError_1[(_0x5c4fc6(0xee))]('Não\x20é\x20permitido\x20alterar\x20registros\x20de\x20outra\x20empresa');return _0x4eeee6&&(await Promise[_0x5c4fc6(0xe9)](_0x4eeee6[_0x5c4fc6(0xf2)](async _0x6e174c=>{const _0xc20480=_0x5c4fc6;await Chatbot_1['default'][_0xc20480(0xd0)]({..._0x6e174c,'queueId':_0x5ab197['id']});})),await Promise[_0x5c4fc6(0xe9)](_0x5ab197[_0x5c4fc6(0xe8)][_0x5c4fc6(0xf2)](async _0x388670=>{const _0x51be8f=_0x5c4fc6,_0x59385e=_0x4eeee6[_0x51be8f(0xd4)](_0x3a6275=>_0x3a6275['id']===_0x388670['id']);_0x59385e===-0x1&&await Chatbot_1[_0x51be8f(0xee)][_0x51be8f(0xea)]({'where':{'id':_0x388670['id']}});}))),await _0x5ab197[_0x5c4fc6(0xc3)](_0x264f8a),await _0x5ab197[_0x5c4fc6(0xce)]({'include':[{'model':Chatbot_1[_0x5c4fc6(0xee)],'as':_0x5c4fc6(0xe8),'include':[{'model':User_1[_0x5c4fc6(0xee)],'as':_0x5c4fc6(0xd6)}],'order':[[{'model':Chatbot_1['default'],'as':_0x5c4fc6(0xe8)},'id',_0x5c4fc6(0xe2)],['id',_0x5c4fc6(0xda)]]}],'order':[[{'model':Chatbot_1[_0x5c4fc6(0xee)],'as':'chatbots'},'id',_0x5c4fc6(0xe2)],['id',_0x5c4fc6(0xda)]]}),_0x5ab197;};exports[a549_0xedc4f8(0xee)]=UpdateQueueService;function a549_0x59b4(_0x45f42c,_0x11139a){const _0xc365f3=a549_0xc365();return a549_0x59b4=function(_0x59b4ea,_0x20fe53){_0x59b4ea=_0x59b4ea-0xbf;let _0x18cf97=_0xc365f3[_0x59b4ea];return _0x18cf97;},a549_0x59b4(_0x45f42c,_0x11139a);}function a549_0xc365(){const _0x35bc23=['upsert','prototype','ERR_QUEUE_NAME_ALREADY_EXISTS','Check-unique-name','findIndex','min','user','validate','6804520Hgvycr','call','ASC','279357wLJZTp','117399UMVsII','companyId','findOne','322911Lklucz','__importStar','sequelize','asc','test','ERR_QUEUE_INVALID_COLOR','get','string','__esModule','chatbots','all','destroy','../../models/User','defineProperty','2037UhfFTC','default','./ShowQueueService','shape','create','map','390QTbzBQ','object','677038jIDdXE','configurable','__importDefault','2903565NXXsLB','update','__createBinding','3096DdzKhi','Check-color','writable','ERR_QUEUE_INVALID_NAME','ERR_QUEUE_COLOR_ALREADY_EXISTS','12TnXhtE','required','getOwnPropertyDescriptor','message','reload','../../models/Queue'];a549_0xc365=function(){return _0x35bc23;};return a549_0xc365();}