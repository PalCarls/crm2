'use strict';const a542_0x4949d7=a542_0x5753;(function(_0x151f87,_0x16fbd2){const _0x5e404c=a542_0x5753,_0x48490c=_0x151f87();while(!![]){try{const _0x2b1a31=-parseInt(_0x5e404c(0x146))/0x1*(parseInt(_0x5e404c(0x14e))/0x2)+parseInt(_0x5e404c(0x11e))/0x3*(parseInt(_0x5e404c(0x13a))/0x4)+-parseInt(_0x5e404c(0x128))/0x5+-parseInt(_0x5e404c(0x14c))/0x6+-parseInt(_0x5e404c(0x151))/0x7*(parseInt(_0x5e404c(0x127))/0x8)+-parseInt(_0x5e404c(0x13d))/0x9+-parseInt(_0x5e404c(0x13b))/0xa*(-parseInt(_0x5e404c(0x139))/0xb);if(_0x2b1a31===_0x16fbd2)break;else _0x48490c['push'](_0x48490c['shift']());}catch(_0x498c73){_0x48490c['push'](_0x48490c['shift']());}}}(a542_0x314c,0x28eef));var __createBinding=this&&this[a542_0x4949d7(0x131)]||(Object[a542_0x4949d7(0x130)]?function(_0x67d414,_0xfb582b,_0x566eca,_0x14bbff){const _0x23f0aa=a542_0x4949d7;if(_0x14bbff===undefined)_0x14bbff=_0x566eca;var _0x2105a5=Object[_0x23f0aa(0x11d)](_0xfb582b,_0x566eca);(!_0x2105a5||(_0x23f0aa(0x12b)in _0x2105a5?!_0xfb582b[_0x23f0aa(0x12a)]:_0x2105a5[_0x23f0aa(0x13c)]||_0x2105a5['configurable']))&&(_0x2105a5={'enumerable':!![],'get':function(){return _0xfb582b[_0x566eca];}}),Object['defineProperty'](_0x67d414,_0x14bbff,_0x2105a5);}:function(_0x51978a,_0x1c0dda,_0x35f10f,_0x516118){if(_0x516118===undefined)_0x516118=_0x35f10f;_0x51978a[_0x516118]=_0x1c0dda[_0x35f10f];}),__setModuleDefault=this&&this[a542_0x4949d7(0x13e)]||(Object[a542_0x4949d7(0x130)]?function(_0xd70151,_0x35ccfb){const _0x282388=a542_0x4949d7;Object[_0x282388(0x11c)](_0xd70151,_0x282388(0x134),{'enumerable':!![],'value':_0x35ccfb});}:function(_0x5cf66a,_0xa6873b){_0x5cf66a['default']=_0xa6873b;}),__importStar=this&&this[a542_0x4949d7(0x148)]||function(_0x43d55a){const _0x931497=a542_0x4949d7;if(_0x43d55a&&_0x43d55a[_0x931497(0x12a)])return _0x43d55a;var _0x43bf01={};if(_0x43d55a!=null){for(var _0xe73e76 in _0x43d55a)if(_0xe73e76!==_0x931497(0x134)&&Object[_0x931497(0x14a)]['hasOwnProperty'][_0x931497(0x13f)](_0x43d55a,_0xe73e76))__createBinding(_0x43bf01,_0x43d55a,_0xe73e76);}return __setModuleDefault(_0x43bf01,_0x43d55a),_0x43bf01;},__importDefault=this&&this[a542_0x4949d7(0x135)]||function(_0x516ffb){const _0x4ae450=a542_0x4949d7;return _0x516ffb&&_0x516ffb[_0x4ae450(0x12a)]?_0x516ffb:{'default':_0x516ffb};};function a542_0x5753(_0x39c3b0,_0x2e202d){const _0x314cb9=a542_0x314c();return a542_0x5753=function(_0x5753d3,_0x3f0c47){_0x5753d3=_0x5753d3-0x11c;let _0x527355=_0x314cb9[_0x5753d3];return _0x527355;},a542_0x5753(_0x39c3b0,_0x2e202d);}Object[a542_0x4949d7(0x11c)](exports,'__esModule',{'value':!![]});function a542_0x314c(){const _0x4af985=['yup','ERR_QUEUE_INVALID_COLOR','203869FbGfNF','findIndex','__importStar','asc','prototype','update','1680564muClLo','required','2DncLfg','sequelize','reload','2203649hLqBNq','defineProperty','getOwnPropertyDescriptor','3BEkVbf','../../models/Chatbot','all','findOne','message','ERR_QUEUE_INVALID_NAME','../../errors/AppError','validate','ASC','8buXqZm','52505OBKjPy','object','__esModule','get','map','min','test','ERR_QUEUE_NAME_ALREADY_EXISTS','create','__createBinding','../../models/User','chatbots','default','__importDefault','upsert','string','../../models/Queue','1111DWozmU','732396EUjkqO','109640ENYMPE','writable','2821761LIjcrX','__setModuleDefault','call','Check-color','Não\x20é\x20permitido\x20alterar\x20registros\x20de\x20outra\x20empresa','Check-color-exists','Check-unique-name'];a542_0x314c=function(){return _0x4af985;};return a542_0x314c();}const sequelize_1=require(a542_0x4949d7(0x14f)),Yup=__importStar(require(a542_0x4949d7(0x144))),AppError_1=__importDefault(require(a542_0x4949d7(0x124))),Chatbot_1=__importDefault(require(a542_0x4949d7(0x11f))),Queue_1=__importDefault(require(a542_0x4949d7(0x138))),ShowQueueService_1=__importDefault(require('./ShowQueueService')),User_1=__importDefault(require(a542_0x4949d7(0x132))),UpdateQueueService=async(_0x3e9720,_0x40362e,_0x56de68)=>{const _0x4339ca=a542_0x4949d7,{color:_0x82bb73,name:_0x410e7d,chatbots:_0x1175ee}=_0x40362e,_0x1e6eb3=Yup[_0x4339ca(0x129)]()['shape']({'name':Yup[_0x4339ca(0x137)]()[_0x4339ca(0x12d)](0x2,_0x4339ca(0x123))[_0x4339ca(0x12e)](_0x4339ca(0x143),_0x4339ca(0x12f),async _0x5aec16=>{const _0x2da129=_0x4339ca;if(_0x5aec16){const _0x2bedbe=await Queue_1[_0x2da129(0x134)][_0x2da129(0x121)]({'where':{'name':_0x5aec16,'id':{[sequelize_1['Op']['ne']]:_0x3e9720},'companyId':_0x56de68}});return!_0x2bedbe;}return!![];}),'color':Yup[_0x4339ca(0x137)]()[_0x4339ca(0x14d)](_0x4339ca(0x145))['test'](_0x4339ca(0x140),_0x4339ca(0x145),async _0x5ec9f5=>{const _0x487355=_0x4339ca;if(_0x5ec9f5){const _0x380c20=/^#[0-9a-f]{3,6}$/i;return _0x380c20[_0x487355(0x12e)](_0x5ec9f5);}return!![];})[_0x4339ca(0x12e)](_0x4339ca(0x142),'ERR_QUEUE_COLOR_ALREADY_EXISTS',async _0x3d117c=>{const _0x102a80=_0x4339ca;if(_0x3d117c){const _0x182d43=await Queue_1[_0x102a80(0x134)]['findOne']({'where':{'color':_0x3d117c,'id':{[sequelize_1['Op']['ne']]:_0x3e9720},'companyId':_0x56de68}});return!_0x182d43;}return!![];})});try{await _0x1e6eb3[_0x4339ca(0x125)]({'color':_0x82bb73,'name':_0x410e7d});}catch(_0x28bd9c){throw new AppError_1['default'](_0x28bd9c[_0x4339ca(0x122)]);}const _0x2a5fb3=await(0x0,ShowQueueService_1[_0x4339ca(0x134)])(_0x3e9720,_0x56de68);if(_0x2a5fb3['companyId']!==_0x56de68)throw new AppError_1[(_0x4339ca(0x134))](_0x4339ca(0x141));return _0x1175ee&&(await Promise[_0x4339ca(0x120)](_0x1175ee['map'](async _0x2b7744=>{const _0xafd149=_0x4339ca;await Chatbot_1[_0xafd149(0x134)][_0xafd149(0x136)]({..._0x2b7744,'queueId':_0x2a5fb3['id']});})),await Promise['all'](_0x2a5fb3[_0x4339ca(0x133)][_0x4339ca(0x12c)](async _0x96594=>{const _0x282066=_0x4339ca,_0x5a6f22=_0x1175ee[_0x282066(0x147)](_0x2c7900=>_0x2c7900['id']===_0x96594['id']);_0x5a6f22===-0x1&&await Chatbot_1[_0x282066(0x134)]['destroy']({'where':{'id':_0x96594['id']}});}))),await _0x2a5fb3[_0x4339ca(0x14b)](_0x40362e),await _0x2a5fb3[_0x4339ca(0x150)]({'include':[{'model':Chatbot_1[_0x4339ca(0x134)],'as':_0x4339ca(0x133),'include':[{'model':User_1[_0x4339ca(0x134)],'as':'user'}],'order':[[{'model':Chatbot_1[_0x4339ca(0x134)],'as':_0x4339ca(0x133)},'id',_0x4339ca(0x149)],['id',_0x4339ca(0x126)]]}],'order':[[{'model':Chatbot_1['default'],'as':'chatbots'},'id',_0x4339ca(0x149)],['id','ASC']]}),_0x2a5fb3;};exports[a542_0x4949d7(0x134)]=UpdateQueueService;