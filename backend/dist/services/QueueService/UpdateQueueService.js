'use strict';const a482_0x3d125d=a482_0x26bd;(function(_0x46f85b,_0x3af4ef){const _0x51e699=a482_0x26bd,_0x315f74=_0x46f85b();while(!![]){try{const _0x26689f=-parseInt(_0x51e699(0xf5))/0x1*(-parseInt(_0x51e699(0x105))/0x2)+-parseInt(_0x51e699(0xef))/0x3*(-parseInt(_0x51e699(0x115))/0x4)+-parseInt(_0x51e699(0x113))/0x5+-parseInt(_0x51e699(0xfa))/0x6*(parseInt(_0x51e699(0xfb))/0x7)+parseInt(_0x51e699(0x110))/0x8+-parseInt(_0x51e699(0x112))/0x9+-parseInt(_0x51e699(0x102))/0xa;if(_0x26689f===_0x3af4ef)break;else _0x315f74['push'](_0x315f74['shift']());}catch(_0x411d44){_0x315f74['push'](_0x315f74['shift']());}}}(a482_0xe5f8,0x565fe));var __createBinding=this&&this[a482_0x3d125d(0xf6)]||(Object['create']?function(_0x5e499d,_0x2022ad,_0x563af2,_0x4a93d0){const _0x593179=a482_0x3d125d;if(_0x4a93d0===undefined)_0x4a93d0=_0x563af2;var _0x2d3cc3=Object[_0x593179(0x10a)](_0x2022ad,_0x563af2);(!_0x2d3cc3||(_0x593179(0x103)in _0x2d3cc3?!_0x2022ad[_0x593179(0xf7)]:_0x2d3cc3['writable']||_0x2d3cc3[_0x593179(0x108)]))&&(_0x2d3cc3={'enumerable':!![],'get':function(){return _0x2022ad[_0x563af2];}}),Object[_0x593179(0x106)](_0x5e499d,_0x4a93d0,_0x2d3cc3);}:function(_0x43618d,_0x17a617,_0x2718ba,_0x3222f7){if(_0x3222f7===undefined)_0x3222f7=_0x2718ba;_0x43618d[_0x3222f7]=_0x17a617[_0x2718ba];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x59e13f,_0x5e770f){const _0x237f5d=a482_0x3d125d;Object[_0x237f5d(0x106)](_0x59e13f,_0x237f5d(0xf4),{'enumerable':!![],'value':_0x5e770f});}:function(_0x1abcb9,_0x57d4ab){const _0x1415ef=a482_0x3d125d;_0x1abcb9[_0x1415ef(0xf4)]=_0x57d4ab;}),__importStar=this&&this[a482_0x3d125d(0xf3)]||function(_0x48bb6b){const _0x348559=a482_0x3d125d;if(_0x48bb6b&&_0x48bb6b[_0x348559(0xf7)])return _0x48bb6b;var _0x232723={};if(_0x48bb6b!=null){for(var _0x25a169 in _0x48bb6b)if(_0x25a169!=='default'&&Object['prototype']['hasOwnProperty'][_0x348559(0x114)](_0x48bb6b,_0x25a169))__createBinding(_0x232723,_0x48bb6b,_0x25a169);}return __setModuleDefault(_0x232723,_0x48bb6b),_0x232723;},__importDefault=this&&this['__importDefault']||function(_0x1175d9){const _0x2db59e=a482_0x3d125d;return _0x1175d9&&_0x1175d9[_0x2db59e(0xf7)]?_0x1175d9:{'default':_0x1175d9};};function a482_0xe5f8(){const _0x2c60ea=['defineProperty','all','configurable','Check-unique-name','getOwnPropertyDescriptor','greetingMessage','Não\x20é\x20permitido\x20alterar\x20registros\x20de\x20outra\x20empresa','ERR_QUEUE_INVALID_COLOR','findIndex','../../errors/AppError','5204664QUBFOC','message','2438712tlrfas','1065270GeIiQT','call','28JAibir','object','upsert','reload','map','ERR_QUEUE_COLOR_ALREADY_EXISTS','chatbots','sequelize','asc','252051ZcDZzn','../../models/Queue','companyId','shape','__importStar','default','178tTnmaH','__createBinding','__esModule','name','min','636RXSjoR','20342wmXLZY','yup','required','validate','string','findOne','ASC','2911460hjoCvx','get','test','2228qOxadM'];a482_0xe5f8=function(){return _0x2c60ea;};return a482_0xe5f8();}Object['defineProperty'](exports,a482_0x3d125d(0xf7),{'value':!![]});function a482_0x26bd(_0x3b335c,_0x2e73fb){const _0xe5f8bb=a482_0xe5f8();return a482_0x26bd=function(_0x26bdda,_0x17041d){_0x26bdda=_0x26bdda-0xec;let _0x380b25=_0xe5f8bb[_0x26bdda];return _0x380b25;},a482_0x26bd(_0x3b335c,_0x2e73fb);}const sequelize_1=require(a482_0x3d125d(0xed)),Yup=__importStar(require(a482_0x3d125d(0xfc))),AppError_1=__importDefault(require(a482_0x3d125d(0x10f))),Chatbot_1=__importDefault(require('../../models/Chatbot')),Queue_1=__importDefault(require(a482_0x3d125d(0xf0))),ShowQueueService_1=__importDefault(require('./ShowQueueService')),UpdateQueueService=async(_0x4ebfbc,_0x30c5a6,_0x19a44b)=>{const _0x302246=a482_0x3d125d,{color:_0x1d51a1,name:_0x110a40,chatbots:_0x11dc27,ativarRoteador:_0x1ba507,tempoRoteador:_0x49828a}=_0x30c5a6,_0xd509e=Yup[_0x302246(0x116)]()[_0x302246(0xf2)]({'name':Yup['string']()[_0x302246(0xf9)](0x2,'ERR_QUEUE_INVALID_NAME')[_0x302246(0x104)](_0x302246(0x109),'ERR_QUEUE_NAME_ALREADY_EXISTS',async _0x678b21=>{const _0x1e9eed=_0x302246;if(_0x678b21){const _0x4a1c30=await Queue_1[_0x1e9eed(0xf4)][_0x1e9eed(0x100)]({'where':{'name':_0x678b21,'id':{[sequelize_1['Op']['ne']]:_0x4ebfbc},'companyId':_0x19a44b}});return!_0x4a1c30;}return!![];}),'color':Yup[_0x302246(0xff)]()[_0x302246(0xfd)]('ERR_QUEUE_INVALID_COLOR')[_0x302246(0x104)]('Check-color',_0x302246(0x10d),async _0x3a7418=>{const _0x4515c2=_0x302246;if(_0x3a7418){const _0x7574ab=/^#[0-9a-f]{3,6}$/i;return _0x7574ab[_0x4515c2(0x104)](_0x3a7418);}return!![];})[_0x302246(0x104)]('Check-color-exists',_0x302246(0x11a),async _0x12e0da=>{const _0x36be07=_0x302246;if(_0x12e0da){const _0x369984=await Queue_1[_0x36be07(0xf4)][_0x36be07(0x100)]({'where':{'color':_0x12e0da,'id':{[sequelize_1['Op']['ne']]:_0x4ebfbc},'companyId':_0x19a44b}});return!_0x369984;}return!![];})});try{await _0xd509e[_0x302246(0xfe)]({'color':_0x1d51a1,'name':_0x110a40});}catch(_0x4919ec){throw new AppError_1['default'](_0x4919ec[_0x302246(0x111)]);}const _0x5a9fed=await(0x0,ShowQueueService_1[_0x302246(0xf4)])(_0x4ebfbc,_0x19a44b);if(_0x5a9fed[_0x302246(0xf1)]!==_0x19a44b)throw new AppError_1[(_0x302246(0xf4))](_0x302246(0x10c));return _0x11dc27&&(await Promise[_0x302246(0x107)](_0x11dc27[_0x302246(0x119)](async _0xa03ac5=>{const _0x43ca48=_0x302246;await Chatbot_1[_0x43ca48(0xf4)][_0x43ca48(0x117)]({..._0xa03ac5,'queueId':_0x5a9fed['id']});})),await Promise[_0x302246(0x107)](_0x5a9fed[_0x302246(0xec)][_0x302246(0x119)](async _0x205727=>{const _0x41e3cb=_0x302246,_0x5b34ef=_0x11dc27[_0x41e3cb(0x10e)](_0x25a49d=>_0x25a49d['id']===_0x205727['id']);_0x5b34ef===-0x1&&await Chatbot_1[_0x41e3cb(0xf4)]['destroy']({'where':{'id':_0x205727['id']}});}))),await _0x5a9fed['update'](_0x30c5a6),await _0x5a9fed[_0x302246(0x118)]({'attributes':['id','color',_0x302246(0xf8),_0x302246(0x10b),'schedules'],'include':[{'model':Chatbot_1[_0x302246(0xf4)],'as':_0x302246(0xec),'order':[[{'model':Chatbot_1[_0x302246(0xf4)],'as':_0x302246(0xec)},'id',_0x302246(0xee)],['id',_0x302246(0x101)]]}],'order':[[{'model':Chatbot_1['default'],'as':_0x302246(0xec)},'id',_0x302246(0xee)],['id',_0x302246(0x101)]]}),_0x5a9fed;};exports[a482_0x3d125d(0xf4)]=UpdateQueueService;