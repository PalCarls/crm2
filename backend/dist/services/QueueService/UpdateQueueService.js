'use strict';function a497_0x1c0d(){const _0x30c660=['Check-color','__setModuleDefault','hasOwnProperty','1117518xHSQBl','24AsALzo','shape','__createBinding','create','min','findOne','call','ERR_QUEUE_INVALID_NAME','16461610OhaYho','greetingMessage','213863YilXEu','6802720lxBeoL','yup','2oOApqp','426830LTxyPL','../../errors/AppError','ERR_QUEUE_INVALID_COLOR','defineProperty','validate','map','ASC','findIndex','getOwnPropertyDescriptor','schedules','default','prototype','name','__importDefault','test','Não\x20é\x20permitido\x20alterar\x20registros\x20de\x20outra\x20empresa','reload','destroy','get','Check-color-exists','../../models/Queue','string','asc','configurable','companyId','../../models/Chatbot','message','Check-unique-name','14ndCBhz','1896570uhqrzC','writable','189627bBhBkT','chatbots','ERR_QUEUE_COLOR_ALREADY_EXISTS','object','__esModule','required','__importStar','update'];a497_0x1c0d=function(){return _0x30c660;};return a497_0x1c0d();}function a497_0x465c(_0x165594,_0x5daed5){const _0x1c0df3=a497_0x1c0d();return a497_0x465c=function(_0x465ce4,_0x1287af){_0x465ce4=_0x465ce4-0x9f;let _0x219abf=_0x1c0df3[_0x465ce4];return _0x219abf;},a497_0x465c(_0x165594,_0x5daed5);}const a497_0x5976ea=a497_0x465c;(function(_0x5d3174,_0x2c62c4){const _0x141790=a497_0x465c,_0x4c6534=_0x5d3174();while(!![]){try{const _0x40ad3e=parseInt(_0x141790(0xcb))/0x1*(parseInt(_0x141790(0xce))/0x2)+-parseInt(_0x141790(0xb5))/0x3+parseInt(_0x141790(0xc1))/0x4*(parseInt(_0x141790(0xcf))/0x5)+-parseInt(_0x141790(0xc0))/0x6*(-parseInt(_0x141790(0xb2))/0x7)+parseInt(_0x141790(0xcc))/0x8+parseInt(_0x141790(0xb3))/0x9+-parseInt(_0x141790(0xc9))/0xa;if(_0x40ad3e===_0x2c62c4)break;else _0x4c6534['push'](_0x4c6534['shift']());}catch(_0x5e5bdd){_0x4c6534['push'](_0x4c6534['shift']());}}}(a497_0x1c0d,0x6ded9));var __createBinding=this&&this[a497_0x5976ea(0xc3)]||(Object['create']?function(_0x536f7c,_0x5c3238,_0xe3cb4d,_0x20634b){const _0x35c332=a497_0x5976ea;if(_0x20634b===undefined)_0x20634b=_0xe3cb4d;var _0x15dd32=Object[_0x35c332(0xd7)](_0x5c3238,_0xe3cb4d);(!_0x15dd32||(_0x35c332(0xa8)in _0x15dd32?!_0x5c3238['__esModule']:_0x15dd32[_0x35c332(0xb4)]||_0x15dd32[_0x35c332(0xad)]))&&(_0x15dd32={'enumerable':!![],'get':function(){return _0x5c3238[_0xe3cb4d];}}),Object[_0x35c332(0xd2)](_0x536f7c,_0x20634b,_0x15dd32);}:function(_0x4d1a09,_0x23d484,_0x3db5aa,_0x6ce4b){if(_0x6ce4b===undefined)_0x6ce4b=_0x3db5aa;_0x4d1a09[_0x6ce4b]=_0x23d484[_0x3db5aa];}),__setModuleDefault=this&&this[a497_0x5976ea(0xbe)]||(Object[a497_0x5976ea(0xc4)]?function(_0x383f83,_0xfb5e18){const _0x46a352=a497_0x5976ea;Object['defineProperty'](_0x383f83,_0x46a352(0xa0),{'enumerable':!![],'value':_0xfb5e18});}:function(_0x464bad,_0x87899a){const _0x1978e0=a497_0x5976ea;_0x464bad[_0x1978e0(0xa0)]=_0x87899a;}),__importStar=this&&this[a497_0x5976ea(0xbb)]||function(_0x217f45){const _0x293e4a=a497_0x5976ea;if(_0x217f45&&_0x217f45[_0x293e4a(0xb9)])return _0x217f45;var _0x390ae9={};if(_0x217f45!=null){for(var _0x2554b5 in _0x217f45)if(_0x2554b5!==_0x293e4a(0xa0)&&Object[_0x293e4a(0xa1)][_0x293e4a(0xbf)][_0x293e4a(0xc7)](_0x217f45,_0x2554b5))__createBinding(_0x390ae9,_0x217f45,_0x2554b5);}return __setModuleDefault(_0x390ae9,_0x217f45),_0x390ae9;},__importDefault=this&&this[a497_0x5976ea(0xa3)]||function(_0x356094){const _0x5c790c=a497_0x5976ea;return _0x356094&&_0x356094[_0x5c790c(0xb9)]?_0x356094:{'default':_0x356094};};Object[a497_0x5976ea(0xd2)](exports,a497_0x5976ea(0xb9),{'value':!![]});const sequelize_1=require('sequelize'),Yup=__importStar(require(a497_0x5976ea(0xcd))),AppError_1=__importDefault(require(a497_0x5976ea(0xd0))),Chatbot_1=__importDefault(require(a497_0x5976ea(0xaf))),Queue_1=__importDefault(require(a497_0x5976ea(0xaa))),ShowQueueService_1=__importDefault(require('./ShowQueueService')),UpdateQueueService=async(_0x24cce9,_0x2a7dcd,_0x2a79a6)=>{const _0x114d34=a497_0x5976ea,{color:_0x23b3e6,name:_0x2caf79,chatbots:_0x12468c,ativarRoteador:_0x5ddcbd,tempoRoteador:_0x25c487}=_0x2a7dcd,_0x1362f9=Yup[_0x114d34(0xb8)]()[_0x114d34(0xc2)]({'name':Yup['string']()[_0x114d34(0xc5)](0x2,_0x114d34(0xc8))[_0x114d34(0xa4)](_0x114d34(0xb1),'ERR_QUEUE_NAME_ALREADY_EXISTS',async _0x41aed4=>{const _0x596448=_0x114d34;if(_0x41aed4){const _0x4b13cb=await Queue_1[_0x596448(0xa0)][_0x596448(0xc6)]({'where':{'name':_0x41aed4,'id':{[sequelize_1['Op']['ne']]:_0x24cce9},'companyId':_0x2a79a6}});return!_0x4b13cb;}return!![];}),'color':Yup[_0x114d34(0xab)]()[_0x114d34(0xba)](_0x114d34(0xd1))[_0x114d34(0xa4)](_0x114d34(0xbd),_0x114d34(0xd1),async _0x27a23e=>{if(_0x27a23e){const _0x357419=/^#[0-9a-f]{3,6}$/i;return _0x357419['test'](_0x27a23e);}return!![];})[_0x114d34(0xa4)](_0x114d34(0xa9),_0x114d34(0xb7),async _0x8a3461=>{const _0x423d59=_0x114d34;if(_0x8a3461){const _0x3a5792=await Queue_1[_0x423d59(0xa0)][_0x423d59(0xc6)]({'where':{'color':_0x8a3461,'id':{[sequelize_1['Op']['ne']]:_0x24cce9},'companyId':_0x2a79a6}});return!_0x3a5792;}return!![];})});try{await _0x1362f9[_0x114d34(0xd3)]({'color':_0x23b3e6,'name':_0x2caf79});}catch(_0x26b24a){throw new AppError_1[(_0x114d34(0xa0))](_0x26b24a[_0x114d34(0xb0)]);}const _0x3df02e=await(0x0,ShowQueueService_1[_0x114d34(0xa0)])(_0x24cce9,_0x2a79a6);if(_0x3df02e[_0x114d34(0xae)]!==_0x2a79a6)throw new AppError_1['default'](_0x114d34(0xa5));return _0x12468c&&(await Promise['all'](_0x12468c['map'](async _0x38890b=>{const _0x106fe3=_0x114d34;await Chatbot_1[_0x106fe3(0xa0)]['upsert']({..._0x38890b,'queueId':_0x3df02e['id']});})),await Promise['all'](_0x3df02e[_0x114d34(0xb6)][_0x114d34(0xd4)](async _0x358dbd=>{const _0x5ab531=_0x114d34,_0x21383f=_0x12468c[_0x5ab531(0xd6)](_0x1525bc=>_0x1525bc['id']===_0x358dbd['id']);_0x21383f===-0x1&&await Chatbot_1[_0x5ab531(0xa0)][_0x5ab531(0xa7)]({'where':{'id':_0x358dbd['id']}});}))),await _0x3df02e[_0x114d34(0xbc)](_0x2a7dcd),await _0x3df02e[_0x114d34(0xa6)]({'attributes':['id','color',_0x114d34(0xa2),_0x114d34(0xca),_0x114d34(0x9f)],'include':[{'model':Chatbot_1[_0x114d34(0xa0)],'as':_0x114d34(0xb6),'order':[[{'model':Chatbot_1[_0x114d34(0xa0)],'as':_0x114d34(0xb6)},'id',_0x114d34(0xac)],['id',_0x114d34(0xd5)]]}],'order':[[{'model':Chatbot_1['default'],'as':_0x114d34(0xb6)},'id',_0x114d34(0xac)],['id',_0x114d34(0xd5)]]}),_0x3df02e;};exports[a497_0x5976ea(0xa0)]=UpdateQueueService;