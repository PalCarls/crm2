'use strict';const a542_0x2dab89=a542_0x5bf7;(function(_0x12a334,_0x35674a){const _0x275e94=a542_0x5bf7,_0x2d357f=_0x12a334();while(!![]){try{const _0x463f36=parseInt(_0x275e94(0xca))/0x1+parseInt(_0x275e94(0xc9))/0x2*(parseInt(_0x275e94(0xe6))/0x3)+-parseInt(_0x275e94(0xeb))/0x4*(-parseInt(_0x275e94(0xcf))/0x5)+-parseInt(_0x275e94(0xe7))/0x6+-parseInt(_0x275e94(0xe8))/0x7*(-parseInt(_0x275e94(0xcc))/0x8)+parseInt(_0x275e94(0xe9))/0x9*(parseInt(_0x275e94(0xf1))/0xa)+-parseInt(_0x275e94(0xc8))/0xb;if(_0x463f36===_0x35674a)break;else _0x2d357f['push'](_0x2d357f['shift']());}catch(_0x174f61){_0x2d357f['push'](_0x2d357f['shift']());}}}(a542_0x1ed4,0x1ed6e));var __createBinding=this&&this['__createBinding']||(Object[a542_0x2dab89(0xd8)]?function(_0x33fcf3,_0x2803b0,_0x226e3e,_0x15b953){const _0x13f2e3=a542_0x2dab89;if(_0x15b953===undefined)_0x15b953=_0x226e3e;var _0x10673c=Object[_0x13f2e3(0xd6)](_0x2803b0,_0x226e3e);(!_0x10673c||(_0x13f2e3(0xd7)in _0x10673c?!_0x2803b0['__esModule']:_0x10673c['writable']||_0x10673c['configurable']))&&(_0x10673c={'enumerable':!![],'get':function(){return _0x2803b0[_0x226e3e];}}),Object[_0x13f2e3(0xd9)](_0x33fcf3,_0x15b953,_0x10673c);}:function(_0x3b0b20,_0x2f3899,_0x340d36,_0x92443a){if(_0x92443a===undefined)_0x92443a=_0x340d36;_0x3b0b20[_0x92443a]=_0x2f3899[_0x340d36];}),__setModuleDefault=this&&this[a542_0x2dab89(0xe0)]||(Object[a542_0x2dab89(0xd8)]?function(_0x5b78a1,_0x5df7f0){Object['defineProperty'](_0x5b78a1,'default',{'enumerable':!![],'value':_0x5df7f0});}:function(_0x3da44d,_0x335e8b){const _0xad28a9=a542_0x2dab89;_0x3da44d[_0xad28a9(0xf2)]=_0x335e8b;}),__importStar=this&&this['__importStar']||function(_0x4935b1){const _0x51bf8f=a542_0x2dab89;if(_0x4935b1&&_0x4935b1[_0x51bf8f(0xe3)])return _0x4935b1;var _0x1d63dc={};if(_0x4935b1!=null){for(var _0x3a1520 in _0x4935b1)if(_0x3a1520!==_0x51bf8f(0xf2)&&Object['prototype']['hasOwnProperty'][_0x51bf8f(0xf6)](_0x4935b1,_0x3a1520))__createBinding(_0x1d63dc,_0x4935b1,_0x3a1520);}return __setModuleDefault(_0x1d63dc,_0x4935b1),_0x1d63dc;},__importDefault=this&&this[a542_0x2dab89(0xf3)]||function(_0x32ea84){const _0x58cb3d=a542_0x2dab89;return _0x32ea84&&_0x32ea84[_0x58cb3d(0xe3)]?_0x32ea84:{'default':_0x32ea84};};Object['defineProperty'](exports,a542_0x2dab89(0xe3),{'value':!![]});const sequelize_1=require(a542_0x2dab89(0xc7)),Yup=__importStar(require(a542_0x2dab89(0xce))),AppError_1=__importDefault(require(a542_0x2dab89(0xe1))),Chatbot_1=__importDefault(require('../../models/Chatbot')),Queue_1=__importDefault(require(a542_0x2dab89(0xe2))),ShowQueueService_1=__importDefault(require(a542_0x2dab89(0xdf))),User_1=__importDefault(require(a542_0x2dab89(0xcd))),UpdateQueueService=async(_0x1c6454,_0x344785,_0x12e389)=>{const _0x559a5c=a542_0x2dab89,{color:_0x5962e7,name:_0x30abdf,chatbots:_0x1d99ac}=_0x344785,_0x60b1a8=Yup[_0x559a5c(0xc5)]()[_0x559a5c(0xd2)]({'name':Yup[_0x559a5c(0xe5)]()[_0x559a5c(0xea)](0x2,_0x559a5c(0xde))[_0x559a5c(0xf0)](_0x559a5c(0xe4),_0x559a5c(0xd3),async _0x572882=>{const _0x26db86=_0x559a5c;if(_0x572882){const _0xf03b9f=await Queue_1[_0x26db86(0xf2)][_0x26db86(0xdd)]({'where':{'name':_0x572882,'id':{[sequelize_1['Op']['ne']]:_0x1c6454},'companyId':_0x12e389}});return!_0xf03b9f;}return!![];}),'color':Yup[_0x559a5c(0xe5)]()[_0x559a5c(0xf4)](_0x559a5c(0xd1))['test']('Check-color',_0x559a5c(0xd1),async _0xc9e38=>{const _0x3aff5a=_0x559a5c;if(_0xc9e38){const _0x183ac9=/^#[0-9a-f]{3,6}$/i;return _0x183ac9[_0x3aff5a(0xf0)](_0xc9e38);}return!![];})[_0x559a5c(0xf0)]('Check-color-exists',_0x559a5c(0xf5),async _0x20caf2=>{const _0x52337c=_0x559a5c;if(_0x20caf2){const _0x599077=await Queue_1[_0x52337c(0xf2)][_0x52337c(0xdd)]({'where':{'color':_0x20caf2,'id':{[sequelize_1['Op']['ne']]:_0x1c6454},'companyId':_0x12e389}});return!_0x599077;}return!![];})});try{await _0x60b1a8[_0x559a5c(0xd0)]({'color':_0x5962e7,'name':_0x30abdf});}catch(_0x1de0b3){throw new AppError_1[(_0x559a5c(0xf2))](_0x1de0b3[_0x559a5c(0xcb)]);}const _0x24254e=await(0x0,ShowQueueService_1['default'])(_0x1c6454,_0x12e389);if(_0x24254e['companyId']!==_0x12e389)throw new AppError_1[(_0x559a5c(0xf2))]('Não\x20é\x20permitido\x20alterar\x20registros\x20de\x20outra\x20empresa');return _0x1d99ac&&(await Promise[_0x559a5c(0xdc)](_0x1d99ac['map'](async _0x357082=>{const _0xc83470=_0x559a5c;await Chatbot_1['default'][_0xc83470(0xec)]({..._0x357082,'queueId':_0x24254e['id']});})),await Promise[_0x559a5c(0xdc)](_0x24254e[_0x559a5c(0xd5)][_0x559a5c(0xc6)](async _0x5a0d4f=>{const _0x4281d6=_0x559a5c,_0x25e175=_0x1d99ac[_0x4281d6(0xc4)](_0x27c738=>_0x27c738['id']===_0x5a0d4f['id']);_0x25e175===-0x1&&await Chatbot_1['default'][_0x4281d6(0xd4)]({'where':{'id':_0x5a0d4f['id']}});}))),await _0x24254e[_0x559a5c(0xdb)](_0x344785),await _0x24254e[_0x559a5c(0xda)]({'include':[{'model':Chatbot_1[_0x559a5c(0xf2)],'as':_0x559a5c(0xd5),'include':[{'model':User_1[_0x559a5c(0xf2)],'as':_0x559a5c(0xed)}],'order':[[{'model':Chatbot_1['default'],'as':_0x559a5c(0xd5)},'id',_0x559a5c(0xee)],['id',_0x559a5c(0xef)]]}],'order':[[{'model':Chatbot_1[_0x559a5c(0xf2)],'as':_0x559a5c(0xd5)},'id','asc'],['id','ASC']]}),_0x24254e;};function a542_0x5bf7(_0x2c067c,_0x2bd910){const _0x1ed475=a542_0x1ed4();return a542_0x5bf7=function(_0x5bf7fa,_0x2d0e70){_0x5bf7fa=_0x5bf7fa-0xc4;let _0x11de23=_0x1ed475[_0x5bf7fa];return _0x11de23;},a542_0x5bf7(_0x2c067c,_0x2bd910);}function a542_0x1ed4(){const _0x5f09eb=['./ShowQueueService','__setModuleDefault','../../errors/AppError','../../models/Queue','__esModule','Check-unique-name','string','4953kFZQhN','346692zOGKMd','7TsfggS','382338KEFapC','min','565992aMEQcQ','upsert','user','asc','ASC','test','30HQrQpp','default','__importDefault','required','ERR_QUEUE_COLOR_ALREADY_EXISTS','call','findIndex','object','map','sequelize','4456320hvhDRQ','134WvQeRF','27786PabFIA','message','1454984XBoFvv','../../models/User','yup','5cDRCek','validate','ERR_QUEUE_INVALID_COLOR','shape','ERR_QUEUE_NAME_ALREADY_EXISTS','destroy','chatbots','getOwnPropertyDescriptor','get','create','defineProperty','reload','update','all','findOne','ERR_QUEUE_INVALID_NAME'];a542_0x1ed4=function(){return _0x5f09eb;};return a542_0x1ed4();}exports[a542_0x2dab89(0xf2)]=UpdateQueueService;