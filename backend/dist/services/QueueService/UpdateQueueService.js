'use strict';const a482_0xa8ed3=a482_0x1a88;(function(_0x9e8695,_0x5975bd){const _0x406dfc=a482_0x1a88,_0x4fd505=_0x9e8695();while(!![]){try{const _0x244d10=-parseInt(_0x406dfc(0x102))/0x1+-parseInt(_0x406dfc(0xf5))/0x2*(parseInt(_0x406dfc(0xd1))/0x3)+parseInt(_0x406dfc(0xeb))/0x4+parseInt(_0x406dfc(0xe0))/0x5+parseInt(_0x406dfc(0x105))/0x6+parseInt(_0x406dfc(0xfc))/0x7*(-parseInt(_0x406dfc(0x108))/0x8)+parseInt(_0x406dfc(0xf3))/0x9*(parseInt(_0x406dfc(0xf7))/0xa);if(_0x244d10===_0x5975bd)break;else _0x4fd505['push'](_0x4fd505['shift']());}catch(_0x466686){_0x4fd505['push'](_0x4fd505['shift']());}}}(a482_0x188f,0xdf00d));function a482_0x188f(){const _0x158239=['49293WjONBJ','update','58PsEiEj','string','280rSDtVx','__setModuleDefault','__esModule','map','shape','10439905GhHWTZ','reload','object','min','../../errors/AppError','call','371709UFpMGs','default','companyId','4025994UxMmXS','greetingMessage','chatbots','8VJfBtZ','getOwnPropertyDescriptor','Check-unique-name','82947LWVRJZ','Check-color','./ShowQueueService','../../models/Queue','message','ERR_QUEUE_INVALID_COLOR','sequelize','defineProperty','validate','ERR_QUEUE_INVALID_NAME','__importDefault','__importStar','../../models/Chatbot','get','color','5693755XkOKax','create','required','Check-color-exists','ERR_QUEUE_COLOR_ALREADY_EXISTS','configurable','asc','ERR_QUEUE_NAME_ALREADY_EXISTS','findIndex','destroy','hasOwnProperty','6461040klMadz','findOne','upsert','test','ASC','Não\x20é\x20permitido\x20alterar\x20registros\x20de\x20outra\x20empresa','yup','all'];a482_0x188f=function(){return _0x158239;};return a482_0x188f();}function a482_0x1a88(_0x4f4b00,_0x4d6513){const _0x188f00=a482_0x188f();return a482_0x1a88=function(_0x1a8813,_0x4b6f6b){_0x1a8813=_0x1a8813-0xcf;let _0x30297e=_0x188f00[_0x1a8813];return _0x30297e;},a482_0x1a88(_0x4f4b00,_0x4d6513);}var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x3e5fae,_0x3e015c,_0x19cf75,_0x45dc06){const _0x596c4e=a482_0x1a88;if(_0x45dc06===undefined)_0x45dc06=_0x19cf75;var _0x4ac322=Object[_0x596c4e(0xcf)](_0x3e015c,_0x19cf75);(!_0x4ac322||(_0x596c4e(0xde)in _0x4ac322?!_0x3e015c[_0x596c4e(0xf9)]:_0x4ac322['writable']||_0x4ac322[_0x596c4e(0xe5)]))&&(_0x4ac322={'enumerable':!![],'get':function(){return _0x3e015c[_0x19cf75];}}),Object['defineProperty'](_0x3e5fae,_0x45dc06,_0x4ac322);}:function(_0x379247,_0x37daa,_0x492581,_0x3461ff){if(_0x3461ff===undefined)_0x3461ff=_0x492581;_0x379247[_0x3461ff]=_0x37daa[_0x492581];}),__setModuleDefault=this&&this[a482_0xa8ed3(0xf8)]||(Object[a482_0xa8ed3(0xe1)]?function(_0x179e56,_0x4e8278){const _0xdc15ff=a482_0xa8ed3;Object[_0xdc15ff(0xd8)](_0x179e56,'default',{'enumerable':!![],'value':_0x4e8278});}:function(_0x43ada8,_0x1859de){const _0x5a7aff=a482_0xa8ed3;_0x43ada8[_0x5a7aff(0x103)]=_0x1859de;}),__importStar=this&&this[a482_0xa8ed3(0xdc)]||function(_0x5bf7c6){const _0x4fdaf6=a482_0xa8ed3;if(_0x5bf7c6&&_0x5bf7c6[_0x4fdaf6(0xf9)])return _0x5bf7c6;var _0xa48c8c={};if(_0x5bf7c6!=null){for(var _0x11a29d in _0x5bf7c6)if(_0x11a29d!==_0x4fdaf6(0x103)&&Object['prototype'][_0x4fdaf6(0xea)][_0x4fdaf6(0x101)](_0x5bf7c6,_0x11a29d))__createBinding(_0xa48c8c,_0x5bf7c6,_0x11a29d);}return __setModuleDefault(_0xa48c8c,_0x5bf7c6),_0xa48c8c;},__importDefault=this&&this[a482_0xa8ed3(0xdb)]||function(_0x542bca){const _0x1ebf3a=a482_0xa8ed3;return _0x542bca&&_0x542bca[_0x1ebf3a(0xf9)]?_0x542bca:{'default':_0x542bca};};Object[a482_0xa8ed3(0xd8)](exports,a482_0xa8ed3(0xf9),{'value':!![]});const sequelize_1=require(a482_0xa8ed3(0xd7)),Yup=__importStar(require(a482_0xa8ed3(0xf1))),AppError_1=__importDefault(require(a482_0xa8ed3(0x100))),Chatbot_1=__importDefault(require(a482_0xa8ed3(0xdd))),Queue_1=__importDefault(require(a482_0xa8ed3(0xd4))),ShowQueueService_1=__importDefault(require(a482_0xa8ed3(0xd3))),UpdateQueueService=async(_0x1d808e,_0x134088,_0x48a3fd)=>{const _0x11d631=a482_0xa8ed3,{color:_0x4c4cd2,name:_0x2241ce,chatbots:_0x2c6d15,ativarRoteador:_0x323288,tempoRoteador:_0x44df92}=_0x134088,_0x4bac7f=Yup[_0x11d631(0xfe)]()[_0x11d631(0xfb)]({'name':Yup[_0x11d631(0xf6)]()[_0x11d631(0xff)](0x2,_0x11d631(0xda))['test'](_0x11d631(0xd0),_0x11d631(0xe7),async _0x1d35c3=>{const _0x24198e=_0x11d631;if(_0x1d35c3){const _0x21e9e8=await Queue_1[_0x24198e(0x103)][_0x24198e(0xec)]({'where':{'name':_0x1d35c3,'id':{[sequelize_1['Op']['ne']]:_0x1d808e},'companyId':_0x48a3fd}});return!_0x21e9e8;}return!![];}),'color':Yup[_0x11d631(0xf6)]()[_0x11d631(0xe2)]('ERR_QUEUE_INVALID_COLOR')[_0x11d631(0xee)](_0x11d631(0xd2),_0x11d631(0xd6),async _0x5bed86=>{const _0x22504a=_0x11d631;if(_0x5bed86){const _0x24815a=/^#[0-9a-f]{3,6}$/i;return _0x24815a[_0x22504a(0xee)](_0x5bed86);}return!![];})[_0x11d631(0xee)](_0x11d631(0xe3),_0x11d631(0xe4),async _0x28e961=>{const _0x17fa36=_0x11d631;if(_0x28e961){const _0x1a451f=await Queue_1[_0x17fa36(0x103)][_0x17fa36(0xec)]({'where':{'color':_0x28e961,'id':{[sequelize_1['Op']['ne']]:_0x1d808e},'companyId':_0x48a3fd}});return!_0x1a451f;}return!![];})});try{await _0x4bac7f[_0x11d631(0xd9)]({'color':_0x4c4cd2,'name':_0x2241ce});}catch(_0x394678){throw new AppError_1[(_0x11d631(0x103))](_0x394678[_0x11d631(0xd5)]);}const _0x35d76a=await(0x0,ShowQueueService_1['default'])(_0x1d808e,_0x48a3fd);if(_0x35d76a[_0x11d631(0x104)]!==_0x48a3fd)throw new AppError_1[(_0x11d631(0x103))](_0x11d631(0xf0));return _0x2c6d15&&(await Promise['all'](_0x2c6d15[_0x11d631(0xfa)](async _0x155f9a=>{const _0x47361e=_0x11d631;await Chatbot_1[_0x47361e(0x103)][_0x47361e(0xed)]({..._0x155f9a,'queueId':_0x35d76a['id']});})),await Promise[_0x11d631(0xf2)](_0x35d76a[_0x11d631(0x107)]['map'](async _0x227ea0=>{const _0x1ea728=_0x11d631,_0xa7fc1=_0x2c6d15[_0x1ea728(0xe8)](_0x3f52f4=>_0x3f52f4['id']===_0x227ea0['id']);_0xa7fc1===-0x1&&await Chatbot_1[_0x1ea728(0x103)][_0x1ea728(0xe9)]({'where':{'id':_0x227ea0['id']}});}))),await _0x35d76a[_0x11d631(0xf4)](_0x134088),await _0x35d76a[_0x11d631(0xfd)]({'attributes':['id',_0x11d631(0xdf),'name',_0x11d631(0x106),'schedules'],'include':[{'model':Chatbot_1[_0x11d631(0x103)],'as':_0x11d631(0x107),'order':[[{'model':Chatbot_1[_0x11d631(0x103)],'as':_0x11d631(0x107)},'id',_0x11d631(0xe6)],['id',_0x11d631(0xef)]]}],'order':[[{'model':Chatbot_1[_0x11d631(0x103)],'as':_0x11d631(0x107)},'id','asc'],['id',_0x11d631(0xef)]]}),_0x35d76a;};exports[a482_0xa8ed3(0x103)]=UpdateQueueService;