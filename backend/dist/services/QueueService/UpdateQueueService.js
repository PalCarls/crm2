'use strict';const a503_0x504c86=a503_0x3d0c;(function(_0x36d87,_0x498916){const _0x210d9a=a503_0x3d0c,_0x3696ae=_0x36d87();while(!![]){try{const _0x39009a=parseInt(_0x210d9a(0x192))/0x1+-parseInt(_0x210d9a(0x187))/0x2+-parseInt(_0x210d9a(0x197))/0x3+-parseInt(_0x210d9a(0x18c))/0x4*(-parseInt(_0x210d9a(0x18b))/0x5)+parseInt(_0x210d9a(0x1a1))/0x6+-parseInt(_0x210d9a(0x19f))/0x7*(parseInt(_0x210d9a(0x17a))/0x8)+parseInt(_0x210d9a(0x1a5))/0x9*(-parseInt(_0x210d9a(0x186))/0xa);if(_0x39009a===_0x498916)break;else _0x3696ae['push'](_0x3696ae['shift']());}catch(_0x570ec2){_0x3696ae['push'](_0x3696ae['shift']());}}}(a503_0x221d,0x1d3a0));var __createBinding=this&&this['__createBinding']||(Object[a503_0x504c86(0x182)]?function(_0x572191,_0x475a01,_0x624a78,_0x14f84f){const _0x56c0b3=a503_0x504c86;if(_0x14f84f===undefined)_0x14f84f=_0x624a78;var _0x104711=Object[_0x56c0b3(0x19d)](_0x475a01,_0x624a78);(!_0x104711||(_0x56c0b3(0x19c)in _0x104711?!_0x475a01[_0x56c0b3(0x1a7)]:_0x104711[_0x56c0b3(0x1a9)]||_0x104711[_0x56c0b3(0x19b)]))&&(_0x104711={'enumerable':!![],'get':function(){return _0x475a01[_0x624a78];}}),Object[_0x56c0b3(0x1a0)](_0x572191,_0x14f84f,_0x104711);}:function(_0x2058a3,_0x37fd77,_0x450ba0,_0x14164e){if(_0x14164e===undefined)_0x14164e=_0x450ba0;_0x2058a3[_0x14164e]=_0x37fd77[_0x450ba0];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a503_0x504c86(0x182)]?function(_0x4e1572,_0x11e51a){const _0x3ef30d=a503_0x504c86;Object['defineProperty'](_0x4e1572,_0x3ef30d(0x195),{'enumerable':!![],'value':_0x11e51a});}:function(_0x67bafa,_0x249a4f){const _0x2c33f7=a503_0x504c86;_0x67bafa[_0x2c33f7(0x195)]=_0x249a4f;}),__importStar=this&&this[a503_0x504c86(0x190)]||function(_0x164fc1){const _0x8b061b=a503_0x504c86;if(_0x164fc1&&_0x164fc1['__esModule'])return _0x164fc1;var _0x2edb5f={};if(_0x164fc1!=null){for(var _0x56a3b9 in _0x164fc1)if(_0x56a3b9!==_0x8b061b(0x195)&&Object[_0x8b061b(0x18e)][_0x8b061b(0x194)][_0x8b061b(0x196)](_0x164fc1,_0x56a3b9))__createBinding(_0x2edb5f,_0x164fc1,_0x56a3b9);}return __setModuleDefault(_0x2edb5f,_0x164fc1),_0x2edb5f;},__importDefault=this&&this[a503_0x504c86(0x183)]||function(_0x2246b0){const _0x1bf68b=a503_0x504c86;return _0x2246b0&&_0x2246b0[_0x1bf68b(0x1a7)]?_0x2246b0:{'default':_0x2246b0};};Object[a503_0x504c86(0x1a0)](exports,a503_0x504c86(0x1a7),{'value':!![]});function a503_0x3d0c(_0x5d20e2,_0x2b7c94){const _0x221dc6=a503_0x221d();return a503_0x3d0c=function(_0x3d0ca3,_0x2b492d){_0x3d0ca3=_0x3d0ca3-0x17a;let _0x1b0ac0=_0x221dc6[_0x3d0ca3];return _0x1b0ac0;},a503_0x3d0c(_0x5d20e2,_0x2b7c94);}function a503_0x221d(){const _0x2363cf=['9hSFRIw','min','__esModule','ERR_QUEUE_INVALID_COLOR','writable','chatbots','message','Check-color','654504yHPehs','Não\x20é\x20permitido\x20alterar\x20registros\x20de\x20outra\x20empresa','ERR_QUEUE_COLOR_ALREADY_EXISTS','../../models/Queue','string','../../models/Chatbot','object','Check-unique-name','create','__importDefault','all','required','855130BSeiQv','73698HTOdkF','update','asc','ERR_QUEUE_NAME_ALREADY_EXISTS','2165CBpNPU','1996yYlFie','yup','prototype','./ShowQueueService','__importStar','findOne','48879KQphVq','test','hasOwnProperty','default','call','276978PMlcir','validate','shape','reload','configurable','get','getOwnPropertyDescriptor','findIndex','14rsdyof','defineProperty','1398480hXPyQW','ASC','../../errors/AppError','Check-color-exists'];a503_0x221d=function(){return _0x2363cf;};return a503_0x221d();}const sequelize_1=require('sequelize'),Yup=__importStar(require(a503_0x504c86(0x18d))),AppError_1=__importDefault(require(a503_0x504c86(0x1a3))),Chatbot_1=__importDefault(require(a503_0x504c86(0x17f))),Queue_1=__importDefault(require(a503_0x504c86(0x17d))),ShowQueueService_1=__importDefault(require(a503_0x504c86(0x18f))),UpdateQueueService=async(_0x21f658,_0xf73cda,_0x3d7f0b)=>{const _0x2da510=a503_0x504c86,{color:_0x30c93b,name:_0x108791,chatbots:_0x18d0f5}=_0xf73cda,_0x40190f=Yup[_0x2da510(0x180)]()[_0x2da510(0x199)]({'name':Yup[_0x2da510(0x17e)]()[_0x2da510(0x1a6)](0x2,'ERR_QUEUE_INVALID_NAME')[_0x2da510(0x193)](_0x2da510(0x181),_0x2da510(0x18a),async _0x736bf6=>{const _0x5b8599=_0x2da510;if(_0x736bf6){const _0x113c8e=await Queue_1['default'][_0x5b8599(0x191)]({'where':{'name':_0x736bf6,'id':{[sequelize_1['Op']['ne']]:_0x21f658},'companyId':_0x3d7f0b}});return!_0x113c8e;}return!![];}),'color':Yup[_0x2da510(0x17e)]()[_0x2da510(0x185)](_0x2da510(0x1a8))['test'](_0x2da510(0x1ac),'ERR_QUEUE_INVALID_COLOR',async _0x443292=>{const _0x1b956b=_0x2da510;if(_0x443292){const _0x32282c=/^#[0-9a-f]{3,6}$/i;return _0x32282c[_0x1b956b(0x193)](_0x443292);}return!![];})[_0x2da510(0x193)](_0x2da510(0x1a4),_0x2da510(0x17c),async _0x7e6f78=>{const _0x1d94c5=_0x2da510;if(_0x7e6f78){const _0x5e0d80=await Queue_1[_0x1d94c5(0x195)]['findOne']({'where':{'color':_0x7e6f78,'id':{[sequelize_1['Op']['ne']]:_0x21f658},'companyId':_0x3d7f0b}});return!_0x5e0d80;}return!![];})});try{await _0x40190f[_0x2da510(0x198)]({'color':_0x30c93b,'name':_0x108791});}catch(_0x3b01cc){throw new AppError_1[(_0x2da510(0x195))](_0x3b01cc[_0x2da510(0x1ab)]);}const _0x1c811b=await(0x0,ShowQueueService_1[_0x2da510(0x195)])(_0x21f658,_0x3d7f0b);if(_0x1c811b['companyId']!==_0x3d7f0b)throw new AppError_1[(_0x2da510(0x195))](_0x2da510(0x17b));return _0x18d0f5&&(await Promise[_0x2da510(0x184)](_0x18d0f5['map'](async _0x1f95ca=>{const _0x22fb57=_0x2da510;await Chatbot_1[_0x22fb57(0x195)]['upsert']({..._0x1f95ca,'queueId':_0x1c811b['id']});})),await Promise[_0x2da510(0x184)](_0x1c811b[_0x2da510(0x1aa)]['map'](async _0x4aa0bf=>{const _0x4eeacb=_0x2da510,_0x28d251=_0x18d0f5[_0x4eeacb(0x19e)](_0x2b9f7a=>_0x2b9f7a['id']===_0x4aa0bf['id']);_0x28d251===-0x1&&await Chatbot_1['default']['destroy']({'where':{'id':_0x4aa0bf['id']}});}))),await _0x1c811b[_0x2da510(0x188)](_0xf73cda),await _0x1c811b[_0x2da510(0x19a)]({'include':[{'model':Chatbot_1['default'],'as':_0x2da510(0x1aa),'order':[[{'model':Chatbot_1[_0x2da510(0x195)],'as':_0x2da510(0x1aa)},'id',_0x2da510(0x189)],['id',_0x2da510(0x1a2)]]}],'order':[[{'model':Chatbot_1[_0x2da510(0x195)],'as':_0x2da510(0x1aa)},'id','asc'],['id','ASC']]}),_0x1c811b;};exports[a503_0x504c86(0x195)]=UpdateQueueService;