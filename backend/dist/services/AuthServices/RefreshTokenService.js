'use strict';function a352_0x42e1(){const _0x11c3a2=['tokenVersion','defineProperty','RefreshTokenService','813255iVoHDM','../UserServices/ShowUserService','default','8319KMShLg','__esModule','76YizBrg','verify','1444786wFHKbK','ERR_SESSION_EXPIRED','clearCookie','683999vjhiio','createAccessToken','jsonwebtoken','refreshSecret','2809128FYvhjm','__importDefault','jrt','1884360QllgEh','createRefreshToken','../../config/auth','2430284dVPYOO'];a352_0x42e1=function(){return _0x11c3a2;};return a352_0x42e1();}const a352_0x42001e=a352_0x2500;function a352_0x2500(_0xa80283,_0x4b4869){const _0x42e163=a352_0x42e1();return a352_0x2500=function(_0x2500aa,_0x4262b2){_0x2500aa=_0x2500aa-0x1d9;let _0xa9dc4e=_0x42e163[_0x2500aa];return _0xa9dc4e;},a352_0x2500(_0xa80283,_0x4b4869);}(function(_0x17bd57,_0x73df83){const _0x3a0396=a352_0x2500,_0x184693=_0x17bd57();while(!![]){try{const _0x3bc6e2=parseInt(_0x3a0396(0x1db))/0x1+parseInt(_0x3a0396(0x1ee))/0x2*(parseInt(_0x3a0396(0x1ec))/0x3)+parseInt(_0x3a0396(0x1e5))/0x4+-parseInt(_0x3a0396(0x1e9))/0x5+-parseInt(_0x3a0396(0x1e2))/0x6+-parseInt(_0x3a0396(0x1f0))/0x7+-parseInt(_0x3a0396(0x1df))/0x8;if(_0x3bc6e2===_0x73df83)break;else _0x184693['push'](_0x184693['shift']());}catch(_0x1bbec5){_0x184693['push'](_0x184693['shift']());}}}(a352_0x42e1,0x588c6));var __importDefault=this&&this[a352_0x42001e(0x1e0)]||function(_0x447e68){return _0x447e68&&_0x447e68['__esModule']?_0x447e68:{'default':_0x447e68};};Object[a352_0x42001e(0x1e7)](exports,a352_0x42001e(0x1ed),{'value':!![]}),exports[a352_0x42001e(0x1e8)]=void 0x0;const jsonwebtoken_1=require(a352_0x42001e(0x1dd)),AppError_1=__importDefault(require('../../errors/AppError')),ShowUserService_1=__importDefault(require(a352_0x42001e(0x1ea))),auth_1=__importDefault(require(a352_0x42001e(0x1e4))),CreateTokens_1=require('../../helpers/CreateTokens'),RefreshTokenService=async(_0x5d74f6,_0x140d17)=>{const _0x20e5d1=a352_0x42001e;try{const _0x35b2c9=(0x0,jsonwebtoken_1[_0x20e5d1(0x1ef)])(_0x140d17,auth_1[_0x20e5d1(0x1eb)][_0x20e5d1(0x1de)]),{id:_0x557cb3,tokenVersion:_0x3fd29f,companyId:_0x46c6ad}=_0x35b2c9,_0x2abc3a=await(0x0,ShowUserService_1['default'])(_0x557cb3);if(_0x2abc3a[_0x20e5d1(0x1e6)]!==_0x3fd29f){_0x5d74f6[_0x20e5d1(0x1da)](_0x20e5d1(0x1e1));throw new AppError_1[(_0x20e5d1(0x1eb))](_0x20e5d1(0x1d9),0x191);}const _0x5da960=(0x0,CreateTokens_1[_0x20e5d1(0x1dc)])(_0x2abc3a),_0x53d69c=(0x0,CreateTokens_1[_0x20e5d1(0x1e3)])(_0x2abc3a);return{'user':_0x2abc3a,'newToken':_0x5da960,'refreshToken':_0x53d69c};}catch(_0x4530cc){_0x5d74f6[_0x20e5d1(0x1da)](_0x20e5d1(0x1e1));throw new AppError_1['default'](_0x20e5d1(0x1d9),0x191);}};exports[a352_0x42001e(0x1e8)]=RefreshTokenService;