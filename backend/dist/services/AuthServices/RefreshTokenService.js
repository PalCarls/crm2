'use strict';const a403_0x3e9a85=a403_0x3fbb;function a403_0x3fbb(_0x7c4c6f,_0x232d68){const _0xe8bf8a=a403_0xe8bf();return a403_0x3fbb=function(_0x3fbb74,_0x3267f3){_0x3fbb74=_0x3fbb74-0x12e;let _0x72a6c3=_0xe8bf8a[_0x3fbb74];return _0x72a6c3;},a403_0x3fbb(_0x7c4c6f,_0x232d68);}(function(_0x8c9ca6,_0x46b509){const _0x1eb478=a403_0x3fbb,_0x3bfcf3=_0x8c9ca6();while(!![]){try{const _0x4586a7=-parseInt(_0x1eb478(0x136))/0x1*(parseInt(_0x1eb478(0x145))/0x2)+parseInt(_0x1eb478(0x143))/0x3+parseInt(_0x1eb478(0x130))/0x4*(-parseInt(_0x1eb478(0x133))/0x5)+parseInt(_0x1eb478(0x13c))/0x6*(-parseInt(_0x1eb478(0x142))/0x7)+parseInt(_0x1eb478(0x131))/0x8+parseInt(_0x1eb478(0x132))/0x9*(parseInt(_0x1eb478(0x13e))/0xa)+parseInt(_0x1eb478(0x13a))/0xb;if(_0x4586a7===_0x46b509)break;else _0x3bfcf3['push'](_0x3bfcf3['shift']());}catch(_0x471847){_0x3bfcf3['push'](_0x3bfcf3['shift']());}}}(a403_0xe8bf,0x8afdb));function a403_0xe8bf(){const _0x3735c2=['2018iNfFkh','createAccessToken','defineProperty','refreshSecret','139532FbLIyN','1438920CaxJUX','396tVXjSZ','30KtmFuf','jrt','__importDefault','827NvzYjG','jsonwebtoken','tokenVersion','../../helpers/CreateTokens','10501293ohCGvt','verify','14970DHGWRT','createRefreshToken','161130vAaXlU','default','clearCookie','__esModule','1358sgHpcv','760734WpYIYc','RefreshTokenService'];a403_0xe8bf=function(){return _0x3735c2;};return a403_0xe8bf();}var __importDefault=this&&this[a403_0x3e9a85(0x135)]||function(_0x3e5a1d){const _0xc82fc4=a403_0x3e9a85;return _0x3e5a1d&&_0x3e5a1d[_0xc82fc4(0x141)]?_0x3e5a1d:{'default':_0x3e5a1d};};Object[a403_0x3e9a85(0x12e)](exports,a403_0x3e9a85(0x141),{'value':!![]}),exports[a403_0x3e9a85(0x144)]=void 0x0;const jsonwebtoken_1=require(a403_0x3e9a85(0x137)),AppError_1=__importDefault(require('../../errors/AppError')),ShowUserService_1=__importDefault(require('../UserServices/ShowUserService')),auth_1=__importDefault(require('../../config/auth')),CreateTokens_1=require(a403_0x3e9a85(0x139)),RefreshTokenService=async(_0x5891a1,_0x37b029)=>{const _0x5092c1=a403_0x3e9a85;try{const _0x1caf96=(0x0,jsonwebtoken_1[_0x5092c1(0x13b)])(_0x37b029,auth_1[_0x5092c1(0x13f)][_0x5092c1(0x12f)]),{id:_0x4254b3,tokenVersion:_0x253ac4,companyId:_0x45d9e4}=_0x1caf96,_0x53cb96=await(0x0,ShowUserService_1[_0x5092c1(0x13f)])(_0x4254b3,_0x45d9e4);if(_0x53cb96[_0x5092c1(0x138)]!==_0x253ac4){_0x5891a1['clearCookie'](_0x5092c1(0x134));throw new AppError_1['default']('ERR_SESSION_EXPIRED',0x191);}const _0x35f00e=(0x0,CreateTokens_1[_0x5092c1(0x146)])(_0x53cb96),_0x5b5a4c=(0x0,CreateTokens_1[_0x5092c1(0x13d)])(_0x53cb96);return{'user':_0x53cb96,'newToken':_0x35f00e,'refreshToken':_0x5b5a4c};}catch(_0x29e6ec){_0x5891a1[_0x5092c1(0x140)](_0x5092c1(0x134));throw new AppError_1[(_0x5092c1(0x13f))]('ERR_SESSION_EXPIRED',0x191);}};exports['RefreshTokenService']=RefreshTokenService;