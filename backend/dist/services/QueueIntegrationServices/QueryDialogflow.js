'use strict';const a470_0x2fb5e9=a470_0x4bce;(function(_0x3f1b39,_0x4749ff){const _0x3c5378=a470_0x4bce,_0x20870f=_0x3f1b39();while(!![]){try{const _0x1a4cae=parseInt(_0x3c5378(0x18a))/0x1*(parseInt(_0x3c5378(0x183))/0x2)+parseInt(_0x3c5378(0x1a3))/0x3*(parseInt(_0x3c5378(0x18d))/0x4)+-parseInt(_0x3c5378(0x185))/0x5+-parseInt(_0x3c5378(0x180))/0x6+-parseInt(_0x3c5378(0x189))/0x7+parseInt(_0x3c5378(0x199))/0x8+parseInt(_0x3c5378(0x18c))/0x9;if(_0x1a4cae===_0x4749ff)break;else _0x20870f['push'](_0x20870f['shift']());}catch(_0x4d37c6){_0x20870f['push'](_0x20870f['shift']());}}}(a470_0xc660,0x7e5d5));function a470_0x4bce(_0x53f7e2,_0x43da05){const _0xc6606d=a470_0xc660();return a470_0x4bce=function(_0x4bce63,_0x2b1fc6){_0x4bce63=_0x4bce63-0x180;let _0x440918=_0xc6606d[_0x4bce63];return _0x440918;},a470_0x4bce(_0x53f7e2,_0x43da05);}var __createBinding=this&&this['__createBinding']||(Object[a470_0x2fb5e9(0x1a0)]?function(_0x1bb5a4,_0x2c399c,_0x46b6a3,_0x250242){const _0x5539ac=a470_0x2fb5e9;if(_0x250242===undefined)_0x250242=_0x46b6a3;var _0x14b86e=Object[_0x5539ac(0x192)](_0x2c399c,_0x46b6a3);(!_0x14b86e||(_0x5539ac(0x181)in _0x14b86e?!_0x2c399c[_0x5539ac(0x186)]:_0x14b86e[_0x5539ac(0x19e)]||_0x14b86e[_0x5539ac(0x190)]))&&(_0x14b86e={'enumerable':!![],'get':function(){return _0x2c399c[_0x46b6a3];}}),Object[_0x5539ac(0x196)](_0x1bb5a4,_0x250242,_0x14b86e);}:function(_0x263f79,_0x417fdb,_0x484c85,_0x21f200){if(_0x21f200===undefined)_0x21f200=_0x484c85;_0x263f79[_0x21f200]=_0x417fdb[_0x484c85];}),__setModuleDefault=this&&this[a470_0x2fb5e9(0x18f)]||(Object[a470_0x2fb5e9(0x1a0)]?function(_0x26aeaa,_0x51f830){const _0x444162=a470_0x2fb5e9;Object[_0x444162(0x196)](_0x26aeaa,_0x444162(0x19b),{'enumerable':!![],'value':_0x51f830});}:function(_0x350b4f,_0x9537b6){const _0x120eb0=a470_0x2fb5e9;_0x350b4f[_0x120eb0(0x19b)]=_0x9537b6;}),__importStar=this&&this['__importStar']||function(_0x1e9df2){const _0x805785=a470_0x2fb5e9;if(_0x1e9df2&&_0x1e9df2[_0x805785(0x186)])return _0x1e9df2;var _0x4f5917={};if(_0x1e9df2!=null){for(var _0x5a1af6 in _0x1e9df2)if(_0x5a1af6!=='default'&&Object[_0x805785(0x19f)]['hasOwnProperty'][_0x805785(0x191)](_0x1e9df2,_0x5a1af6))__createBinding(_0x4f5917,_0x1e9df2,_0x5a1af6);}return __setModuleDefault(_0x4f5917,_0x1e9df2),_0x4f5917;};Object[a470_0x2fb5e9(0x196)](exports,'__esModule',{'value':!![]}),exports['queryDialogFlow']=void 0x0;function a470_0xc660(){const _0x438409=['queryDialogFlow','791091ddRWLI','1ikolYa','boolValue','7687665QnicSe','53044EgIzJH','length','__setModuleDefault','configurable','call','getOwnPropertyDescriptor','diagnosticInfo','captureException','Error\x20handling\x20whatsapp\x20message:\x20Err:\x20','defineProperty','logger','queryResult','2486624smVTTG','projectAgentSessionPath','default','@sentry/node','outputAudio','writable','prototype','create','parameters','error','138SWhETI','2661372QETSrQ','get','fields','522358ImMWnJ','fulfillmentMessages','4810170QgxmHY','__esModule','detectIntent'];a470_0xc660=function(){return _0x438409;};return a470_0xc660();}const Sentry=__importStar(require(a470_0x2fb5e9(0x19c))),logger_1=require('../../utils/logger');async function detectIntent(_0x42358f,_0x57ae8a,_0x434f8e,_0x13379b,_0x963bbc){const _0x12fb23=a470_0x2fb5e9,_0x188456=_0x42358f[_0x12fb23(0x19a)](_0x57ae8a,_0x434f8e),_0x5e99c7={'session':_0x188456,'queryInput':{'text':{'text':_0x13379b,'languageCode':_0x963bbc}}},_0xcc53c=await _0x42358f[_0x12fb23(0x187)](_0x5e99c7);return _0xcc53c[0x0];}async function detectAudioIntent(_0x21bed5,_0x3844bb,_0x471c7e,_0x2a32d9,_0x397070){const _0x29c2=a470_0x2fb5e9,_0x1197db=_0x21bed5[_0x29c2(0x19a)](_0x3844bb,_0x471c7e),_0x33b6cd=0x6,_0x467372=0x3e80,_0x4bd928={'session':_0x1197db,'queryInput':{'audioConfig':{'audioEncoding':_0x33b6cd,'sampleRateHertz':_0x467372,'languageCode':_0x2a32d9}},'inputAudio':_0x397070},_0x589bbb=await _0x21bed5[_0x29c2(0x187)](_0x4bd928);return _0x589bbb[0x0];}async function queryDialogFlow(_0x1218a3,_0x15c098,_0x5d28c6,_0x9a82b8,_0x2dd0ef,_0x59293a){const _0x3c37d7=a470_0x2fb5e9;let _0x2e7ff8;if(_0x59293a){try{_0x2e7ff8=await detectAudioIntent(_0x1218a3,_0x15c098,_0x5d28c6,_0x2dd0ef,_0x59293a);const _0x30a942=_0x2e7ff8?.[_0x3c37d7(0x198)]?.[_0x3c37d7(0x184)],_0x58ec4c=_0x2e7ff8?.['queryResult']?.[_0x3c37d7(0x193)]?.['fields']?.['end_conversation']?.['boolValue'],_0x4992ee=_0x2e7ff8?.[_0x3c37d7(0x198)]?.[_0x3c37d7(0x1a1)]?.[_0x3c37d7(0x182)],_0x50266d=_0x2e7ff8?.[_0x3c37d7(0x19d)];return _0x30a942?.[_0x3c37d7(0x18e)]===0x0?null:{'responses':_0x30a942,'endConversation':_0x58ec4c,'parameters':_0x4992ee,'encodedAudio':_0x50266d};}catch(_0x392be1){Sentry[_0x3c37d7(0x194)](_0x392be1),logger_1[_0x3c37d7(0x197)][_0x3c37d7(0x1a2)](_0x3c37d7(0x195)+_0x392be1);}return null;}else{try{_0x2e7ff8=await detectIntent(_0x1218a3,_0x15c098,_0x5d28c6,_0x9a82b8,_0x2dd0ef);const _0x2debcf=_0x2e7ff8?.[_0x3c37d7(0x198)]?.[_0x3c37d7(0x184)],_0x386d2b=_0x2e7ff8?.[_0x3c37d7(0x198)]?.['diagnosticInfo']?.[_0x3c37d7(0x182)]?.['end_conversation']?.[_0x3c37d7(0x18b)],_0x3daaf3=_0x2e7ff8?.[_0x3c37d7(0x198)]?.[_0x3c37d7(0x1a1)]?.[_0x3c37d7(0x182)],_0x1d4bbe=_0x2e7ff8?.[_0x3c37d7(0x19d)];return _0x2debcf?.[_0x3c37d7(0x18e)]===0x0?null:{'responses':_0x2debcf,'endConversation':_0x386d2b,'parameters':_0x3daaf3,'encodedAudio':_0x1d4bbe};}catch(_0x58ce2f){Sentry['captureException'](_0x58ce2f),logger_1[_0x3c37d7(0x197)]['error'](_0x3c37d7(0x195)+_0x58ce2f);}return null;}}exports[a470_0x2fb5e9(0x188)]=queryDialogFlow;