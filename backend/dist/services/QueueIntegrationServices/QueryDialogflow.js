'use strict';function a536_0x4f87(_0x332571,_0x47c671){const _0x5f1c6f=a536_0x5f1c();return a536_0x4f87=function(_0x4f8719,_0x1a209d){_0x4f8719=_0x4f8719-0x103;let _0x149501=_0x5f1c6f[_0x4f8719];return _0x149501;},a536_0x4f87(_0x332571,_0x47c671);}const a536_0x25598b=a536_0x4f87;(function(_0x227e5e,_0x174a67){const _0x3ac231=a536_0x4f87,_0x4eeb84=_0x227e5e();while(!![]){try{const _0x3121d0=parseInt(_0x3ac231(0x125))/0x1*(parseInt(_0x3ac231(0x114))/0x2)+parseInt(_0x3ac231(0x10b))/0x3*(parseInt(_0x3ac231(0x126))/0x4)+parseInt(_0x3ac231(0x104))/0x5+parseInt(_0x3ac231(0x10d))/0x6+-parseInt(_0x3ac231(0x11c))/0x7*(-parseInt(_0x3ac231(0x10e))/0x8)+-parseInt(_0x3ac231(0x115))/0x9+parseInt(_0x3ac231(0x11d))/0xa*(-parseInt(_0x3ac231(0x109))/0xb);if(_0x3121d0===_0x174a67)break;else _0x4eeb84['push'](_0x4eeb84['shift']());}catch(_0x5a22ca){_0x4eeb84['push'](_0x4eeb84['shift']());}}}(a536_0x5f1c,0x3e2a1));var __createBinding=this&&this[a536_0x25598b(0x11f)]||(Object[a536_0x25598b(0x128)]?function(_0x5d5a80,_0x3b5542,_0x34b216,_0x361df6){const _0x5996e5=a536_0x25598b;if(_0x361df6===undefined)_0x361df6=_0x34b216;var _0x50674f=Object['getOwnPropertyDescriptor'](_0x3b5542,_0x34b216);(!_0x50674f||(_0x5996e5(0x122)in _0x50674f?!_0x3b5542[_0x5996e5(0x120)]:_0x50674f[_0x5996e5(0x113)]||_0x50674f[_0x5996e5(0x124)]))&&(_0x50674f={'enumerable':!![],'get':function(){return _0x3b5542[_0x34b216];}}),Object['defineProperty'](_0x5d5a80,_0x361df6,_0x50674f);}:function(_0x208b8a,_0x437c21,_0x6508d9,_0x48d9ad){if(_0x48d9ad===undefined)_0x48d9ad=_0x6508d9;_0x208b8a[_0x48d9ad]=_0x437c21[_0x6508d9];}),__setModuleDefault=this&&this[a536_0x25598b(0x105)]||(Object[a536_0x25598b(0x128)]?function(_0x265c43,_0xac3ae6){Object['defineProperty'](_0x265c43,'default',{'enumerable':!![],'value':_0xac3ae6});}:function(_0x427aa5,_0x94d0a){_0x427aa5['default']=_0x94d0a;}),__importStar=this&&this[a536_0x25598b(0x11b)]||function(_0x573141){const _0x5cb28e=a536_0x25598b;if(_0x573141&&_0x573141[_0x5cb28e(0x120)])return _0x573141;var _0x32ade3={};if(_0x573141!=null){for(var _0xe0ea4f in _0x573141)if(_0xe0ea4f!==_0x5cb28e(0x11a)&&Object[_0x5cb28e(0x123)]['hasOwnProperty'][_0x5cb28e(0x10c)](_0x573141,_0xe0ea4f))__createBinding(_0x32ade3,_0x573141,_0xe0ea4f);}return __setModuleDefault(_0x32ade3,_0x573141),_0x32ade3;};Object[a536_0x25598b(0x117)](exports,a536_0x25598b(0x120),{'value':!![]}),exports[a536_0x25598b(0x112)]=void 0x0;const Sentry=__importStar(require(a536_0x25598b(0x129))),logger_1=require('../../utils/logger');async function detectIntent(_0x1fc3d2,_0x22011a,_0x21794d,_0x23aa38,_0x442896){const _0x4ff947=a536_0x25598b,_0x1a8b2d=_0x1fc3d2[_0x4ff947(0x110)](_0x22011a,_0x21794d),_0x3b2238={'session':_0x1a8b2d,'queryInput':{'text':{'text':_0x23aa38,'languageCode':_0x442896}}},_0x9814b=await _0x1fc3d2[_0x4ff947(0x111)](_0x3b2238);return _0x9814b[0x0];}async function detectAudioIntent(_0x32164e,_0x62b8e4,_0x21f5d4,_0x539663,_0x44170e){const _0x4b45d2=_0x32164e['projectAgentSessionPath'](_0x62b8e4,_0x21f5d4),_0x1fb5de=0x6,_0x1e339f=0x3e80,_0x2ef08a={'session':_0x4b45d2,'queryInput':{'audioConfig':{'audioEncoding':_0x1fb5de,'sampleRateHertz':_0x1e339f,'languageCode':_0x539663}},'inputAudio':_0x44170e},_0x8b6cea=await _0x32164e['detectIntent'](_0x2ef08a);return _0x8b6cea[0x0];}function a536_0x5f1c(){const _0x322d70=['19530izqEwl','boolValue','__createBinding','__esModule','diagnosticInfo','get','prototype','configurable','13LEJCgC','4ZwXbhK','logger','create','@sentry/node','queryResult','fulfillmentMessages','283490xDGyQl','__setModuleDefault','end_conversation','outputAudio','captureException','2970VtnVeJ','parameters','255849nRflmm','call','1756938PJWOYj','8HZFmqG','error','projectAgentSessionPath','detectIntent','queryDialogFlow','writable','47710BShLSV','3244086wNgTit','length','defineProperty','Error\x20handling\x20whatsapp\x20message:\x20Err:\x20','fields','default','__importStar','2782290ilPFUv'];a536_0x5f1c=function(){return _0x322d70;};return a536_0x5f1c();}async function queryDialogFlow(_0x515d46,_0xd891b2,_0x59813b,_0x5ccb13,_0x54d561,_0x33dd9c){const _0x7caf94=a536_0x25598b;let _0x29df8f;if(_0x33dd9c){try{_0x29df8f=await detectAudioIntent(_0x515d46,_0xd891b2,_0x59813b,_0x54d561,_0x33dd9c);const _0x39a2a9=_0x29df8f?.[_0x7caf94(0x12a)]?.[_0x7caf94(0x103)],_0x33b580=_0x29df8f?.['queryResult']?.[_0x7caf94(0x121)]?.[_0x7caf94(0x119)]?.['end_conversation']?.[_0x7caf94(0x11e)],_0x5d38b6=_0x29df8f?.['queryResult']?.[_0x7caf94(0x10a)]?.[_0x7caf94(0x119)],_0xf4d9aa=_0x29df8f?.['outputAudio'];return _0x39a2a9?.[_0x7caf94(0x116)]===0x0?null:{'responses':_0x39a2a9,'endConversation':_0x33b580,'parameters':_0x5d38b6,'encodedAudio':_0xf4d9aa};}catch(_0x5ee032){Sentry['captureException'](_0x5ee032),logger_1[_0x7caf94(0x127)][_0x7caf94(0x10f)](_0x7caf94(0x118)+_0x5ee032);}return null;}else{try{_0x29df8f=await detectIntent(_0x515d46,_0xd891b2,_0x59813b,_0x5ccb13,_0x54d561);const _0x3a96b9=_0x29df8f?.[_0x7caf94(0x12a)]?.[_0x7caf94(0x103)],_0x4a2064=_0x29df8f?.[_0x7caf94(0x12a)]?.[_0x7caf94(0x121)]?.[_0x7caf94(0x119)]?.[_0x7caf94(0x106)]?.[_0x7caf94(0x11e)],_0x520fac=_0x29df8f?.[_0x7caf94(0x12a)]?.[_0x7caf94(0x10a)]?.[_0x7caf94(0x119)],_0x5628e6=_0x29df8f?.[_0x7caf94(0x107)];return _0x3a96b9?.[_0x7caf94(0x116)]===0x0?null:{'responses':_0x3a96b9,'endConversation':_0x4a2064,'parameters':_0x520fac,'encodedAudio':_0x5628e6};}catch(_0x3730e9){Sentry[_0x7caf94(0x108)](_0x3730e9),logger_1[_0x7caf94(0x127)][_0x7caf94(0x10f)](_0x7caf94(0x118)+_0x3730e9);}return null;}}exports[a536_0x25598b(0x112)]=queryDialogFlow;