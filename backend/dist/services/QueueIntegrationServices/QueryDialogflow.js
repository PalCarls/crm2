'use strict';function a484_0x2b74(){const _0x40cf1b=['551790nnhLSa','__setModuleDefault','__importStar','hasOwnProperty','defineProperty','error','projectAgentSessionPath','parameters','queryResult','get','../../utils/logger','3550098NMHqfs','4047021xdqbyH','boolValue','queryDialogFlow','diagnosticInfo','length','296BopPIG','detectIntent','call','Error\x20handling\x20whatsapp\x20message:\x20Err:\x20','logger','656IGkdMY','2507NnWgkf','__createBinding','3992992DNdKDn','fulfillmentMessages','__esModule','end_conversation','prototype','captureException','5130180qOiQpq','fields','8902075iiJwHP','configurable','create','outputAudio','default','getOwnPropertyDescriptor'];a484_0x2b74=function(){return _0x40cf1b;};return a484_0x2b74();}const a484_0x479efb=a484_0x4a20;(function(_0x2c474e,_0x5d271b){const _0x514c31=a484_0x4a20,_0x788527=_0x2c474e();while(!![]){try{const _0x369a56=-parseInt(_0x514c31(0x11e))/0x1*(parseInt(_0x514c31(0x11d))/0x2)+parseInt(_0x514c31(0x113))/0x3+parseInt(_0x514c31(0x120))/0x4+-parseInt(_0x514c31(0x126))/0x5+-parseInt(_0x514c31(0x112))/0x6+-parseInt(_0x514c31(0x101))/0x7+parseInt(_0x514c31(0x118))/0x8*(parseInt(_0x514c31(0x107))/0x9);if(_0x369a56===_0x5d271b)break;else _0x788527['push'](_0x788527['shift']());}catch(_0x39f42c){_0x788527['push'](_0x788527['shift']());}}}(a484_0x2b74,0xdcb31));var __createBinding=this&&this[a484_0x479efb(0x11f)]||(Object[a484_0x479efb(0x103)]?function(_0x399737,_0xc370b0,_0x2dfe67,_0xddce9){const _0x4ce3cd=a484_0x479efb;if(_0xddce9===undefined)_0xddce9=_0x2dfe67;var _0x466681=Object[_0x4ce3cd(0x106)](_0xc370b0,_0x2dfe67);(!_0x466681||(_0x4ce3cd(0x110)in _0x466681?!_0xc370b0[_0x4ce3cd(0x122)]:_0x466681['writable']||_0x466681[_0x4ce3cd(0x102)]))&&(_0x466681={'enumerable':!![],'get':function(){return _0xc370b0[_0x2dfe67];}}),Object[_0x4ce3cd(0x10b)](_0x399737,_0xddce9,_0x466681);}:function(_0x2ddb9c,_0x444bf2,_0x1b10ed,_0x46ec3c){if(_0x46ec3c===undefined)_0x46ec3c=_0x1b10ed;_0x2ddb9c[_0x46ec3c]=_0x444bf2[_0x1b10ed];}),__setModuleDefault=this&&this[a484_0x479efb(0x108)]||(Object[a484_0x479efb(0x103)]?function(_0x4e5923,_0x281bed){const _0x484b9d=a484_0x479efb;Object[_0x484b9d(0x10b)](_0x4e5923,'default',{'enumerable':!![],'value':_0x281bed});}:function(_0x6e6229,_0x6a4f8b){_0x6e6229['default']=_0x6a4f8b;}),__importStar=this&&this[a484_0x479efb(0x109)]||function(_0x498a20){const _0x93670d=a484_0x479efb;if(_0x498a20&&_0x498a20['__esModule'])return _0x498a20;var _0x1cb41d={};if(_0x498a20!=null){for(var _0x2438bb in _0x498a20)if(_0x2438bb!==_0x93670d(0x105)&&Object[_0x93670d(0x124)][_0x93670d(0x10a)][_0x93670d(0x11a)](_0x498a20,_0x2438bb))__createBinding(_0x1cb41d,_0x498a20,_0x2438bb);}return __setModuleDefault(_0x1cb41d,_0x498a20),_0x1cb41d;};function a484_0x4a20(_0x16ec6d,_0x310476){const _0x2b74c5=a484_0x2b74();return a484_0x4a20=function(_0x4a20c3,_0x48c371){_0x4a20c3=_0x4a20c3-0x101;let _0x2cd2ab=_0x2b74c5[_0x4a20c3];return _0x2cd2ab;},a484_0x4a20(_0x16ec6d,_0x310476);}Object[a484_0x479efb(0x10b)](exports,a484_0x479efb(0x122),{'value':!![]}),exports[a484_0x479efb(0x115)]=void 0x0;const Sentry=__importStar(require('@sentry/node')),logger_1=require(a484_0x479efb(0x111));async function detectIntent(_0x4328b7,_0x5090ee,_0x24ae24,_0x20d8b7,_0x1e9aee){const _0x1b6c82=a484_0x479efb,_0x2d3853=_0x4328b7[_0x1b6c82(0x10d)](_0x5090ee,_0x24ae24),_0x106cb7={'session':_0x2d3853,'queryInput':{'text':{'text':_0x20d8b7,'languageCode':_0x1e9aee}}},_0x187a6d=await _0x4328b7[_0x1b6c82(0x119)](_0x106cb7);return _0x187a6d[0x0];}async function detectAudioIntent(_0x270dd6,_0x263d2f,_0x4e9864,_0x5a6f83,_0x17d991){const _0x1660c0=a484_0x479efb,_0x4db307=_0x270dd6[_0x1660c0(0x10d)](_0x263d2f,_0x4e9864),_0x259075=0x6,_0x562036=0x3e80,_0x16e279={'session':_0x4db307,'queryInput':{'audioConfig':{'audioEncoding':_0x259075,'sampleRateHertz':_0x562036,'languageCode':_0x5a6f83}},'inputAudio':_0x17d991},_0x216e5f=await _0x270dd6[_0x1660c0(0x119)](_0x16e279);return _0x216e5f[0x0];}async function queryDialogFlow(_0x3658c1,_0x393479,_0x48346a,_0x580a03,_0x3bf075,_0x237568){const _0x3bce1b=a484_0x479efb;let _0x2062f4;if(_0x237568){try{_0x2062f4=await detectAudioIntent(_0x3658c1,_0x393479,_0x48346a,_0x3bf075,_0x237568);const _0x3fdcd9=_0x2062f4?.['queryResult']?.[_0x3bce1b(0x121)],_0x325a23=_0x2062f4?.[_0x3bce1b(0x10f)]?.[_0x3bce1b(0x116)]?.[_0x3bce1b(0x127)]?.['end_conversation']?.[_0x3bce1b(0x114)],_0xa7d57b=_0x2062f4?.[_0x3bce1b(0x10f)]?.[_0x3bce1b(0x10e)]?.[_0x3bce1b(0x127)],_0x33b20a=_0x2062f4?.['outputAudio'];return _0x3fdcd9?.[_0x3bce1b(0x117)]===0x0?null:{'responses':_0x3fdcd9,'endConversation':_0x325a23,'parameters':_0xa7d57b,'encodedAudio':_0x33b20a};}catch(_0x1da0e3){Sentry['captureException'](_0x1da0e3),logger_1[_0x3bce1b(0x11c)][_0x3bce1b(0x10c)](_0x3bce1b(0x11b)+_0x1da0e3);}return null;}else{try{_0x2062f4=await detectIntent(_0x3658c1,_0x393479,_0x48346a,_0x580a03,_0x3bf075);const _0x252ad8=_0x2062f4?.[_0x3bce1b(0x10f)]?.[_0x3bce1b(0x121)],_0x784581=_0x2062f4?.[_0x3bce1b(0x10f)]?.[_0x3bce1b(0x116)]?.[_0x3bce1b(0x127)]?.[_0x3bce1b(0x123)]?.[_0x3bce1b(0x114)],_0x5c09fe=_0x2062f4?.['queryResult']?.[_0x3bce1b(0x10e)]?.[_0x3bce1b(0x127)],_0xb0ae1f=_0x2062f4?.[_0x3bce1b(0x104)];return _0x252ad8?.[_0x3bce1b(0x117)]===0x0?null:{'responses':_0x252ad8,'endConversation':_0x784581,'parameters':_0x5c09fe,'encodedAudio':_0xb0ae1f};}catch(_0xca2f2c){Sentry[_0x3bce1b(0x125)](_0xca2f2c),logger_1['logger']['error'](_0x3bce1b(0x11b)+_0xca2f2c);}return null;}}exports[a484_0x479efb(0x115)]=queryDialogFlow;