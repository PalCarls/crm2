'use strict';const a529_0x287e2d=a529_0x21ee;(function(_0x297f5b,_0x3f0080){const _0x27b6a4=a529_0x21ee,_0x37518f=_0x297f5b();while(!![]){try{const _0x466ea6=-parseInt(_0x27b6a4(0xf4))/0x1+parseInt(_0x27b6a4(0xf3))/0x2+-parseInt(_0x27b6a4(0xe1))/0x3+-parseInt(_0x27b6a4(0xed))/0x4+-parseInt(_0x27b6a4(0xe3))/0x5*(parseInt(_0x27b6a4(0xdb))/0x6)+-parseInt(_0x27b6a4(0xf8))/0x7+parseInt(_0x27b6a4(0xf0))/0x8;if(_0x466ea6===_0x3f0080)break;else _0x37518f['push'](_0x37518f['shift']());}catch(_0x640a0e){_0x37518f['push'](_0x37518f['shift']());}}}(a529_0x4b3b,0xc1e49));function a529_0x21ee(_0x319752,_0x4e0a86){const _0x4b3b0c=a529_0x4b3b();return a529_0x21ee=function(_0x21eef6,_0x59ab50){_0x21eef6=_0x21eef6-0xdb;let _0x8f5de6=_0x4b3b0c[_0x21eef6];return _0x8f5de6;},a529_0x21ee(_0x319752,_0x4e0a86);}var __createBinding=this&&this['__createBinding']||(Object[a529_0x287e2d(0xe5)]?function(_0x52b354,_0x1a7c9b,_0x53bc84,_0x455110){const _0x44a6d2=a529_0x287e2d;if(_0x455110===undefined)_0x455110=_0x53bc84;var _0x508f74=Object[_0x44a6d2(0xdd)](_0x1a7c9b,_0x53bc84);(!_0x508f74||('get'in _0x508f74?!_0x1a7c9b[_0x44a6d2(0xde)]:_0x508f74['writable']||_0x508f74[_0x44a6d2(0xee)]))&&(_0x508f74={'enumerable':!![],'get':function(){return _0x1a7c9b[_0x53bc84];}}),Object[_0x44a6d2(0xe9)](_0x52b354,_0x455110,_0x508f74);}:function(_0x4bb0b6,_0x5ead73,_0x12df3d,_0x26d483){if(_0x26d483===undefined)_0x26d483=_0x12df3d;_0x4bb0b6[_0x26d483]=_0x5ead73[_0x12df3d];}),__setModuleDefault=this&&this[a529_0x287e2d(0xf7)]||(Object[a529_0x287e2d(0xe5)]?function(_0x53b8bc,_0x48ba85){const _0x2febd9=a529_0x287e2d;Object[_0x2febd9(0xe9)](_0x53b8bc,_0x2febd9(0xe2),{'enumerable':!![],'value':_0x48ba85});}:function(_0x265727,_0x59627e){const _0x3dc7fd=a529_0x287e2d;_0x265727[_0x3dc7fd(0xe2)]=_0x59627e;}),__importStar=this&&this[a529_0x287e2d(0xfb)]||function(_0x10dafc){const _0x4a6877=a529_0x287e2d;if(_0x10dafc&&_0x10dafc[_0x4a6877(0xde)])return _0x10dafc;var _0x104a62={};if(_0x10dafc!=null){for(var _0x392c6c in _0x10dafc)if(_0x392c6c!=='default'&&Object[_0x4a6877(0xef)][_0x4a6877(0xe6)][_0x4a6877(0xfa)](_0x10dafc,_0x392c6c))__createBinding(_0x104a62,_0x10dafc,_0x392c6c);}return __setModuleDefault(_0x104a62,_0x10dafc),_0x104a62;};Object[a529_0x287e2d(0xe9)](exports,a529_0x287e2d(0xde),{'value':!![]}),exports[a529_0x287e2d(0xf5)]=void 0x0;const Sentry=__importStar(require(a529_0x287e2d(0xdf))),logger_1=require('../../utils/logger');async function detectIntent(_0x1ae922,_0x1a8497,_0x3dbc4b,_0x272ad5,_0x4abd8d){const _0x5ac40c=a529_0x287e2d,_0x2da745=_0x1ae922[_0x5ac40c(0xe7)](_0x1a8497,_0x3dbc4b),_0x5d83eb={'session':_0x2da745,'queryInput':{'text':{'text':_0x272ad5,'languageCode':_0x4abd8d}}},_0x242c6e=await _0x1ae922[_0x5ac40c(0xfd)](_0x5d83eb);return _0x242c6e[0x0];}function a529_0x4b3b(){const _0x135b1f=['queryDialogFlow','outputAudio','__setModuleDefault','8547077tCTVjt','parameters','call','__importStar','fields','detectIntent','144TsAxDe','captureException','getOwnPropertyDescriptor','__esModule','@sentry/node','fulfillmentMessages','2968737XsHrnE','default','278700slYwNQ','boolValue','create','hasOwnProperty','projectAgentSessionPath','Error\x20handling\x20whatsapp\x20message:\x20Err:\x20','defineProperty','diagnosticInfo','error','length','1440652mqeIQc','configurable','prototype','44075936fxEOCc','end_conversation','queryResult','152798srIBFt','883193RsKrVl'];a529_0x4b3b=function(){return _0x135b1f;};return a529_0x4b3b();}async function detectAudioIntent(_0x576e69,_0x365e02,_0x509f24,_0x27ad2a,_0x2bc4d1){const _0x106fcc=a529_0x287e2d,_0x4d8084=_0x576e69[_0x106fcc(0xe7)](_0x365e02,_0x509f24),_0x4eb4da=0x6,_0x140344=0x3e80,_0x5252c6={'session':_0x4d8084,'queryInput':{'audioConfig':{'audioEncoding':_0x4eb4da,'sampleRateHertz':_0x140344,'languageCode':_0x27ad2a}},'inputAudio':_0x2bc4d1},_0x3aa855=await _0x576e69[_0x106fcc(0xfd)](_0x5252c6);return _0x3aa855[0x0];}async function queryDialogFlow(_0x39450c,_0x2480ac,_0x76a59,_0x5280c5,_0x5acd38,_0x2f1c94){const _0x1f3c36=a529_0x287e2d;let _0x41270f;if(_0x2f1c94){try{_0x41270f=await detectAudioIntent(_0x39450c,_0x2480ac,_0x76a59,_0x5acd38,_0x2f1c94);const _0x2631e4=_0x41270f?.[_0x1f3c36(0xf2)]?.[_0x1f3c36(0xe0)],_0x1e6790=_0x41270f?.[_0x1f3c36(0xf2)]?.[_0x1f3c36(0xea)]?.[_0x1f3c36(0xfc)]?.[_0x1f3c36(0xf1)]?.[_0x1f3c36(0xe4)],_0x266322=_0x41270f?.['queryResult']?.[_0x1f3c36(0xf9)]?.[_0x1f3c36(0xfc)],_0x555b85=_0x41270f?.[_0x1f3c36(0xf6)];return _0x2631e4?.[_0x1f3c36(0xec)]===0x0?null:{'responses':_0x2631e4,'endConversation':_0x1e6790,'parameters':_0x266322,'encodedAudio':_0x555b85};}catch(_0x59e7ee){Sentry['captureException'](_0x59e7ee),logger_1['logger'][_0x1f3c36(0xeb)](_0x1f3c36(0xe8)+_0x59e7ee);}return null;}else{try{_0x41270f=await detectIntent(_0x39450c,_0x2480ac,_0x76a59,_0x5280c5,_0x5acd38);const _0x4b39b3=_0x41270f?.[_0x1f3c36(0xf2)]?.[_0x1f3c36(0xe0)],_0x8f67e=_0x41270f?.[_0x1f3c36(0xf2)]?.[_0x1f3c36(0xea)]?.[_0x1f3c36(0xfc)]?.['end_conversation']?.[_0x1f3c36(0xe4)],_0x4e6b30=_0x41270f?.[_0x1f3c36(0xf2)]?.['parameters']?.[_0x1f3c36(0xfc)],_0x226111=_0x41270f?.[_0x1f3c36(0xf6)];return _0x4b39b3?.['length']===0x0?null:{'responses':_0x4b39b3,'endConversation':_0x8f67e,'parameters':_0x4e6b30,'encodedAudio':_0x226111};}catch(_0x5cfe6d){Sentry[_0x1f3c36(0xdc)](_0x5cfe6d),logger_1['logger'][_0x1f3c36(0xeb)](_0x1f3c36(0xe8)+_0x5cfe6d);}return null;}}exports[a529_0x287e2d(0xf5)]=queryDialogFlow;