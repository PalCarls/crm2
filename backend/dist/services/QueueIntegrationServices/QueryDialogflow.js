'use strict';const a490_0xfdc7c7=a490_0x4805;(function(_0x24944a,_0x385005){const _0x1e9a0e=a490_0x4805,_0x4e3540=_0x24944a();while(!![]){try{const _0x263829=parseInt(_0x1e9a0e(0xb9))/0x1*(-parseInt(_0x1e9a0e(0xcc))/0x2)+parseInt(_0x1e9a0e(0xb1))/0x3+-parseInt(_0x1e9a0e(0xb3))/0x4+parseInt(_0x1e9a0e(0xae))/0x5*(-parseInt(_0x1e9a0e(0xb6))/0x6)+parseInt(_0x1e9a0e(0xbf))/0x7+-parseInt(_0x1e9a0e(0xbe))/0x8+parseInt(_0x1e9a0e(0xc9))/0x9;if(_0x263829===_0x385005)break;else _0x4e3540['push'](_0x4e3540['shift']());}catch(_0x28bdcf){_0x4e3540['push'](_0x4e3540['shift']());}}}(a490_0x2be9,0x9bb0d));function a490_0x2be9(){const _0x21d8f2=['projectAgentSessionPath','2038MoCPvf','detectIntent','fulfillmentMessages','boolValue','queryResult','getOwnPropertyDescriptor','end_conversation','85FOZWsE','prototype','create','1179843gdHlMO','defineProperty','2846792bRLPwP','parameters','@sentry/node','274044fYkTRy','__importStar','__esModule','941tFNLJM','diagnosticInfo','error','configurable','Error\x20handling\x20whatsapp\x20message:\x20Err:\x20','5959088XTxleP','8245972kHoszz','captureException','hasOwnProperty','fields','call','logger','outputAudio','__createBinding','default','length','20325177nwFjjV','__setModuleDefault'];a490_0x2be9=function(){return _0x21d8f2;};return a490_0x2be9();}function a490_0x4805(_0x481e5e,_0x2d04eb){const _0x2be92b=a490_0x2be9();return a490_0x4805=function(_0x480548,_0x2362af){_0x480548=_0x480548-0xa8;let _0x2a2222=_0x2be92b[_0x480548];return _0x2a2222;},a490_0x4805(_0x481e5e,_0x2d04eb);}var __createBinding=this&&this[a490_0xfdc7c7(0xc6)]||(Object[a490_0xfdc7c7(0xb0)]?function(_0xeed2b0,_0x17d3b7,_0x50a335,_0x18305b){const _0x33f189=a490_0xfdc7c7;if(_0x18305b===undefined)_0x18305b=_0x50a335;var _0x4992c9=Object[_0x33f189(0xac)](_0x17d3b7,_0x50a335);(!_0x4992c9||('get'in _0x4992c9?!_0x17d3b7[_0x33f189(0xb8)]:_0x4992c9['writable']||_0x4992c9[_0x33f189(0xbc)]))&&(_0x4992c9={'enumerable':!![],'get':function(){return _0x17d3b7[_0x50a335];}}),Object[_0x33f189(0xb2)](_0xeed2b0,_0x18305b,_0x4992c9);}:function(_0x547b2a,_0xe15a31,_0x2c31f6,_0x491844){if(_0x491844===undefined)_0x491844=_0x2c31f6;_0x547b2a[_0x491844]=_0xe15a31[_0x2c31f6];}),__setModuleDefault=this&&this[a490_0xfdc7c7(0xca)]||(Object['create']?function(_0x226fbb,_0x42f811){const _0x2cdb50=a490_0xfdc7c7;Object['defineProperty'](_0x226fbb,_0x2cdb50(0xc7),{'enumerable':!![],'value':_0x42f811});}:function(_0x4359a3,_0x1fe8c2){_0x4359a3['default']=_0x1fe8c2;}),__importStar=this&&this[a490_0xfdc7c7(0xb7)]||function(_0x98f7f){const _0x4bac15=a490_0xfdc7c7;if(_0x98f7f&&_0x98f7f[_0x4bac15(0xb8)])return _0x98f7f;var _0x2b4989={};if(_0x98f7f!=null){for(var _0x4015e0 in _0x98f7f)if(_0x4015e0!==_0x4bac15(0xc7)&&Object[_0x4bac15(0xaf)][_0x4bac15(0xc1)][_0x4bac15(0xc3)](_0x98f7f,_0x4015e0))__createBinding(_0x2b4989,_0x98f7f,_0x4015e0);}return __setModuleDefault(_0x2b4989,_0x98f7f),_0x2b4989;};Object[a490_0xfdc7c7(0xb2)](exports,a490_0xfdc7c7(0xb8),{'value':!![]}),exports['queryDialogFlow']=void 0x0;const Sentry=__importStar(require(a490_0xfdc7c7(0xb5))),logger_1=require('../../utils/logger');async function detectIntent(_0x5c39de,_0x4eaefa,_0x5260b8,_0x2f45c6,_0x58d42c){const _0x448dd4=a490_0xfdc7c7,_0x312a99=_0x5c39de[_0x448dd4(0xcb)](_0x4eaefa,_0x5260b8),_0x175d3d={'session':_0x312a99,'queryInput':{'text':{'text':_0x2f45c6,'languageCode':_0x58d42c}}},_0x57bd7f=await _0x5c39de[_0x448dd4(0xa8)](_0x175d3d);return _0x57bd7f[0x0];}async function detectAudioIntent(_0x22dd20,_0x389306,_0x24c1f6,_0x31ab94,_0x5bfebe){const _0x3e17c6=_0x22dd20['projectAgentSessionPath'](_0x389306,_0x24c1f6),_0x2d6de6=0x6,_0x21c1cd=0x3e80,_0x15a8c5={'session':_0x3e17c6,'queryInput':{'audioConfig':{'audioEncoding':_0x2d6de6,'sampleRateHertz':_0x21c1cd,'languageCode':_0x31ab94}},'inputAudio':_0x5bfebe},_0xd26060=await _0x22dd20['detectIntent'](_0x15a8c5);return _0xd26060[0x0];}async function queryDialogFlow(_0x2487ae,_0x381dde,_0x1c52ad,_0x3e6ffc,_0x45884d,_0x5d480e){const _0x3ecd50=a490_0xfdc7c7;let _0x1f00c7;if(_0x5d480e){try{_0x1f00c7=await detectAudioIntent(_0x2487ae,_0x381dde,_0x1c52ad,_0x45884d,_0x5d480e);const _0x2ec881=_0x1f00c7?.[_0x3ecd50(0xab)]?.[_0x3ecd50(0xa9)],_0x197230=_0x1f00c7?.['queryResult']?.['diagnosticInfo']?.[_0x3ecd50(0xc2)]?.[_0x3ecd50(0xad)]?.[_0x3ecd50(0xaa)],_0xfcdb98=_0x1f00c7?.['queryResult']?.[_0x3ecd50(0xb4)]?.[_0x3ecd50(0xc2)],_0x5a4dd8=_0x1f00c7?.[_0x3ecd50(0xc5)];return _0x2ec881?.[_0x3ecd50(0xc8)]===0x0?null:{'responses':_0x2ec881,'endConversation':_0x197230,'parameters':_0xfcdb98,'encodedAudio':_0x5a4dd8};}catch(_0xa12455){Sentry[_0x3ecd50(0xc0)](_0xa12455),logger_1[_0x3ecd50(0xc4)][_0x3ecd50(0xbb)](_0x3ecd50(0xbd)+_0xa12455);}return null;}else{try{_0x1f00c7=await detectIntent(_0x2487ae,_0x381dde,_0x1c52ad,_0x3e6ffc,_0x45884d);const _0x3f2d41=_0x1f00c7?.[_0x3ecd50(0xab)]?.[_0x3ecd50(0xa9)],_0x5e4c5f=_0x1f00c7?.[_0x3ecd50(0xab)]?.[_0x3ecd50(0xba)]?.[_0x3ecd50(0xc2)]?.[_0x3ecd50(0xad)]?.[_0x3ecd50(0xaa)],_0x814c6d=_0x1f00c7?.['queryResult']?.['parameters']?.['fields'],_0x289e55=_0x1f00c7?.['outputAudio'];return _0x3f2d41?.[_0x3ecd50(0xc8)]===0x0?null:{'responses':_0x3f2d41,'endConversation':_0x5e4c5f,'parameters':_0x814c6d,'encodedAudio':_0x289e55};}catch(_0x49e950){Sentry['captureException'](_0x49e950),logger_1[_0x3ecd50(0xc4)][_0x3ecd50(0xbb)](_0x3ecd50(0xbd)+_0x49e950);}return null;}}exports['queryDialogFlow']=queryDialogFlow;