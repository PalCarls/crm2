'use strict';const a567_0x5df77c=a567_0x48c8;(function(_0x232520,_0x212752){const _0x438570=a567_0x48c8,_0x3479f3=_0x232520();while(!![]){try{const _0x2b4b1d=-parseInt(_0x438570(0x13a))/0x1+parseInt(_0x438570(0x144))/0x2+parseInt(_0x438570(0x15f))/0x3+parseInt(_0x438570(0x13b))/0x4*(parseInt(_0x438570(0x153))/0x5)+parseInt(_0x438570(0x148))/0x6+-parseInt(_0x438570(0x141))/0x7+-parseInt(_0x438570(0x160))/0x8*(parseInt(_0x438570(0x149))/0x9);if(_0x2b4b1d===_0x212752)break;else _0x3479f3['push'](_0x3479f3['shift']());}catch(_0x255c3c){_0x3479f3['push'](_0x3479f3['shift']());}}}(a567_0x337e,0x8703e));var __createBinding=this&&this['__createBinding']||(Object[a567_0x5df77c(0x142)]?function(_0x378151,_0x3bc2ce,_0x40a919,_0x358c1e){const _0xc6c346=a567_0x5df77c;if(_0x358c1e===undefined)_0x358c1e=_0x40a919;var _0x24fce2=Object[_0xc6c346(0x132)](_0x3bc2ce,_0x40a919);(!_0x24fce2||(_0xc6c346(0x143)in _0x24fce2?!_0x3bc2ce['__esModule']:_0x24fce2['writable']||_0x24fce2[_0xc6c346(0x151)]))&&(_0x24fce2={'enumerable':!![],'get':function(){return _0x3bc2ce[_0x40a919];}}),Object[_0xc6c346(0x152)](_0x378151,_0x358c1e,_0x24fce2);}:function(_0x1e7a65,_0x3783c8,_0x23af06,_0x3bcfa4){if(_0x3bcfa4===undefined)_0x3bcfa4=_0x23af06;_0x1e7a65[_0x3bcfa4]=_0x3783c8[_0x23af06];}),__setModuleDefault=this&&this[a567_0x5df77c(0x138)]||(Object[a567_0x5df77c(0x142)]?function(_0x268b74,_0x8a02b2){const _0x1c61dd=a567_0x5df77c;Object['defineProperty'](_0x268b74,_0x1c61dd(0x150),{'enumerable':!![],'value':_0x8a02b2});}:function(_0x539d18,_0x44ca0c){const _0x1d5396=a567_0x5df77c;_0x539d18[_0x1d5396(0x150)]=_0x44ca0c;}),__importStar=this&&this[a567_0x5df77c(0x14e)]||function(_0x43a70c){const _0xf7d04f=a567_0x5df77c;if(_0x43a70c&&_0x43a70c[_0xf7d04f(0x13f)])return _0x43a70c;var _0x2c3828={};if(_0x43a70c!=null){for(var _0x6ba518 in _0x43a70c)if(_0x6ba518!==_0xf7d04f(0x150)&&Object[_0xf7d04f(0x14d)][_0xf7d04f(0x134)]['call'](_0x43a70c,_0x6ba518))__createBinding(_0x2c3828,_0x43a70c,_0x6ba518);}return __setModuleDefault(_0x2c3828,_0x43a70c),_0x2c3828;},__importDefault=this&&this[a567_0x5df77c(0x14f)]||function(_0x19a9e9){const _0x185989=a567_0x5df77c;return _0x19a9e9&&_0x19a9e9[_0x185989(0x13f)]?_0x19a9e9:{'default':_0x19a9e9};};function a567_0x337e(){const _0x4e694d=['includes','1918671RRRIpq','8SKLXyN','isGroup','update','getOwnPropertyDescriptor','TEL;type=CELL;waid=','hasOwnProperty','split','VERSION:3.0\x0a','message','__setModuleDefault','FN:','440558DxqXux','4708cfsBtg','parse','findByPk','extendedTextMessage','__esModule','name','1508584CpDUim','create','get','1800774fFvfws','sendMessage','key','conversation','2955834GGBwLP','16076493XOPvCQ','../../helpers/GetTicketWbot',';;;\x0a','ERR_SENDING_WAPP_MSG','prototype','__importStar','__importDefault','default','configurable','defineProperty','4090rrUBqo','captureException','contactId','../../models/Contact','remoteJid','replace','delay','BEGIN:VCARD\x0a','number','dataJson','g.us'];a567_0x337e=function(){return _0x4e694d;};return a567_0x337e();}Object['defineProperty'](exports,a567_0x5df77c(0x13f),{'value':!![]});const baileys_1=require('@whiskeysockets/baileys'),Sentry=__importStar(require('@sentry/node')),AppError_1=__importDefault(require('../../errors/AppError')),GetTicketWbot_1=__importDefault(require(a567_0x5df77c(0x14a))),Message_1=__importDefault(require('../../models/Message')),Contact_1=__importDefault(require(a567_0x5df77c(0x156))),lodash_1=require('lodash'),Mustache_1=__importDefault(require('../../helpers/Mustache')),SendWhatsAppMessage=async({body:_0x1d8e2b,ticket:_0x1757af,quotedMsg:_0x14fece,msdelay:_0x5f4e32,isPrivate:_0xc395fe,vCard:_0xe5e4dd,isForwarded:isForwarded=![]})=>{const _0xf8b93c=a567_0x5df77c;let _0x9fd73b={};const _0x711f4=await(0x0,GetTicketWbot_1[_0xf8b93c(0x150)])(_0x1757af),_0x3cb341=await Contact_1['default'][_0xf8b93c(0x13d)](_0x1757af[_0xf8b93c(0x155)]);let _0x140197;_0x3cb341[_0xf8b93c(0x157)]&&_0x3cb341[_0xf8b93c(0x157)]!==''&&_0x3cb341[_0xf8b93c(0x157)][_0xf8b93c(0x15e)]('@')?_0x140197=_0x3cb341[_0xf8b93c(0x157)]:_0x140197=_0x3cb341[_0xf8b93c(0x15b)]+'@'+(_0x1757af[_0xf8b93c(0x161)]?_0xf8b93c(0x15d):'s.whatsapp.net');if(_0x14fece){const _0x2cdda9=await Message_1['default']['findOne']({'where':{'id':_0x14fece['id']}});if(_0x2cdda9){const _0x2f6ed1=JSON[_0xf8b93c(0x13c)](_0x2cdda9[_0xf8b93c(0x15c)]);_0x2f6ed1['message'][_0xf8b93c(0x13e)]!==undefined?_0x9fd73b={'quoted':{'key':_0x2f6ed1[_0xf8b93c(0x146)],'message':{'extendedTextMessage':_0x2f6ed1[_0xf8b93c(0x137)][_0xf8b93c(0x13e)]}}}:_0x9fd73b={'quoted':{'key':_0x2f6ed1[_0xf8b93c(0x146)],'message':{'conversation':_0x2f6ed1[_0xf8b93c(0x137)][_0xf8b93c(0x147)]}}};}}if(!(0x0,lodash_1['isNil'])(_0xe5e4dd)){const _0xfe0d54=_0xe5e4dd[_0xf8b93c(0x15b)],_0x33cb80=_0xe5e4dd[_0xf8b93c(0x140)][_0xf8b93c(0x135)]('\x20')[0x0],_0x2e59bb=String(_0xe5e4dd['name'])[_0xf8b93c(0x158)](_0xe5e4dd[_0xf8b93c(0x140)][_0xf8b93c(0x135)]('\x20')[0x0],''),_0x3daaa8=_0xf8b93c(0x15a)+_0xf8b93c(0x136)+('N:'+_0x2e59bb+';'+_0x33cb80+_0xf8b93c(0x14b))+(_0xf8b93c(0x139)+_0xe5e4dd[_0xf8b93c(0x140)]+'\x0a')+(_0xf8b93c(0x133)+_0xfe0d54+':+'+_0xfe0d54+'\x0a')+'END:VCARD';try{await(0x0,baileys_1[_0xf8b93c(0x159)])(_0x5f4e32);const _0x5606f3=await _0x711f4['sendMessage'](_0x140197,{'contacts':{'displayName':''+_0xe5e4dd['name'],'contacts':[{'vcard':_0x3daaa8}]}});return await _0x1757af[_0xf8b93c(0x162)]({'lastMessage':(0x0,Mustache_1[_0xf8b93c(0x150)])(_0x3daaa8,_0x1757af),'imported':null}),_0x5606f3;}catch(_0x1ab930){Sentry[_0xf8b93c(0x154)](_0x1ab930),console['log'](_0x1ab930);throw new AppError_1[(_0xf8b93c(0x150))]('ERR_SENDING_WAPP_MSG');}};try{await(0x0,baileys_1['delay'])(_0x5f4e32);const _0x738a5b=await _0x711f4[_0xf8b93c(0x145)](_0x140197,{'text':(0x0,Mustache_1['default'])(_0x1d8e2b,_0x1757af),'contextInfo':{'forwardingScore':isForwarded?0x2:0x0,'isForwarded':isForwarded?!![]:![]}},{..._0x9fd73b});return await _0x1757af['update']({'lastMessage':(0x0,Mustache_1['default'])(_0x1d8e2b,_0x1757af),'imported':null}),_0x738a5b;}catch(_0x32f1ea){Sentry[_0xf8b93c(0x154)](_0x32f1ea),console['log'](_0x32f1ea);throw new AppError_1[(_0xf8b93c(0x150))](_0xf8b93c(0x14c));}};function a567_0x48c8(_0x56e7b4,_0x2a6a29){const _0x337edb=a567_0x337e();return a567_0x48c8=function(_0x48c887,_0x42a220){_0x48c887=_0x48c887-0x132;let _0x59281d=_0x337edb[_0x48c887];return _0x59281d;},a567_0x48c8(_0x56e7b4,_0x2a6a29);}exports[a567_0x5df77c(0x150)]=SendWhatsAppMessage;