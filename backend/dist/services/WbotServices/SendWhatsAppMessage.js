'use strict';function a620_0x4a39(_0x250f92,_0x52ccbb){const _0x4bdfff=a620_0x4bdf();return a620_0x4a39=function(_0x4a3920,_0x6ee2e){_0x4a3920=_0x4a3920-0x9e;let _0xb86dd3=_0x4bdfff[_0x4a3920];return _0xb86dd3;},a620_0x4a39(_0x250f92,_0x52ccbb);}const a620_0x242e4a=a620_0x4a39;(function(_0x3abfb0,_0x103a7b){const _0x4aeb18=a620_0x4a39,_0x431b67=_0x3abfb0();while(!![]){try{const _0x3d6c93=parseInt(_0x4aeb18(0xbc))/0x1+parseInt(_0x4aeb18(0xc5))/0x2*(-parseInt(_0x4aeb18(0xa6))/0x3)+parseInt(_0x4aeb18(0xa5))/0x4*(-parseInt(_0x4aeb18(0xb1))/0x5)+-parseInt(_0x4aeb18(0xab))/0x6+-parseInt(_0x4aeb18(0xaf))/0x7*(parseInt(_0x4aeb18(0xd0))/0x8)+parseInt(_0x4aeb18(0xbe))/0x9*(parseInt(_0x4aeb18(0xb9))/0xa)+-parseInt(_0x4aeb18(0xbb))/0xb*(-parseInt(_0x4aeb18(0xc8))/0xc);if(_0x3d6c93===_0x103a7b)break;else _0x431b67['push'](_0x431b67['shift']());}catch(_0x35593c){_0x431b67['push'](_0x431b67['shift']());}}}(a620_0x4bdf,0xcc2ab));var __createBinding=this&&this[a620_0x242e4a(0xbf)]||(Object['create']?function(_0x372c0f,_0x176e68,_0x47d8e6,_0x1c70bc){const _0x101be5=a620_0x242e4a;if(_0x1c70bc===undefined)_0x1c70bc=_0x47d8e6;var _0x3efc0a=Object[_0x101be5(0xb3)](_0x176e68,_0x47d8e6);(!_0x3efc0a||('get'in _0x3efc0a?!_0x176e68[_0x101be5(0xb4)]:_0x3efc0a[_0x101be5(0xa0)]||_0x3efc0a['configurable']))&&(_0x3efc0a={'enumerable':!![],'get':function(){return _0x176e68[_0x47d8e6];}}),Object[_0x101be5(0xb2)](_0x372c0f,_0x1c70bc,_0x3efc0a);}:function(_0x36ed6b,_0x365556,_0x216752,_0x41d114){if(_0x41d114===undefined)_0x41d114=_0x216752;_0x36ed6b[_0x41d114]=_0x365556[_0x216752];}),__setModuleDefault=this&&this[a620_0x242e4a(0xb5)]||(Object['create']?function(_0x3fcdf2,_0x222543){Object['defineProperty'](_0x3fcdf2,'default',{'enumerable':!![],'value':_0x222543});}:function(_0x51138b,_0x589226){const _0x39cdb4=a620_0x242e4a;_0x51138b[_0x39cdb4(0xc9)]=_0x589226;}),__importStar=this&&this['__importStar']||function(_0x4ed80e){const _0x3812dc=a620_0x242e4a;if(_0x4ed80e&&_0x4ed80e['__esModule'])return _0x4ed80e;var _0x85bda0={};if(_0x4ed80e!=null){for(var _0x5cfb26 in _0x4ed80e)if(_0x5cfb26!=='default'&&Object['prototype'][_0x3812dc(0xa8)][_0x3812dc(0xa7)](_0x4ed80e,_0x5cfb26))__createBinding(_0x85bda0,_0x4ed80e,_0x5cfb26);}return __setModuleDefault(_0x85bda0,_0x4ed80e),_0x85bda0;},__importDefault=this&&this['__importDefault']||function(_0x137ffd){return _0x137ffd&&_0x137ffd['__esModule']?_0x137ffd:{'default':_0x137ffd};};Object[a620_0x242e4a(0xb2)](exports,a620_0x242e4a(0xb4),{'value':!![]});const baileys_1=require(a620_0x242e4a(0x9e)),Sentry=__importStar(require(a620_0x242e4a(0xce))),AppError_1=__importDefault(require(a620_0x242e4a(0xbd))),GetTicketWbot_1=__importDefault(require(a620_0x242e4a(0xac))),Message_1=__importDefault(require(a620_0x242e4a(0xa4))),Contact_1=__importDefault(require('../../models/Contact')),lodash_1=require(a620_0x242e4a(0xb7)),Mustache_1=__importDefault(require(a620_0x242e4a(0xcd))),SendWhatsAppMessage=async({body:_0x2ffeb7,ticket:_0x4889e6,quotedMsg:_0x980582,msdelay:_0x5b324f,vCard:_0x30d17e,isForwarded:isForwarded=![]})=>{const _0x57213c=a620_0x242e4a;let _0x34ef53={};const _0x56c3a9=await(0x0,GetTicketWbot_1[_0x57213c(0xc9)])(_0x4889e6),_0x4864b8=await Contact_1[_0x57213c(0xc9)][_0x57213c(0xb8)](_0x4889e6['contactId']);let _0x1841da;_0x4864b8[_0x57213c(0xa9)]&&_0x4864b8['remoteJid']!==''&&_0x4864b8[_0x57213c(0xa9)]['includes']('@')?_0x1841da=_0x4864b8[_0x57213c(0xa9)]:_0x1841da=_0x4864b8[_0x57213c(0xcc)]+'@'+(_0x4889e6[_0x57213c(0xd1)]?_0x57213c(0xc0):'s.whatsapp.net');if(_0x980582){const _0x4afe92=await Message_1[_0x57213c(0xc9)][_0x57213c(0xb6)]({'where':{'id':_0x980582['id']}});if(_0x4afe92){const _0x6ae590=JSON[_0x57213c(0xc4)](_0x4afe92[_0x57213c(0xc6)]);_0x6ae590['message']['extendedTextMessage']!==undefined?_0x34ef53={'quoted':{'key':_0x6ae590['key'],'message':{'extendedTextMessage':_0x6ae590[_0x57213c(0xba)]['extendedTextMessage']}}}:_0x34ef53={'quoted':{'key':_0x6ae590[_0x57213c(0xca)],'message':{'conversation':_0x6ae590['message'][_0x57213c(0xb0)]}}};}}if(!(0x0,lodash_1[_0x57213c(0xa1)])(_0x30d17e)){const _0x513765=_0x30d17e[_0x57213c(0xcc)],_0x3bc315=_0x30d17e['name'][_0x57213c(0xcb)]('\x20')[0x0],_0x43ee2c=String(_0x30d17e[_0x57213c(0xa3)])[_0x57213c(0xad)](_0x30d17e[_0x57213c(0xa3)][_0x57213c(0xcb)]('\x20')[0x0],''),_0x8af364=_0x57213c(0xc7)+_0x57213c(0xc2)+('N:'+_0x43ee2c+';'+_0x3bc315+';;;\x0a')+('FN:'+_0x30d17e[_0x57213c(0xa3)]+'\x0a')+(_0x57213c(0xc1)+_0x513765+':+'+_0x513765+'\x0a')+_0x57213c(0xaa);try{await(0x0,baileys_1[_0x57213c(0xc3)])(_0x5b324f);const _0x3a43f9=await _0x56c3a9['sendMessage'](_0x1841da,{'contacts':{'displayName':''+_0x30d17e['name'],'contacts':[{'vcard':_0x8af364}]}});return await _0x4889e6[_0x57213c(0xcf)]({'lastMessage':(0x0,Mustache_1[_0x57213c(0xc9)])(_0x8af364,_0x4889e6),'imported':null}),_0x3a43f9;}catch(_0x336e02){Sentry[_0x57213c(0xa2)](_0x336e02),console[_0x57213c(0x9f)](_0x336e02);throw new AppError_1['default'](_0x57213c(0xae));}};try{await(0x0,baileys_1['delay'])(_0x5b324f);const _0x2d1482=await _0x56c3a9['sendMessage'](_0x1841da,{'text':(0x0,Mustache_1['default'])(_0x2ffeb7,_0x4889e6),'contextInfo':{'forwardingScore':isForwarded?0x2:0x0,'isForwarded':isForwarded?!![]:![]}},{..._0x34ef53});return await _0x4889e6[_0x57213c(0xcf)]({'lastMessage':(0x0,Mustache_1[_0x57213c(0xc9)])(_0x2ffeb7,_0x4889e6),'imported':null}),_0x2d1482;}catch(_0x386361){Sentry[_0x57213c(0xa2)](_0x386361),console[_0x57213c(0x9f)](_0x386361);throw new AppError_1[(_0x57213c(0xc9))](_0x57213c(0xae));}};exports[a620_0x242e4a(0xc9)]=SendWhatsAppMessage;function a620_0x4bdf(){const _0x58e03e=['getOwnPropertyDescriptor','__esModule','__setModuleDefault','findOne','lodash','findByPk','7720GziGon','message','7203097xdQWfm','947399XXRKlM','../../errors/AppError','3798PHmFXT','__createBinding','g.us','TEL;type=CELL;waid=','VERSION:3.0\x0a','delay','parse','12SZQtvW','dataJson','BEGIN:VCARD\x0a','12aaOPqp','default','key','split','number','../../helpers/Mustache','@sentry/node','update','442664koWTzS','isGroup','@whiskeysockets/baileys','log','writable','isNil','captureException','name','../../models/Message','4ZYiZdr','40785fiBxJb','call','hasOwnProperty','remoteJid','END:VCARD','1740876kpaefc','../../helpers/GetTicketWbot','replace','ERR_SENDING_WAPP_MSG','14gGcMYE','conversation','3046805zflUTi','defineProperty'];a620_0x4bdf=function(){return _0x58e03e;};return a620_0x4bdf();}