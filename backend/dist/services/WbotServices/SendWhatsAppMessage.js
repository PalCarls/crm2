'use strict';function a608_0x2f4b(){const _0x351b6a=['conversation','log','1130448sKzBCN','default','call','captureException','get','../../models/Message','@whiskeysockets/baileys','parse','__setModuleDefault','240630uoRqhK','delay','sendMessage','150630eumeRt','remoteJid','replace','250GXajeO','writable','64BqwFuG','668XprASv','includes','1833CBToFJ','40018SWJdSo','isGroup','5COjMvx','@sentry/node','extendedTextMessage','../../models/Contact','name','FN:','__esModule','TEL;type=CELL;waid=','findOne','s.whatsapp.net','defineProperty','number','update','2002167uprABq','lodash','END:VCARD','../../errors/AppError','18767iENmue','__importStar','BEGIN:VCARD\x0a','split','g.us','message','key','prototype','hasOwnProperty','create','configurable','__importDefault'];a608_0x2f4b=function(){return _0x351b6a;};return a608_0x2f4b();}const a608_0x18bf76=a608_0x1aee;(function(_0x430c83,_0x11d159){const _0x538f53=a608_0x1aee,_0x9c4601=_0x430c83();while(!![]){try{const _0x3cc2ef=-parseInt(_0x538f53(0xb7))/0x1+parseInt(_0x538f53(0x87))/0x2*(parseInt(_0x538f53(0x89))/0x3)+parseInt(_0x538f53(0xab))/0x4+-parseInt(_0x538f53(0x8c))/0x5*(parseInt(_0x538f53(0xb4))/0x6)+parseInt(_0x538f53(0x9d))/0x7*(-parseInt(_0x538f53(0x86))/0x8)+-parseInt(_0x538f53(0x99))/0x9+parseInt(_0x538f53(0x84))/0xa*(parseInt(_0x538f53(0x8a))/0xb);if(_0x3cc2ef===_0x11d159)break;else _0x9c4601['push'](_0x9c4601['shift']());}catch(_0x2eb939){_0x9c4601['push'](_0x9c4601['shift']());}}}(a608_0x2f4b,0x22e8e));var __createBinding=this&&this['__createBinding']||(Object[a608_0x18bf76(0xa6)]?function(_0x39fc0f,_0x1608fd,_0x36a9e4,_0x42d90e){const _0xb06e6d=a608_0x18bf76;if(_0x42d90e===undefined)_0x42d90e=_0x36a9e4;var _0x56a711=Object['getOwnPropertyDescriptor'](_0x1608fd,_0x36a9e4);(!_0x56a711||(_0xb06e6d(0xaf)in _0x56a711?!_0x1608fd[_0xb06e6d(0x92)]:_0x56a711[_0xb06e6d(0x85)]||_0x56a711[_0xb06e6d(0xa7)]))&&(_0x56a711={'enumerable':!![],'get':function(){return _0x1608fd[_0x36a9e4];}}),Object[_0xb06e6d(0x96)](_0x39fc0f,_0x42d90e,_0x56a711);}:function(_0x46905a,_0x564ab4,_0x4ec477,_0x12206a){if(_0x12206a===undefined)_0x12206a=_0x4ec477;_0x46905a[_0x12206a]=_0x564ab4[_0x4ec477];}),__setModuleDefault=this&&this[a608_0x18bf76(0xb3)]||(Object[a608_0x18bf76(0xa6)]?function(_0x553faa,_0x54d1cf){const _0x2c6e1b=a608_0x18bf76;Object[_0x2c6e1b(0x96)](_0x553faa,'default',{'enumerable':!![],'value':_0x54d1cf});}:function(_0x40401d,_0x30870a){_0x40401d['default']=_0x30870a;}),__importStar=this&&this[a608_0x18bf76(0x9e)]||function(_0x5aac36){const _0x1bce86=a608_0x18bf76;if(_0x5aac36&&_0x5aac36[_0x1bce86(0x92)])return _0x5aac36;var _0x374ee7={};if(_0x5aac36!=null){for(var _0x4488cb in _0x5aac36)if(_0x4488cb!=='default'&&Object[_0x1bce86(0xa4)][_0x1bce86(0xa5)][_0x1bce86(0xad)](_0x5aac36,_0x4488cb))__createBinding(_0x374ee7,_0x5aac36,_0x4488cb);}return __setModuleDefault(_0x374ee7,_0x5aac36),_0x374ee7;},__importDefault=this&&this[a608_0x18bf76(0xa8)]||function(_0x3e95e6){return _0x3e95e6&&_0x3e95e6['__esModule']?_0x3e95e6:{'default':_0x3e95e6};};Object['defineProperty'](exports,a608_0x18bf76(0x92),{'value':!![]});function a608_0x1aee(_0x5efda2,_0x196e8b){const _0x2f4bbf=a608_0x2f4b();return a608_0x1aee=function(_0x1aee61,_0x35c5e1){_0x1aee61=_0x1aee61-0x84;let _0x211f2b=_0x2f4bbf[_0x1aee61];return _0x211f2b;},a608_0x1aee(_0x5efda2,_0x196e8b);}const baileys_1=require(a608_0x18bf76(0xb1)),Sentry=__importStar(require(a608_0x18bf76(0x8d))),AppError_1=__importDefault(require(a608_0x18bf76(0x9c))),GetTicketWbot_1=__importDefault(require('../../helpers/GetTicketWbot')),Message_1=__importDefault(require(a608_0x18bf76(0xb0))),Contact_1=__importDefault(require(a608_0x18bf76(0x8f))),lodash_1=require(a608_0x18bf76(0x9a)),Mustache_1=__importDefault(require('../../helpers/Mustache')),SendWhatsAppMessage=async({body:_0x1615c2,ticket:_0x20cd0b,quotedMsg:_0x2d8a04,msdelay:_0x39fce1,isPrivate:_0x1aa08d,vCard:_0x3a2cc2,isForwarded:isForwarded=![]})=>{const _0xd7b2c3=a608_0x18bf76;let _0x4a665c={};const _0x18712e=await(0x0,GetTicketWbot_1[_0xd7b2c3(0xac)])(_0x20cd0b),_0x198f34=await Contact_1[_0xd7b2c3(0xac)]['findByPk'](_0x20cd0b['contactId']);let _0x2c96b2;_0x198f34[_0xd7b2c3(0xb8)]&&_0x198f34[_0xd7b2c3(0xb8)]!==''&&_0x198f34[_0xd7b2c3(0xb8)][_0xd7b2c3(0x88)]('@')?_0x2c96b2=_0x198f34[_0xd7b2c3(0xb8)]:_0x2c96b2=_0x198f34[_0xd7b2c3(0x97)]+'@'+(_0x20cd0b[_0xd7b2c3(0x8b)]?_0xd7b2c3(0xa1):_0xd7b2c3(0x95));if(_0x2d8a04){const _0x57bf64=await Message_1[_0xd7b2c3(0xac)][_0xd7b2c3(0x94)]({'where':{'id':_0x2d8a04['id']}});if(_0x57bf64){const _0x761ed5=JSON[_0xd7b2c3(0xb2)](_0x57bf64['dataJson']);_0x761ed5[_0xd7b2c3(0xa2)][_0xd7b2c3(0x8e)]!==undefined?_0x4a665c={'quoted':{'key':_0x761ed5[_0xd7b2c3(0xa3)],'message':{'extendedTextMessage':_0x761ed5['message'][_0xd7b2c3(0x8e)]}}}:_0x4a665c={'quoted':{'key':_0x761ed5[_0xd7b2c3(0xa3)],'message':{'conversation':_0x761ed5['message'][_0xd7b2c3(0xa9)]}}};}}if(!(0x0,lodash_1['isNil'])(_0x3a2cc2)){const _0x159257=_0x3a2cc2[_0xd7b2c3(0x97)],_0x2bb2af=_0x3a2cc2[_0xd7b2c3(0x90)][_0xd7b2c3(0xa0)]('\x20')[0x0],_0xe44259=String(_0x3a2cc2[_0xd7b2c3(0x90)])[_0xd7b2c3(0xb9)](_0x3a2cc2['name']['split']('\x20')[0x0],''),_0x444b0d=_0xd7b2c3(0x9f)+'VERSION:3.0\x0a'+('N:'+_0xe44259+';'+_0x2bb2af+';;;\x0a')+(_0xd7b2c3(0x91)+_0x3a2cc2[_0xd7b2c3(0x90)]+'\x0a')+(_0xd7b2c3(0x93)+_0x159257+':+'+_0x159257+'\x0a')+_0xd7b2c3(0x9b);try{await(0x0,baileys_1[_0xd7b2c3(0xb5)])(_0x39fce1);const _0x60d9f7=await _0x18712e[_0xd7b2c3(0xb6)](_0x2c96b2,{'contacts':{'displayName':''+_0x3a2cc2[_0xd7b2c3(0x90)],'contacts':[{'vcard':_0x444b0d}]}});return await _0x20cd0b['update']({'lastMessage':(0x0,Mustache_1['default'])(_0x444b0d,_0x20cd0b),'imported':null}),_0x60d9f7;}catch(_0x39f9ad){Sentry[_0xd7b2c3(0xae)](_0x39f9ad),console[_0xd7b2c3(0xaa)](_0x39f9ad);throw new AppError_1[(_0xd7b2c3(0xac))]('ERR_SENDING_WAPP_MSG');}};try{await(0x0,baileys_1[_0xd7b2c3(0xb5)])(_0x39fce1);const _0x63e08a=await _0x18712e[_0xd7b2c3(0xb6)](_0x2c96b2,{'text':(0x0,Mustache_1['default'])(_0x1615c2,_0x20cd0b),'contextInfo':{'forwardingScore':isForwarded?0x2:0x0,'isForwarded':isForwarded?!![]:![]}},{..._0x4a665c});return await _0x20cd0b[_0xd7b2c3(0x98)]({'lastMessage':(0x0,Mustache_1[_0xd7b2c3(0xac)])(_0x1615c2,_0x20cd0b),'imported':null}),_0x63e08a;}catch(_0x12754d){Sentry[_0xd7b2c3(0xae)](_0x12754d),console['log'](_0x12754d);throw new AppError_1[(_0xd7b2c3(0xac))]('ERR_SENDING_WAPP_MSG');}};exports[a608_0x18bf76(0xac)]=SendWhatsAppMessage;