'use strict';const a544_0xf2490=a544_0x545d;(function(_0xe90676,_0x115131){const _0x4ef1f8=a544_0x545d,_0x22644d=_0xe90676();while(!![]){try{const _0x3af020=-parseInt(_0x4ef1f8(0x11a))/0x1+parseInt(_0x4ef1f8(0x12c))/0x2+parseInt(_0x4ef1f8(0x13a))/0x3*(-parseInt(_0x4ef1f8(0x14f))/0x4)+parseInt(_0x4ef1f8(0x155))/0x5*(-parseInt(_0x4ef1f8(0x139))/0x6)+parseInt(_0x4ef1f8(0x13c))/0x7+parseInt(_0x4ef1f8(0x144))/0x8+-parseInt(_0x4ef1f8(0x12d))/0x9*(-parseInt(_0x4ef1f8(0x145))/0xa);if(_0x3af020===_0x115131)break;else _0x22644d['push'](_0x22644d['shift']());}catch(_0x4e0c00){_0x22644d['push'](_0x22644d['shift']());}}}(a544_0x1c04,0xf029c));var __createBinding=this&&this[a544_0xf2490(0x126)]||(Object['create']?function(_0x17bfad,_0x4e1122,_0x23be10,_0x6e0fb3){const _0x118dfc=a544_0xf2490;if(_0x6e0fb3===undefined)_0x6e0fb3=_0x23be10;var _0x36030c=Object[_0x118dfc(0x156)](_0x4e1122,_0x23be10);(!_0x36030c||(_0x118dfc(0x146)in _0x36030c?!_0x4e1122[_0x118dfc(0x158)]:_0x36030c[_0x118dfc(0x133)]||_0x36030c[_0x118dfc(0x13b)]))&&(_0x36030c={'enumerable':!![],'get':function(){return _0x4e1122[_0x23be10];}}),Object[_0x118dfc(0x15e)](_0x17bfad,_0x6e0fb3,_0x36030c);}:function(_0x54514f,_0x33a27b,_0x42eef2,_0x33ec86){if(_0x33ec86===undefined)_0x33ec86=_0x42eef2;_0x54514f[_0x33ec86]=_0x33a27b[_0x42eef2];}),__setModuleDefault=this&&this[a544_0xf2490(0x147)]||(Object['create']?function(_0x333e33,_0x556b82){Object['defineProperty'](_0x333e33,'default',{'enumerable':!![],'value':_0x556b82});}:function(_0x12407a,_0x2912ce){const _0x4e3dec=a544_0xf2490;_0x12407a[_0x4e3dec(0x12b)]=_0x2912ce;}),__importStar=this&&this[a544_0xf2490(0x137)]||function(_0x2a4970){const _0x40eec1=a544_0xf2490;if(_0x2a4970&&_0x2a4970[_0x40eec1(0x158)])return _0x2a4970;var _0x41f6ac={};if(_0x2a4970!=null){for(var _0x544add in _0x2a4970)if(_0x544add!==_0x40eec1(0x12b)&&Object[_0x40eec1(0x124)]['hasOwnProperty'][_0x40eec1(0x12a)](_0x2a4970,_0x544add))__createBinding(_0x41f6ac,_0x2a4970,_0x544add);}return __setModuleDefault(_0x41f6ac,_0x2a4970),_0x41f6ac;},__importDefault=this&&this[a544_0xf2490(0x11c)]||function(_0x380615){const _0x4fcea1=a544_0xf2490;return _0x380615&&_0x380615[_0x4fcea1(0x158)]?_0x380615:{'default':_0x380615};};function a544_0x545d(_0xb6b8c9,_0x52f817){const _0x1c043d=a544_0x1c04();return a544_0x545d=function(_0x545d31,_0xf10864){_0x545d31=_0x545d31-0x119;let _0x29fdb5=_0x1c043d[_0x545d31];return _0x29fdb5;},a544_0x545d(_0xb6b8c9,_0x52f817);}function a544_0x1c04(){const _0xaf5dcc=['call','default','383994rnzJav','9aMPsEA','update','captureException','companyId','resolve','@sentry/node','writable','path','readFileSync','includes','__importStar','replace','18jDBFUU','5682297yygrEd','configurable','13021757FLuktP','child_process','../../helpers/Mustache','exec','video','whatsappId','log','\x20-vn\x20-ar\x2044100\x20-ac\x202\x20-b:a\x20192k\x20','4267456oSLYHi','14785690DNitwa','get','__setModuleDefault','s.whatsapp.net','split','../../models/Contact','\x20-y','\x20-vn\x20-ab\x20128k\x20-ar\x2044100\x20-f\x20ipod\x20','toString','/company','4ufKHwt','substring','ðŸŽµ\x20Arquivo\x20de\x20Ã¡udio','unlinkSync','@ffmpeg-installer/ffmpeg','mimetype','558905aHEAkK','getOwnPropertyDescriptor','sendMessage','__esModule','getMessageOptions','application','lookup','findByPk','PVT','defineProperty','audio','getTime','../../libs/wbot','text','ðŸ“Ž\x20Outros\x20anexos','851099yFTBdI','isGroup','__importDefault','../../errors/AppError','originalname','document','g.us','ðŸ“‚\x20Documento','contactId','filename','prototype','audio/mp4','__createBinding','Invalid\x20mimetype','public','remoteJid'];a544_0x1c04=function(){return _0xaf5dcc;};return a544_0x1c04();}Object[a544_0xf2490(0x15e)](exports,a544_0xf2490(0x158),{'value':!![]}),exports[a544_0xf2490(0x159)]=void 0x0;const Sentry=__importStar(require(a544_0xf2490(0x132))),fs_1=__importStar(require('fs')),child_process_1=require(a544_0xf2490(0x13d)),path_1=__importDefault(require('path')),ffmpeg_1=__importDefault(require(a544_0xf2490(0x153))),AppError_1=__importDefault(require(a544_0xf2490(0x11d))),mime_types_1=__importDefault(require('mime-types')),Contact_1=__importDefault(require(a544_0xf2490(0x14a))),wbot_1=require(a544_0xf2490(0x161)),CreateMessageService_1=__importDefault(require('../MessageServices/CreateMessageService')),Mustache_1=__importDefault(require(a544_0xf2490(0x13e))),publicFolder=path_1['default'][a544_0xf2490(0x131)](__dirname,'..','..','..',a544_0xf2490(0x128)),processAudio=async(_0x4e9d06,_0x5b88d0)=>{const _0x147292=a544_0xf2490,_0x553ebc=publicFolder+_0x147292(0x14e)+_0x5b88d0+'/'+new Date()[_0x147292(0x160)]()+'.m4a';return new Promise((_0x5e4a3c,_0x3da7a1)=>{const _0x288649=_0x147292;(0x0,child_process_1[_0x288649(0x13f)])(ffmpeg_1[_0x288649(0x12b)][_0x288649(0x134)]+'\x20-i\x20'+_0x4e9d06+_0x288649(0x14c)+_0x553ebc+_0x288649(0x14b),(_0x3a5ad5,_0x4766c9,_0x5e672e)=>{if(_0x3a5ad5)_0x3da7a1(_0x3a5ad5);_0x5e4a3c(_0x553ebc);});});},processAudioFile=async(_0x201f82,_0x3ad713)=>{const _0x6d22eb=a544_0xf2490,_0x46b813=publicFolder+_0x6d22eb(0x14e)+_0x3ad713+'/'+new Date()[_0x6d22eb(0x160)]()+'.mp3';return new Promise((_0x5c08ae,_0xaebf91)=>{const _0x1cbe3c=_0x6d22eb;(0x0,child_process_1[_0x1cbe3c(0x13f)])(ffmpeg_1[_0x1cbe3c(0x12b)][_0x1cbe3c(0x134)]+'\x20-i\x20'+_0x201f82+_0x1cbe3c(0x143)+_0x46b813,(_0x202fd0,_0x21419c,_0xf79cbc)=>{if(_0x202fd0)_0xaebf91(_0x202fd0);_0x5c08ae(_0x46b813);});});},getMessageOptions=async(_0x4a8385,_0x373093,_0x9f9a25,_0x3ccaba)=>{const _0x4f8a88=a544_0xf2490,_0x5e9303=mime_types_1['default'][_0x4f8a88(0x15b)](_0x373093),_0x4bbe70=_0x5e9303[_0x4f8a88(0x149)]('/')[0x0];try{if(!_0x5e9303)throw new Error(_0x4f8a88(0x127));let _0x37dbb5;if(_0x4bbe70===_0x4f8a88(0x140))_0x37dbb5={'video':fs_1[_0x4f8a88(0x12b)]['readFileSync'](_0x373093),'caption':_0x3ccaba?_0x3ccaba:null,'fileName':_0x4a8385};else{if(_0x4bbe70===_0x4f8a88(0x15f)){const _0x112b00=!![],_0x3391b9=await processAudio(_0x373093,_0x9f9a25);_0x112b00?_0x37dbb5={'audio':fs_1[_0x4f8a88(0x12b)]['readFileSync'](_0x3391b9),'mimetype':_0x4f8a88(0x125),'ptt':!![]}:_0x37dbb5={'audio':fs_1[_0x4f8a88(0x12b)][_0x4f8a88(0x135)](_0x3391b9),'mimetype':_0x112b00?_0x4f8a88(0x125):_0x5e9303,'ptt':!![]};}else{if(_0x4bbe70==='document')_0x37dbb5={'document':fs_1[_0x4f8a88(0x12b)]['readFileSync'](_0x373093),'caption':_0x3ccaba?_0x3ccaba:null,'fileName':_0x4a8385,'mimetype':_0x5e9303};else _0x4bbe70==='application'?_0x37dbb5={'document':fs_1['default'][_0x4f8a88(0x135)](_0x373093),'caption':_0x3ccaba?_0x3ccaba:null,'fileName':_0x4a8385,'mimetype':_0x5e9303}:_0x37dbb5={'image':fs_1['default'][_0x4f8a88(0x135)](_0x373093),'caption':_0x3ccaba?_0x3ccaba:_0x4a8385};}}return _0x37dbb5;}catch(_0x4cc564){return Sentry[_0x4f8a88(0x12f)](_0x4cc564),console['log'](_0x4cc564),null;}};exports[a544_0xf2490(0x159)]=getMessageOptions;const SendWhatsAppMedia=async({media:_0x3b0838,ticket:_0x56a29c,body:_0x54e085,isPrivate:_0x58f934})=>{const _0x266f92=a544_0xf2490;try{const _0x490ba3=await(0x0,wbot_1['getWbot'])(_0x56a29c[_0x266f92(0x141)]),_0x57ef7d=_0x56a29c[_0x266f92(0x130)][_0x266f92(0x14d)](),_0x4819f7=_0x3b0838['path'],_0x3dd832=_0x3b0838[_0x266f92(0x154)][_0x266f92(0x149)]('/')[0x0];let _0x2c7d18,_0x38c1dc='';const _0x320037=(0x0,Mustache_1[_0x266f92(0x12b)])(_0x54e085,_0x56a29c);if(_0x3dd832===_0x266f92(0x140))_0x2c7d18={'video':fs_1[_0x266f92(0x12b)][_0x266f92(0x135)](_0x4819f7),'caption':_0x320037,'fileName':_0x3b0838[_0x266f92(0x11e)][_0x266f92(0x138)]('/','-')},_0x38c1dc='ðŸŽ¥\x20Arquivo\x20de\x20vÃ­deo';else{if(_0x3dd832==='audio'){const _0x9745a5=!![];if(_0x9745a5){const _0x2974d8=await processAudio(_0x3b0838[_0x266f92(0x134)],_0x57ef7d);_0x2c7d18={'audio':fs_1[_0x266f92(0x12b)][_0x266f92(0x135)](_0x2974d8),'mimetype':_0x9745a5?_0x266f92(0x125):_0x3b0838['mimetype'],'ptt':!![]},(0x0,fs_1[_0x266f92(0x152)])(_0x2974d8);}else{const _0xad47bd=await processAudio(_0x3b0838[_0x266f92(0x134)],_0x57ef7d);_0x2c7d18={'audio':fs_1[_0x266f92(0x12b)][_0x266f92(0x135)](_0xad47bd),'mimetype':_0x266f92(0x125),'ptt':!![]},(0x0,fs_1[_0x266f92(0x152)])(_0xad47bd);}_0x38c1dc=_0x266f92(0x151);}else{if(_0x3dd832===_0x266f92(0x11f)||_0x3dd832===_0x266f92(0x162))_0x2c7d18={'document':fs_1[_0x266f92(0x12b)][_0x266f92(0x135)](_0x4819f7),'caption':_0x320037,'fileName':_0x3b0838['originalname']['replace']('/','-'),'mimetype':_0x3b0838[_0x266f92(0x154)]},_0x38c1dc=_0x266f92(0x121);else _0x3dd832===_0x266f92(0x15a)?(_0x2c7d18={'document':fs_1[_0x266f92(0x12b)][_0x266f92(0x135)](_0x4819f7),'caption':_0x320037,'fileName':_0x3b0838[_0x266f92(0x11e)]['replace']('/','-'),'mimetype':_0x3b0838[_0x266f92(0x154)]},_0x38c1dc='ðŸ“Ž\x20Outros\x20anexos'):(_0x2c7d18={'image':fs_1['default'][_0x266f92(0x135)](_0x4819f7),'caption':_0x320037},_0x38c1dc=_0x266f92(0x119));}}if(_0x58f934){const _0x4a6692={'wid':_0x266f92(0x15d)+_0x57ef7d+_0x56a29c['id']+_0x54e085[_0x266f92(0x150)](0x0,0x6),'ticketId':_0x56a29c['id'],'contactId':undefined,'body':_0x38c1dc,'fromMe':!![],'mediaUrl':_0x3b0838[_0x266f92(0x123)],'mediaType':_0x3b0838[_0x266f92(0x154)][_0x266f92(0x149)]('/')[0x0],'read':!![],'quotedMsgId':null,'ack':0x2,'remoteJid':null,'participant':null,'dataJson':null,'ticketTrakingId':null,'isPrivate':_0x58f934};await(0x0,CreateMessageService_1[_0x266f92(0x12b)])({'messageData':_0x4a6692,'companyId':_0x56a29c[_0x266f92(0x130)]});return;}const _0x4f0f18=await Contact_1[_0x266f92(0x12b)][_0x266f92(0x15c)](_0x56a29c[_0x266f92(0x122)]);let _0x5acddf;_0x4f0f18[_0x266f92(0x129)]&&_0x4f0f18[_0x266f92(0x129)]!==''&&_0x4f0f18[_0x266f92(0x129)][_0x266f92(0x136)]('@')?_0x5acddf=_0x4f0f18[_0x266f92(0x129)]:_0x5acddf=_0x4f0f18['number']+'@'+(_0x56a29c[_0x266f92(0x11b)]?_0x266f92(0x120):_0x266f92(0x148));const _0x477cc7=await _0x490ba3[_0x266f92(0x157)](_0x5acddf,{..._0x2c7d18});return await _0x56a29c[_0x266f92(0x12e)]({'lastMessage':(0x0,Mustache_1[_0x266f92(0x12b)])(_0x54e085!==_0x3b0838[_0x266f92(0x123)]?(0x0,Mustache_1[_0x266f92(0x12b)])(_0x54e085,_0x56a29c):_0x38c1dc,_0x56a29c),'imported':null}),_0x477cc7;}catch(_0x25b9e4){Sentry[_0x266f92(0x12f)](_0x25b9e4),console[_0x266f92(0x142)](_0x25b9e4);throw new AppError_1[(_0x266f92(0x12b))]('ERR_SENDING_WAPP_MSG');}};exports['default']=SendWhatsAppMedia;