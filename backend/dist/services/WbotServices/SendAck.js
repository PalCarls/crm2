'use strict';function a543_0xd9fd(){const _0x139e02=['../../errors/AppError','DESC','get','../../models/Ticket','unreadMessages','forEach','deleteById','SendAckBYRemoteJid','store','unreadCount','available','ERR_NO_TICKET_FOUND','280588DYCueR','default','3013662jHQJEZ','contact','chats','remoteJid','../../models/Message','ERR_SENDING_WAPP_MSG','defineProperty','update','4UmzHqb','803058kIdudu','SendAckBYticketId','unavailable','7336966jfVytV','quotedMsg','__importDefault','376009tpSqoB','createdAt','sendPresenceUpdate','__esModule','ticketId','../../helpers/GetTicketWbot','findAndCountAll','54lVSdYc','1945426sGZNtG','580SvRXUd','nÃ£o\x20consegui\x20pegar\x20o\x20wbot','log','330312IEgwzx','25ipeRVX','readMessages','contactId'];a543_0xd9fd=function(){return _0x139e02;};return a543_0xd9fd();}const a543_0x48f9b9=a543_0x1223;(function(_0x58c14,_0x52eb36){const _0x10f47a=a543_0x1223,_0x41651a=_0x58c14();while(!![]){try{const _0x5cb35b=-parseInt(_0x10f47a(0x1ca))/0x1+-parseInt(_0x10f47a(0x1d2))/0x2+-parseInt(_0x10f47a(0x1bb))/0x3*(parseInt(_0x10f47a(0x1c3))/0x4)+-parseInt(_0x10f47a(0x1d7))/0x5*(-parseInt(_0x10f47a(0x1c4))/0x6)+parseInt(_0x10f47a(0x1c7))/0x7+parseInt(_0x10f47a(0x1d6))/0x8*(-parseInt(_0x10f47a(0x1d1))/0x9)+parseInt(_0x10f47a(0x1d3))/0xa*(parseInt(_0x10f47a(0x1b9))/0xb);if(_0x5cb35b===_0x52eb36)break;else _0x41651a['push'](_0x41651a['shift']());}catch(_0x40fe56){_0x41651a['push'](_0x41651a['shift']());}}}(a543_0xd9fd,0x9175f));function a543_0x1223(_0x4c6620,_0x613ce4){const _0xd9fd60=a543_0xd9fd();return a543_0x1223=function(_0x1223ae,_0x196888){_0x1223ae=_0x1223ae-0x1ad;let _0xb177b4=_0xd9fd60[_0x1223ae];return _0xb177b4;},a543_0x1223(_0x4c6620,_0x613ce4);}var __importDefault=this&&this[a543_0x48f9b9(0x1c9)]||function(_0x2e4286){const _0x771c82=a543_0x48f9b9;return _0x2e4286&&_0x2e4286[_0x771c82(0x1cd)]?_0x2e4286:{'default':_0x2e4286};};Object[a543_0x48f9b9(0x1c1)](exports,a543_0x48f9b9(0x1cd),{'value':!![]}),exports[a543_0x48f9b9(0x1b4)]=exports[a543_0x48f9b9(0x1c5)]=void 0x0;const AppError_1=__importDefault(require(a543_0x48f9b9(0x1ad))),GetTicketWbot_1=__importDefault(require(a543_0x48f9b9(0x1cf))),Ticket_1=__importDefault(require(a543_0x48f9b9(0x1b0))),Message_1=__importDefault(require(a543_0x48f9b9(0x1bf))),ShowTicketService_1=__importDefault(require('../TicketServices/ShowTicketService')),SendAckBYticketId=async({ticketId:_0x195826,companyId:_0x48258a})=>{const _0x126c23=a543_0x48f9b9,_0x344a1=await(0x0,ShowTicketService_1[_0x126c23(0x1ba)])(_0x195826,_0x48258a);let _0x38f156=_0x344a1[_0x126c23(0x1b1)];if(_0x38f156>0x0){let _0xb9e167;try{_0xb9e167=await(0x0,GetTicketWbot_1['default'])(_0x344a1);}catch(_0x5ca1f9){console[_0x126c23(0x1d5)](_0x126c23(0x1d4));}if(!_0x344a1)throw new AppError_1[(_0x126c23(0x1ba))](_0x126c23(0x1b8),0x194);const _0x4a6041=0x64,{count:_0x48ccdc,rows:_0x1a3d41}=await Message_1[_0x126c23(0x1ba)][_0x126c23(0x1d0)]({'limit':_0x4a6041,'include':[_0x126c23(0x1bc),{'model':Message_1['default'],'as':_0x126c23(0x1c8),'include':[_0x126c23(0x1bc)]},{'model':Ticket_1[_0x126c23(0x1ba)],'where':{'contactId':_0x344a1[_0x126c23(0x1d9)]},'required':!![]}],'order':[['createdAt',_0x126c23(0x1ae)]]});_0x1a3d41[_0x126c23(0x1b2)](async _0x3520c9=>{const _0x5d3770=_0x126c23;if(_0xb9e167){const _0x175975=_0xb9e167[_0x5d3770(0x1b5)][_0x5d3770(0x1bd)][_0x5d3770(0x1af)](_0x3520c9[_0x5d3770(0x1be)]);_0xb9e167[_0x5d3770(0x1d8)]([_0x3520c9]);let _0x3f258c=_0x3520c9[_0x5d3770(0x1be)],_0xe052bd=_0x3520c9['ticket'];_0xe052bd[_0x5d3770(0x1c2)]({'unreadMessages':0x0});_0x3f258c&&_0x175975?.[_0x5d3770(0x1b6)]>0x0&&(_0xb9e167['store'][_0x5d3770(0x1bd)][_0x5d3770(0x1b3)](_0x3f258c),_0xb9e167[_0x5d3770(0x1cc)](_0x5d3770(0x1b7)),setTimeout(()=>{const _0x44ddf2=_0x5d3770;_0xb9e167[_0x44ddf2(0x1cc)](_0x44ddf2(0x1c6));},0x1388));try{return!![];}catch(_0x4a47a4){throw new AppError_1[(_0x5d3770(0x1ba))](_0x5d3770(0x1c0));}}});return;}};exports[a543_0x48f9b9(0x1c5)]=SendAckBYticketId;const SendAckBYRemoteJid=async({remoteJid:_0x9e8e2a,companyId:_0x4ac374})=>{const _0xc72200=a543_0x48f9b9,{rows:_0x5c9244}=await Message_1['default'][_0xc72200(0x1d0)]({'limit':0x1,'order':[[_0xc72200(0x1cb),_0xc72200(0x1ae)]],'where':{'remoteJid':_0x9e8e2a,'ack':0x0,'companyId':_0x4ac374}});_0x5c9244[_0xc72200(0x1b2)](async _0x579e0c=>{const _0x121ffb=_0xc72200;let _0x882c1a=_0x579e0c[_0x121ffb(0x1ce)];});return;};exports[a543_0x48f9b9(0x1b4)]=SendAckBYRemoteJid;