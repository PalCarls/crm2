'use strict';const a553_0x3750c6=a553_0x3e03;(function(_0x18f13c,_0x5390b3){const _0x1891eb=a553_0x3e03,_0x13dd00=_0x18f13c();while(!![]){try{const _0x1f6c50=parseInt(_0x1891eb(0xc5))/0x1+-parseInt(_0x1891eb(0xa1))/0x2+parseInt(_0x1891eb(0xa6))/0x3*(parseInt(_0x1891eb(0xbb))/0x4)+-parseInt(_0x1891eb(0xbd))/0x5*(-parseInt(_0x1891eb(0xbc))/0x6)+parseInt(_0x1891eb(0xb9))/0x7+parseInt(_0x1891eb(0xb1))/0x8+parseInt(_0x1891eb(0xac))/0x9*(-parseInt(_0x1891eb(0xb2))/0xa);if(_0x1f6c50===_0x5390b3)break;else _0x13dd00['push'](_0x13dd00['shift']());}catch(_0x4e8cf4){_0x13dd00['push'](_0x13dd00['shift']());}}}(a553_0x3b6e,0xcc1bf));var __createBinding=this&&this[a553_0x3750c6(0xc3)]||(Object['create']?function(_0x2e6854,_0x421613,_0x1544bb,_0x37111e){const _0x23da85=a553_0x3750c6;if(_0x37111e===undefined)_0x37111e=_0x1544bb;var _0x518f21=Object[_0x23da85(0xb3)](_0x421613,_0x1544bb);(!_0x518f21||(_0x23da85(0x98)in _0x518f21?!_0x421613[_0x23da85(0xae)]:_0x518f21[_0x23da85(0x9e)]||_0x518f21[_0x23da85(0xa9)]))&&(_0x518f21={'enumerable':!![],'get':function(){return _0x421613[_0x1544bb];}}),Object[_0x23da85(0x9a)](_0x2e6854,_0x37111e,_0x518f21);}:function(_0x2c29ee,_0x409ab4,_0x2c1b7e,_0x3e4be5){if(_0x3e4be5===undefined)_0x3e4be5=_0x2c1b7e;_0x2c29ee[_0x3e4be5]=_0x409ab4[_0x2c1b7e];}),__setModuleDefault=this&&this[a553_0x3750c6(0x97)]||(Object[a553_0x3750c6(0xc2)]?function(_0x170e59,_0x65e28f){const _0x5d655c=a553_0x3750c6;Object[_0x5d655c(0x9a)](_0x170e59,_0x5d655c(0x9c),{'enumerable':!![],'value':_0x65e28f});}:function(_0x52a838,_0x5bb651){const _0x34141d=a553_0x3750c6;_0x52a838[_0x34141d(0x9c)]=_0x5bb651;}),__importStar=this&&this[a553_0x3750c6(0x9f)]||function(_0x128c26){const _0x1dd1ec=a553_0x3750c6;if(_0x128c26&&_0x128c26[_0x1dd1ec(0xae)])return _0x128c26;var _0x186a22={};if(_0x128c26!=null){for(var _0x5a9375 in _0x128c26)if(_0x5a9375!==_0x1dd1ec(0x9c)&&Object[_0x1dd1ec(0xaf)][_0x1dd1ec(0x9d)][_0x1dd1ec(0xaa)](_0x128c26,_0x5a9375))__createBinding(_0x186a22,_0x128c26,_0x5a9375);}return __setModuleDefault(_0x186a22,_0x128c26),_0x186a22;},__importDefault=this&&this['__importDefault']||function(_0x1301a8){const _0x113704=a553_0x3750c6;return _0x1301a8&&_0x1301a8[_0x113704(0xae)]?_0x1301a8:{'default':_0x1301a8};};function a553_0x3e03(_0x14cf47,_0xa854d1){const _0x3b6e8c=a553_0x3b6e();return a553_0x3e03=function(_0x3e03bd,_0x4894d4){_0x3e03bd=_0x3e03bd-0x96;let _0xa9c27c=_0x3b6e8c[_0x3e03bd];return _0xa9c27c;},a553_0x3e03(_0x14cf47,_0xa854d1);}Object[a553_0x3750c6(0x9a)](exports,'__esModule',{'value':!![]});const Sentry=__importStar(require(a553_0x3750c6(0xb7))),Contact_1=__importDefault(require(a553_0x3750c6(0xb8))),Setting_1=__importDefault(require(a553_0x3750c6(0xc0))),Ticket_1=__importDefault(require(a553_0x3750c6(0xa7))),logger_1=require(a553_0x3750c6(0xad)),CreateOrUpdateBaileysService_1=__importDefault(require('../BaileysServices/CreateOrUpdateBaileysService')),CreateMessageService_1=__importDefault(require(a553_0x3750c6(0xab))),wbotMonitor=async(_0x2a684f,_0x5bbc39,_0xd15eb9)=>{const _0x1a65ab=a553_0x3750c6;try{_0x2a684f['ws']['on'](_0x1a65ab(0xa4),async _0x1cef65=>{const _0x937b91=_0x1a65ab,_0x51629c=_0x1cef65['content'][0x0];if(_0x51629c[_0x937b91(0xbf)]===_0x937b91(0xb0)){const _0x13a26d=await Setting_1[_0x937b91(0x9c)][_0x937b91(0x99)]({'where':{'key':_0x937b91(0xa3),'companyId':_0xd15eb9}});if(_0x13a26d['value']===_0x937b91(0xb6)){await _0x2a684f['sendMessage'](_0x1cef65[_0x937b91(0xa2)]['from'],{'text':'*Mensagem\x20Automática:*\x0a\x0aAs\x20chamadas\x20de\x20voz\x20e\x20vídeo\x20estão\x20desabilitas\x20para\x20esse\x20WhatsApp,\x20favor\x20enviar\x20uma\x20mensagem\x20de\x20texto.\x20Obrigado'});const _0x2d7a23=_0x1cef65[_0x937b91(0xa2)][_0x937b91(0xa5)]['replace'](/\D/g,''),_0x1be9c0=await Contact_1[_0x937b91(0x9c)][_0x937b91(0x99)]({'where':{'companyId':_0xd15eb9,'number':_0x2d7a23}}),_0x1fe81a=await Ticket_1[_0x937b91(0x9c)][_0x937b91(0x99)]({'where':{'contactId':_0x1be9c0['id'],'whatsappId':_0x2a684f['id'],'companyId':_0xd15eb9}});if(!_0x1fe81a)return;const _0x6616f9=new Date(),_0x5dcc42=_0x6616f9[_0x937b91(0xc1)](),_0x39f796=_0x6616f9[_0x937b91(0xa0)](),_0x2e69b8='Chamada\x20de\x20voz/vídeo\x20perdida\x20às\x20'+_0x5dcc42+':'+_0x39f796,_0x2a31fb={'wid':_0x51629c[_0x937b91(0xa2)][_0x937b91(0xb4)],'ticketId':_0x1fe81a['id'],'contactId':_0x1be9c0['id'],'body':_0x2e69b8,'fromMe':![],'mediaType':_0x937b91(0x9b),'read':!![],'quotedMsgId':null,'ack':0x1};return await _0x1fe81a[_0x937b91(0xb5)]({'lastMessage':_0x2e69b8}),_0x1fe81a[_0x937b91(0xc4)]===_0x937b91(0xbe)&&await _0x1fe81a['update']({'status':_0x937b91(0x96)}),(0x0,CreateMessageService_1['default'])({'messageData':_0x2a31fb,'companyId':_0xd15eb9});}}}),_0x2a684f['ev']['on'](_0x1a65ab(0xa8),async _0x259989=>{const _0x107974=_0x1a65ab;await(0x0,CreateOrUpdateBaileysService_1[_0x107974(0x9c)])({'whatsappId':_0x5bbc39['id'],'contacts':_0x259989});});}catch(_0x5c86e3){Sentry['captureException'](_0x5c86e3),logger_1[_0x1a65ab(0xba)]['error'](_0x5c86e3);}};exports['default']=wbotMonitor;function a553_0x3b6e(){const _0x367b1b=['disabled','@sentry/node','../../models/Contact','2015328FUYeRb','logger','28kLxtVz','306waLjzn','17665KochKG','closed','tag','../../models/Setting','getHours','create','__createBinding','status','997516kRMqVO','pending','__setModuleDefault','get','findOne','defineProperty','call_log','default','hasOwnProperty','writable','__importStar','getMinutes','2894086nRYSwA','attrs','acceptCallWhatsapp','CB:call','from','233733OPxOAW','../../models/Ticket','contacts.upsert','configurable','call','../MessageServices/CreateMessageService','9Xumaid','../../utils/logger','__esModule','prototype','terminate','4408096ALiVyJ','2789180lLDXlk','getOwnPropertyDescriptor','call-id','update'];a553_0x3b6e=function(){return _0x367b1b;};return a553_0x3b6e();}