'use strict';function a619_0x4423(){const _0x4ec287=['getMonth','../DialogChatBotsServices/ShowDialogChatBotsServices','medias','72bsLuas','file','findOne','\x0a*[\x20#\x20]*\x20Voltar\x20para\x20o\x20menu\x20principal\x0a*[\x20Sair\x20]*\x20Encerrar\x20atendimento','verifyMediaMessage','company','3530268NfpexT','../../helpers/Mustache','attendent','entries','16946813MeyRBX','5pYAtbm','charAt','queue','sayChatbot','chatbotId','button','toString','../DialogChatBotsServices/CreateDialogChatBotsServices','writable','path','__importDefault','substring','greetingMediaAttachment','buttonsResponseMessage','__createBinding','getDate','18fXFyXZ','optUserId','./SendWhatsAppMedia','dueDate','\x20]*\x20-\x20','optQueueId','getBodyMessage','deleteAndCreateDialogStage','split','1015883KmXmPL','pending','replace','optFileId','Menu','configurable','304rYszFl','fromMe','closed','list','public','mediaType','verifyMessage','floor','closeTicket','18501WnMZyW','isGroup','2585960cgOjpX','listResponseMessage','ticketData','../DialogChatBotsServices/DeleteDialogChatBotsServices','selectedButtonId','public/temp/','g.us','axios','message','‎Não\x20consegui\x20enviar\x20o\x20PDF,\x20tente\x20novamente!','chatbots','singleSelectReply','contact','key','../../services/FileServices/ShowService','../ChatBotServices/ShowChatBotByChatbotIdServices','../ChatBotServices/ShowChatBotServices','defineProperty','resolve','whatsapp','selectedRowId','15224PWvGey','Escolha\x20uma\x20opção','__esModule','prototype','default','\x0a*[\x20Sair\x20]*\x20-\x20Encerrar\x20Atendimento','length','options','__importStar','localeCompare','number','*[\x20','name','ticketId','optIntegrationId','getOwnPropertyDescriptor','image/jpeg','test','random','../WhatsappService/ShowWhatsAppService','userId','update','queueType','1336xDXXBw','text','26suGYer','chatBotType','push','companyId','readFileSync','20850HmIKfY','create','greetingMessage','fileList','forEach','../../models/CompaniesSettings','7bit','sendMessage','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','getFullYear','trim','s.whatsapp.net'];a619_0x4423=function(){return _0x4ec287;};return a619_0x4423();}const a619_0x29075b=a619_0x42a1;(function(_0x41b1f7,_0x204c3e){const _0x3dd1c1=a619_0x42a1,_0x995bb3=_0x41b1f7();while(!![]){try{const _0x3a928d=parseInt(_0x3dd1c1(0x202))/0x1*(parseInt(_0x3dd1c1(0x1e9))/0x2)+-parseInt(_0x3dd1c1(0x207))/0x3*(-parseInt(_0x3dd1c1(0x1c9))/0x4)+-parseInt(_0x3dd1c1(0x221))/0x5*(parseInt(_0x3dd1c1(0x21c))/0x6)+-parseInt(_0x3dd1c1(0x1d2))/0x7*(-parseInt(_0x3dd1c1(0x200))/0x8)+-parseInt(_0x3dd1c1(0x1ba))/0x9*(-parseInt(_0x3dd1c1(0x1d4))/0xa)+parseInt(_0x3dd1c1(0x1c3))/0xb*(parseInt(_0x3dd1c1(0x216))/0xc)+-parseInt(_0x3dd1c1(0x220))/0xd;if(_0x3a928d===_0x204c3e)break;else _0x995bb3['push'](_0x995bb3['shift']());}catch(_0x47e6c8){_0x995bb3['push'](_0x995bb3['shift']());}}}(a619_0x4423,0x54ac8));var __createBinding=this&&this[a619_0x29075b(0x1b8)]||(Object[a619_0x29075b(0x208)]?function(_0x438a5d,_0x6f553d,_0x64d35d,_0x4bf3b4){const _0x273bdd=a619_0x29075b;if(_0x4bf3b4===undefined)_0x4bf3b4=_0x64d35d;var _0x62a038=Object[_0x273bdd(0x1f8)](_0x6f553d,_0x64d35d);(!_0x62a038||('get'in _0x62a038?!_0x6f553d['__esModule']:_0x62a038[_0x273bdd(0x229)]||_0x62a038[_0x273bdd(0x1c8)]))&&(_0x62a038={'enumerable':!![],'get':function(){return _0x6f553d[_0x64d35d];}}),Object[_0x273bdd(0x1e5)](_0x438a5d,_0x4bf3b4,_0x62a038);}:function(_0x4d7be8,_0x26576d,_0x4badbb,_0x580f21){if(_0x580f21===undefined)_0x580f21=_0x4badbb;_0x4d7be8[_0x580f21]=_0x26576d[_0x4badbb];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a619_0x29075b(0x208)]?function(_0x56f58b,_0x496180){const _0x8347f5=a619_0x29075b;Object[_0x8347f5(0x1e5)](_0x56f58b,_0x8347f5(0x1ed),{'enumerable':!![],'value':_0x496180});}:function(_0x1878bd,_0x57636f){const _0x3a9759=a619_0x29075b;_0x1878bd[_0x3a9759(0x1ed)]=_0x57636f;}),__importStar=this&&this[a619_0x29075b(0x1f1)]||function(_0x4e5cb7){const _0x1741ae=a619_0x29075b;if(_0x4e5cb7&&_0x4e5cb7['__esModule'])return _0x4e5cb7;var _0x164ef9={};if(_0x4e5cb7!=null){for(var _0x21a7d8 in _0x4e5cb7)if(_0x21a7d8!==_0x1741ae(0x1ed)&&Object[_0x1741ae(0x1ec)]['hasOwnProperty']['call'](_0x4e5cb7,_0x21a7d8))__createBinding(_0x164ef9,_0x4e5cb7,_0x21a7d8);}return __setModuleDefault(_0x164ef9,_0x4e5cb7),_0x164ef9;},__importDefault=this&&this[a619_0x29075b(0x1b4)]||function(_0x5a7f36){const _0x9d41fa=a619_0x29075b;return _0x5a7f36&&_0x5a7f36[_0x9d41fa(0x1eb)]?_0x5a7f36:{'default':_0x5a7f36};};Object['defineProperty'](exports,a619_0x29075b(0x1eb),{'value':!![]}),exports[a619_0x29075b(0x224)]=exports[a619_0x29075b(0x1c1)]=void 0x0;const path_1=__importDefault(require(a619_0x29075b(0x1b3))),wbotMessageListener_1=require('./wbotMessageListener'),ShowDialogChatBotsServices_1=__importDefault(require(a619_0x29075b(0x214))),ShowQueueService_1=__importDefault(require('../QueueService/ShowQueueService')),ShowChatBotServices_1=__importDefault(require(a619_0x29075b(0x1e4))),DeleteDialogChatBotsServices_1=__importDefault(require(a619_0x29075b(0x1d7))),ShowChatBotByChatbotIdServices_1=__importDefault(require(a619_0x29075b(0x1e3))),CreateDialogChatBotsServices_1=__importDefault(require(a619_0x29075b(0x228))),ShowWhatsAppService_1=__importDefault(require(a619_0x29075b(0x1fc))),Mustache_1=__importDefault(require(a619_0x29075b(0x21d))),UpdateTicketService_1=__importDefault(require('../TicketServices/UpdateTicketService')),ShowService_1=__importDefault(require(a619_0x29075b(0x1e2))),SendWhatsAppMedia_1=__importStar(require(a619_0x29075b(0x1bc))),CompaniesSettings_1=__importDefault(require(a619_0x29075b(0x20c))),fs=require('fs');var axios=require(a619_0x29075b(0x1db));const isNumeric=_0xf95667=>/^-?\d+$/[a619_0x29075b(0x1fa)](_0xf95667),deleteAndCreateDialogStage=async(_0x258b13,_0x28cd57,_0x242b55)=>{const _0x52a20a=a619_0x29075b;try{await(0x0,DeleteDialogChatBotsServices_1[_0x52a20a(0x1ed)])(_0x258b13['id']);const _0x1d9ccf=await(0x0,ShowChatBotByChatbotIdServices_1[_0x52a20a(0x1ed)])(_0x28cd57);return!_0x1d9ccf&&await _0x242b55[_0x52a20a(0x1fe)]({'isBot':![]}),await(0x0,CreateDialogChatBotsServices_1[_0x52a20a(0x1ed)])({'awaiting':0x1,'contactId':_0x258b13['id'],'chatbotId':_0x28cd57,'queueId':_0x1d9ccf['queueId']});}catch(_0x4dbbd0){await _0x242b55[_0x52a20a(0x1fe)]({'isBot':![]});}};function a619_0x42a1(_0x1ec90f,_0x1db28f){const _0x4423a0=a619_0x4423();return a619_0x42a1=function(_0x42a146,_0x377ad3){_0x42a146=_0x42a146-0x1b3;let _0x2a699b=_0x4423a0[_0x42a146];return _0x2a699b;},a619_0x42a1(_0x1ec90f,_0x1db28f);}exports[a619_0x29075b(0x1c1)]=deleteAndCreateDialogStage;const sendMessage=async(_0x214fdc,_0x1e2c68,_0x377821,_0x3655ce)=>{const _0x307cbb=a619_0x29075b,_0x55facc=await _0x214fdc[_0x307cbb(0x20e)](_0x1e2c68['number']+'@'+(_0x377821[_0x307cbb(0x1d3)]?'g.us':'s.whatsapp.net'),{'text':(0x0,Mustache_1[_0x307cbb(0x1ed)])(_0x3655ce,_0x377821)});(0x0,wbotMessageListener_1[_0x307cbb(0x1cf)])(_0x55facc,_0x377821,_0x1e2c68);},sendMessageLink=async(_0xfdc935,_0xd45fbf,_0x408aa5,_0x1be762,_0x2182ac)=>{const _0x5e0115=a619_0x29075b;let _0x3fe558;try{_0x3fe558=await _0xfdc935['sendMessage'](_0xd45fbf[_0x5e0115(0x1f3)]+'@'+(_0x408aa5['isGroup']?_0x5e0115(0x1da):'s.whatsapp.net'),{'document':_0x1be762?{'url':_0x1be762}:fs[_0x5e0115(0x206)](_0x5e0115(0x1d9)+_0x2182ac+'-'+makeid(0xa)),'fileName':_0x2182ac,'mimetype':'application/pdf'});}catch(_0x18a115){_0x3fe558=await _0xfdc935[_0x5e0115(0x20e)](_0xd45fbf[_0x5e0115(0x1f3)]+'@'+(_0x408aa5['isGroup']?_0x5e0115(0x1da):_0x5e0115(0x212)),{'text':(0x0,Mustache_1['default'])(_0x5e0115(0x1dd),_0x408aa5)});}(0x0,wbotMessageListener_1[_0x5e0115(0x1cf)])(_0x3fe558,_0x408aa5,_0xd45fbf);},sendMessageImage=async(_0x2ed987,_0x4f1029,_0x49f1f0,_0x2b2f7d,_0xc9f871)=>{const _0x47ab39=a619_0x29075b;let _0xeb2c9f;try{_0xeb2c9f=await _0x2ed987[_0x47ab39(0x20e)](_0x4f1029['number']+'@'+(_0x49f1f0[_0x47ab39(0x1d3)]?_0x47ab39(0x1da):_0x47ab39(0x212)),{'image':_0x2b2f7d?{'url':_0x2b2f7d}:fs[_0x47ab39(0x206)](_0x47ab39(0x1d9)+_0xc9f871+'-'+makeid(0xa)),'fileName':_0xc9f871,'caption':_0xc9f871,'mimetype':_0x47ab39(0x1f9)});}catch(_0x1277e9){_0xeb2c9f=await _0x2ed987[_0x47ab39(0x20e)](_0x4f1029['number']+'@'+(_0x49f1f0['isGroup']?'g.us':_0x47ab39(0x212)),{'text':(0x0,Mustache_1['default'])('Não\x20consegui\x20enviar\x20o\x20PDF,\x20tente\x20novamente!',_0x49f1f0)});}(0x0,wbotMessageListener_1[_0x47ab39(0x1cf)])(_0xeb2c9f,_0x49f1f0,_0x4f1029);},sendDialog=async(_0x188500,_0x289142,_0x54b7c3,_0x29e9e9)=>{const _0xf6ef79=a619_0x29075b,_0xd6ce04=await(0x0,ShowChatBotServices_1[_0xf6ef79(0x1ed)])(_0x188500['id']);if(_0xd6ce04[_0xf6ef79(0x1f0)]){let _0x49ff7e=_0x29e9e9[_0xf6ef79(0x205)];const _0x28e375=await CompaniesSettings_1[_0xf6ef79(0x1ed)][_0xf6ef79(0x218)]({'where':{'companyId':_0x49ff7e}}),_0x17b6a0=_0x28e375?.[_0xf6ef79(0x203)]||_0xf6ef79(0x201),_0x5b1773=async()=>{const _0x28e312=_0xf6ef79;let _0x4ca7c8='';_0xd6ce04[_0x28e312(0x1f0)][_0x28e312(0x20b)]((_0x48eb62,_0x134eb6)=>{const _0x193eac=_0x28e312;_0x4ca7c8+=_0x193eac(0x1f4)+(_0x134eb6+0x1)+_0x193eac(0x1be)+_0x48eb62[_0x193eac(0x1f5)]+'\x0a';});const _0x2b20aa=_0x4ca7c8[_0x28e312(0x1ef)]>0x0?_0x4ca7c8+_0x28e312(0x219):_0x4ca7c8+'\x0a*[\x20Sair\x20]*\x20Encerrar\x20atendimento';if(_0x4ca7c8['length']>0x0){const _0x2b9a47=(0x0,Mustache_1['default'])('‎\x20'+_0x188500[_0x28e312(0x209)]+'\x0a\x0a'+_0x2b20aa,_0x29e9e9),_0x250fb2=await sendMessage(_0x289142,_0x54b7c3,_0x29e9e9,_0x2b9a47);return _0x250fb2;}const _0x5ed4f1=(0x0,Mustache_1[_0x28e312(0x1ed)])('‎\x20'+_0x188500[_0x28e312(0x209)],_0x29e9e9),_0x1dd2f2=await sendMessage(_0x289142,_0x54b7c3,_0x29e9e9,_0x5ed4f1);return _0x1dd2f2;},_0x25e1cb=async()=>{const _0xa9950d=_0xf6ef79,_0x128462=[];_0xd6ce04['options'][_0xa9950d(0x20b)]((_0x33a0ad,_0x1ad123)=>{const _0x4e919a=_0xa9950d;_0x128462[_0x4e919a(0x204)]({'buttonId':''+(_0x1ad123+0x1),'buttonText':{'displayText':_0x33a0ad[_0x4e919a(0x1f5)]},'type':0x1});});if(_0x128462[_0xa9950d(0x1ef)]>0x0){const _0x256a46={'text':'‎'+_0x188500['greetingMessage'],'buttons':_0x128462,'headerType':0x1},_0x3c1332=await _0x289142['sendMessage'](_0x54b7c3[_0xa9950d(0x1f3)]+'@'+(_0x29e9e9['isGroup']?_0xa9950d(0x1da):'s.whatsapp.net'),_0x256a46);return await(0x0,wbotMessageListener_1[_0xa9950d(0x1cf)])(_0x3c1332,_0x29e9e9,_0x54b7c3),_0x3c1332;}const _0x3eef51='‎'+_0x188500[_0xa9950d(0x209)],_0x1474ab=await sendMessage(_0x289142,_0x54b7c3,_0x29e9e9,_0x3eef51);return _0x1474ab;},_0xe556b4=async()=>{const _0x388bd2=_0xf6ef79,_0x45ddd6=[];_0xd6ce04['options'][_0x388bd2(0x20b)]((_0x467d5e,_0x58d38f)=>{const _0x9547a9=_0x388bd2;_0x45ddd6[_0x9547a9(0x204)]({'title':_0x467d5e[_0x9547a9(0x1f5)],'rowId':''+(_0x58d38f+0x1)});});if(_0x45ddd6[_0x388bd2(0x1ef)]>0x0){const _0x46040d=[{'title':_0x388bd2(0x1c7),'rows':_0x45ddd6}],_0xb7d581={'text':(0x0,Mustache_1[_0x388bd2(0x1ed)])('‎'+_0x188500['greetingMessage'],_0x29e9e9),'buttonText':_0x388bd2(0x1ea),'sections':_0x46040d},_0xff7090=await _0x289142['sendMessage'](_0x54b7c3['number']+'@'+(_0x29e9e9[_0x388bd2(0x1d3)]?_0x388bd2(0x1da):_0x388bd2(0x212)),_0xb7d581);return await(0x0,wbotMessageListener_1['verifyMessage'])(_0xff7090,_0x29e9e9,_0x54b7c3),_0xff7090;}const _0x485011='‎'+_0x188500[_0x388bd2(0x209)],_0x183a85=await sendMessage(_0x289142,_0x54b7c3,_0x29e9e9,_0x485011);return _0x183a85;};if(_0x17b6a0===_0xf6ef79(0x201))return await _0x5b1773();if(_0x17b6a0===_0xf6ef79(0x226)&&_0xd6ce04[_0xf6ef79(0x1f0)][_0xf6ef79(0x1ef)]>0x4)return await _0x5b1773();if(_0x17b6a0===_0xf6ef79(0x226)&&_0xd6ce04[_0xf6ef79(0x1f0)]['length']<=0x4)return await _0x25e1cb();if(_0x17b6a0===_0xf6ef79(0x1cc))return await _0xe556b4();}},backToMainMenu=async(_0x35153f,_0x1d723a,_0x3fa448)=>{const _0x1887ae=a619_0x29075b;await(0x0,UpdateTicketService_1['default'])({'ticketData':{'queueId':null,'userId':null},'ticketId':_0x3fa448['id'],'companyId':_0x3fa448[_0x1887ae(0x205)]});const {queues:_0x3adfc4,greetingMessage:_0x4536fd,greetingMediaAttachment:_0x26ac04}=await(0x0,ShowWhatsAppService_1[_0x1887ae(0x1ed)])(_0x35153f['id'],_0x3fa448[_0x1887ae(0x205)]),_0x233214=await CompaniesSettings_1[_0x1887ae(0x1ed)][_0x1887ae(0x218)]({'where':{'companyId':_0x3fa448[_0x1887ae(0x205)]}}),_0x36defb=async()=>{const _0x6162d7=_0x1887ae;let _0x1d9421='';_0x3adfc4[_0x6162d7(0x20b)]((_0x17d2aa,_0x3fbe9f)=>{const _0x320774=_0x6162d7;_0x1d9421+='*[\x20'+(_0x3fbe9f+0x1)+_0x320774(0x1be)+_0x17d2aa['name']+'\x0a';}),_0x1d9421+=_0x6162d7(0x1ee);const _0x3fb48c=(0x0,Mustache_1[_0x6162d7(0x1ed)])('‎\x20'+_0x4536fd+'\x0a\x0a'+_0x1d9421,_0x3fa448);if(_0x26ac04!==null){const _0x26cda0=path_1[_0x6162d7(0x1ed)][_0x6162d7(0x1e6)]('public',_0x6162d7(0x21b)+_0x3fa448[_0x6162d7(0x205)],_0x3fa448['whatsapp']['greetingMediaAttachment']),_0x45e530=_0x3fa448[_0x6162d7(0x1e7)][_0x6162d7(0x1b6)],_0x3e54d3=await(0x0,SendWhatsAppMedia_1['getMessageOptions'])(_0x45e530,_0x26cda0,String(_0x3fa448['companyId']),_0x3fb48c),_0x361ddf=await _0x35153f[_0x6162d7(0x20e)](_0x3fa448[_0x6162d7(0x1e0)][_0x6162d7(0x1f3)]+'@'+(_0x3fa448['isGroup']?_0x6162d7(0x1da):_0x6162d7(0x212)),{..._0x3e54d3});await(0x0,wbotMessageListener_1[_0x6162d7(0x21a)])(_0x361ddf,_0x3fa448,_0x1d723a);}else{const _0x23c62e=await _0x35153f[_0x6162d7(0x20e)](_0x1d723a[_0x6162d7(0x1f3)]+'@'+(_0x3fa448[_0x6162d7(0x1d3)]?_0x6162d7(0x1da):'s.whatsapp.net'),{'text':_0x3fb48c});await(0x0,wbotMessageListener_1[_0x6162d7(0x1cf)])(_0x23c62e,_0x3fa448,_0x1d723a);}const _0x4b8025=await(0x0,DeleteDialogChatBotsServices_1[_0x6162d7(0x1ed)])(_0x1d723a['id']);return _0x4b8025;};if(_0x233214[_0x1887ae(0x203)]===_0x1887ae(0x201))return _0x36defb();};function validaCpfCnpj(_0x367c77){const _0x5af152=a619_0x29075b;if(_0x367c77['length']==0xb){var _0x33d4c0=_0x367c77[_0x5af152(0x211)]();_0x33d4c0=_0x33d4c0['replace'](/\./g,''),_0x33d4c0=_0x33d4c0['replace']('-',''),_0x33d4c0=_0x33d4c0['split']('');var _0x59ce0c=0x0,_0x3a5ffa=0x0,_0x2dc770=![];for(var _0x5ea5e2=0x1;_0x33d4c0[_0x5af152(0x1ef)]>_0x5ea5e2;_0x5ea5e2++){_0x33d4c0[_0x5ea5e2-0x1]!=_0x33d4c0[_0x5ea5e2]&&(_0x2dc770=!![]);}if(_0x2dc770==![])return![];for(var _0x5ea5e2=0x0,_0x8e9306=0xa;_0x33d4c0[_0x5af152(0x1ef)]-0x2>_0x5ea5e2;_0x5ea5e2++,_0x8e9306--){_0x59ce0c+=_0x33d4c0[_0x5ea5e2]*_0x8e9306;}_0x59ce0c=_0x59ce0c*0xa%0xb;_0x59ce0c==0xa&&(_0x59ce0c=0x0);if(_0x59ce0c!=_0x33d4c0[0x9])return![];for(var _0x5ea5e2=0x0,_0x8e9306=0xb;_0x33d4c0[_0x5af152(0x1ef)]-0x1>_0x5ea5e2;_0x5ea5e2++,_0x8e9306--){_0x3a5ffa+=_0x33d4c0[_0x5ea5e2]*_0x8e9306;}return _0x3a5ffa=_0x3a5ffa*0xa%0xb,_0x3a5ffa==0xa&&(_0x3a5ffa=0x0),_0x3a5ffa!=_0x33d4c0[0xa]?![]:!![];}else{if(_0x367c77['length']==0xe){var _0xc64993=_0x367c77[_0x5af152(0x211)]();_0xc64993=_0xc64993[_0x5af152(0x1c5)](/\./g,''),_0xc64993=_0xc64993[_0x5af152(0x1c5)]('-',''),_0xc64993=_0xc64993['replace']('/',''),_0xc64993=_0xc64993[_0x5af152(0x1c2)]('');var _0x59ce0c=0x0,_0x3a5ffa=0x0,_0x2dc770=![];for(var _0x5ea5e2=0x1;_0xc64993[_0x5af152(0x1ef)]>_0x5ea5e2;_0x5ea5e2++){_0xc64993[_0x5ea5e2-0x1]!=_0xc64993[_0x5ea5e2]&&(_0x2dc770=!![]);}if(_0x2dc770==![])return![];for(var _0x5ea5e2=0x0,_0x35b9c3=0x5,_0x44a69d=0xd;_0xc64993[_0x5af152(0x1ef)]-0x2>_0x5ea5e2;_0x5ea5e2++,_0x35b9c3--,_0x44a69d--){_0x35b9c3>=0x2?_0x59ce0c+=_0xc64993[_0x5ea5e2]*_0x35b9c3:_0x59ce0c+=_0xc64993[_0x5ea5e2]*_0x44a69d;}_0x59ce0c=_0x59ce0c%0xb;_0x59ce0c<0x2?_0x59ce0c=0x0:_0x59ce0c=0xb-_0x59ce0c;if(_0x59ce0c!=_0xc64993[0xc])return![];for(var _0x5ea5e2=0x0,_0x35b9c3=0x6,_0x44a69d=0xe;_0xc64993[_0x5af152(0x1ef)]-0x1>_0x5ea5e2;_0x5ea5e2++,_0x35b9c3--,_0x44a69d--){_0x35b9c3>=0x2?_0x3a5ffa+=_0xc64993[_0x5ea5e2]*_0x35b9c3:_0x3a5ffa+=_0xc64993[_0x5ea5e2]*_0x44a69d;}return _0x3a5ffa=_0x3a5ffa%0xb,_0x3a5ffa<0x2?_0x3a5ffa=0x0:_0x3a5ffa=0xb-_0x3a5ffa,_0x3a5ffa!=_0xc64993[0xd]?![]:!![];}else return![];}}function timeout(_0x27eb85){return new Promise(_0x57c307=>setTimeout(_0x57c307,_0x27eb85));}async function sleep(_0x41261d){await timeout(_0x41261d);}function firstDayOfMonth(_0x1c8e86){const _0xb730df=a619_0x29075b,_0x5a00df=new Date(),_0x385c78=new Date(_0x5a00df['getFullYear'](),_0x5a00df[_0xb730df(0x213)]()-_0x1c8e86,0x1);return _0x385c78;};function lastDayOfMonth(_0x29c523){const _0x2af033=a619_0x29075b,_0x39ba5d=new Date(),_0x582069=new Date(_0x39ba5d[_0x2af033(0x210)](),_0x39ba5d[_0x2af033(0x213)]()+_0x29c523,0x0);return _0x582069;};function dataAtualFormatada(_0xad20d3){const _0x4e6367=a619_0x29075b;var _0x3cc822=_0xad20d3[_0x4e6367(0x1b9)]()[_0x4e6367(0x227)](),_0x3e8684=_0x3cc822['length']==0x1?'0'+_0x3cc822:_0x3cc822,_0x4544fb=(_0xad20d3[_0x4e6367(0x213)]()+0x1)[_0x4e6367(0x227)](),_0x4373b1=_0x4544fb[_0x4e6367(0x1ef)]==0x1?'0'+_0x4544fb:_0x4544fb,_0x66a8c6=_0xad20d3[_0x4e6367(0x210)]();return _0x3e8684+'/'+_0x4373b1+'/'+_0x66a8c6;}function makeid(_0x2bc002){const _0xa49c02=a619_0x29075b;var _0x60b672='',_0x970fcd=_0xa49c02(0x20f),_0x3fd3f5=_0x970fcd['length'];for(var _0xc91109=0x0;_0xc91109<_0x2bc002;_0xc91109++){_0x60b672+=_0x970fcd[_0xa49c02(0x222)](Math[_0xa49c02(0x1d0)](Math[_0xa49c02(0x1fb)]()*_0x3fd3f5));}return _0x60b672;}function replaceAll(_0x1c2703,_0x1df6c3,_0x5b488a){const _0x4ac650=a619_0x29075b;return _0x1c2703[_0x4ac650(0x1c5)](new RegExp(_0x1df6c3,'g'),_0x5b488a);}function formatDate(_0x286c94){const _0x3cb2cb=a619_0x29075b;return _0x286c94['substring'](0x8,0xa)+'/'+_0x286c94[_0x3cb2cb(0x1b5)](0x5,0x7)+'/'+_0x286c94['substring'](0x0,0x4);}function sortfunction(_0x5e56dc,_0x37d2f6){const _0x49e6c9=a619_0x29075b;return _0x5e56dc[_0x49e6c9(0x1bd)][_0x49e6c9(0x1f2)](_0x37d2f6[_0x49e6c9(0x1bd)]);}async function sendMsgAndCloseTicket(_0x29884d,_0x5f1d4f,_0xa3a2f6){const _0x372dd5=a619_0x29075b,_0x1261d5={'ticketData':{'status':'closed','userId':_0xa3a2f6?.[_0x372dd5(0x1fd)]||null,'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'ticketId':_0xa3a2f6['id'],'companyId':_0xa3a2f6[_0x372dd5(0x205)]};await sleep(0x7d0),await(0x0,UpdateTicketService_1[_0x372dd5(0x1ed)])(_0x1261d5);}const sayChatbot=async(_0x592d41,_0x5e6e55,_0x4d4115,_0x4f07a5,_0x15ca6c)=>{const _0x520eed=a619_0x29075b,_0x53efff=_0x15ca6c?.[_0x520eed(0x1dc)]?.[_0x520eed(0x1b7)]?.[_0x520eed(0x1d8)]||_0x15ca6c?.['message']?.[_0x520eed(0x1d5)]?.[_0x520eed(0x1df)][_0x520eed(0x1e8)]||(0x0,wbotMessageListener_1['getBodyMessage'])(_0x15ca6c);if(!_0x592d41&&_0x53efff&&_0x15ca6c[_0x520eed(0x1e1)][_0x520eed(0x1ca)])return;const _0x195ce8=await(0x0,ShowDialogChatBotsServices_1[_0x520eed(0x1ed)])(_0x4f07a5['id']);if(_0x53efff['toLocaleLowerCase']()==='sair'){const _0x1bc80b={'ticketData':{'status':_0x520eed(0x1cb),'sendFarewellMessage':!![],'amountUsedBotQueues':0x0},'ticketId':_0x4d4115['id'],'companyId':_0x4d4115[_0x520eed(0x205)]};await(0x0,UpdateTicketService_1[_0x520eed(0x1ed)])(_0x1bc80b);return;}if(_0x53efff==='#'){const _0x34c416=await backToMainMenu(_0x5e6e55,_0x4f07a5,_0x4d4115);return;}if(!_0x195ce8){const _0x5d667b=await(0x0,ShowQueueService_1[_0x520eed(0x1ed)])(_0x592d41,_0x4d4115[_0x520eed(0x205)]),_0x4eaf7a=_0x15ca6c?.[_0x520eed(0x1dc)]?.[_0x520eed(0x1b7)]?.['selectedButtonId']||_0x15ca6c?.[_0x520eed(0x1dc)]?.[_0x520eed(0x1d5)]?.[_0x520eed(0x1df)]['selectedRowId']||(0x0,wbotMessageListener_1[_0x520eed(0x1c0)])(_0x15ca6c),_0x4994d5=_0x5d667b[_0x520eed(0x1de)][+_0x4eaf7a-0x1];if(_0x4994d5){if(_0x4994d5['queueType']==='integration')try{const _0x344983={'ticketData':{'integrationId':_0x4994d5[_0x520eed(0x1f7)],'useIntegration':!![],'status':_0x520eed(0x1c4)},'ticketId':_0x4d4115['id']};await(0x0,UpdateTicketService_1[_0x520eed(0x1ed)])({'ticketData':{..._0x344983[_0x520eed(0x1d6)]},'ticketId':_0x344983[_0x520eed(0x1f6)],'companyId':_0x4d4115[_0x520eed(0x205)]});}catch(_0x544413){await(0x0,exports[_0x520eed(0x1c1)])(_0x4f07a5,_0x4994d5['id'],_0x4d4115);}else{if(_0x4994d5[_0x520eed(0x1ff)]===_0x520eed(0x223))try{const _0x14c991={'ticketData':{'queueId':_0x4994d5['optQueueId'],'status':_0x520eed(0x1c4)},'ticketId':_0x4d4115['id']};await(0x0,UpdateTicketService_1[_0x520eed(0x1ed)])({'ticketData':{..._0x14c991[_0x520eed(0x1d6)]},'ticketId':_0x14c991[_0x520eed(0x1f6)],'companyId':_0x4d4115['companyId']});}catch(_0x37b8b9){await(0x0,exports[_0x520eed(0x1c1)])(_0x4f07a5,_0x4994d5['id'],_0x4d4115);}else{if(_0x4994d5[_0x520eed(0x1ff)]==='attendent')try{const _0x7f5666={'ticketData':{'queueId':_0x4994d5[_0x520eed(0x1bf)],'userId':_0x4994d5[_0x520eed(0x1bb)],'status':_0x520eed(0x1c4)},'ticketId':_0x4d4115['id']};await(0x0,UpdateTicketService_1[_0x520eed(0x1ed)])({'ticketData':{..._0x7f5666[_0x520eed(0x1d6)]},'ticketId':_0x7f5666[_0x520eed(0x1f6)],'companyId':_0x4d4115['companyId']});}catch(_0xed8505){await(0x0,exports['deleteAndCreateDialogStage'])(_0x4f07a5,_0x4994d5['id'],_0x4d4115);}}}await(0x0,exports[_0x520eed(0x1c1)])(_0x4f07a5,_0x4994d5['id'],_0x4d4115);let _0x4ddbe9;_0x4994d5?.['greetingMessage']&&(_0x4ddbe9=await sendDialog(_0x4994d5,_0x5e6e55,_0x4f07a5,_0x4d4115));if(_0x4994d5['queueType']===_0x520eed(0x217))try{const _0x396896=path_1[_0x520eed(0x1ed)][_0x520eed(0x1e6)](__dirname,'..','..','..',_0x520eed(0x1cd)),_0x2f2b18=await(0x0,ShowService_1[_0x520eed(0x1ed)])(_0x4994d5[_0x520eed(0x1c6)],_0x4d4115['companyId']),_0x415d4a=path_1['default'][_0x520eed(0x1e6)](_0x396896,'company'+_0x4d4115[_0x520eed(0x205)],_0x520eed(0x20a),String(_0x2f2b18['id']));for(const [_0x5c12b9,_0x195da9]of _0x2f2b18[_0x520eed(0x1f0)][_0x520eed(0x21f)]()){const _0x47b5b4={'fieldname':_0x520eed(0x215),'originalname':_0x195da9[_0x520eed(0x1b3)],'encoding':_0x520eed(0x20d),'mimetype':_0x195da9['mediaType'],'filename':_0x195da9[_0x520eed(0x1b3)],'path':path_1[_0x520eed(0x1ed)][_0x520eed(0x1e6)](_0x415d4a,_0x195da9['path'])};await(0x0,SendWhatsAppMedia_1[_0x520eed(0x1ed)])({'media':_0x47b5b4,'ticket':_0x4d4115,'body':_0x195da9[_0x520eed(0x1f5)],'isForwarded':![]});};}catch(_0x4effb6){await(0x0,exports[_0x520eed(0x1c1)])(_0x4f07a5,_0x4994d5['id'],_0x4d4115);}return _0x4994d5['closeTicket']&&await sendMsgAndCloseTicket(_0x5e6e55,_0x4d4115[_0x520eed(0x1e0)],_0x4d4115),_0x4ddbe9;}}if(_0x195ce8){const _0x4d85bb=isNumeric(_0x53efff)?_0x53efff:0x1,_0x5c9166=await(0x0,ShowChatBotServices_1[_0x520eed(0x1ed)])(_0x195ce8[_0x520eed(0x225)]),_0x206b12=_0x5c9166[_0x520eed(0x1f0)][+_0x4d85bb-0x1]?_0x5c9166['options'][+_0x4d85bb-0x1]:_0x5c9166[_0x520eed(0x1f0)][0x0];if(!_0x206b12[_0x520eed(0x209)]){await(0x0,DeleteDialogChatBotsServices_1[_0x520eed(0x1ed)])(_0x4f07a5['id']);return;}if(_0x206b12){if(_0x206b12['queueType']==='integration')try{const _0x2a239e={'ticketData':{'integrationId':_0x206b12['optIntegrationId'],'useIntegration':!![],'status':'pending'},'ticketId':_0x4d4115['id']};await(0x0,UpdateTicketService_1[_0x520eed(0x1ed)])({'ticketData':{..._0x2a239e[_0x520eed(0x1d6)]},'ticketId':_0x2a239e[_0x520eed(0x1f6)],'companyId':_0x4d4115['companyId']});}catch(_0x9129b6){await(0x0,exports['deleteAndCreateDialogStage'])(_0x4f07a5,_0x206b12['id'],_0x4d4115);}else{if(_0x206b12[_0x520eed(0x1ff)]==='queue')try{const _0x18600f={'ticketData':{'queueId':_0x206b12[_0x520eed(0x1bf)],'status':_0x520eed(0x1c4)},'ticketId':_0x4d4115['id']};await(0x0,UpdateTicketService_1['default'])({'ticketData':{..._0x18600f['ticketData']},'ticketId':_0x18600f[_0x520eed(0x1f6)],'companyId':_0x4d4115[_0x520eed(0x205)]});}catch(_0x5944e5){await(0x0,exports[_0x520eed(0x1c1)])(_0x4f07a5,_0x206b12['id'],_0x4d4115);}else{if(_0x206b12[_0x520eed(0x1ff)]===_0x520eed(0x21e))try{const _0x17f4df={'ticketData':{'queueId':_0x206b12['optQueueId'],'userId':_0x206b12[_0x520eed(0x1bb)],'status':_0x520eed(0x1c4)},'ticketId':_0x4d4115['id']};await(0x0,UpdateTicketService_1[_0x520eed(0x1ed)])({'ticketData':{..._0x17f4df[_0x520eed(0x1d6)]},'ticketId':_0x17f4df['ticketId'],'companyId':_0x4d4115[_0x520eed(0x205)]});}catch(_0x41c766){await(0x0,exports[_0x520eed(0x1c1)])(_0x4f07a5,_0x206b12['id'],_0x4d4115);}}}await(0x0,exports[_0x520eed(0x1c1)])(_0x4f07a5,_0x206b12['id'],_0x4d4115);if(_0x206b12[_0x520eed(0x1ff)]===_0x520eed(0x217))try{const _0x53b67b=path_1[_0x520eed(0x1ed)][_0x520eed(0x1e6)](__dirname,'..','..','..',_0x520eed(0x1cd)),_0x4295cc=await(0x0,ShowService_1[_0x520eed(0x1ed)])(_0x206b12[_0x520eed(0x1c6)],_0x4d4115[_0x520eed(0x205)]),_0x17d56d=path_1[_0x520eed(0x1ed)][_0x520eed(0x1e6)](_0x53b67b,_0x520eed(0x21b)+_0x4d4115[_0x520eed(0x205)],_0x520eed(0x20a),String(_0x4295cc['id']));for(const [_0x1105ed,_0x16fb95]of _0x4295cc[_0x520eed(0x1f0)][_0x520eed(0x21f)]()){const _0x3c18a0={'fieldname':_0x520eed(0x215),'originalname':_0x16fb95[_0x520eed(0x1b3)],'encoding':_0x520eed(0x20d),'mimetype':_0x16fb95[_0x520eed(0x1ce)],'filename':_0x16fb95['path'],'path':path_1[_0x520eed(0x1ed)]['resolve'](_0x17d56d,_0x16fb95[_0x520eed(0x1b3)])};await(0x0,SendWhatsAppMedia_1[_0x520eed(0x1ed)])({'media':_0x3c18a0,'ticket':_0x4d4115,'body':_0x16fb95['name'],'isForwarded':![]});};}catch(_0x2d1abf){await(0x0,exports[_0x520eed(0x1c1)])(_0x4f07a5,_0x206b12['id'],_0x4d4115);}_0x206b12[_0x520eed(0x1d1)]&&await sendMsgAndCloseTicket(_0x5e6e55,_0x4d4115['contact'],_0x4d4115);await(0x0,exports[_0x520eed(0x1c1)])(_0x4f07a5,_0x206b12['id'],_0x4d4115);const _0x122c80=await sendDialog(_0x206b12,_0x5e6e55,_0x4f07a5,_0x4d4115);return _0x122c80;}}};exports[a619_0x29075b(0x224)]=sayChatbot;