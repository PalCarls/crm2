'use strict';const a552_0x1ebb4f=a552_0x5837;(function(_0x79583,_0x457185){const _0x30804e=a552_0x5837,_0x8c267f=_0x79583();while(!![]){try{const _0x32acb6=-parseInt(_0x30804e(0x179))/0x1*(parseInt(_0x30804e(0x186))/0x2)+-parseInt(_0x30804e(0x1b2))/0x3*(parseInt(_0x30804e(0x1ac))/0x4)+parseInt(_0x30804e(0x183))/0x5+parseInt(_0x30804e(0x1c1))/0x6+parseInt(_0x30804e(0x170))/0x7+-parseInt(_0x30804e(0x1c0))/0x8+parseInt(_0x30804e(0x1bf))/0x9;if(_0x32acb6===_0x457185)break;else _0x8c267f['push'](_0x8c267f['shift']());}catch(_0x534dfa){_0x8c267f['push'](_0x8c267f['shift']());}}}(a552_0x44c6,0x22953));var __importDefault=this&&this[a552_0x1ebb4f(0x182)]||function(_0x5ece9e){const _0x482c1a=a552_0x1ebb4f;return _0x5ece9e&&_0x5ece9e[_0x482c1a(0x19e)]?_0x5ece9e:{'default':_0x5ece9e};};Object[a552_0x1ebb4f(0x1aa)](exports,a552_0x1ebb4f(0x19e),{'value':!![]}),exports['sayChatbot']=exports[a552_0x1ebb4f(0x193)]=void 0x0;const path_1=__importDefault(require(a552_0x1ebb4f(0x18c))),wbotMessageListener_1=require(a552_0x1ebb4f(0x1b9)),ShowDialogChatBotsServices_1=__importDefault(require(a552_0x1ebb4f(0x1b0))),ShowQueueService_1=__importDefault(require(a552_0x1ebb4f(0x17e))),ShowChatBotServices_1=__importDefault(require(a552_0x1ebb4f(0x190))),DeleteDialogChatBotsServices_1=__importDefault(require(a552_0x1ebb4f(0x187))),ShowChatBotByChatbotIdServices_1=__importDefault(require('../ChatBotServices/ShowChatBotByChatbotIdServices')),CreateDialogChatBotsServices_1=__importDefault(require('../DialogChatBotsServices/CreateDialogChatBotsServices')),ShowWhatsAppService_1=__importDefault(require(a552_0x1ebb4f(0x19a))),Mustache_1=__importDefault(require(a552_0x1ebb4f(0x18a))),UpdateTicketService_1=__importDefault(require(a552_0x1ebb4f(0x1c2))),User_1=__importDefault(require(a552_0x1ebb4f(0x192))),ShowService_1=__importDefault(require(a552_0x1ebb4f(0x198))),SendWhatsAppMedia_1=__importDefault(require(a552_0x1ebb4f(0x16b))),CompaniesSettings_1=__importDefault(require(a552_0x1ebb4f(0x181))),fs=require('fs');var axios=require('axios');const isNumeric=_0x19d064=>/^-?\d+$/['test'](_0x19d064),deleteAndCreateDialogStage=async(_0x204279,_0x1e0d1c,_0x443611)=>{const _0x1e5da9=a552_0x1ebb4f;try{await(0x0,DeleteDialogChatBotsServices_1['default'])(_0x204279['id']);const _0xcc7ab9=await(0x0,ShowChatBotByChatbotIdServices_1[_0x1e5da9(0x189)])(_0x1e0d1c);return!_0xcc7ab9&&await _0x443611[_0x1e5da9(0x16f)]({'isBot':![]}),await(0x0,CreateDialogChatBotsServices_1[_0x1e5da9(0x189)])({'awaiting':0x1,'contactId':_0x204279['id'],'chatbotId':_0x1e0d1c,'queueId':_0xcc7ab9[_0x1e5da9(0x1a7)]});}catch(_0x5adb90){await _0x443611[_0x1e5da9(0x16f)]({'isBot':![]});}};exports[a552_0x1ebb4f(0x193)]=deleteAndCreateDialogStage;const sendMessage=async(_0x1475bf,_0x50d82f,_0x238ca6,_0x3e537e)=>{const _0x39c522=a552_0x1ebb4f,_0x2c4080=await _0x1475bf[_0x39c522(0x195)](_0x50d82f[_0x39c522(0x1a2)]+'@'+(_0x238ca6['isGroup']?_0x39c522(0x1a6):'s.whatsapp.net'),{'text':(0x0,Mustache_1[_0x39c522(0x189)])(_0x3e537e,_0x238ca6)});(0x0,wbotMessageListener_1[_0x39c522(0x184)])(_0x2c4080,_0x238ca6,_0x50d82f);},sendMessageLink=async(_0x1e4759,_0x5b6ed9,_0x5ce060,_0x1238d3,_0x2ad832)=>{const _0x263d51=a552_0x1ebb4f;let _0x1039d7;try{_0x1039d7=await _0x1e4759[_0x263d51(0x195)](_0x5b6ed9[_0x263d51(0x1a2)]+'@'+(_0x5ce060[_0x263d51(0x18f)]?_0x263d51(0x1a6):_0x263d51(0x1cd)),{'document':_0x1238d3?{'url':_0x1238d3}:fs[_0x263d51(0x17a)](_0x263d51(0x194)+_0x2ad832+'-'+makeid(0xa)),'fileName':_0x2ad832,'mimetype':_0x263d51(0x1cc)});}catch(_0x57e850){_0x1039d7=await _0x1e4759[_0x263d51(0x195)](_0x5b6ed9[_0x263d51(0x1a2)]+'@'+(_0x5ce060[_0x263d51(0x18f)]?_0x263d51(0x1a6):'s.whatsapp.net'),{'text':(0x0,Mustache_1[_0x263d51(0x189)])('‎Não\x20consegui\x20enviar\x20o\x20PDF,\x20tente\x20novamente!',_0x5ce060)});}(0x0,wbotMessageListener_1[_0x263d51(0x184)])(_0x1039d7,_0x5ce060,_0x5b6ed9);},sendMessageImage=async(_0x32ebc7,_0x29feb9,_0x5101ac,_0x335b01,_0x59894d)=>{const _0x51ec1d=a552_0x1ebb4f;let _0x32b21b;try{_0x32b21b=await _0x32ebc7[_0x51ec1d(0x195)](_0x29feb9[_0x51ec1d(0x1a2)]+'@'+(_0x5101ac[_0x51ec1d(0x18f)]?'g.us':'s.whatsapp.net'),{'image':_0x335b01?{'url':_0x335b01}:fs[_0x51ec1d(0x17a)](_0x51ec1d(0x194)+_0x59894d+'-'+makeid(0xa)),'fileName':_0x59894d,'caption':_0x59894d,'mimetype':'image/jpeg'});}catch(_0x3bb9aa){_0x32b21b=await _0x32ebc7[_0x51ec1d(0x195)](_0x29feb9[_0x51ec1d(0x1a2)]+'@'+(_0x5101ac['isGroup']?'g.us':_0x51ec1d(0x1cd)),{'text':(0x0,Mustache_1[_0x51ec1d(0x189)])(_0x51ec1d(0x199),_0x5101ac)});}(0x0,wbotMessageListener_1['verifyMessage'])(_0x32b21b,_0x5101ac,_0x29feb9);},sendDialog=async(_0x177d9f,_0x46ad94,_0xb2ee05,_0x1ca83)=>{const _0x5552fa=a552_0x1ebb4f,_0x5ed51d=await(0x0,ShowChatBotServices_1[_0x5552fa(0x189)])(_0x177d9f['id']);if(_0x5ed51d['options']){let _0x4d2b3d=_0x1ca83[_0x5552fa(0x1ce)];const _0x2833bf=await CompaniesSettings_1[_0x5552fa(0x189)][_0x5552fa(0x1ca)]({'where':{'companyId':_0x4d2b3d}}),_0x11b3c6=_0x2833bf?.['chatBotType']||_0x5552fa(0x1b7),_0x2b2b19=async()=>{const _0x443930=_0x5552fa;let _0x4687c4='';_0x5ed51d[_0x443930(0x1b4)][_0x443930(0x1a1)]((_0x1abff8,_0x3c20aa)=>{const _0x1d4179=_0x443930;_0x4687c4+='*'+(_0x3c20aa+0x1)+_0x1d4179(0x197)+_0x1abff8[_0x1d4179(0x17f)]+'\x0a';});const _0x64ceed=_0x4687c4[_0x443930(0x1c7)]>0x0?_0x4687c4+'\x0a*#*\x20Voltar\x20para\x20o\x20menu\x20principal':_0x4687c4;if(_0x4687c4[_0x443930(0x1c7)]>0x0){const _0x51d19f='‎'+_0x177d9f[_0x443930(0x1be)]+'\x0a\x0a'+_0x64ceed,_0x38e627=await sendMessage(_0x46ad94,_0xb2ee05,_0x1ca83,_0x51d19f);return _0x38e627;}const _0x3cc9b6='‎'+_0x177d9f['greetingMessage'],_0x1132ee=await sendMessage(_0x46ad94,_0xb2ee05,_0x1ca83,_0x3cc9b6);return _0x1132ee;},_0x97e7c=async()=>{const _0x2830c0=_0x5552fa,_0x3802f0=[];_0x5ed51d['options'][_0x2830c0(0x1a1)]((_0x589631,_0x302ad7)=>{const _0x2887ca=_0x2830c0;_0x3802f0['push']({'buttonId':''+(_0x302ad7+0x1),'buttonText':{'displayText':_0x589631[_0x2887ca(0x17f)]},'type':0x1});});if(_0x3802f0[_0x2830c0(0x1c7)]>0x0){const _0x35e333={'text':'‎'+_0x177d9f['greetingMessage'],'buttons':_0x3802f0,'headerType':0x1},_0x136e7e=await _0x46ad94[_0x2830c0(0x195)](_0xb2ee05[_0x2830c0(0x1a2)]+'@'+(_0x1ca83[_0x2830c0(0x18f)]?_0x2830c0(0x1a6):'s.whatsapp.net'),_0x35e333);return await(0x0,wbotMessageListener_1['verifyMessage'])(_0x136e7e,_0x1ca83,_0xb2ee05),_0x136e7e;}const _0x37975d='‎'+_0x177d9f[_0x2830c0(0x1be)],_0x391535=await sendMessage(_0x46ad94,_0xb2ee05,_0x1ca83,_0x37975d);return _0x391535;},_0x5021a2=async()=>{const _0x39c9f6=_0x5552fa,_0xf86e2a=[];_0x5ed51d['options'][_0x39c9f6(0x1a1)]((_0x1594b4,_0x26b452)=>{const _0x52a747=_0x39c9f6;_0xf86e2a[_0x52a747(0x174)]({'title':_0x1594b4[_0x52a747(0x17f)],'rowId':''+(_0x26b452+0x1)});});if(_0xf86e2a['length']>0x0){const _0xaa793e=[{'title':_0x39c9f6(0x178),'rows':_0xf86e2a}],_0x360df9={'text':(0x0,Mustache_1[_0x39c9f6(0x189)])('‎'+_0x177d9f[_0x39c9f6(0x1be)],_0x1ca83),'buttonText':_0x39c9f6(0x180),'sections':_0xaa793e},_0x1d03d8=await _0x46ad94[_0x39c9f6(0x195)](_0xb2ee05['number']+'@'+(_0x1ca83[_0x39c9f6(0x18f)]?_0x39c9f6(0x1a6):_0x39c9f6(0x1cd)),_0x360df9);return await(0x0,wbotMessageListener_1[_0x39c9f6(0x184)])(_0x1d03d8,_0x1ca83,_0xb2ee05),_0x1d03d8;}const _0x2f0909='‎'+_0x177d9f[_0x39c9f6(0x1be)],_0x5a7507=await sendMessage(_0x46ad94,_0xb2ee05,_0x1ca83,_0x2f0909);return _0x5a7507;};if(_0x11b3c6===_0x5552fa(0x1b7))return await _0x2b2b19();if(_0x11b3c6===_0x5552fa(0x175)&&_0x5ed51d[_0x5552fa(0x1b4)]['length']>0x4)return await _0x2b2b19();if(_0x11b3c6===_0x5552fa(0x175)&&_0x5ed51d[_0x5552fa(0x1b4)]['length']<=0x4)return await _0x97e7c();if(_0x11b3c6===_0x5552fa(0x1ae))return await _0x5021a2();}},backToMainMenu=async(_0x516a10,_0x30c631,_0x3e3521)=>{const _0x4d55c1=a552_0x1ebb4f;await(0x0,UpdateTicketService_1[_0x4d55c1(0x189)])({'ticketData':{'queueId':null,'userId':null},'ticketId':_0x3e3521['id'],'companyId':_0x3e3521[_0x4d55c1(0x1ce)]});const {queues:_0x2529e9,greetingMessage:_0x5609ec}=await(0x0,ShowWhatsAppService_1[_0x4d55c1(0x189)])(_0x516a10['id'],_0x3e3521[_0x4d55c1(0x1ce)]),_0x39a1ac=await CompaniesSettings_1[_0x4d55c1(0x189)][_0x4d55c1(0x1ca)]({'where':{'key':'chatBotType'}}),_0x118475=async()=>{const _0x2abe7b=_0x4d55c1;let _0x1400bd='';_0x2529e9[_0x2abe7b(0x1a1)]((_0x56c61c,_0x7e1e3c)=>{const _0x4e727d=_0x2abe7b;_0x1400bd+='*'+(_0x7e1e3c+0x1)+_0x4e727d(0x197)+_0x56c61c[_0x4e727d(0x17f)]+'\x0a';});const _0x1ce701=(0x0,Mustache_1[_0x2abe7b(0x189)])('‎'+_0x5609ec+'\x0a\x0a'+_0x1400bd,_0x3e3521);await sendMessage(_0x516a10,_0x30c631,_0x3e3521,_0x1ce701);const _0x3fb1e2=await(0x0,DeleteDialogChatBotsServices_1['default'])(_0x30c631['id']);return _0x3fb1e2;},_0x4b2fc9=async()=>{const _0x2bc347=_0x4d55c1,_0x396b21=[];_0x2529e9[_0x2bc347(0x1a1)]((_0x5e9e51,_0x13c3bc)=>{const _0x414f1=_0x2bc347;_0x396b21['push']({'buttonId':''+(_0x13c3bc+0x1),'buttonText':{'displayText':_0x5e9e51[_0x414f1(0x17f)]},'type':0x1});});const _0x2eebb5={'text':(0x0,Mustache_1[_0x2bc347(0x189)])('‎'+_0x5609ec,_0x3e3521),'buttons':_0x396b21,'headerType':0x1},_0x2c395a=await _0x516a10[_0x2bc347(0x195)](_0x30c631[_0x2bc347(0x1a2)]+'@'+(_0x3e3521['isGroup']?_0x2bc347(0x1a6):_0x2bc347(0x1cd)),_0x2eebb5);await(0x0,wbotMessageListener_1['verifyMessage'])(_0x2c395a,_0x3e3521,_0x30c631);const _0x28bf90=await(0x0,DeleteDialogChatBotsServices_1[_0x2bc347(0x189)])(_0x30c631['id']);return _0x28bf90;},_0x5b4248=async()=>{const _0x279a06=_0x4d55c1,_0x222aa0=[];_0x2529e9[_0x279a06(0x1a1)]((_0x471860,_0x435476)=>{const _0xdea591=_0x279a06;_0x222aa0[_0xdea591(0x174)]({'title':_0x471860['name'],'rowId':''+(_0x435476+0x1)});});const _0x4a877b=[{'title':'Menu','rows':_0x222aa0}],_0x14242b={'text':(0x0,Mustache_1['default'])('‎'+_0x5609ec,_0x3e3521),'buttonText':_0x279a06(0x180),'sections':_0x4a877b},_0x3b7029=await _0x516a10[_0x279a06(0x195)](_0x30c631[_0x279a06(0x1a2)]+'@'+(_0x3e3521[_0x279a06(0x18f)]?_0x279a06(0x1a6):'s.whatsapp.net'),_0x14242b);await(0x0,wbotMessageListener_1[_0x279a06(0x184)])(_0x3b7029,_0x3e3521,_0x30c631);const _0x36819c=await(0x0,DeleteDialogChatBotsServices_1[_0x279a06(0x189)])(_0x30c631['id']);return _0x36819c;};if(_0x39a1ac[_0x4d55c1(0x18b)]==='text')return _0x118475();if(_0x39a1ac[_0x4d55c1(0x18b)]===_0x4d55c1(0x175)&&_0x2529e9['length']>0x4)return _0x118475();if(_0x39a1ac['chatBotType']==='button'&&_0x2529e9[_0x4d55c1(0x1c7)]<=0x4)return _0x4b2fc9();if(_0x39a1ac[_0x4d55c1(0x18b)]===_0x4d55c1(0x1ae))return _0x5b4248();};function validaCpfCnpj(_0x423268){const _0x2b4ffd=a552_0x1ebb4f;if(_0x423268[_0x2b4ffd(0x1c7)]==0xb){var _0x44c3d9=_0x423268[_0x2b4ffd(0x188)]();_0x44c3d9=_0x44c3d9[_0x2b4ffd(0x17b)](/\./g,''),_0x44c3d9=_0x44c3d9[_0x2b4ffd(0x17b)]('-',''),_0x44c3d9=_0x44c3d9[_0x2b4ffd(0x1a0)]('');var _0x2b6e39=0x0,_0x28a03a=0x0,_0x26d81f=![];for(var _0xb144e5=0x1;_0x44c3d9[_0x2b4ffd(0x1c7)]>_0xb144e5;_0xb144e5++){_0x44c3d9[_0xb144e5-0x1]!=_0x44c3d9[_0xb144e5]&&(_0x26d81f=!![]);}if(_0x26d81f==![])return![];for(var _0xb144e5=0x0,_0x7e005b=0xa;_0x44c3d9[_0x2b4ffd(0x1c7)]-0x2>_0xb144e5;_0xb144e5++,_0x7e005b--){_0x2b6e39+=_0x44c3d9[_0xb144e5]*_0x7e005b;}_0x2b6e39=_0x2b6e39*0xa%0xb;_0x2b6e39==0xa&&(_0x2b6e39=0x0);if(_0x2b6e39!=_0x44c3d9[0x9])return![];for(var _0xb144e5=0x0,_0x7e005b=0xb;_0x44c3d9[_0x2b4ffd(0x1c7)]-0x1>_0xb144e5;_0xb144e5++,_0x7e005b--){_0x28a03a+=_0x44c3d9[_0xb144e5]*_0x7e005b;}return _0x28a03a=_0x28a03a*0xa%0xb,_0x28a03a==0xa&&(_0x28a03a=0x0),_0x28a03a!=_0x44c3d9[0xa]?![]:!![];}else{if(_0x423268[_0x2b4ffd(0x1c7)]==0xe){var _0x3da40b=_0x423268[_0x2b4ffd(0x188)]();_0x3da40b=_0x3da40b[_0x2b4ffd(0x17b)](/\./g,''),_0x3da40b=_0x3da40b[_0x2b4ffd(0x17b)]('-',''),_0x3da40b=_0x3da40b['replace']('/',''),_0x3da40b=_0x3da40b[_0x2b4ffd(0x1a0)]('');var _0x2b6e39=0x0,_0x28a03a=0x0,_0x26d81f=![];for(var _0xb144e5=0x1;_0x3da40b[_0x2b4ffd(0x1c7)]>_0xb144e5;_0xb144e5++){_0x3da40b[_0xb144e5-0x1]!=_0x3da40b[_0xb144e5]&&(_0x26d81f=!![]);}if(_0x26d81f==![])return![];for(var _0xb144e5=0x0,_0x45a717=0x5,_0x5f4781=0xd;_0x3da40b[_0x2b4ffd(0x1c7)]-0x2>_0xb144e5;_0xb144e5++,_0x45a717--,_0x5f4781--){_0x45a717>=0x2?_0x2b6e39+=_0x3da40b[_0xb144e5]*_0x45a717:_0x2b6e39+=_0x3da40b[_0xb144e5]*_0x5f4781;}_0x2b6e39=_0x2b6e39%0xb;_0x2b6e39<0x2?_0x2b6e39=0x0:_0x2b6e39=0xb-_0x2b6e39;if(_0x2b6e39!=_0x3da40b[0xc])return![];for(var _0xb144e5=0x0,_0x45a717=0x6,_0x5f4781=0xe;_0x3da40b['length']-0x1>_0xb144e5;_0xb144e5++,_0x45a717--,_0x5f4781--){_0x45a717>=0x2?_0x28a03a+=_0x3da40b[_0xb144e5]*_0x45a717:_0x28a03a+=_0x3da40b[_0xb144e5]*_0x5f4781;}return _0x28a03a=_0x28a03a%0xb,_0x28a03a<0x2?_0x28a03a=0x0:_0x28a03a=0xb-_0x28a03a,_0x28a03a!=_0x3da40b[0xd]?![]:!![];}else return![];}}function timeout(_0x1d6402){return new Promise(_0x86dece=>setTimeout(_0x86dece,_0x1d6402));}async function sleep(_0x248fbb){await timeout(_0x248fbb);}function firstDayOfMonth(_0x1c760a){const _0x45624f=a552_0x1ebb4f,_0x3da5ea=new Date(),_0x2c3e5f=new Date(_0x3da5ea['getFullYear'](),_0x3da5ea[_0x45624f(0x1af)]()-_0x1c760a,0x1);return _0x2c3e5f;};function lastDayOfMonth(_0x310ac8){const _0x5a54f1=a552_0x1ebb4f,_0x586613=new Date(),_0x1ba08c=new Date(_0x586613[_0x5a54f1(0x1c8)](),_0x586613[_0x5a54f1(0x1af)]()+_0x310ac8,0x0);return _0x1ba08c;};function dataAtualFormatada(_0xd524c7){const _0x3a156c=a552_0x1ebb4f;var _0x7d4e02=_0xd524c7[_0x3a156c(0x172)]()[_0x3a156c(0x1b8)](),_0x35fa71=_0x7d4e02[_0x3a156c(0x1c7)]==0x1?'0'+_0x7d4e02:_0x7d4e02,_0x1197bc=(_0xd524c7[_0x3a156c(0x1af)]()+0x1)[_0x3a156c(0x1b8)](),_0x5948ad=_0x1197bc[_0x3a156c(0x1c7)]==0x1?'0'+_0x1197bc:_0x1197bc,_0x14562b=_0xd524c7[_0x3a156c(0x1c8)]();return _0x35fa71+'/'+_0x5948ad+'/'+_0x14562b;}function makeid(_0x4030a4){const _0x15068f=a552_0x1ebb4f;var _0x261383='',_0x186701=_0x15068f(0x196),_0x1495db=_0x186701[_0x15068f(0x1c7)];for(var _0x585678=0x0;_0x585678<_0x4030a4;_0x585678++){_0x261383+=_0x186701[_0x15068f(0x19c)](Math[_0x15068f(0x16d)](Math['random']()*_0x1495db));}return _0x261383;}function a552_0x44c6(){const _0x6a10d=['isGroup','../ChatBotServices/ShowChatBotServices','chatbots','../../models/User','deleteAndCreateDialogStage','public/temp/','sendMessage','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','*\x20-\x20','../../services/FileServices/ShowService','Não\x20consegui\x20enviar\x20o\x20PDF,\x20tente\x20novamente!','../WhatsappService/ShowWhatsAppService','selectedButtonId','charAt','buttonsResponseMessage','__esModule','integration','split','forEach','number','file','djsdlaskjasa','localeCompare','g.us','queueId','fromMe','resolve','defineProperty','closed','524YgvIZa','substring','list','getMonth','../DialogChatBotsServices/ShowDialogChatBotsServices','key','4395tWoqYC','open','options','ticketData','finalizar','text','toString','./wbotMessageListener','optIntegrationId','public','selectedRowId','7bit','greetingMessage','2971107ksudUw','921992cOhaeP','768468toterh','../TicketServices/UpdateTicketService','dueDate','company','isAgent','getBodyMessage','length','getFullYear','ticketId','findOne','listResponseMessage','application/pdf','s.whatsapp.net','companyId','optQueueId','./SendWhatsAppMedia','singleSelectReply','floor','Estamos\x20finalizando\x20esta\x20conversa!\x20Caso\x20precise\x20entre\x20em\x20contato\x20conosco!','update','1415113BefTAL','message','getDate','fileList','push','button','pending','optUserId','Menu','4538nRZIfM','readFileSync','replace','medias','sayChatbot','../QueueService/ShowQueueService','name','Escolha\x20uma\x20opção','../../models/CompaniesSettings','__importDefault','122155xJWGmJ','verifyMessage','optFileId','104IIIhLj','../DialogChatBotsServices/DeleteDialogChatBotsServices','trim','default','../../helpers/Mustache','chatBotType','path','queueType','mediaType'];a552_0x44c6=function(){return _0x6a10d;};return a552_0x44c6();}function replaceAll(_0x46237b,_0x3cadb3,_0xa7db0a){const _0x357d78=a552_0x1ebb4f;return _0x46237b[_0x357d78(0x17b)](new RegExp(_0x3cadb3,'g'),_0xa7db0a);}function a552_0x5837(_0xe7d22f,_0x102644){const _0x44c609=a552_0x44c6();return a552_0x5837=function(_0x58379f,_0x5e8701){_0x58379f=_0x58379f-0x16a;let _0x48c2a0=_0x44c609[_0x58379f];return _0x48c2a0;},a552_0x5837(_0xe7d22f,_0x102644);}function formatDate(_0x14c1a3){const _0x2ae051=a552_0x1ebb4f;return _0x14c1a3[_0x2ae051(0x1ad)](0x8,0xa)+'/'+_0x14c1a3[_0x2ae051(0x1ad)](0x5,0x7)+'/'+_0x14c1a3[_0x2ae051(0x1ad)](0x0,0x4);}function sortfunction(_0x85ea1b,_0x474e32){const _0x2d41df=a552_0x1ebb4f;return _0x85ea1b['dueDate'][_0x2d41df(0x1a5)](_0x474e32[_0x2d41df(0x1c3)]);}async function sendMsgAndCloseTicket(_0x49f807,_0x4047db,_0x4535e5){const _0x53d9c5=a552_0x1ebb4f,_0x3219e0=_0x53d9c5(0x16e);await sleep(0x7d0),await sendMessage(_0x49f807,_0x4047db,_0x4535e5,_0x3219e0);const _0x5c7bd3={'ticketData':{'status':'closed','userId':0x1,'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'ticketId':_0x4535e5['id'],'companyId':_0x4535e5['companyId'],'ratingId':undefined};await sleep(0x7d0),await(0x0,UpdateTicketService_1[_0x53d9c5(0x189)])(_0x5c7bd3);}const sayChatbot=async(_0x5a3434,_0x4436cd,_0x117f9c,_0x3a5dfc,_0x353412)=>{const _0x47de5c=a552_0x1ebb4f,_0x37f532=_0x353412?.[_0x47de5c(0x171)]?.[_0x47de5c(0x19d)]?.[_0x47de5c(0x19b)]||_0x353412?.[_0x47de5c(0x171)]?.[_0x47de5c(0x1cb)]?.[_0x47de5c(0x16c)][_0x47de5c(0x1bc)]||(0x0,wbotMessageListener_1[_0x47de5c(0x1c6)])(_0x353412);if(!_0x5a3434&&_0x37f532&&_0x353412[_0x47de5c(0x1b1)][_0x47de5c(0x1a8)])return;const _0x295fe1=await(0x0,ShowDialogChatBotsServices_1[_0x47de5c(0x189)])(_0x3a5dfc['id']),_0x43a8cf=await(0x0,ShowQueueService_1[_0x47de5c(0x189)])(_0x5a3434,_0x117f9c[_0x47de5c(0x1ce)]);let _0x3f7ad8;if(_0x37f532['toLocaleLowerCase']()===_0x47de5c(0x1b6)){const _0x44cc84={'ticketData':{'status':_0x47de5c(0x1ab),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'ticketId':_0x117f9c['id'],'companyId':_0x117f9c[_0x47de5c(0x1ce)]};await(0x0,UpdateTicketService_1[_0x47de5c(0x189)])(_0x44cc84);}if(_0x37f532==='#'){const _0x11e511=await backToMainMenu(_0x4436cd,_0x3a5dfc,_0x117f9c);return _0x11e511;}if(!_0x295fe1){const _0x52162e=await(0x0,ShowQueueService_1[_0x47de5c(0x189)])(_0x5a3434,_0x117f9c[_0x47de5c(0x1ce)]),_0x49e734=_0x353412?.[_0x47de5c(0x171)]?.[_0x47de5c(0x19d)]?.['selectedButtonId']||_0x353412?.[_0x47de5c(0x171)]?.[_0x47de5c(0x1cb)]?.[_0x47de5c(0x16c)][_0x47de5c(0x1bc)]||(0x0,wbotMessageListener_1[_0x47de5c(0x1c6)])(_0x353412),_0x3cf89b=_0x52162e[_0x47de5c(0x191)][+_0x49e734-0x1];if(_0x3cf89b){console['log'](_0x47de5c(0x1a4));if(_0x3cf89b[_0x47de5c(0x18d)]===_0x47de5c(0x19f))try{const _0x20654b={'ticketData':{'integrationId':_0x3cf89b[_0x47de5c(0x1ba)],'useIntegration':!![],'status':_0x47de5c(0x176)},'ticketId':_0x117f9c['id']};await(0x0,UpdateTicketService_1[_0x47de5c(0x189)])({'ticketData':{..._0x20654b[_0x47de5c(0x1b5)]},'ticketId':_0x20654b['ticketId'],'companyId':_0x117f9c['companyId']});}catch(_0x5a3a97){await(0x0,exports[_0x47de5c(0x193)])(_0x3a5dfc,_0x3cf89b['id'],_0x117f9c);}if(_0x3cf89b[_0x47de5c(0x18d)]==='queue')try{const _0x5ad149={'ticketData':{'queueId':_0x3cf89b[_0x47de5c(0x16a)],'status':'pending'},'ticketId':_0x117f9c['id']};await(0x0,UpdateTicketService_1[_0x47de5c(0x189)])({'ticketData':{..._0x5ad149['ticketData']},'ticketId':_0x5ad149['ticketId'],'companyId':_0x117f9c['companyId']});}catch(_0x27236a){await(0x0,exports['deleteAndCreateDialogStage'])(_0x3a5dfc,_0x3cf89b['id'],_0x117f9c);}if(_0x3cf89b[_0x47de5c(0x18d)]==='attendent')try{const _0x2852a5={'ticketData':{'queueId':_0x3cf89b[_0x47de5c(0x16a)],'userId':_0x3cf89b[_0x47de5c(0x177)],'status':'pending'},'ticketId':_0x117f9c['id']};await(0x0,UpdateTicketService_1['default'])({'ticketData':{..._0x2852a5[_0x47de5c(0x1b5)]},'ticketId':_0x2852a5[_0x47de5c(0x1c9)],'companyId':_0x117f9c[_0x47de5c(0x1ce)]});}catch(_0x5a52ca){await(0x0,exports[_0x47de5c(0x193)])(_0x3a5dfc,_0x3cf89b['id'],_0x117f9c);}await(0x0,exports['deleteAndCreateDialogStage'])(_0x3a5dfc,_0x3cf89b['id'],_0x117f9c);let _0x2e96c1;_0x3cf89b?.[_0x47de5c(0x1be)]&&(_0x2e96c1=await sendDialog(_0x3cf89b,_0x4436cd,_0x3a5dfc,_0x117f9c));if(_0x3cf89b['queueType']===_0x47de5c(0x1a3))try{const _0x224557=path_1[_0x47de5c(0x189)]['resolve'](__dirname,'..','..','..',_0x47de5c(0x1bb)),_0x243880=await(0x0,ShowService_1['default'])(_0x3cf89b[_0x47de5c(0x185)],_0x117f9c[_0x47de5c(0x1ce)]),_0x5a453a=path_1[_0x47de5c(0x189)][_0x47de5c(0x1a9)](_0x224557,_0x47de5c(0x1c4)+_0x117f9c[_0x47de5c(0x1ce)],_0x47de5c(0x173),String(_0x243880['id']));for(const [_0x5a296c,_0x4c02f3]of _0x243880[_0x47de5c(0x1b4)]['entries']()){const _0xe58303={'fieldname':_0x47de5c(0x17c),'originalname':_0x4c02f3[_0x47de5c(0x18c)],'encoding':_0x47de5c(0x1bd),'mimetype':_0x4c02f3[_0x47de5c(0x18e)],'filename':_0x4c02f3[_0x47de5c(0x18c)],'path':path_1[_0x47de5c(0x189)]['resolve'](_0x5a453a,_0x4c02f3[_0x47de5c(0x18c)])};await(0x0,SendWhatsAppMedia_1['default'])({'media':_0xe58303,'ticket':_0x117f9c,'body':_0x4c02f3['name'],'isForwarded':![]});};}catch(_0x272f58){await(0x0,exports[_0x47de5c(0x193)])(_0x3a5dfc,_0x3cf89b['id'],_0x117f9c);}return _0x2e96c1;}}if(_0x295fe1){const _0x61a749=isNumeric(_0x37f532)?_0x37f532:0x1,_0x578f48=await(0x0,ShowChatBotServices_1['default'])(_0x295fe1['chatbotId']),_0xc1cccd=_0x578f48['options'][+_0x61a749-0x1]?_0x578f48[_0x47de5c(0x1b4)][+_0x61a749-0x1]:_0x578f48[_0x47de5c(0x1b4)][0x0];if(!_0xc1cccd[_0x47de5c(0x1be)]){await(0x0,DeleteDialogChatBotsServices_1[_0x47de5c(0x189)])(_0x3a5dfc['id']);return;}if(_0xc1cccd){if(_0xc1cccd[_0x47de5c(0x1c5)]){const _0x59a9a1=await User_1[_0x47de5c(0x189)][_0x47de5c(0x1ca)]({'where':{'name':_0xc1cccd[_0x47de5c(0x17f)]}}),_0x1edf28={'ticketData':{'userId':_0x59a9a1['id'],'status':_0x47de5c(0x1b3)},'ticketId':_0x117f9c['id']};await(0x0,UpdateTicketService_1['default'])({'ticketData':{..._0x1edf28['ticketData']},'ticketId':_0x1edf28[_0x47de5c(0x1c9)],'companyId':_0x117f9c[_0x47de5c(0x1ce)]});}await(0x0,exports[_0x47de5c(0x193)])(_0x3a5dfc,_0xc1cccd['id'],_0x117f9c);const _0x39beee=await sendDialog(_0xc1cccd,_0x4436cd,_0x3a5dfc,_0x117f9c);return _0x39beee;}}};exports[a552_0x1ebb4f(0x17d)]=sayChatbot;