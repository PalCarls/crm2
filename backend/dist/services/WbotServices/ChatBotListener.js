'use strict';const a611_0x24dfb0=a611_0x1d67;(function(_0x47490c,_0x403eb4){const _0x495907=a611_0x1d67,_0x309495=_0x47490c();while(!![]){try{const _0x1931f4=-parseInt(_0x495907(0x139))/0x1*(parseInt(_0x495907(0x100))/0x2)+parseInt(_0x495907(0xe2))/0x3*(parseInt(_0x495907(0x137))/0x4)+-parseInt(_0x495907(0x13f))/0x5+-parseInt(_0x495907(0xe9))/0x6+-parseInt(_0x495907(0x111))/0x7*(-parseInt(_0x495907(0xd3))/0x8)+parseInt(_0x495907(0x13e))/0x9+parseInt(_0x495907(0x115))/0xa*(parseInt(_0x495907(0xdc))/0xb);if(_0x1931f4===_0x403eb4)break;else _0x309495['push'](_0x309495['shift']());}catch(_0x4f4c7c){_0x309495['push'](_0x309495['shift']());}}}(a611_0x10c6,0x8341b));var __createBinding=this&&this[a611_0x24dfb0(0x135)]||(Object[a611_0x24dfb0(0xe1)]?function(_0x2ce343,_0x489efc,_0x117d03,_0x5b75b6){const _0x18a8b9=a611_0x24dfb0;if(_0x5b75b6===undefined)_0x5b75b6=_0x117d03;var _0x103007=Object['getOwnPropertyDescriptor'](_0x489efc,_0x117d03);(!_0x103007||(_0x18a8b9(0x13c)in _0x103007?!_0x489efc[_0x18a8b9(0x134)]:_0x103007['writable']||_0x103007[_0x18a8b9(0xcf)]))&&(_0x103007={'enumerable':!![],'get':function(){return _0x489efc[_0x117d03];}}),Object[_0x18a8b9(0xd9)](_0x2ce343,_0x5b75b6,_0x103007);}:function(_0x52d703,_0x826035,_0x13d36f,_0x3a167e){if(_0x3a167e===undefined)_0x3a167e=_0x13d36f;_0x52d703[_0x3a167e]=_0x826035[_0x13d36f];}),__setModuleDefault=this&&this[a611_0x24dfb0(0x109)]||(Object[a611_0x24dfb0(0xe1)]?function(_0x370d2b,_0x3ebabf){const _0x441c0e=a611_0x24dfb0;Object['defineProperty'](_0x370d2b,_0x441c0e(0x145),{'enumerable':!![],'value':_0x3ebabf});}:function(_0x5ab8c4,_0x3fa899){_0x5ab8c4['default']=_0x3fa899;}),__importStar=this&&this['__importStar']||function(_0x7efb20){const _0x3b2fac=a611_0x24dfb0;if(_0x7efb20&&_0x7efb20['__esModule'])return _0x7efb20;var _0x42c9ec={};if(_0x7efb20!=null){for(var _0x24f68c in _0x7efb20)if(_0x24f68c!==_0x3b2fac(0x145)&&Object['prototype'][_0x3b2fac(0xeb)][_0x3b2fac(0x12d)](_0x7efb20,_0x24f68c))__createBinding(_0x42c9ec,_0x7efb20,_0x24f68c);}return __setModuleDefault(_0x42c9ec,_0x7efb20),_0x42c9ec;},__importDefault=this&&this[a611_0x24dfb0(0x126)]||function(_0x10e964){const _0x2b7fb6=a611_0x24dfb0;return _0x10e964&&_0x10e964[_0x2b7fb6(0x134)]?_0x10e964:{'default':_0x10e964};};function a611_0x10c6(){const _0x1274b0=['chatbotId','optUserId','entries','sendMessage','create','1570641UFSbsa','../TicketServices/UpdateTicketService','closeTicket','update','getFullYear','queueType','buttonsResponseMessage','4138482AoFcPY','resolve','hasOwnProperty','deleteAndCreateDialogStage','Menu','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','../DialogChatBotsServices/ShowDialogChatBotsServices','‎Não\x20consegui\x20enviar\x20o\x20PDF,\x20tente\x20novamente!','../../services/FileServices/ShowService','companyId','selectedButtonId','localeCompare','verifyMediaMessage','verifyMessage','\x0a*[\x20Sair\x20]*\x20-\x20Encerrar\x20Atendimento','fileList','greetingMediaAttachment','isGroup','public/temp/','sayChatbot','g.us','toLocaleLowerCase','whatsapp','144852dQKBOk','contact','ticketId','length','number','name','sair','\x20]*\x20-\x20','selectedRowId','__setModuleDefault','dueDate','pending','forEach','mediaType','replace','push','split','7soThjM','medias','getMonth','*[\x20','150DeeqGM','\x0a*[\x20#\x20]*\x20Voltar\x20para\x20o\x20menu\x20principal\x0a*[\x20Sair\x20]*\x20Encerrar\x20atendimento','fromMe','findOne','./SendWhatsAppMedia','list','substring','charAt','greetingMessage','public','Não\x20consegui\x20enviar\x20o\x20PDF,\x20tente\x20novamente!','chatbots','s.whatsapp.net','attendent','../DialogChatBotsServices/CreateDialogChatBotsServices','../../models/CompaniesSettings','chatBotType','__importDefault','optIntegrationId','integration','optQueueId','company','../ChatBotServices/ShowChatBotByChatbotIdServices','trim','call','floor','image/jpeg','../DialogChatBotsServices/DeleteDialogChatBotsServices','ticketData','closed','getBodyMessage','__esModule','__createBinding','listResponseMessage','4dfsiMy','userId','2dyArwq','message','axios','get','7bit','3827610bOodiz','4865125nfCzqe','optFileId','options','\x0a*[\x20Sair\x20]*\x20Encerrar\x20atendimento','path','queue','default','configurable','toString','text','readFileSync','7469192ZOQckZ','file','../WhatsappService/ShowWhatsAppService','queueId','../QueueService/ShowQueueService','../../helpers/Mustache','defineProperty','singleSelectReply','button','339361tgoASR'];a611_0x10c6=function(){return _0x1274b0;};return a611_0x10c6();}Object[a611_0x24dfb0(0xd9)](exports,'__esModule',{'value':!![]}),exports[a611_0x24dfb0(0xfc)]=exports[a611_0x24dfb0(0xec)]=void 0x0;const path_1=__importDefault(require('path')),wbotMessageListener_1=require('./wbotMessageListener'),ShowDialogChatBotsServices_1=__importDefault(require(a611_0x24dfb0(0xef))),ShowQueueService_1=__importDefault(require(a611_0x24dfb0(0xd7))),ShowChatBotServices_1=__importDefault(require('../ChatBotServices/ShowChatBotServices')),DeleteDialogChatBotsServices_1=__importDefault(require(a611_0x24dfb0(0x130))),ShowChatBotByChatbotIdServices_1=__importDefault(require(a611_0x24dfb0(0x12b))),CreateDialogChatBotsServices_1=__importDefault(require(a611_0x24dfb0(0x123))),ShowWhatsAppService_1=__importDefault(require(a611_0x24dfb0(0xd5))),Mustache_1=__importDefault(require(a611_0x24dfb0(0xd8))),UpdateTicketService_1=__importDefault(require(a611_0x24dfb0(0xe3))),ShowService_1=__importDefault(require(a611_0x24dfb0(0xf1))),SendWhatsAppMedia_1=__importStar(require(a611_0x24dfb0(0x119))),CompaniesSettings_1=__importDefault(require(a611_0x24dfb0(0x124))),fs=require('fs');var axios=require(a611_0x24dfb0(0x13b));const isNumeric=_0x1f1e0e=>/^-?\d+$/['test'](_0x1f1e0e),deleteAndCreateDialogStage=async(_0x10b41a,_0x53cd58,_0x85bad2)=>{const _0x3816f3=a611_0x24dfb0;try{await(0x0,DeleteDialogChatBotsServices_1[_0x3816f3(0x145)])(_0x10b41a['id']);const _0x280659=await(0x0,ShowChatBotByChatbotIdServices_1[_0x3816f3(0x145)])(_0x53cd58);return!_0x280659&&await _0x85bad2[_0x3816f3(0xe5)]({'isBot':![]}),await(0x0,CreateDialogChatBotsServices_1[_0x3816f3(0x145)])({'awaiting':0x1,'contactId':_0x10b41a['id'],'chatbotId':_0x53cd58,'queueId':_0x280659[_0x3816f3(0xd6)]});}catch(_0x43f529){await _0x85bad2[_0x3816f3(0xe5)]({'isBot':![]});}};exports[a611_0x24dfb0(0xec)]=deleteAndCreateDialogStage;const sendMessage=async(_0x53fca1,_0x42484e,_0x1b4903,_0x201eab)=>{const _0x1a84f0=a611_0x24dfb0,_0x47e45c=await _0x53fca1[_0x1a84f0(0xe0)](_0x42484e[_0x1a84f0(0x104)]+'@'+(_0x1b4903[_0x1a84f0(0xfa)]?_0x1a84f0(0xfd):_0x1a84f0(0x121)),{'text':(0x0,Mustache_1['default'])(_0x201eab,_0x1b4903)});(0x0,wbotMessageListener_1[_0x1a84f0(0xf6)])(_0x47e45c,_0x1b4903,_0x42484e);},sendMessageLink=async(_0x33a8ae,_0x367150,_0x301e05,_0x1a4224,_0x457067)=>{const _0x5d7992=a611_0x24dfb0;let _0x1c7af3;try{_0x1c7af3=await _0x33a8ae[_0x5d7992(0xe0)](_0x367150[_0x5d7992(0x104)]+'@'+(_0x301e05[_0x5d7992(0xfa)]?_0x5d7992(0xfd):_0x5d7992(0x121)),{'document':_0x1a4224?{'url':_0x1a4224}:fs['readFileSync']('public/temp/'+_0x457067+'-'+makeid(0xa)),'fileName':_0x457067,'mimetype':'application/pdf'});}catch(_0x11a556){_0x1c7af3=await _0x33a8ae[_0x5d7992(0xe0)](_0x367150[_0x5d7992(0x104)]+'@'+(_0x301e05[_0x5d7992(0xfa)]?'g.us':'s.whatsapp.net'),{'text':(0x0,Mustache_1[_0x5d7992(0x145)])(_0x5d7992(0xf0),_0x301e05)});}(0x0,wbotMessageListener_1[_0x5d7992(0xf6)])(_0x1c7af3,_0x301e05,_0x367150);},sendMessageImage=async(_0x30de1c,_0x163f07,_0x44f15f,_0x282fdb,_0x5a0740)=>{const _0x2dde6d=a611_0x24dfb0;let _0x189c69;try{_0x189c69=await _0x30de1c[_0x2dde6d(0xe0)](_0x163f07['number']+'@'+(_0x44f15f[_0x2dde6d(0xfa)]?_0x2dde6d(0xfd):'s.whatsapp.net'),{'image':_0x282fdb?{'url':_0x282fdb}:fs[_0x2dde6d(0xd2)](_0x2dde6d(0xfb)+_0x5a0740+'-'+makeid(0xa)),'fileName':_0x5a0740,'caption':_0x5a0740,'mimetype':_0x2dde6d(0x12f)});}catch(_0x3f86a5){_0x189c69=await _0x30de1c[_0x2dde6d(0xe0)](_0x163f07[_0x2dde6d(0x104)]+'@'+(_0x44f15f['isGroup']?_0x2dde6d(0xfd):'s.whatsapp.net'),{'text':(0x0,Mustache_1[_0x2dde6d(0x145)])(_0x2dde6d(0x11f),_0x44f15f)});}(0x0,wbotMessageListener_1[_0x2dde6d(0xf6)])(_0x189c69,_0x44f15f,_0x163f07);},sendDialog=async(_0x5553f8,_0x3954c3,_0x34ae28,_0x21be42)=>{const _0x2528ee=a611_0x24dfb0,_0x3b677d=await(0x0,ShowChatBotServices_1[_0x2528ee(0x145)])(_0x5553f8['id']);if(_0x3b677d[_0x2528ee(0x141)]){let _0x428fcf=_0x21be42[_0x2528ee(0xf2)];const _0x333496=await CompaniesSettings_1[_0x2528ee(0x145)][_0x2528ee(0x118)]({'where':{'companyId':_0x428fcf}}),_0x5cb54d=_0x333496?.['chatBotType']||_0x2528ee(0xd1),_0x32c2a7=async()=>{const _0x345fb4=_0x2528ee;let _0x527cbe='';_0x3b677d[_0x345fb4(0x141)][_0x345fb4(0x10c)]((_0x17396c,_0x290270)=>{const _0x175ec6=_0x345fb4;_0x527cbe+=_0x175ec6(0x114)+(_0x290270+0x1)+_0x175ec6(0x107)+_0x17396c[_0x175ec6(0x105)]+'\x0a';});const _0x338644=_0x527cbe[_0x345fb4(0x103)]>0x0?_0x527cbe+_0x345fb4(0x116):_0x527cbe+_0x345fb4(0x142);if(_0x527cbe[_0x345fb4(0x103)]>0x0){const _0x3ae8a7=(0x0,Mustache_1['default'])('‎\x20'+_0x5553f8[_0x345fb4(0x11d)]+'\x0a\x0a'+_0x338644,_0x21be42),_0x645a40=await sendMessage(_0x3954c3,_0x34ae28,_0x21be42,_0x3ae8a7);return _0x645a40;}const _0x27cf62=(0x0,Mustache_1[_0x345fb4(0x145)])('‎\x20'+_0x5553f8[_0x345fb4(0x11d)],_0x21be42),_0x2aa8a1=await sendMessage(_0x3954c3,_0x34ae28,_0x21be42,_0x27cf62);return _0x2aa8a1;},_0xe05d05=async()=>{const _0x2827e2=_0x2528ee,_0x33f69f=[];_0x3b677d[_0x2827e2(0x141)]['forEach']((_0x2e861e,_0x162ae5)=>{_0x33f69f['push']({'buttonId':''+(_0x162ae5+0x1),'buttonText':{'displayText':_0x2e861e['name']},'type':0x1});});if(_0x33f69f[_0x2827e2(0x103)]>0x0){const _0x4690ea={'text':'‎'+_0x5553f8['greetingMessage'],'buttons':_0x33f69f,'headerType':0x1},_0xbf43a8=await _0x3954c3[_0x2827e2(0xe0)](_0x34ae28['number']+'@'+(_0x21be42[_0x2827e2(0xfa)]?_0x2827e2(0xfd):_0x2827e2(0x121)),_0x4690ea);return await(0x0,wbotMessageListener_1['verifyMessage'])(_0xbf43a8,_0x21be42,_0x34ae28),_0xbf43a8;}const _0x4e750c='‎'+_0x5553f8['greetingMessage'],_0x168f34=await sendMessage(_0x3954c3,_0x34ae28,_0x21be42,_0x4e750c);return _0x168f34;},_0x841f4=async()=>{const _0x20dba0=_0x2528ee,_0x40208b=[];_0x3b677d[_0x20dba0(0x141)][_0x20dba0(0x10c)]((_0x201271,_0x40edd7)=>{const _0x5e65cb=_0x20dba0;_0x40208b[_0x5e65cb(0x10f)]({'title':_0x201271[_0x5e65cb(0x105)],'rowId':''+(_0x40edd7+0x1)});});if(_0x40208b[_0x20dba0(0x103)]>0x0){const _0x2d131e=[{'title':_0x20dba0(0xed),'rows':_0x40208b}],_0x248c6f={'text':(0x0,Mustache_1['default'])('‎'+_0x5553f8[_0x20dba0(0x11d)],_0x21be42),'buttonText':'Escolha\x20uma\x20opção','sections':_0x2d131e},_0x553d69=await _0x3954c3['sendMessage'](_0x34ae28[_0x20dba0(0x104)]+'@'+(_0x21be42[_0x20dba0(0xfa)]?_0x20dba0(0xfd):_0x20dba0(0x121)),_0x248c6f);return await(0x0,wbotMessageListener_1[_0x20dba0(0xf6)])(_0x553d69,_0x21be42,_0x34ae28),_0x553d69;}const _0x2bddc1='‎'+_0x5553f8[_0x20dba0(0x11d)],_0x562a7d=await sendMessage(_0x3954c3,_0x34ae28,_0x21be42,_0x2bddc1);return _0x562a7d;};if(_0x5cb54d===_0x2528ee(0xd1))return await _0x32c2a7();if(_0x5cb54d===_0x2528ee(0xdb)&&_0x3b677d[_0x2528ee(0x141)][_0x2528ee(0x103)]>0x4)return await _0x32c2a7();if(_0x5cb54d===_0x2528ee(0xdb)&&_0x3b677d[_0x2528ee(0x141)][_0x2528ee(0x103)]<=0x4)return await _0xe05d05();if(_0x5cb54d===_0x2528ee(0x11a))return await _0x841f4();}},backToMainMenu=async(_0x5a035a,_0x12b242,_0x461b05)=>{const _0x490ef1=a611_0x24dfb0;await(0x0,UpdateTicketService_1['default'])({'ticketData':{'queueId':null,'userId':null},'ticketId':_0x461b05['id'],'companyId':_0x461b05[_0x490ef1(0xf2)]});const {queues:_0x2ea8e0,greetingMessage:_0x3d2b7,greetingMediaAttachment:_0x5db468}=await(0x0,ShowWhatsAppService_1[_0x490ef1(0x145)])(_0x5a035a['id'],_0x461b05[_0x490ef1(0xf2)]),_0x36d612=await CompaniesSettings_1[_0x490ef1(0x145)][_0x490ef1(0x118)]({'where':{'companyId':_0x461b05[_0x490ef1(0xf2)]}}),_0x2e6c6e=async()=>{const _0x5ca7da=_0x490ef1;let _0x58a008='';_0x2ea8e0[_0x5ca7da(0x10c)]((_0x25805f,_0x417f92)=>{const _0x144735=_0x5ca7da;_0x58a008+='*[\x20'+(_0x417f92+0x1)+_0x144735(0x107)+_0x25805f['name']+'\x0a';}),_0x58a008+=_0x5ca7da(0xf7);const _0x178d7f=(0x0,Mustache_1[_0x5ca7da(0x145)])('‎\x20'+_0x3d2b7+'\x0a\x0a'+_0x58a008,_0x461b05);if(_0x5db468!==null){const _0x3a861e=path_1['default'][_0x5ca7da(0xea)](_0x5ca7da(0x11e),_0x5ca7da(0x12a)+_0x461b05[_0x5ca7da(0xf2)],_0x461b05[_0x5ca7da(0xff)][_0x5ca7da(0xf9)]),_0x51e0ce=_0x461b05[_0x5ca7da(0xff)][_0x5ca7da(0xf9)],_0x21299f=await(0x0,SendWhatsAppMedia_1['getMessageOptions'])(_0x51e0ce,_0x3a861e,String(_0x461b05[_0x5ca7da(0xf2)]),_0x178d7f),_0x5bfcb1=await _0x5a035a['sendMessage'](_0x461b05[_0x5ca7da(0x101)][_0x5ca7da(0x104)]+'@'+(_0x461b05['isGroup']?_0x5ca7da(0xfd):_0x5ca7da(0x121)),{..._0x21299f});await(0x0,wbotMessageListener_1[_0x5ca7da(0xf5)])(_0x5bfcb1,_0x461b05,_0x12b242);}else{const _0x45896c=await _0x5a035a['sendMessage'](_0x12b242['number']+'@'+(_0x461b05[_0x5ca7da(0xfa)]?_0x5ca7da(0xfd):_0x5ca7da(0x121)),{'text':_0x178d7f});await(0x0,wbotMessageListener_1[_0x5ca7da(0xf6)])(_0x45896c,_0x461b05,_0x12b242);}const _0x260a86=await(0x0,DeleteDialogChatBotsServices_1[_0x5ca7da(0x145)])(_0x12b242['id']);return _0x260a86;};if(_0x36d612[_0x490ef1(0x125)]===_0x490ef1(0xd1))return _0x2e6c6e();};function a611_0x1d67(_0x4e3747,_0x54aa95){const _0x10c689=a611_0x10c6();return a611_0x1d67=function(_0x1d670d,_0x1c3c3b){_0x1d670d=_0x1d670d-0xcf;let _0x24ae04=_0x10c689[_0x1d670d];return _0x24ae04;},a611_0x1d67(_0x4e3747,_0x54aa95);}function validaCpfCnpj(_0x5afd1f){const _0x234bc7=a611_0x24dfb0;if(_0x5afd1f[_0x234bc7(0x103)]==0xb){var _0x4f340d=_0x5afd1f[_0x234bc7(0x12c)]();_0x4f340d=_0x4f340d['replace'](/\./g,''),_0x4f340d=_0x4f340d['replace']('-',''),_0x4f340d=_0x4f340d[_0x234bc7(0x110)]('');var _0x38ac84=0x0,_0x2e2313=0x0,_0x3ab717=![];for(var _0x486e6e=0x1;_0x4f340d[_0x234bc7(0x103)]>_0x486e6e;_0x486e6e++){_0x4f340d[_0x486e6e-0x1]!=_0x4f340d[_0x486e6e]&&(_0x3ab717=!![]);}if(_0x3ab717==![])return![];for(var _0x486e6e=0x0,_0xb5947=0xa;_0x4f340d[_0x234bc7(0x103)]-0x2>_0x486e6e;_0x486e6e++,_0xb5947--){_0x38ac84+=_0x4f340d[_0x486e6e]*_0xb5947;}_0x38ac84=_0x38ac84*0xa%0xb;_0x38ac84==0xa&&(_0x38ac84=0x0);if(_0x38ac84!=_0x4f340d[0x9])return![];for(var _0x486e6e=0x0,_0xb5947=0xb;_0x4f340d['length']-0x1>_0x486e6e;_0x486e6e++,_0xb5947--){_0x2e2313+=_0x4f340d[_0x486e6e]*_0xb5947;}return _0x2e2313=_0x2e2313*0xa%0xb,_0x2e2313==0xa&&(_0x2e2313=0x0),_0x2e2313!=_0x4f340d[0xa]?![]:!![];}else{if(_0x5afd1f[_0x234bc7(0x103)]==0xe){var _0x557a79=_0x5afd1f['trim']();_0x557a79=_0x557a79[_0x234bc7(0x10e)](/\./g,''),_0x557a79=_0x557a79[_0x234bc7(0x10e)]('-',''),_0x557a79=_0x557a79[_0x234bc7(0x10e)]('/',''),_0x557a79=_0x557a79['split']('');var _0x38ac84=0x0,_0x2e2313=0x0,_0x3ab717=![];for(var _0x486e6e=0x1;_0x557a79[_0x234bc7(0x103)]>_0x486e6e;_0x486e6e++){_0x557a79[_0x486e6e-0x1]!=_0x557a79[_0x486e6e]&&(_0x3ab717=!![]);}if(_0x3ab717==![])return![];for(var _0x486e6e=0x0,_0x204503=0x5,_0x58bad0=0xd;_0x557a79[_0x234bc7(0x103)]-0x2>_0x486e6e;_0x486e6e++,_0x204503--,_0x58bad0--){_0x204503>=0x2?_0x38ac84+=_0x557a79[_0x486e6e]*_0x204503:_0x38ac84+=_0x557a79[_0x486e6e]*_0x58bad0;}_0x38ac84=_0x38ac84%0xb;_0x38ac84<0x2?_0x38ac84=0x0:_0x38ac84=0xb-_0x38ac84;if(_0x38ac84!=_0x557a79[0xc])return![];for(var _0x486e6e=0x0,_0x204503=0x6,_0x58bad0=0xe;_0x557a79[_0x234bc7(0x103)]-0x1>_0x486e6e;_0x486e6e++,_0x204503--,_0x58bad0--){_0x204503>=0x2?_0x2e2313+=_0x557a79[_0x486e6e]*_0x204503:_0x2e2313+=_0x557a79[_0x486e6e]*_0x58bad0;}return _0x2e2313=_0x2e2313%0xb,_0x2e2313<0x2?_0x2e2313=0x0:_0x2e2313=0xb-_0x2e2313,_0x2e2313!=_0x557a79[0xd]?![]:!![];}else return![];}}function timeout(_0x28cb17){return new Promise(_0x15b7eb=>setTimeout(_0x15b7eb,_0x28cb17));}async function sleep(_0x3fe36a){await timeout(_0x3fe36a);}function firstDayOfMonth(_0x50989f){const _0x336753=a611_0x24dfb0,_0x5ab0f9=new Date(),_0x5c14a1=new Date(_0x5ab0f9['getFullYear'](),_0x5ab0f9[_0x336753(0x113)]()-_0x50989f,0x1);return _0x5c14a1;};function lastDayOfMonth(_0xcf8757){const _0x1cfb78=a611_0x24dfb0,_0x199a1e=new Date(),_0x5e40f0=new Date(_0x199a1e[_0x1cfb78(0xe6)](),_0x199a1e['getMonth']()+_0xcf8757,0x0);return _0x5e40f0;};function dataAtualFormatada(_0x53f3d2){const _0x90b407=a611_0x24dfb0;var _0x2af55=_0x53f3d2['getDate']()['toString'](),_0x380e37=_0x2af55[_0x90b407(0x103)]==0x1?'0'+_0x2af55:_0x2af55,_0x32ff28=(_0x53f3d2['getMonth']()+0x1)[_0x90b407(0xd0)](),_0x5be76c=_0x32ff28['length']==0x1?'0'+_0x32ff28:_0x32ff28,_0x1d46b7=_0x53f3d2[_0x90b407(0xe6)]();return _0x380e37+'/'+_0x5be76c+'/'+_0x1d46b7;}function makeid(_0x5c4518){const _0x547522=a611_0x24dfb0;var _0x592b30='',_0x4d37ac=_0x547522(0xee),_0x184bd2=_0x4d37ac[_0x547522(0x103)];for(var _0x3b7917=0x0;_0x3b7917<_0x5c4518;_0x3b7917++){_0x592b30+=_0x4d37ac[_0x547522(0x11c)](Math[_0x547522(0x12e)](Math['random']()*_0x184bd2));}return _0x592b30;}function replaceAll(_0x4dc588,_0x2555be,_0x7d652){const _0x405dbf=a611_0x24dfb0;return _0x4dc588[_0x405dbf(0x10e)](new RegExp(_0x2555be,'g'),_0x7d652);}function formatDate(_0x3bd1bd){const _0xe3d538=a611_0x24dfb0;return _0x3bd1bd[_0xe3d538(0x11b)](0x8,0xa)+'/'+_0x3bd1bd[_0xe3d538(0x11b)](0x5,0x7)+'/'+_0x3bd1bd[_0xe3d538(0x11b)](0x0,0x4);}function sortfunction(_0x47500e,_0x3935e8){const _0x59bff2=a611_0x24dfb0;return _0x47500e['dueDate'][_0x59bff2(0xf4)](_0x3935e8[_0x59bff2(0x10a)]);}async function sendMsgAndCloseTicket(_0x2c180e,_0x5295c4,_0x375e47){const _0x1e6c40=a611_0x24dfb0,_0x1ce269={'ticketData':{'status':_0x1e6c40(0x132),'userId':_0x375e47?.[_0x1e6c40(0x138)]||null,'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'ticketId':_0x375e47['id'],'companyId':_0x375e47[_0x1e6c40(0xf2)]};await sleep(0x7d0),await(0x0,UpdateTicketService_1[_0x1e6c40(0x145)])(_0x1ce269);}const sayChatbot=async(_0x45db53,_0x47d581,_0x33fb4a,_0x38cab8,_0x5d4697)=>{const _0x781378=a611_0x24dfb0,_0x713d98=_0x5d4697?.[_0x781378(0x13a)]?.[_0x781378(0xe8)]?.[_0x781378(0xf3)]||_0x5d4697?.[_0x781378(0x13a)]?.['listResponseMessage']?.[_0x781378(0xda)]['selectedRowId']||(0x0,wbotMessageListener_1[_0x781378(0x133)])(_0x5d4697);if(!_0x45db53&&_0x713d98&&_0x5d4697['key'][_0x781378(0x117)])return;const _0x5ae545=await(0x0,ShowDialogChatBotsServices_1['default'])(_0x38cab8['id']);if(_0x713d98[_0x781378(0xfe)]()===_0x781378(0x106)){const _0x2dfeb6={'ticketData':{'status':_0x781378(0x132),'sendFarewellMessage':!![],'amountUsedBotQueues':0x0},'ticketId':_0x33fb4a['id'],'companyId':_0x33fb4a[_0x781378(0xf2)]};await(0x0,UpdateTicketService_1[_0x781378(0x145)])(_0x2dfeb6);return;}if(_0x713d98==='#'){const _0x37e8ec=await backToMainMenu(_0x47d581,_0x38cab8,_0x33fb4a);return;}if(!_0x5ae545){const _0x1f0e93=await(0x0,ShowQueueService_1[_0x781378(0x145)])(_0x45db53,_0x33fb4a['companyId']),_0x187552=_0x5d4697?.[_0x781378(0x13a)]?.[_0x781378(0xe8)]?.[_0x781378(0xf3)]||_0x5d4697?.[_0x781378(0x13a)]?.[_0x781378(0x136)]?.[_0x781378(0xda)][_0x781378(0x108)]||(0x0,wbotMessageListener_1[_0x781378(0x133)])(_0x5d4697),_0x1bee54=_0x1f0e93[_0x781378(0x120)][+_0x187552-0x1];if(_0x1bee54){if(_0x1bee54[_0x781378(0xe7)]===_0x781378(0x128))try{const _0x23d493={'ticketData':{'integrationId':_0x1bee54[_0x781378(0x127)],'useIntegration':!![],'status':'pending'},'ticketId':_0x33fb4a['id']};await(0x0,UpdateTicketService_1[_0x781378(0x145)])({'ticketData':{..._0x23d493[_0x781378(0x131)]},'ticketId':_0x23d493[_0x781378(0x102)],'companyId':_0x33fb4a['companyId']});}catch(_0x475d5d){await(0x0,exports['deleteAndCreateDialogStage'])(_0x38cab8,_0x1bee54['id'],_0x33fb4a);}else{if(_0x1bee54['queueType']===_0x781378(0x144))try{const _0x4f381f={'ticketData':{'queueId':_0x1bee54[_0x781378(0x129)],'status':_0x781378(0x10b)},'ticketId':_0x33fb4a['id']};await(0x0,UpdateTicketService_1['default'])({'ticketData':{..._0x4f381f['ticketData']},'ticketId':_0x4f381f[_0x781378(0x102)],'companyId':_0x33fb4a[_0x781378(0xf2)]});}catch(_0x52acc7){await(0x0,exports[_0x781378(0xec)])(_0x38cab8,_0x1bee54['id'],_0x33fb4a);}else{if(_0x1bee54[_0x781378(0xe7)]===_0x781378(0x122))try{const _0x25835d={'ticketData':{'queueId':_0x1bee54[_0x781378(0x129)],'userId':_0x1bee54[_0x781378(0xde)],'status':_0x781378(0x10b)},'ticketId':_0x33fb4a['id']};await(0x0,UpdateTicketService_1[_0x781378(0x145)])({'ticketData':{..._0x25835d['ticketData']},'ticketId':_0x25835d['ticketId'],'companyId':_0x33fb4a[_0x781378(0xf2)]});}catch(_0x50813a){await(0x0,exports[_0x781378(0xec)])(_0x38cab8,_0x1bee54['id'],_0x33fb4a);}}}await(0x0,exports['deleteAndCreateDialogStage'])(_0x38cab8,_0x1bee54['id'],_0x33fb4a);let _0x2f3f0c;_0x1bee54?.[_0x781378(0x11d)]&&(_0x2f3f0c=await sendDialog(_0x1bee54,_0x47d581,_0x38cab8,_0x33fb4a));if(_0x1bee54[_0x781378(0xe7)]===_0x781378(0xd4))try{const _0x322b2b=path_1[_0x781378(0x145)][_0x781378(0xea)](__dirname,'..','..','..',_0x781378(0x11e)),_0x2111c4=await(0x0,ShowService_1['default'])(_0x1bee54['optFileId'],_0x33fb4a[_0x781378(0xf2)]),_0x17a212=path_1[_0x781378(0x145)]['resolve'](_0x322b2b,'company'+_0x33fb4a['companyId'],_0x781378(0xf8),String(_0x2111c4['id']));for(const [_0xbfd763,_0x527b93]of _0x2111c4[_0x781378(0x141)]['entries']()){const _0x3ff773={'fieldname':_0x781378(0x112),'originalname':_0x527b93[_0x781378(0x143)],'encoding':_0x781378(0x13d),'mimetype':_0x527b93[_0x781378(0x10d)],'filename':_0x527b93[_0x781378(0x143)],'path':path_1[_0x781378(0x145)][_0x781378(0xea)](_0x17a212,_0x527b93[_0x781378(0x143)])};await(0x0,SendWhatsAppMedia_1[_0x781378(0x145)])({'media':_0x3ff773,'ticket':_0x33fb4a,'body':_0x527b93[_0x781378(0x105)],'isForwarded':![]});};}catch(_0x259018){await(0x0,exports['deleteAndCreateDialogStage'])(_0x38cab8,_0x1bee54['id'],_0x33fb4a);}return _0x1bee54[_0x781378(0xe4)]&&await sendMsgAndCloseTicket(_0x47d581,_0x33fb4a[_0x781378(0x101)],_0x33fb4a),_0x2f3f0c;}}if(_0x5ae545){const _0x495880=isNumeric(_0x713d98)?_0x713d98:0x1,_0x417e15=await(0x0,ShowChatBotServices_1[_0x781378(0x145)])(_0x5ae545[_0x781378(0xdd)]),_0x4fbcdd=_0x417e15[_0x781378(0x141)][+_0x495880-0x1]?_0x417e15['options'][+_0x495880-0x1]:_0x417e15[_0x781378(0x141)][0x0];if(!_0x4fbcdd[_0x781378(0x11d)]){await(0x0,DeleteDialogChatBotsServices_1[_0x781378(0x145)])(_0x38cab8['id']);return;}if(_0x4fbcdd){if(_0x4fbcdd[_0x781378(0xe7)]===_0x781378(0x128))try{const _0x192005={'ticketData':{'integrationId':_0x4fbcdd[_0x781378(0x127)],'useIntegration':!![],'status':'pending'},'ticketId':_0x33fb4a['id']};await(0x0,UpdateTicketService_1[_0x781378(0x145)])({'ticketData':{..._0x192005[_0x781378(0x131)]},'ticketId':_0x192005[_0x781378(0x102)],'companyId':_0x33fb4a[_0x781378(0xf2)]});}catch(_0x15f55d){await(0x0,exports[_0x781378(0xec)])(_0x38cab8,_0x4fbcdd['id'],_0x33fb4a);}else{if(_0x4fbcdd['queueType']===_0x781378(0x144))try{const _0x4c72ea={'ticketData':{'queueId':_0x4fbcdd[_0x781378(0x129)],'status':'pending'},'ticketId':_0x33fb4a['id']};await(0x0,UpdateTicketService_1['default'])({'ticketData':{..._0x4c72ea['ticketData']},'ticketId':_0x4c72ea[_0x781378(0x102)],'companyId':_0x33fb4a[_0x781378(0xf2)]});}catch(_0x48d2db){await(0x0,exports[_0x781378(0xec)])(_0x38cab8,_0x4fbcdd['id'],_0x33fb4a);}else{if(_0x4fbcdd[_0x781378(0xe7)]===_0x781378(0x122))try{const _0x576504={'ticketData':{'queueId':_0x4fbcdd[_0x781378(0x129)],'userId':_0x4fbcdd['optUserId'],'status':'pending'},'ticketId':_0x33fb4a['id']};await(0x0,UpdateTicketService_1[_0x781378(0x145)])({'ticketData':{..._0x576504[_0x781378(0x131)]},'ticketId':_0x576504[_0x781378(0x102)],'companyId':_0x33fb4a['companyId']});}catch(_0x545994){await(0x0,exports['deleteAndCreateDialogStage'])(_0x38cab8,_0x4fbcdd['id'],_0x33fb4a);}}}await(0x0,exports['deleteAndCreateDialogStage'])(_0x38cab8,_0x4fbcdd['id'],_0x33fb4a);if(_0x4fbcdd[_0x781378(0xe7)]===_0x781378(0xd4))try{const _0x334783=path_1[_0x781378(0x145)]['resolve'](__dirname,'..','..','..','public'),_0x30a893=await(0x0,ShowService_1[_0x781378(0x145)])(_0x4fbcdd[_0x781378(0x140)],_0x33fb4a[_0x781378(0xf2)]),_0x4e9f1d=path_1[_0x781378(0x145)]['resolve'](_0x334783,'company'+_0x33fb4a[_0x781378(0xf2)],_0x781378(0xf8),String(_0x30a893['id']));for(const [_0x29fb86,_0x185ba9]of _0x30a893[_0x781378(0x141)][_0x781378(0xdf)]()){const _0x3ea93f={'fieldname':'medias','originalname':_0x185ba9[_0x781378(0x143)],'encoding':_0x781378(0x13d),'mimetype':_0x185ba9[_0x781378(0x10d)],'filename':_0x185ba9[_0x781378(0x143)],'path':path_1['default']['resolve'](_0x4e9f1d,_0x185ba9[_0x781378(0x143)])};await(0x0,SendWhatsAppMedia_1[_0x781378(0x145)])({'media':_0x3ea93f,'ticket':_0x33fb4a,'body':_0x185ba9[_0x781378(0x105)],'isForwarded':![]});};}catch(_0x1418a2){await(0x0,exports[_0x781378(0xec)])(_0x38cab8,_0x4fbcdd['id'],_0x33fb4a);}_0x4fbcdd[_0x781378(0xe4)]&&await sendMsgAndCloseTicket(_0x47d581,_0x33fb4a[_0x781378(0x101)],_0x33fb4a);await(0x0,exports['deleteAndCreateDialogStage'])(_0x38cab8,_0x4fbcdd['id'],_0x33fb4a);const _0x9bf398=await sendDialog(_0x4fbcdd,_0x47d581,_0x38cab8,_0x33fb4a);return _0x9bf398;}}};exports['sayChatbot']=sayChatbot;