'use strict';function a535_0x377b(){const _0xcbebe9=['8mKsfpV','floor','axios','entries','../../helpers/Mustache','application/pdf','154wGZqTK','906204IdHWyH','substring','selectedButtonId','chatbots','chatBotType','51380cmCdYn','test','pending','path','list','findOne','getDate','medias','4473cadril','company','singleSelectReply','1420696XZCKfC','../DialogChatBotsServices/DeleteDialogChatBotsServices','s.whatsapp.net','button','fileList','ticketData','text','deleteAndCreateDialogStage','listResponseMessage','chatbotId','finalizar','getMonth','../DialogChatBotsServices/CreateDialogChatBotsServices','sayChatbot','charAt','number','toString','replace','defineProperty','Menu','../QueueService/ShowQueueService','companyId','../ChatBotServices/ShowChatBotByChatbotIdServices','./wbotMessageListener','queueType','__importDefault','Não\x20consegui\x20enviar\x20o\x20PDF,\x20tente\x20novamente!','Escolha\x20uma\x20opção','g.us','__esModule','localeCompare','isGroup','../ChatBotServices/ShowChatBotServices','attendent','416658fJSoTm','\x0a*#*\x20Voltar\x20para\x20o\x20menu\x20principal','update','sendMessage','closed','fromMe','optQueueId','buttonsResponseMessage','dueDate','key','length','‎Não\x20consegui\x20enviar\x20o\x20PDF,\x20tente\x20novamente!','optFileId','selectedRowId','../../models/Setting','push','Estamos\x20finalizando\x20esta\x20conversa!\x20Caso\x20precise\x20entre\x20em\x20contato\x20conosco!','split','public','../../services/FileServices/ShowService','2290QDMkXc','forEach','public/temp/','options','../WhatsappService/ShowWhatsAppService','default','file','trim','readFileSync','ticketId','value','../TicketServices/UpdateTicketService','greetingMessage','verifyMessage','952860oUQCfD','toLocaleLowerCase','getBodyMessage','name','random','getFullYear','1902qWmKxg','resolve','mediaType','message','./SendWhatsAppMedia'];a535_0x377b=function(){return _0xcbebe9;};return a535_0x377b();}const a535_0x56cfcb=a535_0x10fa;(function(_0x3ee0ad,_0x8cc8d1){const _0x2e0bf7=a535_0x10fa,_0x479a71=_0x3ee0ad();while(!![]){try{const _0x234cad=parseInt(_0x2e0bf7(0x9d))/0x1*(-parseInt(_0x2e0bf7(0xa9))/0x2)+-parseInt(_0x2e0bf7(0xd6))/0x3+parseInt(_0x2e0bf7(0xa4))/0x4+parseInt(_0x2e0bf7(0x92))/0x5+-parseInt(_0x2e0bf7(0x98))/0x6*(-parseInt(_0x2e0bf7(0xa3))/0x7)+parseInt(_0x2e0bf7(0xb4))/0x8+parseInt(_0x2e0bf7(0xb1))/0x9*(-parseInt(_0x2e0bf7(0x84))/0xa);if(_0x234cad===_0x8cc8d1)break;else _0x479a71['push'](_0x479a71['shift']());}catch(_0x40bc36){_0x479a71['push'](_0x479a71['shift']());}}}(a535_0x377b,0x23069));var __importDefault=this&&this[a535_0x56cfcb(0xcd)]||function(_0x1cbb53){const _0x81939e=a535_0x56cfcb;return _0x1cbb53&&_0x1cbb53[_0x81939e(0xd1)]?_0x1cbb53:{'default':_0x1cbb53};};Object[a535_0x56cfcb(0xc6)](exports,a535_0x56cfcb(0xd1),{'value':!![]}),exports[a535_0x56cfcb(0xc1)]=exports[a535_0x56cfcb(0xbb)]=void 0x0;const path_1=__importDefault(require(a535_0x56cfcb(0xac))),wbotMessageListener_1=require(a535_0x56cfcb(0xcb)),ShowDialogChatBotsServices_1=__importDefault(require('../DialogChatBotsServices/ShowDialogChatBotsServices')),ShowQueueService_1=__importDefault(require(a535_0x56cfcb(0xc8))),ShowChatBotServices_1=__importDefault(require(a535_0x56cfcb(0xd4))),DeleteDialogChatBotsServices_1=__importDefault(require(a535_0x56cfcb(0xb5))),ShowChatBotByChatbotIdServices_1=__importDefault(require(a535_0x56cfcb(0xca))),CreateDialogChatBotsServices_1=__importDefault(require(a535_0x56cfcb(0xc0))),ShowWhatsAppService_1=__importDefault(require(a535_0x56cfcb(0x88))),Mustache_1=__importDefault(require(a535_0x56cfcb(0xa1))),UpdateTicketService_1=__importDefault(require(a535_0x56cfcb(0x8f))),User_1=__importDefault(require('../../models/User')),Setting_1=__importDefault(require(a535_0x56cfcb(0x7e))),ShowService_1=__importDefault(require(a535_0x56cfcb(0x83))),SendWhatsAppMedia_1=__importDefault(require(a535_0x56cfcb(0x9c))),fs=require('fs');var axios=require(a535_0x56cfcb(0x9f));const isNumeric=_0x59bcae=>/^-?\d+$/[a535_0x56cfcb(0xaa)](_0x59bcae),deleteAndCreateDialogStage=async(_0x5bd4e1,_0x3af315,_0x155e4c)=>{const _0x94fd0a=a535_0x56cfcb;try{await(0x0,DeleteDialogChatBotsServices_1[_0x94fd0a(0x89)])(_0x5bd4e1['id']);const _0x9a5a07=await(0x0,ShowChatBotByChatbotIdServices_1[_0x94fd0a(0x89)])(_0x3af315);return!_0x9a5a07&&await _0x155e4c[_0x94fd0a(0xd8)]({'isBot':![]}),await(0x0,CreateDialogChatBotsServices_1[_0x94fd0a(0x89)])({'awaiting':0x1,'contactId':_0x5bd4e1['id'],'chatbotId':_0x3af315,'queueId':_0x9a5a07['queueId']});}catch(_0x598506){await _0x155e4c['update']({'isBot':![]});}};exports[a535_0x56cfcb(0xbb)]=deleteAndCreateDialogStage;function a535_0x10fa(_0x1df2b9,_0x5f454b){const _0x377bc1=a535_0x377b();return a535_0x10fa=function(_0x10fa2c,_0x58f3eb){_0x10fa2c=_0x10fa2c-0x77;let _0x215256=_0x377bc1[_0x10fa2c];return _0x215256;},a535_0x10fa(_0x1df2b9,_0x5f454b);}const sendMessage=async(_0x3e84e4,_0x1e6182,_0x5bf7bb,_0x437414)=>{const _0xbb0b30=a535_0x56cfcb,_0x15d9f5=await _0x3e84e4[_0xbb0b30(0xd9)](_0x1e6182[_0xbb0b30(0xc3)]+'@'+(_0x5bf7bb['isGroup']?'g.us':'s.whatsapp.net'),{'text':(0x0,Mustache_1[_0xbb0b30(0x89)])(_0x437414,_0x5bf7bb)});(0x0,wbotMessageListener_1['verifyMessage'])(_0x15d9f5,_0x5bf7bb,_0x1e6182);},sendMessageLink=async(_0x4907a7,_0x4e9a34,_0x184138,_0x57c73c,_0x3b8e15)=>{const _0x10f540=a535_0x56cfcb;let _0x25dc24;try{_0x25dc24=await _0x4907a7[_0x10f540(0xd9)](_0x4e9a34[_0x10f540(0xc3)]+'@'+(_0x184138['isGroup']?'g.us':'s.whatsapp.net'),{'document':_0x57c73c?{'url':_0x57c73c}:fs[_0x10f540(0x8c)](_0x10f540(0x86)+_0x3b8e15+'-'+makeid(0xa)),'fileName':_0x3b8e15,'mimetype':_0x10f540(0xa2)});}catch(_0x48bdf6){_0x25dc24=await _0x4907a7[_0x10f540(0xd9)](_0x4e9a34['number']+'@'+(_0x184138['isGroup']?'g.us':_0x10f540(0xb6)),{'text':(0x0,Mustache_1[_0x10f540(0x89)])(_0x10f540(0x7b),_0x184138)});}(0x0,wbotMessageListener_1[_0x10f540(0x91)])(_0x25dc24,_0x184138,_0x4e9a34);},sendMessageImage=async(_0x296ef4,_0x4f15fe,_0xf7b1f8,_0x57e074,_0x2fb3fa)=>{const _0x33d82d=a535_0x56cfcb;let _0x4b49f8;try{_0x4b49f8=await _0x296ef4[_0x33d82d(0xd9)](_0x4f15fe[_0x33d82d(0xc3)]+'@'+(_0xf7b1f8[_0x33d82d(0xd3)]?_0x33d82d(0xd0):_0x33d82d(0xb6)),{'image':_0x57e074?{'url':_0x57e074}:fs[_0x33d82d(0x8c)](_0x33d82d(0x86)+_0x2fb3fa+'-'+makeid(0xa)),'fileName':_0x2fb3fa,'caption':_0x2fb3fa,'mimetype':'image/jpeg'});}catch(_0x425a48){_0x4b49f8=await _0x296ef4[_0x33d82d(0xd9)](_0x4f15fe[_0x33d82d(0xc3)]+'@'+(_0xf7b1f8['isGroup']?_0x33d82d(0xd0):_0x33d82d(0xb6)),{'text':(0x0,Mustache_1[_0x33d82d(0x89)])(_0x33d82d(0xce),_0xf7b1f8)});}(0x0,wbotMessageListener_1[_0x33d82d(0x91)])(_0x4b49f8,_0xf7b1f8,_0x4f15fe);},sendDialog=async(_0x1bd368,_0x373b86,_0x2dc89c,_0x29fb48)=>{const _0x4c3f2c=a535_0x56cfcb,_0x5f0a89=await(0x0,ShowChatBotServices_1['default'])(_0x1bd368['id']);if(_0x5f0a89[_0x4c3f2c(0x87)]){const _0x1e079c=await Setting_1[_0x4c3f2c(0x89)]['findOne']({'where':{'key':_0x4c3f2c(0xa8),'companyId':_0x29fb48[_0x4c3f2c(0xc9)]}}),_0x399a3c=_0x1e079c?.[_0x4c3f2c(0x8e)]||_0x4c3f2c(0xba),_0x9ec9ce=async()=>{const _0x4dc74e=_0x4c3f2c;let _0xc7b356='';_0x5f0a89['options'][_0x4dc74e(0x85)]((_0x1bfb88,_0x1303ab)=>{_0xc7b356+='*'+(_0x1303ab+0x1)+'*\x20-\x20'+_0x1bfb88['name']+'\x0a';});const _0x6c7fa=_0xc7b356[_0x4dc74e(0x7a)]>0x0?_0xc7b356+_0x4dc74e(0xd7):_0xc7b356;if(_0xc7b356[_0x4dc74e(0x7a)]>0x0){const _0x1f92aa='‎'+_0x1bd368['greetingMessage']+'\x0a\x0a'+_0x6c7fa,_0x193e49=await sendMessage(_0x373b86,_0x2dc89c,_0x29fb48,_0x1f92aa);return _0x193e49;}const _0x2bc4ee='‎'+_0x1bd368[_0x4dc74e(0x90)],_0x460d49=await sendMessage(_0x373b86,_0x2dc89c,_0x29fb48,_0x2bc4ee);return _0x460d49;},_0x2b6ba1=async()=>{const _0x636a27=_0x4c3f2c,_0x5e0bb1=[];_0x5f0a89[_0x636a27(0x87)]['forEach']((_0x1f2819,_0x4e05c7)=>{const _0x3632d7=_0x636a27;_0x5e0bb1[_0x3632d7(0x7f)]({'buttonId':''+(_0x4e05c7+0x1),'buttonText':{'displayText':_0x1f2819[_0x3632d7(0x95)]},'type':0x1});});if(_0x5e0bb1[_0x636a27(0x7a)]>0x0){const _0xa38802={'text':'‎'+_0x1bd368[_0x636a27(0x90)],'buttons':_0x5e0bb1,'headerType':0x1},_0x34ddbd=await _0x373b86[_0x636a27(0xd9)](_0x2dc89c['number']+'@'+(_0x29fb48[_0x636a27(0xd3)]?_0x636a27(0xd0):_0x636a27(0xb6)),_0xa38802);return await(0x0,wbotMessageListener_1[_0x636a27(0x91)])(_0x34ddbd,_0x29fb48,_0x2dc89c),_0x34ddbd;}const _0x188f29='‎'+_0x1bd368['greetingMessage'],_0x36f8eb=await sendMessage(_0x373b86,_0x2dc89c,_0x29fb48,_0x188f29);return _0x36f8eb;},_0x518296=async()=>{const _0x46bb28=_0x4c3f2c,_0x23df92=[];_0x5f0a89[_0x46bb28(0x87)][_0x46bb28(0x85)]((_0x1631b8,_0x337206)=>{const _0x5117b0=_0x46bb28;_0x23df92['push']({'title':_0x1631b8[_0x5117b0(0x95)],'rowId':''+(_0x337206+0x1)});});if(_0x23df92[_0x46bb28(0x7a)]>0x0){const _0x11e713=[{'title':_0x46bb28(0xc7),'rows':_0x23df92}],_0x1bf7c7={'text':(0x0,Mustache_1[_0x46bb28(0x89)])('‎'+_0x1bd368['greetingMessage'],_0x29fb48),'buttonText':'Escolha\x20uma\x20opção','sections':_0x11e713},_0x4c0fd9=await _0x373b86[_0x46bb28(0xd9)](_0x2dc89c[_0x46bb28(0xc3)]+'@'+(_0x29fb48[_0x46bb28(0xd3)]?_0x46bb28(0xd0):'s.whatsapp.net'),_0x1bf7c7);return await(0x0,wbotMessageListener_1[_0x46bb28(0x91)])(_0x4c0fd9,_0x29fb48,_0x2dc89c),_0x4c0fd9;}const _0x1dcba9='‎'+_0x1bd368[_0x46bb28(0x90)],_0x424035=await sendMessage(_0x373b86,_0x2dc89c,_0x29fb48,_0x1dcba9);return _0x424035;};if(_0x399a3c==='text')return await _0x9ec9ce();if(_0x399a3c==='button'&&_0x5f0a89[_0x4c3f2c(0x87)][_0x4c3f2c(0x7a)]>0x4)return await _0x9ec9ce();if(_0x399a3c==='button'&&_0x5f0a89[_0x4c3f2c(0x87)]['length']<=0x4)return await _0x2b6ba1();if(_0x399a3c===_0x4c3f2c(0xad))return await _0x518296();}},backToMainMenu=async(_0x381256,_0x492453,_0xa60e5e)=>{const _0x4b9285=a535_0x56cfcb;await(0x0,UpdateTicketService_1[_0x4b9285(0x89)])({'ticketData':{'queueId':null,'userId':null},'ticketId':_0xa60e5e['id'],'companyId':_0xa60e5e['companyId']});const {queues:_0x55e0e7,greetingMessage:_0x4ca1ed}=await(0x0,ShowWhatsAppService_1[_0x4b9285(0x89)])(_0x381256['id'],_0xa60e5e[_0x4b9285(0xc9)]),_0x55bb63=await Setting_1[_0x4b9285(0x89)][_0x4b9285(0xae)]({'where':{'key':'chatBotType'}}),_0x3db6a0=async()=>{const _0x1e6ef5=_0x4b9285;let _0x426b97='';_0x55e0e7[_0x1e6ef5(0x85)]((_0x261ce3,_0x3cb32e)=>{_0x426b97+='*'+(_0x3cb32e+0x1)+'*\x20-\x20'+_0x261ce3['name']+'\x0a';});const _0x356fd0=(0x0,Mustache_1['default'])('‎'+_0x4ca1ed+'\x0a\x0a'+_0x426b97,_0xa60e5e);await sendMessage(_0x381256,_0x492453,_0xa60e5e,_0x356fd0);const _0x10102d=await(0x0,DeleteDialogChatBotsServices_1[_0x1e6ef5(0x89)])(_0x492453['id']);return _0x10102d;},_0x42a5d5=async()=>{const _0x8abbf7=_0x4b9285,_0x4b1b39=[];_0x55e0e7[_0x8abbf7(0x85)]((_0x16df72,_0x45b67f)=>{const _0x3a87d9=_0x8abbf7;_0x4b1b39[_0x3a87d9(0x7f)]({'buttonId':''+(_0x45b67f+0x1),'buttonText':{'displayText':_0x16df72[_0x3a87d9(0x95)]},'type':0x1});});const _0x24273d={'text':(0x0,Mustache_1[_0x8abbf7(0x89)])('‎'+_0x4ca1ed,_0xa60e5e),'buttons':_0x4b1b39,'headerType':0x1},_0x4d8b01=await _0x381256[_0x8abbf7(0xd9)](_0x492453[_0x8abbf7(0xc3)]+'@'+(_0xa60e5e[_0x8abbf7(0xd3)]?_0x8abbf7(0xd0):'s.whatsapp.net'),_0x24273d);await(0x0,wbotMessageListener_1[_0x8abbf7(0x91)])(_0x4d8b01,_0xa60e5e,_0x492453);const _0x5407be=await(0x0,DeleteDialogChatBotsServices_1[_0x8abbf7(0x89)])(_0x492453['id']);return _0x5407be;},_0x206056=async()=>{const _0x38cb6f=_0x4b9285,_0x52be3d=[];_0x55e0e7[_0x38cb6f(0x85)]((_0x33b0e0,_0x4916d0)=>{const _0x3cd392=_0x38cb6f;_0x52be3d[_0x3cd392(0x7f)]({'title':_0x33b0e0['name'],'rowId':''+(_0x4916d0+0x1)});});const _0x3fc8fb=[{'title':_0x38cb6f(0xc7),'rows':_0x52be3d}],_0x1e4b33={'text':(0x0,Mustache_1[_0x38cb6f(0x89)])('‎'+_0x4ca1ed,_0xa60e5e),'buttonText':_0x38cb6f(0xcf),'sections':_0x3fc8fb},_0x57e5ec=await _0x381256['sendMessage'](_0x492453[_0x38cb6f(0xc3)]+'@'+(_0xa60e5e[_0x38cb6f(0xd3)]?_0x38cb6f(0xd0):_0x38cb6f(0xb6)),_0x1e4b33);await(0x0,wbotMessageListener_1[_0x38cb6f(0x91)])(_0x57e5ec,_0xa60e5e,_0x492453);const _0x4550c2=await(0x0,DeleteDialogChatBotsServices_1[_0x38cb6f(0x89)])(_0x492453['id']);return _0x4550c2;};if(_0x55bb63[_0x4b9285(0x8e)]==='text')return _0x3db6a0();if(_0x55bb63['value']===_0x4b9285(0xb7)&&_0x55e0e7[_0x4b9285(0x7a)]>0x4)return _0x3db6a0();if(_0x55bb63[_0x4b9285(0x8e)]===_0x4b9285(0xb7)&&_0x55e0e7[_0x4b9285(0x7a)]<=0x4)return _0x42a5d5();if(_0x55bb63[_0x4b9285(0x8e)]===_0x4b9285(0xad))return _0x206056();};function validaCpfCnpj(_0x24119e){const _0x3391c8=a535_0x56cfcb;if(_0x24119e[_0x3391c8(0x7a)]==0xb){var _0x101fd9=_0x24119e[_0x3391c8(0x8b)]();_0x101fd9=_0x101fd9[_0x3391c8(0xc5)](/\./g,''),_0x101fd9=_0x101fd9['replace']('-',''),_0x101fd9=_0x101fd9['split']('');var _0x5d7d4b=0x0,_0x31ae55=0x0,_0x286244=![];for(var _0x2af240=0x1;_0x101fd9[_0x3391c8(0x7a)]>_0x2af240;_0x2af240++){_0x101fd9[_0x2af240-0x1]!=_0x101fd9[_0x2af240]&&(_0x286244=!![]);}if(_0x286244==![])return![];for(var _0x2af240=0x0,_0x5dc097=0xa;_0x101fd9[_0x3391c8(0x7a)]-0x2>_0x2af240;_0x2af240++,_0x5dc097--){_0x5d7d4b+=_0x101fd9[_0x2af240]*_0x5dc097;}_0x5d7d4b=_0x5d7d4b*0xa%0xb;_0x5d7d4b==0xa&&(_0x5d7d4b=0x0);if(_0x5d7d4b!=_0x101fd9[0x9])return![];for(var _0x2af240=0x0,_0x5dc097=0xb;_0x101fd9[_0x3391c8(0x7a)]-0x1>_0x2af240;_0x2af240++,_0x5dc097--){_0x31ae55+=_0x101fd9[_0x2af240]*_0x5dc097;}return _0x31ae55=_0x31ae55*0xa%0xb,_0x31ae55==0xa&&(_0x31ae55=0x0),_0x31ae55!=_0x101fd9[0xa]?![]:!![];}else{if(_0x24119e[_0x3391c8(0x7a)]==0xe){var _0x5c6c49=_0x24119e[_0x3391c8(0x8b)]();_0x5c6c49=_0x5c6c49[_0x3391c8(0xc5)](/\./g,''),_0x5c6c49=_0x5c6c49['replace']('-',''),_0x5c6c49=_0x5c6c49[_0x3391c8(0xc5)]('/',''),_0x5c6c49=_0x5c6c49[_0x3391c8(0x81)]('');var _0x5d7d4b=0x0,_0x31ae55=0x0,_0x286244=![];for(var _0x2af240=0x1;_0x5c6c49['length']>_0x2af240;_0x2af240++){_0x5c6c49[_0x2af240-0x1]!=_0x5c6c49[_0x2af240]&&(_0x286244=!![]);}if(_0x286244==![])return![];for(var _0x2af240=0x0,_0x860d91=0x5,_0x4c39d6=0xd;_0x5c6c49[_0x3391c8(0x7a)]-0x2>_0x2af240;_0x2af240++,_0x860d91--,_0x4c39d6--){_0x860d91>=0x2?_0x5d7d4b+=_0x5c6c49[_0x2af240]*_0x860d91:_0x5d7d4b+=_0x5c6c49[_0x2af240]*_0x4c39d6;}_0x5d7d4b=_0x5d7d4b%0xb;_0x5d7d4b<0x2?_0x5d7d4b=0x0:_0x5d7d4b=0xb-_0x5d7d4b;if(_0x5d7d4b!=_0x5c6c49[0xc])return![];for(var _0x2af240=0x0,_0x860d91=0x6,_0x4c39d6=0xe;_0x5c6c49['length']-0x1>_0x2af240;_0x2af240++,_0x860d91--,_0x4c39d6--){_0x860d91>=0x2?_0x31ae55+=_0x5c6c49[_0x2af240]*_0x860d91:_0x31ae55+=_0x5c6c49[_0x2af240]*_0x4c39d6;}return _0x31ae55=_0x31ae55%0xb,_0x31ae55<0x2?_0x31ae55=0x0:_0x31ae55=0xb-_0x31ae55,_0x31ae55!=_0x5c6c49[0xd]?![]:!![];}else return![];}}function timeout(_0xd897b7){return new Promise(_0x2c0ee5=>setTimeout(_0x2c0ee5,_0xd897b7));}async function sleep(_0x326b8f){await timeout(_0x326b8f);}function firstDayOfMonth(_0x492b58){const _0x792314=a535_0x56cfcb,_0x1c2996=new Date(),_0x3e6be4=new Date(_0x1c2996[_0x792314(0x97)](),_0x1c2996[_0x792314(0xbf)]()-_0x492b58,0x1);return _0x3e6be4;};function lastDayOfMonth(_0x3cf51f){const _0x3e9a65=a535_0x56cfcb,_0x3ebd0a=new Date(),_0x595ebc=new Date(_0x3ebd0a[_0x3e9a65(0x97)](),_0x3ebd0a[_0x3e9a65(0xbf)]()+_0x3cf51f,0x0);return _0x595ebc;};function dataAtualFormatada(_0x5d4d62){const _0x8047cf=a535_0x56cfcb;var _0x1152f1=_0x5d4d62[_0x8047cf(0xaf)]()['toString'](),_0x16b886=_0x1152f1['length']==0x1?'0'+_0x1152f1:_0x1152f1,_0x4257a6=(_0x5d4d62[_0x8047cf(0xbf)]()+0x1)[_0x8047cf(0xc4)](),_0x210824=_0x4257a6[_0x8047cf(0x7a)]==0x1?'0'+_0x4257a6:_0x4257a6,_0x463f45=_0x5d4d62[_0x8047cf(0x97)]();return _0x16b886+'/'+_0x210824+'/'+_0x463f45;}function makeid(_0x4c9a02){const _0x529b5c=a535_0x56cfcb;var _0x276b7e='',_0x12e134='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',_0x158688=_0x12e134[_0x529b5c(0x7a)];for(var _0x52c0e2=0x0;_0x52c0e2<_0x4c9a02;_0x52c0e2++){_0x276b7e+=_0x12e134[_0x529b5c(0xc2)](Math[_0x529b5c(0x9e)](Math[_0x529b5c(0x96)]()*_0x158688));}return _0x276b7e;}function replaceAll(_0x5c0843,_0x290e27,_0x2328e5){const _0x531e4a=a535_0x56cfcb;return _0x5c0843[_0x531e4a(0xc5)](new RegExp(_0x290e27,'g'),_0x2328e5);}function formatDate(_0xdc3ca1){const _0x2c1923=a535_0x56cfcb;return _0xdc3ca1[_0x2c1923(0xa5)](0x8,0xa)+'/'+_0xdc3ca1[_0x2c1923(0xa5)](0x5,0x7)+'/'+_0xdc3ca1[_0x2c1923(0xa5)](0x0,0x4);}function sortfunction(_0x5d0996,_0x1e818a){const _0x30129e=a535_0x56cfcb;return _0x5d0996[_0x30129e(0x78)][_0x30129e(0xd2)](_0x1e818a[_0x30129e(0x78)]);}async function sendMsgAndCloseTicket(_0x6a8c27,_0x5b598e,_0x586e2e){const _0x339a21=a535_0x56cfcb,_0x549c74=_0x339a21(0x80);await sleep(0x7d0),await sendMessage(_0x6a8c27,_0x5b598e,_0x586e2e,_0x549c74);const _0x3ff088={'ticketData':{'status':_0x339a21(0xda),'userId':0x1,'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'ticketId':_0x586e2e['id'],'companyId':_0x586e2e['companyId'],'ratingId':undefined};await sleep(0x7d0),await(0x0,UpdateTicketService_1[_0x339a21(0x89)])(_0x3ff088);}const sayChatbot=async(_0xb95870,_0x1f0ead,_0x1e29d8,_0x3a33f1,_0x1715a3)=>{const _0x533ccf=a535_0x56cfcb,_0xec2545=_0x1715a3?.['message']?.['buttonsResponseMessage']?.[_0x533ccf(0xa6)]||_0x1715a3?.[_0x533ccf(0x9b)]?.[_0x533ccf(0xbc)]?.[_0x533ccf(0xb3)][_0x533ccf(0x7d)]||(0x0,wbotMessageListener_1[_0x533ccf(0x94)])(_0x1715a3);if(!_0xb95870&&_0xec2545&&_0x1715a3[_0x533ccf(0x79)][_0x533ccf(0xdb)])return;const _0x2fbaaf=await(0x0,ShowDialogChatBotsServices_1[_0x533ccf(0x89)])(_0x3a33f1['id']),_0x353883=await(0x0,ShowQueueService_1[_0x533ccf(0x89)])(_0xb95870,_0x1e29d8['companyId']);let _0xf46a1f;if(_0xec2545[_0x533ccf(0x93)]()===_0x533ccf(0xbe)){const _0x11278a={'ticketData':{'status':_0x533ccf(0xda),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'ticketId':_0x1e29d8['id'],'companyId':_0x1e29d8[_0x533ccf(0xc9)]};await(0x0,UpdateTicketService_1[_0x533ccf(0x89)])(_0x11278a);}if(_0xec2545==='#'){const _0x1784cb=await backToMainMenu(_0x1f0ead,_0x3a33f1,_0x1e29d8);return _0x1784cb;}if(!_0x2fbaaf){const _0x361003=await(0x0,ShowQueueService_1[_0x533ccf(0x89)])(_0xb95870,_0x1e29d8[_0x533ccf(0xc9)]),_0xaf3451=_0x1715a3?.['message']?.[_0x533ccf(0x77)]?.['selectedButtonId']||_0x1715a3?.['message']?.['listResponseMessage']?.[_0x533ccf(0xb3)]['selectedRowId']||(0x0,wbotMessageListener_1[_0x533ccf(0x94)])(_0x1715a3),_0x31fc27=_0x361003[_0x533ccf(0xa7)][+_0xaf3451-0x1];if(_0x31fc27){if(_0x31fc27[_0x533ccf(0xcc)]==='queue')try{const _0x1f88e0={'ticketData':{'queueId':_0x31fc27['optQueueId'],'status':_0x533ccf(0xab)},'ticketId':_0x1e29d8['id']};await(0x0,UpdateTicketService_1[_0x533ccf(0x89)])({'ticketData':{..._0x1f88e0['ticketData']},'ticketId':_0x1f88e0[_0x533ccf(0x8d)],'companyId':_0x1e29d8[_0x533ccf(0xc9)]});}catch(_0x30c1de){await(0x0,exports['deleteAndCreateDialogStage'])(_0x3a33f1,_0x31fc27['id'],_0x1e29d8);}if(_0x31fc27[_0x533ccf(0xcc)]===_0x533ccf(0xd5))try{const _0x397cda={'ticketData':{'queueId':_0x31fc27[_0x533ccf(0xdc)],'userId':_0x31fc27['optUserId'],'status':_0x533ccf(0xab)},'ticketId':_0x1e29d8['id']};await(0x0,UpdateTicketService_1[_0x533ccf(0x89)])({'ticketData':{..._0x397cda['ticketData']},'ticketId':_0x397cda[_0x533ccf(0x8d)],'companyId':_0x1e29d8[_0x533ccf(0xc9)]});}catch(_0x4b37f5){await(0x0,exports[_0x533ccf(0xbb)])(_0x3a33f1,_0x31fc27['id'],_0x1e29d8);}await(0x0,exports[_0x533ccf(0xbb)])(_0x3a33f1,_0x31fc27['id'],_0x1e29d8);let _0x797140;_0x31fc27?.[_0x533ccf(0x90)]&&(_0x797140=await sendDialog(_0x31fc27,_0x1f0ead,_0x3a33f1,_0x1e29d8));if(_0x31fc27['queueType']===_0x533ccf(0x8a))try{const _0x8e6d88=path_1[_0x533ccf(0x89)]['resolve'](__dirname,'..','..','..',_0x533ccf(0x82)),_0x23cb2c=await(0x0,ShowService_1['default'])(_0x31fc27[_0x533ccf(0x7c)],_0x1e29d8[_0x533ccf(0xc9)]),_0x3feabe=path_1[_0x533ccf(0x89)][_0x533ccf(0x99)](_0x8e6d88,_0x533ccf(0xb2)+_0x1e29d8[_0x533ccf(0xc9)],_0x533ccf(0xb8),String(_0x23cb2c['id']));for(const [_0x2a1f51,_0x1dd70c]of _0x23cb2c[_0x533ccf(0x87)][_0x533ccf(0xa0)]()){const _0x1d32fe={'fieldname':_0x533ccf(0xb0),'originalname':_0x1dd70c[_0x533ccf(0xac)],'encoding':'7bit','mimetype':_0x1dd70c[_0x533ccf(0x9a)],'filename':_0x1dd70c['path'],'path':path_1[_0x533ccf(0x89)][_0x533ccf(0x99)](_0x3feabe,_0x1dd70c[_0x533ccf(0xac)])};await(0x0,SendWhatsAppMedia_1[_0x533ccf(0x89)])({'media':_0x1d32fe,'ticket':_0x1e29d8,'body':_0x1dd70c[_0x533ccf(0x95)]});};}catch(_0x3e08fe){await(0x0,exports[_0x533ccf(0xbb)])(_0x3a33f1,_0x31fc27['id'],_0x1e29d8);}return _0x797140;}}if(_0x2fbaaf){const _0x38665f=isNumeric(_0xec2545)?_0xec2545:0x1,_0x42cb5f=await(0x0,ShowChatBotServices_1[_0x533ccf(0x89)])(_0x2fbaaf[_0x533ccf(0xbd)]),_0x407a60=_0x42cb5f['options'][+_0x38665f-0x1]?_0x42cb5f['options'][+_0x38665f-0x1]:_0x42cb5f[_0x533ccf(0x87)][0x0];if(!_0x407a60[_0x533ccf(0x90)]){await(0x0,DeleteDialogChatBotsServices_1[_0x533ccf(0x89)])(_0x3a33f1['id']);return;}if(_0x407a60){if(_0x407a60['isAgent']){const _0xef5ac0=await User_1['default'][_0x533ccf(0xae)]({'where':{'name':_0x407a60['name']}}),_0x17d03b={'ticketData':{'userId':_0xef5ac0['id'],'status':'open'},'ticketId':_0x1e29d8['id']};await(0x0,UpdateTicketService_1[_0x533ccf(0x89)])({'ticketData':{..._0x17d03b[_0x533ccf(0xb9)]},'ticketId':_0x17d03b['ticketId'],'companyId':_0x1e29d8[_0x533ccf(0xc9)]});}await(0x0,exports['deleteAndCreateDialogStage'])(_0x3a33f1,_0x407a60['id'],_0x1e29d8);const _0x175e75=await sendDialog(_0x407a60,_0x1f0ead,_0x3a33f1,_0x1e29d8);return _0x175e75;}}};exports[a535_0x56cfcb(0xc1)]=sayChatbot;