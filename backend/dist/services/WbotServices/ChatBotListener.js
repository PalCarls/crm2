'use strict';const a599_0x10b581=a599_0x4d6e;function a599_0x4d6e(_0x583ebc,_0x2bc244){const _0x22f7bf=a599_0x22f7();return a599_0x4d6e=function(_0x4d6e42,_0x49e86e){_0x4d6e42=_0x4d6e42-0x6f;let _0x449e06=_0x22f7bf[_0x4d6e42];return _0x449e06;},a599_0x4d6e(_0x583ebc,_0x2bc244);}(function(_0xf35ecc,_0x1f5857){const _0x689ba6=a599_0x4d6e,_0x1b09f0=_0xf35ecc();while(!![]){try{const _0x9c5721=parseInt(_0x689ba6(0x87))/0x1+parseInt(_0x689ba6(0xc2))/0x2*(-parseInt(_0x689ba6(0xb4))/0x3)+-parseInt(_0x689ba6(0xaf))/0x4+-parseInt(_0x689ba6(0x9b))/0x5*(-parseInt(_0x689ba6(0x8f))/0x6)+-parseInt(_0x689ba6(0x84))/0x7*(parseInt(_0x689ba6(0x95))/0x8)+-parseInt(_0x689ba6(0xb9))/0x9*(parseInt(_0x689ba6(0x83))/0xa)+parseInt(_0x689ba6(0x8d))/0xb;if(_0x9c5721===_0x1f5857)break;else _0x1b09f0['push'](_0x1b09f0['shift']());}catch(_0x49f3d4){_0x1b09f0['push'](_0x1b09f0['shift']());}}}(a599_0x22f7,0x20af4));var __createBinding=this&&this[a599_0x10b581(0xdb)]||(Object[a599_0x10b581(0xc8)]?function(_0x7dad74,_0x473502,_0xe2ed2c,_0x5044d7){const _0x182202=a599_0x10b581;if(_0x5044d7===undefined)_0x5044d7=_0xe2ed2c;var _0x1f8ee9=Object[_0x182202(0x9e)](_0x473502,_0xe2ed2c);(!_0x1f8ee9||(_0x182202(0xae)in _0x1f8ee9?!_0x473502[_0x182202(0x9a)]:_0x1f8ee9['writable']||_0x1f8ee9['configurable']))&&(_0x1f8ee9={'enumerable':!![],'get':function(){return _0x473502[_0xe2ed2c];}}),Object[_0x182202(0x7c)](_0x7dad74,_0x5044d7,_0x1f8ee9);}:function(_0x3be4dd,_0x1f7250,_0x2dad3c,_0x105f45){if(_0x105f45===undefined)_0x105f45=_0x2dad3c;_0x3be4dd[_0x105f45]=_0x1f7250[_0x2dad3c];}),__setModuleDefault=this&&this[a599_0x10b581(0x92)]||(Object[a599_0x10b581(0xc8)]?function(_0x45a61d,_0xe52d99){const _0x3d7f9f=a599_0x10b581;Object['defineProperty'](_0x45a61d,_0x3d7f9f(0xcb),{'enumerable':!![],'value':_0xe52d99});}:function(_0x4333c2,_0x2cb922){_0x4333c2['default']=_0x2cb922;}),__importStar=this&&this[a599_0x10b581(0xd4)]||function(_0x59e1d6){const _0x109109=a599_0x10b581;if(_0x59e1d6&&_0x59e1d6['__esModule'])return _0x59e1d6;var _0x443ade={};if(_0x59e1d6!=null){for(var _0x45fcef in _0x59e1d6)if(_0x45fcef!==_0x109109(0xcb)&&Object[_0x109109(0xac)][_0x109109(0x86)][_0x109109(0x96)](_0x59e1d6,_0x45fcef))__createBinding(_0x443ade,_0x59e1d6,_0x45fcef);}return __setModuleDefault(_0x443ade,_0x59e1d6),_0x443ade;},__importDefault=this&&this[a599_0x10b581(0x73)]||function(_0x3b9c78){const _0x59218a=a599_0x10b581;return _0x3b9c78&&_0x3b9c78[_0x59218a(0x9a)]?_0x3b9c78:{'default':_0x3b9c78};};Object[a599_0x10b581(0x7c)](exports,a599_0x10b581(0x9a),{'value':!![]}),exports[a599_0x10b581(0x77)]=exports[a599_0x10b581(0xc0)]=void 0x0;const path_1=__importDefault(require('path')),wbotMessageListener_1=require('./wbotMessageListener'),ShowDialogChatBotsServices_1=__importDefault(require(a599_0x10b581(0xca))),ShowQueueService_1=__importDefault(require(a599_0x10b581(0xc4))),ShowChatBotServices_1=__importDefault(require(a599_0x10b581(0xc1))),DeleteDialogChatBotsServices_1=__importDefault(require(a599_0x10b581(0xd2))),ShowChatBotByChatbotIdServices_1=__importDefault(require(a599_0x10b581(0x85))),CreateDialogChatBotsServices_1=__importDefault(require('../DialogChatBotsServices/CreateDialogChatBotsServices')),ShowWhatsAppService_1=__importDefault(require(a599_0x10b581(0x82))),Mustache_1=__importDefault(require(a599_0x10b581(0x75))),UpdateTicketService_1=__importDefault(require('../TicketServices/UpdateTicketService')),ShowService_1=__importDefault(require(a599_0x10b581(0xba))),SendWhatsAppMedia_1=__importStar(require('./SendWhatsAppMedia')),CompaniesSettings_1=__importDefault(require('../../models/CompaniesSettings')),fs=require('fs');var axios=require('axios');const isNumeric=_0x8abebc=>/^-?\d+$/[a599_0x10b581(0xc7)](_0x8abebc),deleteAndCreateDialogStage=async(_0x4a8f43,_0x356752,_0x35a4ef)=>{const _0x510c02=a599_0x10b581;try{await(0x0,DeleteDialogChatBotsServices_1['default'])(_0x4a8f43['id']);const _0x49f587=await(0x0,ShowChatBotByChatbotIdServices_1[_0x510c02(0xcb)])(_0x356752);return!_0x49f587&&await _0x35a4ef[_0x510c02(0xa7)]({'isBot':![]}),await(0x0,CreateDialogChatBotsServices_1[_0x510c02(0xcb)])({'awaiting':0x1,'contactId':_0x4a8f43['id'],'chatbotId':_0x356752,'queueId':_0x49f587['queueId']});}catch(_0x30fdb4){await _0x35a4ef[_0x510c02(0xa7)]({'isBot':![]});}};exports[a599_0x10b581(0xc0)]=deleteAndCreateDialogStage;const sendMessage=async(_0x39ff58,_0x5c4a1e,_0x3312b3,_0x4eb2c7)=>{const _0xb97828=a599_0x10b581,_0x53708e=await _0x39ff58[_0xb97828(0xd1)](_0x5c4a1e[_0xb97828(0xa9)]+'@'+(_0x3312b3['isGroup']?_0xb97828(0xdc):_0xb97828(0xbc)),{'text':(0x0,Mustache_1[_0xb97828(0xcb)])(_0x4eb2c7,_0x3312b3)});(0x0,wbotMessageListener_1[_0xb97828(0xc3)])(_0x53708e,_0x3312b3,_0x5c4a1e);},sendMessageLink=async(_0xd2cbd4,_0x43c351,_0x5793c7,_0x3c8034,_0x4d0d89)=>{const _0x7fe89f=a599_0x10b581;let _0x1b2b14;try{_0x1b2b14=await _0xd2cbd4[_0x7fe89f(0xd1)](_0x43c351[_0x7fe89f(0xa9)]+'@'+(_0x5793c7[_0x7fe89f(0xbb)]?_0x7fe89f(0xdc):'s.whatsapp.net'),{'document':_0x3c8034?{'url':_0x3c8034}:fs[_0x7fe89f(0xd9)]('public/temp/'+_0x4d0d89+'-'+makeid(0xa)),'fileName':_0x4d0d89,'mimetype':_0x7fe89f(0xab)});}catch(_0x137f77){_0x1b2b14=await _0xd2cbd4[_0x7fe89f(0xd1)](_0x43c351[_0x7fe89f(0xa9)]+'@'+(_0x5793c7[_0x7fe89f(0xbb)]?_0x7fe89f(0xdc):_0x7fe89f(0xbc)),{'text':(0x0,Mustache_1[_0x7fe89f(0xcb)])(_0x7fe89f(0x8e),_0x5793c7)});}(0x0,wbotMessageListener_1[_0x7fe89f(0xc3)])(_0x1b2b14,_0x5793c7,_0x43c351);},sendMessageImage=async(_0xcb1614,_0x2e2185,_0x180780,_0x441bbe,_0x3c6ff8)=>{const _0x41c918=a599_0x10b581;let _0x356efb;try{_0x356efb=await _0xcb1614['sendMessage'](_0x2e2185[_0x41c918(0xa9)]+'@'+(_0x180780['isGroup']?_0x41c918(0xdc):_0x41c918(0xbc)),{'image':_0x441bbe?{'url':_0x441bbe}:fs['readFileSync'](_0x41c918(0xa5)+_0x3c6ff8+'-'+makeid(0xa)),'fileName':_0x3c6ff8,'caption':_0x3c6ff8,'mimetype':_0x41c918(0xbf)});}catch(_0x25703d){_0x356efb=await _0xcb1614[_0x41c918(0xd1)](_0x2e2185['number']+'@'+(_0x180780[_0x41c918(0xbb)]?'g.us':'s.whatsapp.net'),{'text':(0x0,Mustache_1['default'])(_0x41c918(0xad),_0x180780)});}(0x0,wbotMessageListener_1[_0x41c918(0xc3)])(_0x356efb,_0x180780,_0x2e2185);},sendDialog=async(_0x7b8ca6,_0x48b234,_0x5a201d,_0xc8f69e)=>{const _0x44d68d=a599_0x10b581,_0x537014=await(0x0,ShowChatBotServices_1[_0x44d68d(0xcb)])(_0x7b8ca6['id']);if(_0x537014['options']){let _0x158757=_0xc8f69e[_0x44d68d(0x7a)];const _0x2e0f1b=await CompaniesSettings_1[_0x44d68d(0xcb)]['findOne']({'where':{'companyId':_0x158757}}),_0x466371=_0x2e0f1b?.['chatBotType']||_0x44d68d(0xdf),_0x285aad=async()=>{const _0x42028d=_0x44d68d;let _0x14cc24='';_0x537014[_0x42028d(0x74)][_0x42028d(0x99)]((_0xf7b2e5,_0xbd5a1a)=>{const _0x2aac44=_0x42028d;_0x14cc24+=_0x2aac44(0xb2)+(_0xbd5a1a+0x1)+_0x2aac44(0xd3)+_0xf7b2e5['name']+'\x0a';});const _0x4cb8ee=_0x14cc24[_0x42028d(0xe0)]>0x0?_0x14cc24+'\x0a*[\x20#\x20]*\x20Voltar\x20para\x20o\x20menu\x20principal\x0a*[\x20Sair\x20]*\x20Encerrar\x20atendimento':_0x14cc24+'\x0a*[\x20Sair\x20]*\x20Encerrar\x20atendimento';if(_0x14cc24['length']>0x0){const _0x5a449e='‎'+_0x7b8ca6[_0x42028d(0xde)]+'\x0a\x0a'+_0x4cb8ee,_0x35d7a3=await sendMessage(_0x48b234,_0x5a201d,_0xc8f69e,_0x5a449e);return _0x35d7a3;}const _0x1a2bc7='‎'+_0x7b8ca6[_0x42028d(0xde)],_0x391854=await sendMessage(_0x48b234,_0x5a201d,_0xc8f69e,_0x1a2bc7);return _0x391854;},_0x19ece9=async()=>{const _0x49f2f6=_0x44d68d,_0x1bb278=[];_0x537014[_0x49f2f6(0x74)][_0x49f2f6(0x99)]((_0x1f8265,_0x3894ab)=>{const _0x4d070a=_0x49f2f6;_0x1bb278[_0x4d070a(0xd7)]({'buttonId':''+(_0x3894ab+0x1),'buttonText':{'displayText':_0x1f8265[_0x4d070a(0xa1)]},'type':0x1});});if(_0x1bb278[_0x49f2f6(0xe0)]>0x0){const _0x20aaa3={'text':'‎'+_0x7b8ca6[_0x49f2f6(0xde)],'buttons':_0x1bb278,'headerType':0x1},_0x5b6f97=await _0x48b234[_0x49f2f6(0xd1)](_0x5a201d[_0x49f2f6(0xa9)]+'@'+(_0xc8f69e[_0x49f2f6(0xbb)]?_0x49f2f6(0xdc):_0x49f2f6(0xbc)),_0x20aaa3);return await(0x0,wbotMessageListener_1['verifyMessage'])(_0x5b6f97,_0xc8f69e,_0x5a201d),_0x5b6f97;}const _0x54d253='‎'+_0x7b8ca6['greetingMessage'],_0x586650=await sendMessage(_0x48b234,_0x5a201d,_0xc8f69e,_0x54d253);return _0x586650;},_0x253494=async()=>{const _0x1e17db=_0x44d68d,_0x2a7f9e=[];_0x537014['options']['forEach']((_0x56ce90,_0x539578)=>{const _0xf549d0=a599_0x4d6e;_0x2a7f9e[_0xf549d0(0xd7)]({'title':_0x56ce90[_0xf549d0(0xa1)],'rowId':''+(_0x539578+0x1)});});if(_0x2a7f9e[_0x1e17db(0xe0)]>0x0){const _0x4f8c26=[{'title':'Menu','rows':_0x2a7f9e}],_0x3491d5={'text':(0x0,Mustache_1[_0x1e17db(0xcb)])('‎'+_0x7b8ca6[_0x1e17db(0xde)],_0xc8f69e),'buttonText':_0x1e17db(0xb6),'sections':_0x4f8c26},_0x49d84e=await _0x48b234[_0x1e17db(0xd1)](_0x5a201d[_0x1e17db(0xa9)]+'@'+(_0xc8f69e[_0x1e17db(0xbb)]?_0x1e17db(0xdc):_0x1e17db(0xbc)),_0x3491d5);return await(0x0,wbotMessageListener_1[_0x1e17db(0xc3)])(_0x49d84e,_0xc8f69e,_0x5a201d),_0x49d84e;}const _0xd4fe54='‎'+_0x7b8ca6['greetingMessage'],_0x275e30=await sendMessage(_0x48b234,_0x5a201d,_0xc8f69e,_0xd4fe54);return _0x275e30;};if(_0x466371===_0x44d68d(0xdf))return await _0x285aad();if(_0x466371===_0x44d68d(0xa4)&&_0x537014[_0x44d68d(0x74)][_0x44d68d(0xe0)]>0x4)return await _0x285aad();if(_0x466371===_0x44d68d(0xa4)&&_0x537014[_0x44d68d(0x74)][_0x44d68d(0xe0)]<=0x4)return await _0x19ece9();if(_0x466371===_0x44d68d(0x7b))return await _0x253494();}},backToMainMenu=async(_0x4bdc82,_0x586b67,_0x48b362)=>{const _0x6a435d=a599_0x10b581;await(0x0,UpdateTicketService_1[_0x6a435d(0xcb)])({'ticketData':{'queueId':null,'userId':null},'ticketId':_0x48b362['id'],'companyId':_0x48b362[_0x6a435d(0x7a)]});const {queues:_0x29cbbd,greetingMessage:_0x17a767,greetingMediaAttachment:_0x1fe01a}=await(0x0,ShowWhatsAppService_1[_0x6a435d(0xcb)])(_0x4bdc82['id'],_0x48b362[_0x6a435d(0x7a)]),_0x55b1c5=await CompaniesSettings_1[_0x6a435d(0xcb)]['findOne']({'where':{'companyId':_0x48b362[_0x6a435d(0x7a)]}}),_0x2d5a01=async()=>{const _0x50f8bf=_0x6a435d;let _0x14b024='';_0x29cbbd[_0x50f8bf(0x99)]((_0x36b94d,_0x1f2a41)=>{const _0x2c380c=_0x50f8bf;_0x14b024+='*[\x20'+(_0x1f2a41+0x1)+'\x20]*\x20-\x20'+_0x36b94d[_0x2c380c(0xa1)]+'\x0a';}),_0x14b024+=_0x50f8bf(0xb0);const _0x1b4406=(0x0,Mustache_1[_0x50f8bf(0xcb)])('‎'+_0x17a767+'\x0a\x0a'+_0x14b024,_0x48b362);if(_0x1fe01a!==null){const _0x2964b1=path_1[_0x50f8bf(0xcb)][_0x50f8bf(0x98)]('public',_0x50f8bf(0xd8)+_0x48b362[_0x50f8bf(0x7a)],_0x48b362[_0x50f8bf(0xce)][_0x50f8bf(0xd6)]),_0x34161c=_0x48b362['whatsapp'][_0x50f8bf(0xd6)],_0x27d759=await(0x0,SendWhatsAppMedia_1[_0x50f8bf(0xd0)])(_0x34161c,_0x2964b1,String(_0x48b362[_0x50f8bf(0x7a)]),_0x1b4406),_0x248dbc=await _0x4bdc82[_0x50f8bf(0xd1)](_0x48b362[_0x50f8bf(0x90)][_0x50f8bf(0xa9)]+'@'+(_0x48b362[_0x50f8bf(0xbb)]?_0x50f8bf(0xdc):'s.whatsapp.net'),{..._0x27d759});await(0x0,wbotMessageListener_1[_0x50f8bf(0x94)])(_0x248dbc,_0x48b362,_0x586b67);}else await _0x4bdc82['sendMessage'](_0x586b67[_0x50f8bf(0xa9)]+'@'+(_0x48b362[_0x50f8bf(0xbb)]?_0x50f8bf(0xdc):_0x50f8bf(0xbc)),{'text':_0x1b4406});const _0x580579=await(0x0,DeleteDialogChatBotsServices_1['default'])(_0x586b67['id']);return _0x580579;};if(_0x55b1c5[_0x6a435d(0x70)]===_0x6a435d(0xdf))return _0x2d5a01();};function validaCpfCnpj(_0x3a384b){const _0x3cdad7=a599_0x10b581;if(_0x3a384b[_0x3cdad7(0xe0)]==0xb){var _0x21c498=_0x3a384b[_0x3cdad7(0x91)]();_0x21c498=_0x21c498[_0x3cdad7(0xaa)](/\./g,''),_0x21c498=_0x21c498[_0x3cdad7(0xaa)]('-',''),_0x21c498=_0x21c498['split']('');var _0x1e5391=0x0,_0x355501=0x0,_0x795232=![];for(var _0xab4759=0x1;_0x21c498[_0x3cdad7(0xe0)]>_0xab4759;_0xab4759++){_0x21c498[_0xab4759-0x1]!=_0x21c498[_0xab4759]&&(_0x795232=!![]);}if(_0x795232==![])return![];for(var _0xab4759=0x0,_0x11cf5c=0xa;_0x21c498[_0x3cdad7(0xe0)]-0x2>_0xab4759;_0xab4759++,_0x11cf5c--){_0x1e5391+=_0x21c498[_0xab4759]*_0x11cf5c;}_0x1e5391=_0x1e5391*0xa%0xb;_0x1e5391==0xa&&(_0x1e5391=0x0);if(_0x1e5391!=_0x21c498[0x9])return![];for(var _0xab4759=0x0,_0x11cf5c=0xb;_0x21c498[_0x3cdad7(0xe0)]-0x1>_0xab4759;_0xab4759++,_0x11cf5c--){_0x355501+=_0x21c498[_0xab4759]*_0x11cf5c;}return _0x355501=_0x355501*0xa%0xb,_0x355501==0xa&&(_0x355501=0x0),_0x355501!=_0x21c498[0xa]?![]:!![];}else{if(_0x3a384b['length']==0xe){var _0x35863a=_0x3a384b[_0x3cdad7(0x91)]();_0x35863a=_0x35863a[_0x3cdad7(0xaa)](/\./g,''),_0x35863a=_0x35863a['replace']('-',''),_0x35863a=_0x35863a[_0x3cdad7(0xaa)]('/',''),_0x35863a=_0x35863a[_0x3cdad7(0x7d)]('');var _0x1e5391=0x0,_0x355501=0x0,_0x795232=![];for(var _0xab4759=0x1;_0x35863a[_0x3cdad7(0xe0)]>_0xab4759;_0xab4759++){_0x35863a[_0xab4759-0x1]!=_0x35863a[_0xab4759]&&(_0x795232=!![]);}if(_0x795232==![])return![];for(var _0xab4759=0x0,_0x2f9d2a=0x5,_0x12a739=0xd;_0x35863a[_0x3cdad7(0xe0)]-0x2>_0xab4759;_0xab4759++,_0x2f9d2a--,_0x12a739--){_0x2f9d2a>=0x2?_0x1e5391+=_0x35863a[_0xab4759]*_0x2f9d2a:_0x1e5391+=_0x35863a[_0xab4759]*_0x12a739;}_0x1e5391=_0x1e5391%0xb;_0x1e5391<0x2?_0x1e5391=0x0:_0x1e5391=0xb-_0x1e5391;if(_0x1e5391!=_0x35863a[0xc])return![];for(var _0xab4759=0x0,_0x2f9d2a=0x6,_0x12a739=0xe;_0x35863a[_0x3cdad7(0xe0)]-0x1>_0xab4759;_0xab4759++,_0x2f9d2a--,_0x12a739--){_0x2f9d2a>=0x2?_0x355501+=_0x35863a[_0xab4759]*_0x2f9d2a:_0x355501+=_0x35863a[_0xab4759]*_0x12a739;}return _0x355501=_0x355501%0xb,_0x355501<0x2?_0x355501=0x0:_0x355501=0xb-_0x355501,_0x355501!=_0x35863a[0xd]?![]:!![];}else return![];}}function timeout(_0x59f566){return new Promise(_0xcfee33=>setTimeout(_0xcfee33,_0x59f566));}async function sleep(_0x539bc6){await timeout(_0x539bc6);}function firstDayOfMonth(_0x241b81){const _0x32a475=a599_0x10b581,_0x249863=new Date(),_0x442c99=new Date(_0x249863[_0x32a475(0x9f)](),_0x249863['getMonth']()-_0x241b81,0x1);return _0x442c99;}function a599_0x22f7(){const _0x4ca1ee=['localeCompare','__importDefault','options','../../helpers/Mustache','message','sayChatbot','getDate','closeTicket','companyId','list','defineProperty','split','selectedRowId','closed','fileList','pending','../WhatsappService/ShowWhatsAppService','151390CzqIrL','16604diBmIr','../ChatBotServices/ShowChatBotByChatbotIdServices','hasOwnProperty','86204LvEjTN','optUserId','attendent','file','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','chatbotId','7015525IDwoVa','‎Não\x20consegui\x20enviar\x20o\x20PDF,\x20tente\x20novamente!','12vhgSAq','contact','trim','__setModuleDefault','path','verifyMediaMessage','768uPgUOT','call','7bit','resolve','forEach','__esModule','354055UVUyMO','ticketId','userId','getOwnPropertyDescriptor','getFullYear','listResponseMessage','name','dueDate','singleSelectReply','button','public/temp/','toLocaleLowerCase','update','mediaType','number','replace','application/pdf','prototype','Não\x20consegui\x20enviar\x20o\x20PDF,\x20tente\x20novamente!','get','546648jkmHzg','\x0a*[\x20Sair\x20]*\x20-\x20Encerrar\x20Atendimento','entries','*[\x20','charAt','15KiFcDM','public','Escolha\x20uma\x20opção','buttonsResponseMessage','chatbots','126VcFbSv','../../services/FileServices/ShowService','isGroup','s.whatsapp.net','ticketData','medias','image/jpeg','deleteAndCreateDialogStage','../ChatBotServices/ShowChatBotServices','62162gTVmeN','verifyMessage','../QueueService/ShowQueueService','getMonth','random','test','create','toString','../DialogChatBotsServices/ShowDialogChatBotsServices','default','queue','optFileId','whatsapp','selectedButtonId','getMessageOptions','sendMessage','../DialogChatBotsServices/DeleteDialogChatBotsServices','\x20]*\x20-\x20','__importStar','substring','greetingMediaAttachment','push','company','readFileSync','optQueueId','__createBinding','g.us','integration','greetingMessage','text','length','fromMe','chatBotType','queueType'];a599_0x22f7=function(){return _0x4ca1ee;};return a599_0x22f7();};function lastDayOfMonth(_0x3cfda8){const _0x506dc9=a599_0x10b581,_0x4def90=new Date(),_0x59ee94=new Date(_0x4def90[_0x506dc9(0x9f)](),_0x4def90[_0x506dc9(0xc5)]()+_0x3cfda8,0x0);return _0x59ee94;};function dataAtualFormatada(_0x2272fa){const _0x5769c6=a599_0x10b581;var _0x124756=_0x2272fa[_0x5769c6(0x78)]()[_0x5769c6(0xc9)](),_0x28eeff=_0x124756[_0x5769c6(0xe0)]==0x1?'0'+_0x124756:_0x124756,_0x2fd886=(_0x2272fa[_0x5769c6(0xc5)]()+0x1)[_0x5769c6(0xc9)](),_0x43c0e7=_0x2fd886[_0x5769c6(0xe0)]==0x1?'0'+_0x2fd886:_0x2fd886,_0x130f9f=_0x2272fa[_0x5769c6(0x9f)]();return _0x28eeff+'/'+_0x43c0e7+'/'+_0x130f9f;}function makeid(_0x2925e7){const _0x566e79=a599_0x10b581;var _0x1687cd='',_0x508016=_0x566e79(0x8b),_0x294bb8=_0x508016[_0x566e79(0xe0)];for(var _0x14ab82=0x0;_0x14ab82<_0x2925e7;_0x14ab82++){_0x1687cd+=_0x508016[_0x566e79(0xb3)](Math['floor'](Math[_0x566e79(0xc6)]()*_0x294bb8));}return _0x1687cd;}function replaceAll(_0x228c27,_0x3fcc00,_0x4e2ee4){const _0x56dba6=a599_0x10b581;return _0x228c27[_0x56dba6(0xaa)](new RegExp(_0x3fcc00,'g'),_0x4e2ee4);}function formatDate(_0xaf65d4){const _0x403083=a599_0x10b581;return _0xaf65d4[_0x403083(0xd5)](0x8,0xa)+'/'+_0xaf65d4[_0x403083(0xd5)](0x5,0x7)+'/'+_0xaf65d4[_0x403083(0xd5)](0x0,0x4);}function sortfunction(_0x309835,_0x3804c2){const _0x3888e7=a599_0x10b581;return _0x309835[_0x3888e7(0xa2)][_0x3888e7(0x72)](_0x3804c2[_0x3888e7(0xa2)]);}async function sendMsgAndCloseTicket(_0x31534f,_0x535ecf,_0x4e1b42){const _0x10a8ae=a599_0x10b581,_0xbf3317={'ticketData':{'status':_0x10a8ae(0x7f),'userId':_0x4e1b42?.[_0x10a8ae(0x9d)]||null,'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'ticketId':_0x4e1b42['id'],'companyId':_0x4e1b42[_0x10a8ae(0x7a)]};await sleep(0x7d0),await(0x0,UpdateTicketService_1[_0x10a8ae(0xcb)])(_0xbf3317);}const sayChatbot=async(_0x5d67d6,_0x43bb37,_0x476e00,_0x142aa1,_0x2defe1)=>{const _0x12b9ab=a599_0x10b581,_0x5f194c=_0x2defe1?.[_0x12b9ab(0x76)]?.[_0x12b9ab(0xb7)]?.[_0x12b9ab(0xcf)]||_0x2defe1?.[_0x12b9ab(0x76)]?.[_0x12b9ab(0xa0)]?.[_0x12b9ab(0xa3)]['selectedRowId']||(0x0,wbotMessageListener_1['getBodyMessage'])(_0x2defe1);if(!_0x5d67d6&&_0x5f194c&&_0x2defe1['key'][_0x12b9ab(0x6f)])return;const _0x2c7d6e=await(0x0,ShowDialogChatBotsServices_1[_0x12b9ab(0xcb)])(_0x142aa1['id']);if(_0x5f194c[_0x12b9ab(0xa6)]()==='sair'){const _0x134511={'ticketData':{'status':_0x12b9ab(0x7f),'sendFarewellMessage':!![],'amountUsedBotQueues':0x0},'ticketId':_0x476e00['id'],'companyId':_0x476e00[_0x12b9ab(0x7a)]};await(0x0,UpdateTicketService_1[_0x12b9ab(0xcb)])(_0x134511);return;}if(_0x5f194c==='#'){const _0x5f03ba=await backToMainMenu(_0x43bb37,_0x142aa1,_0x476e00);return;}if(!_0x2c7d6e){const _0x3edcf4=await(0x0,ShowQueueService_1[_0x12b9ab(0xcb)])(_0x5d67d6,_0x476e00['companyId']),_0x1ce71a=_0x2defe1?.[_0x12b9ab(0x76)]?.[_0x12b9ab(0xb7)]?.[_0x12b9ab(0xcf)]||_0x2defe1?.[_0x12b9ab(0x76)]?.['listResponseMessage']?.['singleSelectReply'][_0x12b9ab(0x7e)]||(0x0,wbotMessageListener_1['getBodyMessage'])(_0x2defe1),_0xf10900=_0x3edcf4[_0x12b9ab(0xb8)][+_0x1ce71a-0x1];if(_0xf10900){if(_0xf10900['queueType']==='integration')try{const _0x58ddf1={'ticketData':{'integrationId':_0xf10900['optIntegrationId'],'useIntegration':!![],'status':_0x12b9ab(0x81)},'ticketId':_0x476e00['id']};await(0x0,UpdateTicketService_1[_0x12b9ab(0xcb)])({'ticketData':{..._0x58ddf1['ticketData']},'ticketId':_0x58ddf1[_0x12b9ab(0x9c)],'companyId':_0x476e00[_0x12b9ab(0x7a)]});}catch(_0x59b65f){await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0xf10900['id'],_0x476e00);}else{if(_0xf10900[_0x12b9ab(0x71)]===_0x12b9ab(0xcc))try{const _0x56fdf8={'ticketData':{'queueId':_0xf10900[_0x12b9ab(0xda)],'status':_0x12b9ab(0x81)},'ticketId':_0x476e00['id']};await(0x0,UpdateTicketService_1[_0x12b9ab(0xcb)])({'ticketData':{..._0x56fdf8[_0x12b9ab(0xbd)]},'ticketId':_0x56fdf8['ticketId'],'companyId':_0x476e00[_0x12b9ab(0x7a)]});}catch(_0x5255ef){await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0xf10900['id'],_0x476e00);}else{if(_0xf10900[_0x12b9ab(0x71)]===_0x12b9ab(0x89))try{const _0x5acc77={'ticketData':{'queueId':_0xf10900[_0x12b9ab(0xda)],'userId':_0xf10900[_0x12b9ab(0x88)],'status':_0x12b9ab(0x81)},'ticketId':_0x476e00['id']};await(0x0,UpdateTicketService_1[_0x12b9ab(0xcb)])({'ticketData':{..._0x5acc77['ticketData']},'ticketId':_0x5acc77[_0x12b9ab(0x9c)],'companyId':_0x476e00[_0x12b9ab(0x7a)]});}catch(_0x28b2d5){await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0xf10900['id'],_0x476e00);}}}await(0x0,exports['deleteAndCreateDialogStage'])(_0x142aa1,_0xf10900['id'],_0x476e00);let _0x34d391;_0xf10900?.[_0x12b9ab(0xde)]&&(_0x34d391=await sendDialog(_0xf10900,_0x43bb37,_0x142aa1,_0x476e00));if(_0xf10900[_0x12b9ab(0x71)]===_0x12b9ab(0x8a))try{const _0x301be5=path_1[_0x12b9ab(0xcb)][_0x12b9ab(0x98)](__dirname,'..','..','..',_0x12b9ab(0xb5)),_0x3c13a5=await(0x0,ShowService_1['default'])(_0xf10900[_0x12b9ab(0xcd)],_0x476e00[_0x12b9ab(0x7a)]),_0x26563b=path_1[_0x12b9ab(0xcb)][_0x12b9ab(0x98)](_0x301be5,_0x12b9ab(0xd8)+_0x476e00['companyId'],_0x12b9ab(0x80),String(_0x3c13a5['id']));for(const [_0x38eafa,_0x3c1711]of _0x3c13a5[_0x12b9ab(0x74)][_0x12b9ab(0xb1)]()){const _0x24f13c={'fieldname':_0x12b9ab(0xbe),'originalname':_0x3c1711[_0x12b9ab(0x93)],'encoding':_0x12b9ab(0x97),'mimetype':_0x3c1711['mediaType'],'filename':_0x3c1711[_0x12b9ab(0x93)],'path':path_1['default'][_0x12b9ab(0x98)](_0x26563b,_0x3c1711[_0x12b9ab(0x93)])};await(0x0,SendWhatsAppMedia_1[_0x12b9ab(0xcb)])({'media':_0x24f13c,'ticket':_0x476e00,'body':_0x3c1711[_0x12b9ab(0xa1)],'isForwarded':![]});};}catch(_0x40df86){await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0xf10900['id'],_0x476e00);}return _0xf10900['closeTicket']&&await sendMsgAndCloseTicket(_0x43bb37,_0x476e00['contact'],_0x476e00),_0x34d391;}}if(_0x2c7d6e){const _0x4bb73a=isNumeric(_0x5f194c)?_0x5f194c:0x1,_0x27bcae=await(0x0,ShowChatBotServices_1[_0x12b9ab(0xcb)])(_0x2c7d6e[_0x12b9ab(0x8c)]),_0x30ec45=_0x27bcae[_0x12b9ab(0x74)][+_0x4bb73a-0x1]?_0x27bcae['options'][+_0x4bb73a-0x1]:_0x27bcae[_0x12b9ab(0x74)][0x0];if(!_0x30ec45[_0x12b9ab(0xde)]){await(0x0,DeleteDialogChatBotsServices_1[_0x12b9ab(0xcb)])(_0x142aa1['id']);return;}if(_0x30ec45){if(_0x30ec45[_0x12b9ab(0x71)]===_0x12b9ab(0xdd))try{const _0x3134e8={'ticketData':{'integrationId':_0x30ec45['optIntegrationId'],'useIntegration':!![],'status':_0x12b9ab(0x81)},'ticketId':_0x476e00['id']};await(0x0,UpdateTicketService_1['default'])({'ticketData':{..._0x3134e8[_0x12b9ab(0xbd)]},'ticketId':_0x3134e8['ticketId'],'companyId':_0x476e00[_0x12b9ab(0x7a)]});}catch(_0x170a1a){await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0x30ec45['id'],_0x476e00);}else{if(_0x30ec45[_0x12b9ab(0x71)]==='queue')try{const _0x1da3e4={'ticketData':{'queueId':_0x30ec45[_0x12b9ab(0xda)],'status':_0x12b9ab(0x81)},'ticketId':_0x476e00['id']};await(0x0,UpdateTicketService_1[_0x12b9ab(0xcb)])({'ticketData':{..._0x1da3e4['ticketData']},'ticketId':_0x1da3e4[_0x12b9ab(0x9c)],'companyId':_0x476e00['companyId']});}catch(_0x198a5b){await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0x30ec45['id'],_0x476e00);}else{if(_0x30ec45[_0x12b9ab(0x71)]===_0x12b9ab(0x89))try{const _0x54eaa9={'ticketData':{'queueId':_0x30ec45[_0x12b9ab(0xda)],'userId':_0x30ec45['optUserId'],'status':'pending'},'ticketId':_0x476e00['id']};await(0x0,UpdateTicketService_1['default'])({'ticketData':{..._0x54eaa9['ticketData']},'ticketId':_0x54eaa9[_0x12b9ab(0x9c)],'companyId':_0x476e00[_0x12b9ab(0x7a)]});}catch(_0x4e55f8){await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0x30ec45['id'],_0x476e00);}}}await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0x30ec45['id'],_0x476e00);if(_0x30ec45[_0x12b9ab(0x71)]==='file')try{const _0x471f60=path_1[_0x12b9ab(0xcb)]['resolve'](__dirname,'..','..','..','public'),_0x36add1=await(0x0,ShowService_1['default'])(_0x30ec45[_0x12b9ab(0xcd)],_0x476e00[_0x12b9ab(0x7a)]),_0x492588=path_1[_0x12b9ab(0xcb)]['resolve'](_0x471f60,_0x12b9ab(0xd8)+_0x476e00['companyId'],_0x12b9ab(0x80),String(_0x36add1['id']));for(const [_0x454ef4,_0x16846b]of _0x36add1['options'][_0x12b9ab(0xb1)]()){const _0x51935e={'fieldname':_0x12b9ab(0xbe),'originalname':_0x16846b[_0x12b9ab(0x93)],'encoding':_0x12b9ab(0x97),'mimetype':_0x16846b[_0x12b9ab(0xa8)],'filename':_0x16846b[_0x12b9ab(0x93)],'path':path_1[_0x12b9ab(0xcb)]['resolve'](_0x492588,_0x16846b[_0x12b9ab(0x93)])};await(0x0,SendWhatsAppMedia_1[_0x12b9ab(0xcb)])({'media':_0x51935e,'ticket':_0x476e00,'body':_0x16846b[_0x12b9ab(0xa1)],'isForwarded':![]});};}catch(_0x397876){await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0x30ec45['id'],_0x476e00);}_0x30ec45[_0x12b9ab(0x79)]&&await sendMsgAndCloseTicket(_0x43bb37,_0x476e00[_0x12b9ab(0x90)],_0x476e00);await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0x30ec45['id'],_0x476e00);const _0x182391=await sendDialog(_0x30ec45,_0x43bb37,_0x142aa1,_0x476e00);return _0x182391;}}};exports['sayChatbot']=sayChatbot;