<<<<<<< HEAD
'use strict';const a600_0x57c1d2=a600_0x3586;(function(_0x351ec1,_0x417329){const _0x16794c=a600_0x3586,_0x4e16db=_0x351ec1();while(!![]){try{const _0x22fc87=parseInt(_0x16794c(0x1d3))/0x1*(parseInt(_0x16794c(0x20c))/0x2)+-parseInt(_0x16794c(0x1e0))/0x3+parseInt(_0x16794c(0x1e6))/0x4+parseInt(_0x16794c(0x20a))/0x5+-parseInt(_0x16794c(0x215))/0x6*(-parseInt(_0x16794c(0x1c8))/0x7)+-parseInt(_0x16794c(0x1d6))/0x8+parseInt(_0x16794c(0x201))/0x9*(-parseInt(_0x16794c(0x1ad))/0xa);if(_0x22fc87===_0x417329)break;else _0x4e16db['push'](_0x4e16db['shift']());}catch(_0xa9fb0e){_0x4e16db['push'](_0x4e16db['shift']());}}}(a600_0x39e3,0xd1ce4));function a600_0x3586(_0x21958e,_0x4d2024){const _0x39e337=a600_0x39e3();return a600_0x3586=function(_0x3586e4,_0x3db08a){_0x3586e4=_0x3586e4-0x1a1;let _0xdc4f63=_0x39e337[_0x3586e4];return _0xdc4f63;},a600_0x3586(_0x21958e,_0x4d2024);}var __createBinding=this&&this[a600_0x57c1d2(0x1b7)]||(Object['create']?function(_0x1df9b0,_0x4fe093,_0xe36584,_0x57a9e3){const _0x16c171=a600_0x57c1d2;if(_0x57a9e3===undefined)_0x57a9e3=_0xe36584;var _0x151c32=Object[_0x16c171(0x1f7)](_0x4fe093,_0xe36584);(!_0x151c32||(_0x16c171(0x200)in _0x151c32?!_0x4fe093[_0x16c171(0x1bb)]:_0x151c32[_0x16c171(0x1cb)]||_0x151c32['configurable']))&&(_0x151c32={'enumerable':!![],'get':function(){return _0x4fe093[_0xe36584];}}),Object[_0x16c171(0x207)](_0x1df9b0,_0x57a9e3,_0x151c32);}:function(_0x32c684,_0x204897,_0x1c4962,_0x22298f){if(_0x22298f===undefined)_0x22298f=_0x1c4962;_0x32c684[_0x22298f]=_0x204897[_0x1c4962];}),__setModuleDefault=this&&this[a600_0x57c1d2(0x1b2)]||(Object[a600_0x57c1d2(0x1ca)]?function(_0x238e5f,_0x131b01){const _0x16a68d=a600_0x57c1d2;Object[_0x16a68d(0x207)](_0x238e5f,'default',{'enumerable':!![],'value':_0x131b01});}:function(_0x3f0893,_0x3784e7){_0x3f0893['default']=_0x3784e7;}),__importStar=this&&this[a600_0x57c1d2(0x1cd)]||function(_0x5cddaa){const _0x3512ee=a600_0x57c1d2;if(_0x5cddaa&&_0x5cddaa[_0x3512ee(0x1bb)])return _0x5cddaa;var _0x363350={};if(_0x5cddaa!=null){for(var _0x39523b in _0x5cddaa)if(_0x39523b!==_0x3512ee(0x1c3)&&Object['prototype'][_0x3512ee(0x20f)][_0x3512ee(0x1e8)](_0x5cddaa,_0x39523b))__createBinding(_0x363350,_0x5cddaa,_0x39523b);}return __setModuleDefault(_0x363350,_0x5cddaa),_0x363350;},__importDefault=this&&this['__importDefault']||function(_0x41b147){const _0x566994=a600_0x57c1d2;return _0x41b147&&_0x41b147[_0x566994(0x1bb)]?_0x41b147:{'default':_0x41b147};};Object[a600_0x57c1d2(0x207)](exports,a600_0x57c1d2(0x1bb),{'value':!![]}),exports[a600_0x57c1d2(0x1c4)]=exports[a600_0x57c1d2(0x1f2)]=void 0x0;const path_1=__importDefault(require(a600_0x57c1d2(0x1a9))),wbotMessageListener_1=require(a600_0x57c1d2(0x1e4)),ShowDialogChatBotsServices_1=__importDefault(require(a600_0x57c1d2(0x216))),ShowQueueService_1=__importDefault(require(a600_0x57c1d2(0x1a4))),ShowChatBotServices_1=__importDefault(require(a600_0x57c1d2(0x1f5))),DeleteDialogChatBotsServices_1=__importDefault(require(a600_0x57c1d2(0x210))),ShowChatBotByChatbotIdServices_1=__importDefault(require(a600_0x57c1d2(0x1f1))),CreateDialogChatBotsServices_1=__importDefault(require(a600_0x57c1d2(0x205))),ShowWhatsAppService_1=__importDefault(require(a600_0x57c1d2(0x1fd))),Mustache_1=__importDefault(require(a600_0x57c1d2(0x1ab))),UpdateTicketService_1=__importDefault(require(a600_0x57c1d2(0x213))),ShowService_1=__importDefault(require('../../services/FileServices/ShowService')),SendWhatsAppMedia_1=__importStar(require(a600_0x57c1d2(0x1b8))),CompaniesSettings_1=__importDefault(require(a600_0x57c1d2(0x1fb))),fs=require('fs');var axios=require(a600_0x57c1d2(0x20d));const isNumeric=_0x35510e=>/^-?\d+$/[a600_0x57c1d2(0x20b)](_0x35510e),deleteAndCreateDialogStage=async(_0x3f5750,_0x1bd219,_0x2a1ef5)=>{const _0x1c70ea=a600_0x57c1d2;try{await(0x0,DeleteDialogChatBotsServices_1['default'])(_0x3f5750['id']);const _0x424287=await(0x0,ShowChatBotByChatbotIdServices_1[_0x1c70ea(0x1c3)])(_0x1bd219);return!_0x424287&&await _0x2a1ef5[_0x1c70ea(0x1c1)]({'isBot':![]}),await(0x0,CreateDialogChatBotsServices_1['default'])({'awaiting':0x1,'contactId':_0x3f5750['id'],'chatbotId':_0x1bd219,'queueId':_0x424287[_0x1c70ea(0x1ac)]});}catch(_0x17c57c){await _0x2a1ef5[_0x1c70ea(0x1c1)]({'isBot':![]});}};exports['deleteAndCreateDialogStage']=deleteAndCreateDialogStage;const sendMessage=async(_0x4bf32e,_0x38ffd6,_0x1c2314,_0x3fb9c3)=>{const _0x531415=a600_0x57c1d2,_0x56dab8=await _0x4bf32e['sendMessage'](_0x38ffd6[_0x531415(0x1c5)]+'@'+(_0x1c2314[_0x531415(0x1f3)]?_0x531415(0x20e):'s.whatsapp.net'),{'text':(0x0,Mustache_1['default'])(_0x3fb9c3,_0x1c2314)});(0x0,wbotMessageListener_1[_0x531415(0x1b1)])(_0x56dab8,_0x1c2314,_0x38ffd6);},sendMessageLink=async(_0x27c1e8,_0xeba270,_0x248991,_0x48b173,_0x18ec00)=>{const _0xc085d6=a600_0x57c1d2;let _0x113063;try{_0x113063=await _0x27c1e8[_0xc085d6(0x1f8)](_0xeba270[_0xc085d6(0x1c5)]+'@'+(_0x248991[_0xc085d6(0x1f3)]?_0xc085d6(0x20e):_0xc085d6(0x1bf)),{'document':_0x48b173?{'url':_0x48b173}:fs['readFileSync'](_0xc085d6(0x1a6)+_0x18ec00+'-'+makeid(0xa)),'fileName':_0x18ec00,'mimetype':_0xc085d6(0x1ee)});}catch(_0x7591fa){_0x113063=await _0x27c1e8[_0xc085d6(0x1f8)](_0xeba270[_0xc085d6(0x1c5)]+'@'+(_0x248991[_0xc085d6(0x1f3)]?'g.us':_0xc085d6(0x1bf)),{'text':(0x0,Mustache_1[_0xc085d6(0x1c3)])('‎Não\x20consegui\x20enviar\x20o\x20PDF,\x20tente\x20novamente!',_0x248991)});}(0x0,wbotMessageListener_1[_0xc085d6(0x1b1)])(_0x113063,_0x248991,_0xeba270);},sendMessageImage=async(_0x2db372,_0x1c2455,_0x4cf59e,_0x170a08,_0x1b81c4)=>{const _0x34b590=a600_0x57c1d2;let _0x27b7fe;try{_0x27b7fe=await _0x2db372['sendMessage'](_0x1c2455[_0x34b590(0x1c5)]+'@'+(_0x4cf59e[_0x34b590(0x1f3)]?_0x34b590(0x20e):_0x34b590(0x1bf)),{'image':_0x170a08?{'url':_0x170a08}:fs['readFileSync']('public/temp/'+_0x1b81c4+'-'+makeid(0xa)),'fileName':_0x1b81c4,'caption':_0x1b81c4,'mimetype':_0x34b590(0x1d1)});}catch(_0x54e27e){_0x27b7fe=await _0x2db372[_0x34b590(0x1f8)](_0x1c2455[_0x34b590(0x1c5)]+'@'+(_0x4cf59e[_0x34b590(0x1f3)]?_0x34b590(0x20e):_0x34b590(0x1bf)),{'text':(0x0,Mustache_1[_0x34b590(0x1c3)])(_0x34b590(0x217),_0x4cf59e)});}(0x0,wbotMessageListener_1['verifyMessage'])(_0x27b7fe,_0x4cf59e,_0x1c2455);},sendDialog=async(_0x28e9e4,_0x335378,_0x219d57,_0x1d8b15)=>{const _0x41e3d6=a600_0x57c1d2,_0x4a5fca=await(0x0,ShowChatBotServices_1[_0x41e3d6(0x1c3)])(_0x28e9e4['id']);if(_0x4a5fca[_0x41e3d6(0x1b4)]){let _0x47113c=_0x1d8b15[_0x41e3d6(0x1b5)];const _0x1d96e4=await CompaniesSettings_1[_0x41e3d6(0x1c3)][_0x41e3d6(0x204)]({'where':{'companyId':_0x47113c}}),_0x4543c8=_0x1d96e4?.['chatBotType']||_0x41e3d6(0x1ec),_0x531f98=async()=>{const _0x2041a5=_0x41e3d6;let _0xe23d53='';_0x4a5fca[_0x2041a5(0x1b4)][_0x2041a5(0x203)]((_0x1211da,_0x53f273)=>{const _0x4d0f87=_0x2041a5;_0xe23d53+=_0x4d0f87(0x1d8)+(_0x53f273+0x1)+'\x20]*\x20-\x20'+_0x1211da['name']+'\x0a';});const _0xc95d26=_0xe23d53['length']>0x0?_0xe23d53+_0x2041a5(0x1d7):_0xe23d53+_0x2041a5(0x202);if(_0xe23d53[_0x2041a5(0x1be)]>0x0){const _0x1991b3='‎'+_0x28e9e4[_0x2041a5(0x1ff)]+'\x0a\x0a'+_0xc95d26,_0x5813ec=await sendMessage(_0x335378,_0x219d57,_0x1d8b15,_0x1991b3);return _0x5813ec;}const _0x467386='‎'+_0x28e9e4['greetingMessage'],_0x3cd08e=await sendMessage(_0x335378,_0x219d57,_0x1d8b15,_0x467386);return _0x3cd08e;},_0x381949=async()=>{const _0x43e644=_0x41e3d6,_0x416142=[];_0x4a5fca[_0x43e644(0x1b4)]['forEach']((_0x2d0bb1,_0x472a06)=>{const _0x4bdb3e=_0x43e644;_0x416142[_0x4bdb3e(0x1b3)]({'buttonId':''+(_0x472a06+0x1),'buttonText':{'displayText':_0x2d0bb1[_0x4bdb3e(0x1a8)]},'type':0x1});});if(_0x416142['length']>0x0){const _0x281000={'text':'‎'+_0x28e9e4['greetingMessage'],'buttons':_0x416142,'headerType':0x1},_0x69cc05=await _0x335378[_0x43e644(0x1f8)](_0x219d57[_0x43e644(0x1c5)]+'@'+(_0x1d8b15[_0x43e644(0x1f3)]?_0x43e644(0x20e):_0x43e644(0x1bf)),_0x281000);return await(0x0,wbotMessageListener_1['verifyMessage'])(_0x69cc05,_0x1d8b15,_0x219d57),_0x69cc05;}const _0x36bfeb='‎'+_0x28e9e4['greetingMessage'],_0x35bccd=await sendMessage(_0x335378,_0x219d57,_0x1d8b15,_0x36bfeb);return _0x35bccd;},_0xebbccb=async()=>{const _0x2db2a9=_0x41e3d6,_0x4060f8=[];_0x4a5fca[_0x2db2a9(0x1b4)][_0x2db2a9(0x203)]((_0xe49d48,_0x50301b)=>{const _0x5b9da0=_0x2db2a9;_0x4060f8[_0x5b9da0(0x1b3)]({'title':_0xe49d48[_0x5b9da0(0x1a8)],'rowId':''+(_0x50301b+0x1)});});if(_0x4060f8[_0x2db2a9(0x1be)]>0x0){const _0x1f39f7=[{'title':_0x2db2a9(0x1ae),'rows':_0x4060f8}],_0x483ed4={'text':(0x0,Mustache_1[_0x2db2a9(0x1c3)])('‎'+_0x28e9e4['greetingMessage'],_0x1d8b15),'buttonText':_0x2db2a9(0x1de),'sections':_0x1f39f7},_0x40daf1=await _0x335378['sendMessage'](_0x219d57[_0x2db2a9(0x1c5)]+'@'+(_0x1d8b15[_0x2db2a9(0x1f3)]?_0x2db2a9(0x20e):'s.whatsapp.net'),_0x483ed4);return await(0x0,wbotMessageListener_1[_0x2db2a9(0x1b1)])(_0x40daf1,_0x1d8b15,_0x219d57),_0x40daf1;}const _0x255558='‎'+_0x28e9e4['greetingMessage'],_0x5a0696=await sendMessage(_0x335378,_0x219d57,_0x1d8b15,_0x255558);return _0x5a0696;};if(_0x4543c8==='text')return await _0x531f98();if(_0x4543c8==='button'&&_0x4a5fca[_0x41e3d6(0x1b4)][_0x41e3d6(0x1be)]>0x4)return await _0x531f98();if(_0x4543c8===_0x41e3d6(0x1f0)&&_0x4a5fca['options'][_0x41e3d6(0x1be)]<=0x4)return await _0x381949();if(_0x4543c8===_0x41e3d6(0x1f9))return await _0xebbccb();}},backToMainMenu=async(_0x48a5e9,_0x1cc5bf,_0x2c03d3)=>{const _0x1b4fda=a600_0x57c1d2;await(0x0,UpdateTicketService_1[_0x1b4fda(0x1c3)])({'ticketData':{'queueId':null,'userId':null},'ticketId':_0x2c03d3['id'],'companyId':_0x2c03d3['companyId']});const {queues:_0x43aa7f,greetingMessage:_0x35a046,greetingMediaAttachment:_0x50f24c}=await(0x0,ShowWhatsAppService_1[_0x1b4fda(0x1c3)])(_0x48a5e9['id'],_0x2c03d3['companyId']),_0x3aed12=await CompaniesSettings_1[_0x1b4fda(0x1c3)][_0x1b4fda(0x204)]({'where':{'companyId':_0x2c03d3[_0x1b4fda(0x1b5)]}}),_0x5b3712=async()=>{const _0x193701=_0x1b4fda;let _0xc21930='';_0x43aa7f[_0x193701(0x203)]((_0x295896,_0x38253a)=>{const _0x1225f2=_0x193701;_0xc21930+=_0x1225f2(0x1d8)+(_0x38253a+0x1)+_0x1225f2(0x1db)+_0x295896[_0x1225f2(0x1a8)]+'\x0a';}),_0xc21930+=_0x193701(0x1e3);const _0x437588=(0x0,Mustache_1[_0x193701(0x1c3)])('‎'+_0x35a046+'\x0a\x0a'+_0xc21930,_0x2c03d3);if(_0x50f24c!==null){const _0x4f6e39=path_1[_0x193701(0x1c3)][_0x193701(0x1b0)](_0x193701(0x1ce),_0x193701(0x1da)+_0x2c03d3[_0x193701(0x1b5)],_0x2c03d3[_0x193701(0x1bc)][_0x193701(0x1e1)]),_0x11e3fd=_0x2c03d3[_0x193701(0x1bc)][_0x193701(0x1e1)],_0x373960=await(0x0,SendWhatsAppMedia_1[_0x193701(0x1c7)])(_0x11e3fd,_0x4f6e39,String(_0x2c03d3[_0x193701(0x1b5)]),_0x437588),_0x2a0535=await _0x48a5e9[_0x193701(0x1f8)](_0x2c03d3['contact'][_0x193701(0x1c5)]+'@'+(_0x2c03d3[_0x193701(0x1f3)]?_0x193701(0x20e):_0x193701(0x1bf)),{..._0x373960});await(0x0,wbotMessageListener_1[_0x193701(0x1f4)])(_0x2a0535,_0x2c03d3,_0x1cc5bf);}else await _0x48a5e9[_0x193701(0x1f8)](_0x1cc5bf[_0x193701(0x1c5)]+'@'+(_0x2c03d3[_0x193701(0x1f3)]?'g.us':_0x193701(0x1bf)),{'text':_0x437588});const _0xb36f2=await(0x0,DeleteDialogChatBotsServices_1['default'])(_0x1cc5bf['id']);return _0xb36f2;};if(_0x3aed12['chatBotType']===_0x1b4fda(0x1ec))return _0x5b3712();};function validaCpfCnpj(_0x3baf14){const _0x1099da=a600_0x57c1d2;if(_0x3baf14[_0x1099da(0x1be)]==0xb){var _0x40a11f=_0x3baf14[_0x1099da(0x211)]();_0x40a11f=_0x40a11f[_0x1099da(0x1cf)](/\./g,''),_0x40a11f=_0x40a11f[_0x1099da(0x1cf)]('-',''),_0x40a11f=_0x40a11f['split']('');var _0x346f99=0x0,_0x1a0396=0x0,_0x42f8f5=![];for(var _0x655e87=0x1;_0x40a11f['length']>_0x655e87;_0x655e87++){_0x40a11f[_0x655e87-0x1]!=_0x40a11f[_0x655e87]&&(_0x42f8f5=!![]);}if(_0x42f8f5==![])return![];for(var _0x655e87=0x0,_0x1cdb67=0xa;_0x40a11f['length']-0x2>_0x655e87;_0x655e87++,_0x1cdb67--){_0x346f99+=_0x40a11f[_0x655e87]*_0x1cdb67;}_0x346f99=_0x346f99*0xa%0xb;_0x346f99==0xa&&(_0x346f99=0x0);if(_0x346f99!=_0x40a11f[0x9])return![];for(var _0x655e87=0x0,_0x1cdb67=0xb;_0x40a11f[_0x1099da(0x1be)]-0x1>_0x655e87;_0x655e87++,_0x1cdb67--){_0x1a0396+=_0x40a11f[_0x655e87]*_0x1cdb67;}return _0x1a0396=_0x1a0396*0xa%0xb,_0x1a0396==0xa&&(_0x1a0396=0x0),_0x1a0396!=_0x40a11f[0xa]?![]:!![];}else{if(_0x3baf14[_0x1099da(0x1be)]==0xe){var _0xf7eadd=_0x3baf14[_0x1099da(0x211)]();_0xf7eadd=_0xf7eadd[_0x1099da(0x1cf)](/\./g,''),_0xf7eadd=_0xf7eadd[_0x1099da(0x1cf)]('-',''),_0xf7eadd=_0xf7eadd[_0x1099da(0x1cf)]('/',''),_0xf7eadd=_0xf7eadd['split']('');var _0x346f99=0x0,_0x1a0396=0x0,_0x42f8f5=![];for(var _0x655e87=0x1;_0xf7eadd['length']>_0x655e87;_0x655e87++){_0xf7eadd[_0x655e87-0x1]!=_0xf7eadd[_0x655e87]&&(_0x42f8f5=!![]);}if(_0x42f8f5==![])return![];for(var _0x655e87=0x0,_0x102702=0x5,_0x2e539a=0xd;_0xf7eadd['length']-0x2>_0x655e87;_0x655e87++,_0x102702--,_0x2e539a--){_0x102702>=0x2?_0x346f99+=_0xf7eadd[_0x655e87]*_0x102702:_0x346f99+=_0xf7eadd[_0x655e87]*_0x2e539a;}_0x346f99=_0x346f99%0xb;_0x346f99<0x2?_0x346f99=0x0:_0x346f99=0xb-_0x346f99;if(_0x346f99!=_0xf7eadd[0xc])return![];for(var _0x655e87=0x0,_0x102702=0x6,_0x2e539a=0xe;_0xf7eadd['length']-0x1>_0x655e87;_0x655e87++,_0x102702--,_0x2e539a--){_0x102702>=0x2?_0x1a0396+=_0xf7eadd[_0x655e87]*_0x102702:_0x1a0396+=_0xf7eadd[_0x655e87]*_0x2e539a;}return _0x1a0396=_0x1a0396%0xb,_0x1a0396<0x2?_0x1a0396=0x0:_0x1a0396=0xb-_0x1a0396,_0x1a0396!=_0xf7eadd[0xd]?![]:!![];}else return![];}}function timeout(_0x43baa2){return new Promise(_0x4a4427=>setTimeout(_0x4a4427,_0x43baa2));}async function sleep(_0x1cde9e){await timeout(_0x1cde9e);}function firstDayOfMonth(_0x50ab76){const _0x2313ea=new Date(),_0x56691f=new Date(_0x2313ea['getFullYear'](),_0x2313ea['getMonth']()-_0x50ab76,0x1);return _0x56691f;};function lastDayOfMonth(_0x53b74f){const _0x2952a8=a600_0x57c1d2,_0x4d0c85=new Date(),_0x89d394=new Date(_0x4d0c85['getFullYear'](),_0x4d0c85[_0x2952a8(0x1b9)]()+_0x53b74f,0x0);return _0x89d394;}function a600_0x39e3(){const _0x397cb7=['s.whatsapp.net','attendent','update','ticketData','default','sayChatbot','number','chatbots','getMessageOptions','7SsMOEb','getBodyMessage','create','writable','optUserId','__importStar','public','replace','queue','image/jpeg','integration','38kFTJRH','getDate','ticketId','9981848YODkgN','\x0a*[\x20#\x20]*\x20Voltar\x20para\x20o\x20menu\x20principal\x0a*[\x20Sair\x20]*\x20Encerrar\x20atendimento','*[\x20','getFullYear','company','\x20]*\x20-\x20','fromMe','file','Escolha\x20uma\x20opção','toLocaleLowerCase','433578cTnolb','greetingMediaAttachment','optIntegrationId','\x0a*[\x20Sair\x20]*\x20-\x20Encerrar\x20Atendimento','./wbotMessageListener','7bit','4331992fHaZUc','selectedRowId','call','mediaType','dueDate','substring','text','selectedButtonId','application/pdf','entries','button','../ChatBotServices/ShowChatBotByChatbotIdServices','deleteAndCreateDialogStage','isGroup','verifyMediaMessage','../ChatBotServices/ShowChatBotServices','closed','getOwnPropertyDescriptor','sendMessage','list','listResponseMessage','../../models/CompaniesSettings','contact','../WhatsappService/ShowWhatsAppService','fileList','greetingMessage','get','71883YKNcTU','\x0a*[\x20Sair\x20]*\x20Encerrar\x20atendimento','forEach','findOne','../DialogChatBotsServices/CreateDialogChatBotsServices','queueType','defineProperty','localeCompare','singleSelectReply','8381875oyJqZE','test','21304wKwpAQ','axios','g.us','hasOwnProperty','../DialogChatBotsServices/DeleteDialogChatBotsServices','trim','key','../TicketServices/UpdateTicketService','closeTicket','5786502jOiGlD','../DialogChatBotsServices/ShowDialogChatBotsServices','Não\x20consegui\x20enviar\x20o\x20PDF,\x20tente\x20novamente!','random','buttonsResponseMessage','optQueueId','message','../QueueService/ShowQueueService','medias','public/temp/','pending','name','path','userId','../../helpers/Mustache','queueId','2350GJmlGR','Menu','optFileId','resolve','verifyMessage','__setModuleDefault','push','options','companyId','toString','__createBinding','./SendWhatsAppMedia','getMonth','floor','__esModule','whatsapp','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','length'];a600_0x39e3=function(){return _0x397cb7;};return a600_0x39e3();};function dataAtualFormatada(_0x375f27){const _0x242777=a600_0x57c1d2;var _0x179851=_0x375f27[_0x242777(0x1d4)]()[_0x242777(0x1b6)](),_0xc75e5e=_0x179851[_0x242777(0x1be)]==0x1?'0'+_0x179851:_0x179851,_0x131532=(_0x375f27[_0x242777(0x1b9)]()+0x1)[_0x242777(0x1b6)](),_0xc01662=_0x131532[_0x242777(0x1be)]==0x1?'0'+_0x131532:_0x131532,_0x3ef92f=_0x375f27[_0x242777(0x1d9)]();return _0xc75e5e+'/'+_0xc01662+'/'+_0x3ef92f;}function makeid(_0x3c47fa){const _0x112d41=a600_0x57c1d2;var _0x3d9486='',_0x57fd93=_0x112d41(0x1bd),_0x3177b5=_0x57fd93[_0x112d41(0x1be)];for(var _0x47f6b8=0x0;_0x47f6b8<_0x3c47fa;_0x47f6b8++){_0x3d9486+=_0x57fd93['charAt'](Math[_0x112d41(0x1ba)](Math[_0x112d41(0x218)]()*_0x3177b5));}return _0x3d9486;}function replaceAll(_0x17f4c0,_0x36b31b,_0x1ade83){const _0x4b6159=a600_0x57c1d2;return _0x17f4c0[_0x4b6159(0x1cf)](new RegExp(_0x36b31b,'g'),_0x1ade83);}function formatDate(_0x6ad10c){const _0x46716e=a600_0x57c1d2;return _0x6ad10c[_0x46716e(0x1eb)](0x8,0xa)+'/'+_0x6ad10c[_0x46716e(0x1eb)](0x5,0x7)+'/'+_0x6ad10c[_0x46716e(0x1eb)](0x0,0x4);}function sortfunction(_0x56283b,_0x18c3c5){const _0x22665f=a600_0x57c1d2;return _0x56283b['dueDate'][_0x22665f(0x208)](_0x18c3c5[_0x22665f(0x1ea)]);}async function sendMsgAndCloseTicket(_0x5d9fc0,_0x554d55,_0xe41fca){const _0x2f9423=a600_0x57c1d2,_0x52a34e={'ticketData':{'status':_0x2f9423(0x1f6),'userId':_0xe41fca?.[_0x2f9423(0x1aa)]||null,'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'ticketId':_0xe41fca['id'],'companyId':_0xe41fca[_0x2f9423(0x1b5)]};await sleep(0x7d0),await(0x0,UpdateTicketService_1[_0x2f9423(0x1c3)])(_0x52a34e);}const sayChatbot=async(_0xfcb196,_0x49d087,_0x55bc35,_0x383eab,_0x21470c)=>{const _0x4dad34=a600_0x57c1d2,_0x442317=_0x21470c?.[_0x4dad34(0x1a3)]?.[_0x4dad34(0x1a1)]?.[_0x4dad34(0x1ed)]||_0x21470c?.['message']?.[_0x4dad34(0x1fa)]?.[_0x4dad34(0x209)][_0x4dad34(0x1e7)]||(0x0,wbotMessageListener_1[_0x4dad34(0x1c9)])(_0x21470c);if(!_0xfcb196&&_0x442317&&_0x21470c[_0x4dad34(0x212)][_0x4dad34(0x1dc)])return;const _0xde6d3f=await(0x0,ShowDialogChatBotsServices_1[_0x4dad34(0x1c3)])(_0x383eab['id']);if(_0x442317[_0x4dad34(0x1df)]()==='sair'){const _0x231674={'ticketData':{'status':_0x4dad34(0x1f6),'sendFarewellMessage':!![],'amountUsedBotQueues':0x0},'ticketId':_0x55bc35['id'],'companyId':_0x55bc35[_0x4dad34(0x1b5)]};await(0x0,UpdateTicketService_1['default'])(_0x231674);return;}if(_0x442317==='#'){const _0x1917f=await backToMainMenu(_0x49d087,_0x383eab,_0x55bc35);return;}if(!_0xde6d3f){const _0x2f4a49=await(0x0,ShowQueueService_1['default'])(_0xfcb196,_0x55bc35[_0x4dad34(0x1b5)]),_0x4a82fd=_0x21470c?.[_0x4dad34(0x1a3)]?.['buttonsResponseMessage']?.[_0x4dad34(0x1ed)]||_0x21470c?.['message']?.[_0x4dad34(0x1fa)]?.['singleSelectReply'][_0x4dad34(0x1e7)]||(0x0,wbotMessageListener_1[_0x4dad34(0x1c9)])(_0x21470c),_0x3e24d2=_0x2f4a49[_0x4dad34(0x1c6)][+_0x4a82fd-0x1];if(_0x3e24d2){if(_0x3e24d2[_0x4dad34(0x206)]===_0x4dad34(0x1d2))try{const _0x12ad38={'ticketData':{'integrationId':_0x3e24d2[_0x4dad34(0x1e2)],'useIntegration':!![],'status':'pending'},'ticketId':_0x55bc35['id']};await(0x0,UpdateTicketService_1[_0x4dad34(0x1c3)])({'ticketData':{..._0x12ad38[_0x4dad34(0x1c2)]},'ticketId':_0x12ad38[_0x4dad34(0x1d5)],'companyId':_0x55bc35[_0x4dad34(0x1b5)]});}catch(_0x3cbbd5){await(0x0,exports[_0x4dad34(0x1f2)])(_0x383eab,_0x3e24d2['id'],_0x55bc35);}else{if(_0x3e24d2[_0x4dad34(0x206)]==='queue')try{const _0x3813db={'ticketData':{'queueId':_0x3e24d2['optQueueId'],'status':_0x4dad34(0x1a7)},'ticketId':_0x55bc35['id']};await(0x0,UpdateTicketService_1[_0x4dad34(0x1c3)])({'ticketData':{..._0x3813db[_0x4dad34(0x1c2)]},'ticketId':_0x3813db[_0x4dad34(0x1d5)],'companyId':_0x55bc35[_0x4dad34(0x1b5)]});}catch(_0x3b2b66){await(0x0,exports['deleteAndCreateDialogStage'])(_0x383eab,_0x3e24d2['id'],_0x55bc35);}else{if(_0x3e24d2[_0x4dad34(0x206)]===_0x4dad34(0x1c0))try{const _0x353133={'ticketData':{'queueId':_0x3e24d2[_0x4dad34(0x1a2)],'userId':_0x3e24d2['optUserId'],'status':_0x4dad34(0x1a7)},'ticketId':_0x55bc35['id']};await(0x0,UpdateTicketService_1['default'])({'ticketData':{..._0x353133[_0x4dad34(0x1c2)]},'ticketId':_0x353133[_0x4dad34(0x1d5)],'companyId':_0x55bc35['companyId']});}catch(_0x1a7964){await(0x0,exports[_0x4dad34(0x1f2)])(_0x383eab,_0x3e24d2['id'],_0x55bc35);}}}await(0x0,exports['deleteAndCreateDialogStage'])(_0x383eab,_0x3e24d2['id'],_0x55bc35);let _0x1dc920;_0x3e24d2?.[_0x4dad34(0x1ff)]&&(_0x1dc920=await sendDialog(_0x3e24d2,_0x49d087,_0x383eab,_0x55bc35));if(_0x3e24d2[_0x4dad34(0x206)]===_0x4dad34(0x1dd))try{const _0x4fd3c3=path_1[_0x4dad34(0x1c3)][_0x4dad34(0x1b0)](__dirname,'..','..','..',_0x4dad34(0x1ce)),_0x1ecb3d=await(0x0,ShowService_1[_0x4dad34(0x1c3)])(_0x3e24d2[_0x4dad34(0x1af)],_0x55bc35['companyId']),_0x5f00e5=path_1[_0x4dad34(0x1c3)][_0x4dad34(0x1b0)](_0x4fd3c3,'company'+_0x55bc35['companyId'],_0x4dad34(0x1fe),String(_0x1ecb3d['id']));for(const [_0x3f03a7,_0x23f9ad]of _0x1ecb3d[_0x4dad34(0x1b4)]['entries']()){const _0x38db6b={'fieldname':_0x4dad34(0x1a5),'originalname':_0x23f9ad[_0x4dad34(0x1a9)],'encoding':'7bit','mimetype':_0x23f9ad[_0x4dad34(0x1e9)],'filename':_0x23f9ad[_0x4dad34(0x1a9)],'path':path_1[_0x4dad34(0x1c3)][_0x4dad34(0x1b0)](_0x5f00e5,_0x23f9ad[_0x4dad34(0x1a9)])};await(0x0,SendWhatsAppMedia_1['default'])({'media':_0x38db6b,'ticket':_0x55bc35,'body':_0x23f9ad[_0x4dad34(0x1a8)],'isForwarded':![]});};}catch(_0x38d1b9){await(0x0,exports[_0x4dad34(0x1f2)])(_0x383eab,_0x3e24d2['id'],_0x55bc35);}return _0x3e24d2['closeTicket']&&await sendMsgAndCloseTicket(_0x49d087,_0x55bc35[_0x4dad34(0x1fc)],_0x55bc35),_0x1dc920;}}if(_0xde6d3f){const _0x4ba60b=isNumeric(_0x442317)?_0x442317:0x1,_0x367acd=await(0x0,ShowChatBotServices_1[_0x4dad34(0x1c3)])(_0xde6d3f['chatbotId']),_0x5d31cd=_0x367acd[_0x4dad34(0x1b4)][+_0x4ba60b-0x1]?_0x367acd[_0x4dad34(0x1b4)][+_0x4ba60b-0x1]:_0x367acd['options'][0x0];if(!_0x5d31cd['greetingMessage']){await(0x0,DeleteDialogChatBotsServices_1[_0x4dad34(0x1c3)])(_0x383eab['id']);return;}if(_0x5d31cd){if(_0x5d31cd[_0x4dad34(0x206)]===_0x4dad34(0x1d2))try{const _0x554f4e={'ticketData':{'integrationId':_0x5d31cd[_0x4dad34(0x1e2)],'useIntegration':!![],'status':'pending'},'ticketId':_0x55bc35['id']};await(0x0,UpdateTicketService_1[_0x4dad34(0x1c3)])({'ticketData':{..._0x554f4e[_0x4dad34(0x1c2)]},'ticketId':_0x554f4e[_0x4dad34(0x1d5)],'companyId':_0x55bc35['companyId']});}catch(_0x96967a){await(0x0,exports[_0x4dad34(0x1f2)])(_0x383eab,_0x5d31cd['id'],_0x55bc35);}else{if(_0x5d31cd[_0x4dad34(0x206)]===_0x4dad34(0x1d0))try{const _0xab170={'ticketData':{'queueId':_0x5d31cd[_0x4dad34(0x1a2)],'status':'pending'},'ticketId':_0x55bc35['id']};await(0x0,UpdateTicketService_1['default'])({'ticketData':{..._0xab170[_0x4dad34(0x1c2)]},'ticketId':_0xab170[_0x4dad34(0x1d5)],'companyId':_0x55bc35['companyId']});}catch(_0x2c68a7){await(0x0,exports[_0x4dad34(0x1f2)])(_0x383eab,_0x5d31cd['id'],_0x55bc35);}else{if(_0x5d31cd[_0x4dad34(0x206)]===_0x4dad34(0x1c0))try{const _0x432793={'ticketData':{'queueId':_0x5d31cd[_0x4dad34(0x1a2)],'userId':_0x5d31cd[_0x4dad34(0x1cc)],'status':'pending'},'ticketId':_0x55bc35['id']};await(0x0,UpdateTicketService_1[_0x4dad34(0x1c3)])({'ticketData':{..._0x432793[_0x4dad34(0x1c2)]},'ticketId':_0x432793[_0x4dad34(0x1d5)],'companyId':_0x55bc35[_0x4dad34(0x1b5)]});}catch(_0x59180e){await(0x0,exports[_0x4dad34(0x1f2)])(_0x383eab,_0x5d31cd['id'],_0x55bc35);}}}await(0x0,exports[_0x4dad34(0x1f2)])(_0x383eab,_0x5d31cd['id'],_0x55bc35);if(_0x5d31cd[_0x4dad34(0x206)]==='file')try{const _0x584d1f=path_1[_0x4dad34(0x1c3)][_0x4dad34(0x1b0)](__dirname,'..','..','..',_0x4dad34(0x1ce)),_0x3a37e2=await(0x0,ShowService_1['default'])(_0x5d31cd[_0x4dad34(0x1af)],_0x55bc35[_0x4dad34(0x1b5)]),_0x4ca7f3=path_1[_0x4dad34(0x1c3)][_0x4dad34(0x1b0)](_0x584d1f,_0x4dad34(0x1da)+_0x55bc35[_0x4dad34(0x1b5)],'fileList',String(_0x3a37e2['id']));for(const [_0x4b0245,_0x5fc587]of _0x3a37e2[_0x4dad34(0x1b4)][_0x4dad34(0x1ef)]()){const _0x47f40e={'fieldname':'medias','originalname':_0x5fc587[_0x4dad34(0x1a9)],'encoding':_0x4dad34(0x1e5),'mimetype':_0x5fc587[_0x4dad34(0x1e9)],'filename':_0x5fc587[_0x4dad34(0x1a9)],'path':path_1[_0x4dad34(0x1c3)][_0x4dad34(0x1b0)](_0x4ca7f3,_0x5fc587[_0x4dad34(0x1a9)])};await(0x0,SendWhatsAppMedia_1[_0x4dad34(0x1c3)])({'media':_0x47f40e,'ticket':_0x55bc35,'body':_0x5fc587[_0x4dad34(0x1a8)],'isForwarded':![]});};}catch(_0x2c8af0){await(0x0,exports[_0x4dad34(0x1f2)])(_0x383eab,_0x5d31cd['id'],_0x55bc35);}_0x5d31cd[_0x4dad34(0x214)]&&await sendMsgAndCloseTicket(_0x49d087,_0x55bc35[_0x4dad34(0x1fc)],_0x55bc35);await(0x0,exports[_0x4dad34(0x1f2)])(_0x383eab,_0x5d31cd['id'],_0x55bc35);const _0x2931e3=await sendDialog(_0x5d31cd,_0x49d087,_0x383eab,_0x55bc35);return _0x2931e3;}}};exports[a600_0x57c1d2(0x1c4)]=sayChatbot;
=======
'use strict';const a599_0x10b581=a599_0x4d6e;function a599_0x4d6e(_0x583ebc,_0x2bc244){const _0x22f7bf=a599_0x22f7();return a599_0x4d6e=function(_0x4d6e42,_0x49e86e){_0x4d6e42=_0x4d6e42-0x6f;let _0x449e06=_0x22f7bf[_0x4d6e42];return _0x449e06;},a599_0x4d6e(_0x583ebc,_0x2bc244);}(function(_0xf35ecc,_0x1f5857){const _0x689ba6=a599_0x4d6e,_0x1b09f0=_0xf35ecc();while(!![]){try{const _0x9c5721=parseInt(_0x689ba6(0x87))/0x1+parseInt(_0x689ba6(0xc2))/0x2*(-parseInt(_0x689ba6(0xb4))/0x3)+-parseInt(_0x689ba6(0xaf))/0x4+-parseInt(_0x689ba6(0x9b))/0x5*(-parseInt(_0x689ba6(0x8f))/0x6)+-parseInt(_0x689ba6(0x84))/0x7*(parseInt(_0x689ba6(0x95))/0x8)+-parseInt(_0x689ba6(0xb9))/0x9*(parseInt(_0x689ba6(0x83))/0xa)+parseInt(_0x689ba6(0x8d))/0xb;if(_0x9c5721===_0x1f5857)break;else _0x1b09f0['push'](_0x1b09f0['shift']());}catch(_0x49f3d4){_0x1b09f0['push'](_0x1b09f0['shift']());}}}(a599_0x22f7,0x20af4));var __createBinding=this&&this[a599_0x10b581(0xdb)]||(Object[a599_0x10b581(0xc8)]?function(_0x7dad74,_0x473502,_0xe2ed2c,_0x5044d7){const _0x182202=a599_0x10b581;if(_0x5044d7===undefined)_0x5044d7=_0xe2ed2c;var _0x1f8ee9=Object[_0x182202(0x9e)](_0x473502,_0xe2ed2c);(!_0x1f8ee9||(_0x182202(0xae)in _0x1f8ee9?!_0x473502[_0x182202(0x9a)]:_0x1f8ee9['writable']||_0x1f8ee9['configurable']))&&(_0x1f8ee9={'enumerable':!![],'get':function(){return _0x473502[_0xe2ed2c];}}),Object[_0x182202(0x7c)](_0x7dad74,_0x5044d7,_0x1f8ee9);}:function(_0x3be4dd,_0x1f7250,_0x2dad3c,_0x105f45){if(_0x105f45===undefined)_0x105f45=_0x2dad3c;_0x3be4dd[_0x105f45]=_0x1f7250[_0x2dad3c];}),__setModuleDefault=this&&this[a599_0x10b581(0x92)]||(Object[a599_0x10b581(0xc8)]?function(_0x45a61d,_0xe52d99){const _0x3d7f9f=a599_0x10b581;Object['defineProperty'](_0x45a61d,_0x3d7f9f(0xcb),{'enumerable':!![],'value':_0xe52d99});}:function(_0x4333c2,_0x2cb922){_0x4333c2['default']=_0x2cb922;}),__importStar=this&&this[a599_0x10b581(0xd4)]||function(_0x59e1d6){const _0x109109=a599_0x10b581;if(_0x59e1d6&&_0x59e1d6['__esModule'])return _0x59e1d6;var _0x443ade={};if(_0x59e1d6!=null){for(var _0x45fcef in _0x59e1d6)if(_0x45fcef!==_0x109109(0xcb)&&Object[_0x109109(0xac)][_0x109109(0x86)][_0x109109(0x96)](_0x59e1d6,_0x45fcef))__createBinding(_0x443ade,_0x59e1d6,_0x45fcef);}return __setModuleDefault(_0x443ade,_0x59e1d6),_0x443ade;},__importDefault=this&&this[a599_0x10b581(0x73)]||function(_0x3b9c78){const _0x59218a=a599_0x10b581;return _0x3b9c78&&_0x3b9c78[_0x59218a(0x9a)]?_0x3b9c78:{'default':_0x3b9c78};};Object[a599_0x10b581(0x7c)](exports,a599_0x10b581(0x9a),{'value':!![]}),exports[a599_0x10b581(0x77)]=exports[a599_0x10b581(0xc0)]=void 0x0;const path_1=__importDefault(require('path')),wbotMessageListener_1=require('./wbotMessageListener'),ShowDialogChatBotsServices_1=__importDefault(require(a599_0x10b581(0xca))),ShowQueueService_1=__importDefault(require(a599_0x10b581(0xc4))),ShowChatBotServices_1=__importDefault(require(a599_0x10b581(0xc1))),DeleteDialogChatBotsServices_1=__importDefault(require(a599_0x10b581(0xd2))),ShowChatBotByChatbotIdServices_1=__importDefault(require(a599_0x10b581(0x85))),CreateDialogChatBotsServices_1=__importDefault(require('../DialogChatBotsServices/CreateDialogChatBotsServices')),ShowWhatsAppService_1=__importDefault(require(a599_0x10b581(0x82))),Mustache_1=__importDefault(require(a599_0x10b581(0x75))),UpdateTicketService_1=__importDefault(require('../TicketServices/UpdateTicketService')),ShowService_1=__importDefault(require(a599_0x10b581(0xba))),SendWhatsAppMedia_1=__importStar(require('./SendWhatsAppMedia')),CompaniesSettings_1=__importDefault(require('../../models/CompaniesSettings')),fs=require('fs');var axios=require('axios');const isNumeric=_0x8abebc=>/^-?\d+$/[a599_0x10b581(0xc7)](_0x8abebc),deleteAndCreateDialogStage=async(_0x4a8f43,_0x356752,_0x35a4ef)=>{const _0x510c02=a599_0x10b581;try{await(0x0,DeleteDialogChatBotsServices_1['default'])(_0x4a8f43['id']);const _0x49f587=await(0x0,ShowChatBotByChatbotIdServices_1[_0x510c02(0xcb)])(_0x356752);return!_0x49f587&&await _0x35a4ef[_0x510c02(0xa7)]({'isBot':![]}),await(0x0,CreateDialogChatBotsServices_1[_0x510c02(0xcb)])({'awaiting':0x1,'contactId':_0x4a8f43['id'],'chatbotId':_0x356752,'queueId':_0x49f587['queueId']});}catch(_0x30fdb4){await _0x35a4ef[_0x510c02(0xa7)]({'isBot':![]});}};exports[a599_0x10b581(0xc0)]=deleteAndCreateDialogStage;const sendMessage=async(_0x39ff58,_0x5c4a1e,_0x3312b3,_0x4eb2c7)=>{const _0xb97828=a599_0x10b581,_0x53708e=await _0x39ff58[_0xb97828(0xd1)](_0x5c4a1e[_0xb97828(0xa9)]+'@'+(_0x3312b3['isGroup']?_0xb97828(0xdc):_0xb97828(0xbc)),{'text':(0x0,Mustache_1[_0xb97828(0xcb)])(_0x4eb2c7,_0x3312b3)});(0x0,wbotMessageListener_1[_0xb97828(0xc3)])(_0x53708e,_0x3312b3,_0x5c4a1e);},sendMessageLink=async(_0xd2cbd4,_0x43c351,_0x5793c7,_0x3c8034,_0x4d0d89)=>{const _0x7fe89f=a599_0x10b581;let _0x1b2b14;try{_0x1b2b14=await _0xd2cbd4[_0x7fe89f(0xd1)](_0x43c351[_0x7fe89f(0xa9)]+'@'+(_0x5793c7[_0x7fe89f(0xbb)]?_0x7fe89f(0xdc):'s.whatsapp.net'),{'document':_0x3c8034?{'url':_0x3c8034}:fs[_0x7fe89f(0xd9)]('public/temp/'+_0x4d0d89+'-'+makeid(0xa)),'fileName':_0x4d0d89,'mimetype':_0x7fe89f(0xab)});}catch(_0x137f77){_0x1b2b14=await _0xd2cbd4[_0x7fe89f(0xd1)](_0x43c351[_0x7fe89f(0xa9)]+'@'+(_0x5793c7[_0x7fe89f(0xbb)]?_0x7fe89f(0xdc):_0x7fe89f(0xbc)),{'text':(0x0,Mustache_1[_0x7fe89f(0xcb)])(_0x7fe89f(0x8e),_0x5793c7)});}(0x0,wbotMessageListener_1[_0x7fe89f(0xc3)])(_0x1b2b14,_0x5793c7,_0x43c351);},sendMessageImage=async(_0xcb1614,_0x2e2185,_0x180780,_0x441bbe,_0x3c6ff8)=>{const _0x41c918=a599_0x10b581;let _0x356efb;try{_0x356efb=await _0xcb1614['sendMessage'](_0x2e2185[_0x41c918(0xa9)]+'@'+(_0x180780['isGroup']?_0x41c918(0xdc):_0x41c918(0xbc)),{'image':_0x441bbe?{'url':_0x441bbe}:fs['readFileSync'](_0x41c918(0xa5)+_0x3c6ff8+'-'+makeid(0xa)),'fileName':_0x3c6ff8,'caption':_0x3c6ff8,'mimetype':_0x41c918(0xbf)});}catch(_0x25703d){_0x356efb=await _0xcb1614[_0x41c918(0xd1)](_0x2e2185['number']+'@'+(_0x180780[_0x41c918(0xbb)]?'g.us':'s.whatsapp.net'),{'text':(0x0,Mustache_1['default'])(_0x41c918(0xad),_0x180780)});}(0x0,wbotMessageListener_1[_0x41c918(0xc3)])(_0x356efb,_0x180780,_0x2e2185);},sendDialog=async(_0x7b8ca6,_0x48b234,_0x5a201d,_0xc8f69e)=>{const _0x44d68d=a599_0x10b581,_0x537014=await(0x0,ShowChatBotServices_1[_0x44d68d(0xcb)])(_0x7b8ca6['id']);if(_0x537014['options']){let _0x158757=_0xc8f69e[_0x44d68d(0x7a)];const _0x2e0f1b=await CompaniesSettings_1[_0x44d68d(0xcb)]['findOne']({'where':{'companyId':_0x158757}}),_0x466371=_0x2e0f1b?.['chatBotType']||_0x44d68d(0xdf),_0x285aad=async()=>{const _0x42028d=_0x44d68d;let _0x14cc24='';_0x537014[_0x42028d(0x74)][_0x42028d(0x99)]((_0xf7b2e5,_0xbd5a1a)=>{const _0x2aac44=_0x42028d;_0x14cc24+=_0x2aac44(0xb2)+(_0xbd5a1a+0x1)+_0x2aac44(0xd3)+_0xf7b2e5['name']+'\x0a';});const _0x4cb8ee=_0x14cc24[_0x42028d(0xe0)]>0x0?_0x14cc24+'\x0a*[\x20#\x20]*\x20Voltar\x20para\x20o\x20menu\x20principal\x0a*[\x20Sair\x20]*\x20Encerrar\x20atendimento':_0x14cc24+'\x0a*[\x20Sair\x20]*\x20Encerrar\x20atendimento';if(_0x14cc24['length']>0x0){const _0x5a449e='‎'+_0x7b8ca6[_0x42028d(0xde)]+'\x0a\x0a'+_0x4cb8ee,_0x35d7a3=await sendMessage(_0x48b234,_0x5a201d,_0xc8f69e,_0x5a449e);return _0x35d7a3;}const _0x1a2bc7='‎'+_0x7b8ca6[_0x42028d(0xde)],_0x391854=await sendMessage(_0x48b234,_0x5a201d,_0xc8f69e,_0x1a2bc7);return _0x391854;},_0x19ece9=async()=>{const _0x49f2f6=_0x44d68d,_0x1bb278=[];_0x537014[_0x49f2f6(0x74)][_0x49f2f6(0x99)]((_0x1f8265,_0x3894ab)=>{const _0x4d070a=_0x49f2f6;_0x1bb278[_0x4d070a(0xd7)]({'buttonId':''+(_0x3894ab+0x1),'buttonText':{'displayText':_0x1f8265[_0x4d070a(0xa1)]},'type':0x1});});if(_0x1bb278[_0x49f2f6(0xe0)]>0x0){const _0x20aaa3={'text':'‎'+_0x7b8ca6[_0x49f2f6(0xde)],'buttons':_0x1bb278,'headerType':0x1},_0x5b6f97=await _0x48b234[_0x49f2f6(0xd1)](_0x5a201d[_0x49f2f6(0xa9)]+'@'+(_0xc8f69e[_0x49f2f6(0xbb)]?_0x49f2f6(0xdc):_0x49f2f6(0xbc)),_0x20aaa3);return await(0x0,wbotMessageListener_1['verifyMessage'])(_0x5b6f97,_0xc8f69e,_0x5a201d),_0x5b6f97;}const _0x54d253='‎'+_0x7b8ca6['greetingMessage'],_0x586650=await sendMessage(_0x48b234,_0x5a201d,_0xc8f69e,_0x54d253);return _0x586650;},_0x253494=async()=>{const _0x1e17db=_0x44d68d,_0x2a7f9e=[];_0x537014['options']['forEach']((_0x56ce90,_0x539578)=>{const _0xf549d0=a599_0x4d6e;_0x2a7f9e[_0xf549d0(0xd7)]({'title':_0x56ce90[_0xf549d0(0xa1)],'rowId':''+(_0x539578+0x1)});});if(_0x2a7f9e[_0x1e17db(0xe0)]>0x0){const _0x4f8c26=[{'title':'Menu','rows':_0x2a7f9e}],_0x3491d5={'text':(0x0,Mustache_1[_0x1e17db(0xcb)])('‎'+_0x7b8ca6[_0x1e17db(0xde)],_0xc8f69e),'buttonText':_0x1e17db(0xb6),'sections':_0x4f8c26},_0x49d84e=await _0x48b234[_0x1e17db(0xd1)](_0x5a201d[_0x1e17db(0xa9)]+'@'+(_0xc8f69e[_0x1e17db(0xbb)]?_0x1e17db(0xdc):_0x1e17db(0xbc)),_0x3491d5);return await(0x0,wbotMessageListener_1[_0x1e17db(0xc3)])(_0x49d84e,_0xc8f69e,_0x5a201d),_0x49d84e;}const _0xd4fe54='‎'+_0x7b8ca6['greetingMessage'],_0x275e30=await sendMessage(_0x48b234,_0x5a201d,_0xc8f69e,_0xd4fe54);return _0x275e30;};if(_0x466371===_0x44d68d(0xdf))return await _0x285aad();if(_0x466371===_0x44d68d(0xa4)&&_0x537014[_0x44d68d(0x74)][_0x44d68d(0xe0)]>0x4)return await _0x285aad();if(_0x466371===_0x44d68d(0xa4)&&_0x537014[_0x44d68d(0x74)][_0x44d68d(0xe0)]<=0x4)return await _0x19ece9();if(_0x466371===_0x44d68d(0x7b))return await _0x253494();}},backToMainMenu=async(_0x4bdc82,_0x586b67,_0x48b362)=>{const _0x6a435d=a599_0x10b581;await(0x0,UpdateTicketService_1[_0x6a435d(0xcb)])({'ticketData':{'queueId':null,'userId':null},'ticketId':_0x48b362['id'],'companyId':_0x48b362[_0x6a435d(0x7a)]});const {queues:_0x29cbbd,greetingMessage:_0x17a767,greetingMediaAttachment:_0x1fe01a}=await(0x0,ShowWhatsAppService_1[_0x6a435d(0xcb)])(_0x4bdc82['id'],_0x48b362[_0x6a435d(0x7a)]),_0x55b1c5=await CompaniesSettings_1[_0x6a435d(0xcb)]['findOne']({'where':{'companyId':_0x48b362[_0x6a435d(0x7a)]}}),_0x2d5a01=async()=>{const _0x50f8bf=_0x6a435d;let _0x14b024='';_0x29cbbd[_0x50f8bf(0x99)]((_0x36b94d,_0x1f2a41)=>{const _0x2c380c=_0x50f8bf;_0x14b024+='*[\x20'+(_0x1f2a41+0x1)+'\x20]*\x20-\x20'+_0x36b94d[_0x2c380c(0xa1)]+'\x0a';}),_0x14b024+=_0x50f8bf(0xb0);const _0x1b4406=(0x0,Mustache_1[_0x50f8bf(0xcb)])('‎'+_0x17a767+'\x0a\x0a'+_0x14b024,_0x48b362);if(_0x1fe01a!==null){const _0x2964b1=path_1[_0x50f8bf(0xcb)][_0x50f8bf(0x98)]('public',_0x50f8bf(0xd8)+_0x48b362[_0x50f8bf(0x7a)],_0x48b362[_0x50f8bf(0xce)][_0x50f8bf(0xd6)]),_0x34161c=_0x48b362['whatsapp'][_0x50f8bf(0xd6)],_0x27d759=await(0x0,SendWhatsAppMedia_1[_0x50f8bf(0xd0)])(_0x34161c,_0x2964b1,String(_0x48b362[_0x50f8bf(0x7a)]),_0x1b4406),_0x248dbc=await _0x4bdc82[_0x50f8bf(0xd1)](_0x48b362[_0x50f8bf(0x90)][_0x50f8bf(0xa9)]+'@'+(_0x48b362[_0x50f8bf(0xbb)]?_0x50f8bf(0xdc):'s.whatsapp.net'),{..._0x27d759});await(0x0,wbotMessageListener_1[_0x50f8bf(0x94)])(_0x248dbc,_0x48b362,_0x586b67);}else await _0x4bdc82['sendMessage'](_0x586b67[_0x50f8bf(0xa9)]+'@'+(_0x48b362[_0x50f8bf(0xbb)]?_0x50f8bf(0xdc):_0x50f8bf(0xbc)),{'text':_0x1b4406});const _0x580579=await(0x0,DeleteDialogChatBotsServices_1['default'])(_0x586b67['id']);return _0x580579;};if(_0x55b1c5[_0x6a435d(0x70)]===_0x6a435d(0xdf))return _0x2d5a01();};function validaCpfCnpj(_0x3a384b){const _0x3cdad7=a599_0x10b581;if(_0x3a384b[_0x3cdad7(0xe0)]==0xb){var _0x21c498=_0x3a384b[_0x3cdad7(0x91)]();_0x21c498=_0x21c498[_0x3cdad7(0xaa)](/\./g,''),_0x21c498=_0x21c498[_0x3cdad7(0xaa)]('-',''),_0x21c498=_0x21c498['split']('');var _0x1e5391=0x0,_0x355501=0x0,_0x795232=![];for(var _0xab4759=0x1;_0x21c498[_0x3cdad7(0xe0)]>_0xab4759;_0xab4759++){_0x21c498[_0xab4759-0x1]!=_0x21c498[_0xab4759]&&(_0x795232=!![]);}if(_0x795232==![])return![];for(var _0xab4759=0x0,_0x11cf5c=0xa;_0x21c498[_0x3cdad7(0xe0)]-0x2>_0xab4759;_0xab4759++,_0x11cf5c--){_0x1e5391+=_0x21c498[_0xab4759]*_0x11cf5c;}_0x1e5391=_0x1e5391*0xa%0xb;_0x1e5391==0xa&&(_0x1e5391=0x0);if(_0x1e5391!=_0x21c498[0x9])return![];for(var _0xab4759=0x0,_0x11cf5c=0xb;_0x21c498[_0x3cdad7(0xe0)]-0x1>_0xab4759;_0xab4759++,_0x11cf5c--){_0x355501+=_0x21c498[_0xab4759]*_0x11cf5c;}return _0x355501=_0x355501*0xa%0xb,_0x355501==0xa&&(_0x355501=0x0),_0x355501!=_0x21c498[0xa]?![]:!![];}else{if(_0x3a384b['length']==0xe){var _0x35863a=_0x3a384b[_0x3cdad7(0x91)]();_0x35863a=_0x35863a[_0x3cdad7(0xaa)](/\./g,''),_0x35863a=_0x35863a['replace']('-',''),_0x35863a=_0x35863a[_0x3cdad7(0xaa)]('/',''),_0x35863a=_0x35863a[_0x3cdad7(0x7d)]('');var _0x1e5391=0x0,_0x355501=0x0,_0x795232=![];for(var _0xab4759=0x1;_0x35863a[_0x3cdad7(0xe0)]>_0xab4759;_0xab4759++){_0x35863a[_0xab4759-0x1]!=_0x35863a[_0xab4759]&&(_0x795232=!![]);}if(_0x795232==![])return![];for(var _0xab4759=0x0,_0x2f9d2a=0x5,_0x12a739=0xd;_0x35863a[_0x3cdad7(0xe0)]-0x2>_0xab4759;_0xab4759++,_0x2f9d2a--,_0x12a739--){_0x2f9d2a>=0x2?_0x1e5391+=_0x35863a[_0xab4759]*_0x2f9d2a:_0x1e5391+=_0x35863a[_0xab4759]*_0x12a739;}_0x1e5391=_0x1e5391%0xb;_0x1e5391<0x2?_0x1e5391=0x0:_0x1e5391=0xb-_0x1e5391;if(_0x1e5391!=_0x35863a[0xc])return![];for(var _0xab4759=0x0,_0x2f9d2a=0x6,_0x12a739=0xe;_0x35863a[_0x3cdad7(0xe0)]-0x1>_0xab4759;_0xab4759++,_0x2f9d2a--,_0x12a739--){_0x2f9d2a>=0x2?_0x355501+=_0x35863a[_0xab4759]*_0x2f9d2a:_0x355501+=_0x35863a[_0xab4759]*_0x12a739;}return _0x355501=_0x355501%0xb,_0x355501<0x2?_0x355501=0x0:_0x355501=0xb-_0x355501,_0x355501!=_0x35863a[0xd]?![]:!![];}else return![];}}function timeout(_0x59f566){return new Promise(_0xcfee33=>setTimeout(_0xcfee33,_0x59f566));}async function sleep(_0x539bc6){await timeout(_0x539bc6);}function firstDayOfMonth(_0x241b81){const _0x32a475=a599_0x10b581,_0x249863=new Date(),_0x442c99=new Date(_0x249863[_0x32a475(0x9f)](),_0x249863['getMonth']()-_0x241b81,0x1);return _0x442c99;}function a599_0x22f7(){const _0x4ca1ee=['localeCompare','__importDefault','options','../../helpers/Mustache','message','sayChatbot','getDate','closeTicket','companyId','list','defineProperty','split','selectedRowId','closed','fileList','pending','../WhatsappService/ShowWhatsAppService','151390CzqIrL','16604diBmIr','../ChatBotServices/ShowChatBotByChatbotIdServices','hasOwnProperty','86204LvEjTN','optUserId','attendent','file','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','chatbotId','7015525IDwoVa','‎Não\x20consegui\x20enviar\x20o\x20PDF,\x20tente\x20novamente!','12vhgSAq','contact','trim','__setModuleDefault','path','verifyMediaMessage','768uPgUOT','call','7bit','resolve','forEach','__esModule','354055UVUyMO','ticketId','userId','getOwnPropertyDescriptor','getFullYear','listResponseMessage','name','dueDate','singleSelectReply','button','public/temp/','toLocaleLowerCase','update','mediaType','number','replace','application/pdf','prototype','Não\x20consegui\x20enviar\x20o\x20PDF,\x20tente\x20novamente!','get','546648jkmHzg','\x0a*[\x20Sair\x20]*\x20-\x20Encerrar\x20Atendimento','entries','*[\x20','charAt','15KiFcDM','public','Escolha\x20uma\x20opção','buttonsResponseMessage','chatbots','126VcFbSv','../../services/FileServices/ShowService','isGroup','s.whatsapp.net','ticketData','medias','image/jpeg','deleteAndCreateDialogStage','../ChatBotServices/ShowChatBotServices','62162gTVmeN','verifyMessage','../QueueService/ShowQueueService','getMonth','random','test','create','toString','../DialogChatBotsServices/ShowDialogChatBotsServices','default','queue','optFileId','whatsapp','selectedButtonId','getMessageOptions','sendMessage','../DialogChatBotsServices/DeleteDialogChatBotsServices','\x20]*\x20-\x20','__importStar','substring','greetingMediaAttachment','push','company','readFileSync','optQueueId','__createBinding','g.us','integration','greetingMessage','text','length','fromMe','chatBotType','queueType'];a599_0x22f7=function(){return _0x4ca1ee;};return a599_0x22f7();};function lastDayOfMonth(_0x3cfda8){const _0x506dc9=a599_0x10b581,_0x4def90=new Date(),_0x59ee94=new Date(_0x4def90[_0x506dc9(0x9f)](),_0x4def90[_0x506dc9(0xc5)]()+_0x3cfda8,0x0);return _0x59ee94;};function dataAtualFormatada(_0x2272fa){const _0x5769c6=a599_0x10b581;var _0x124756=_0x2272fa[_0x5769c6(0x78)]()[_0x5769c6(0xc9)](),_0x28eeff=_0x124756[_0x5769c6(0xe0)]==0x1?'0'+_0x124756:_0x124756,_0x2fd886=(_0x2272fa[_0x5769c6(0xc5)]()+0x1)[_0x5769c6(0xc9)](),_0x43c0e7=_0x2fd886[_0x5769c6(0xe0)]==0x1?'0'+_0x2fd886:_0x2fd886,_0x130f9f=_0x2272fa[_0x5769c6(0x9f)]();return _0x28eeff+'/'+_0x43c0e7+'/'+_0x130f9f;}function makeid(_0x2925e7){const _0x566e79=a599_0x10b581;var _0x1687cd='',_0x508016=_0x566e79(0x8b),_0x294bb8=_0x508016[_0x566e79(0xe0)];for(var _0x14ab82=0x0;_0x14ab82<_0x2925e7;_0x14ab82++){_0x1687cd+=_0x508016[_0x566e79(0xb3)](Math['floor'](Math[_0x566e79(0xc6)]()*_0x294bb8));}return _0x1687cd;}function replaceAll(_0x228c27,_0x3fcc00,_0x4e2ee4){const _0x56dba6=a599_0x10b581;return _0x228c27[_0x56dba6(0xaa)](new RegExp(_0x3fcc00,'g'),_0x4e2ee4);}function formatDate(_0xaf65d4){const _0x403083=a599_0x10b581;return _0xaf65d4[_0x403083(0xd5)](0x8,0xa)+'/'+_0xaf65d4[_0x403083(0xd5)](0x5,0x7)+'/'+_0xaf65d4[_0x403083(0xd5)](0x0,0x4);}function sortfunction(_0x309835,_0x3804c2){const _0x3888e7=a599_0x10b581;return _0x309835[_0x3888e7(0xa2)][_0x3888e7(0x72)](_0x3804c2[_0x3888e7(0xa2)]);}async function sendMsgAndCloseTicket(_0x31534f,_0x535ecf,_0x4e1b42){const _0x10a8ae=a599_0x10b581,_0xbf3317={'ticketData':{'status':_0x10a8ae(0x7f),'userId':_0x4e1b42?.[_0x10a8ae(0x9d)]||null,'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'ticketId':_0x4e1b42['id'],'companyId':_0x4e1b42[_0x10a8ae(0x7a)]};await sleep(0x7d0),await(0x0,UpdateTicketService_1[_0x10a8ae(0xcb)])(_0xbf3317);}const sayChatbot=async(_0x5d67d6,_0x43bb37,_0x476e00,_0x142aa1,_0x2defe1)=>{const _0x12b9ab=a599_0x10b581,_0x5f194c=_0x2defe1?.[_0x12b9ab(0x76)]?.[_0x12b9ab(0xb7)]?.[_0x12b9ab(0xcf)]||_0x2defe1?.[_0x12b9ab(0x76)]?.[_0x12b9ab(0xa0)]?.[_0x12b9ab(0xa3)]['selectedRowId']||(0x0,wbotMessageListener_1['getBodyMessage'])(_0x2defe1);if(!_0x5d67d6&&_0x5f194c&&_0x2defe1['key'][_0x12b9ab(0x6f)])return;const _0x2c7d6e=await(0x0,ShowDialogChatBotsServices_1[_0x12b9ab(0xcb)])(_0x142aa1['id']);if(_0x5f194c[_0x12b9ab(0xa6)]()==='sair'){const _0x134511={'ticketData':{'status':_0x12b9ab(0x7f),'sendFarewellMessage':!![],'amountUsedBotQueues':0x0},'ticketId':_0x476e00['id'],'companyId':_0x476e00[_0x12b9ab(0x7a)]};await(0x0,UpdateTicketService_1[_0x12b9ab(0xcb)])(_0x134511);return;}if(_0x5f194c==='#'){const _0x5f03ba=await backToMainMenu(_0x43bb37,_0x142aa1,_0x476e00);return;}if(!_0x2c7d6e){const _0x3edcf4=await(0x0,ShowQueueService_1[_0x12b9ab(0xcb)])(_0x5d67d6,_0x476e00['companyId']),_0x1ce71a=_0x2defe1?.[_0x12b9ab(0x76)]?.[_0x12b9ab(0xb7)]?.[_0x12b9ab(0xcf)]||_0x2defe1?.[_0x12b9ab(0x76)]?.['listResponseMessage']?.['singleSelectReply'][_0x12b9ab(0x7e)]||(0x0,wbotMessageListener_1['getBodyMessage'])(_0x2defe1),_0xf10900=_0x3edcf4[_0x12b9ab(0xb8)][+_0x1ce71a-0x1];if(_0xf10900){if(_0xf10900['queueType']==='integration')try{const _0x58ddf1={'ticketData':{'integrationId':_0xf10900['optIntegrationId'],'useIntegration':!![],'status':_0x12b9ab(0x81)},'ticketId':_0x476e00['id']};await(0x0,UpdateTicketService_1[_0x12b9ab(0xcb)])({'ticketData':{..._0x58ddf1['ticketData']},'ticketId':_0x58ddf1[_0x12b9ab(0x9c)],'companyId':_0x476e00[_0x12b9ab(0x7a)]});}catch(_0x59b65f){await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0xf10900['id'],_0x476e00);}else{if(_0xf10900[_0x12b9ab(0x71)]===_0x12b9ab(0xcc))try{const _0x56fdf8={'ticketData':{'queueId':_0xf10900[_0x12b9ab(0xda)],'status':_0x12b9ab(0x81)},'ticketId':_0x476e00['id']};await(0x0,UpdateTicketService_1[_0x12b9ab(0xcb)])({'ticketData':{..._0x56fdf8[_0x12b9ab(0xbd)]},'ticketId':_0x56fdf8['ticketId'],'companyId':_0x476e00[_0x12b9ab(0x7a)]});}catch(_0x5255ef){await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0xf10900['id'],_0x476e00);}else{if(_0xf10900[_0x12b9ab(0x71)]===_0x12b9ab(0x89))try{const _0x5acc77={'ticketData':{'queueId':_0xf10900[_0x12b9ab(0xda)],'userId':_0xf10900[_0x12b9ab(0x88)],'status':_0x12b9ab(0x81)},'ticketId':_0x476e00['id']};await(0x0,UpdateTicketService_1[_0x12b9ab(0xcb)])({'ticketData':{..._0x5acc77['ticketData']},'ticketId':_0x5acc77[_0x12b9ab(0x9c)],'companyId':_0x476e00[_0x12b9ab(0x7a)]});}catch(_0x28b2d5){await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0xf10900['id'],_0x476e00);}}}await(0x0,exports['deleteAndCreateDialogStage'])(_0x142aa1,_0xf10900['id'],_0x476e00);let _0x34d391;_0xf10900?.[_0x12b9ab(0xde)]&&(_0x34d391=await sendDialog(_0xf10900,_0x43bb37,_0x142aa1,_0x476e00));if(_0xf10900[_0x12b9ab(0x71)]===_0x12b9ab(0x8a))try{const _0x301be5=path_1[_0x12b9ab(0xcb)][_0x12b9ab(0x98)](__dirname,'..','..','..',_0x12b9ab(0xb5)),_0x3c13a5=await(0x0,ShowService_1['default'])(_0xf10900[_0x12b9ab(0xcd)],_0x476e00[_0x12b9ab(0x7a)]),_0x26563b=path_1[_0x12b9ab(0xcb)][_0x12b9ab(0x98)](_0x301be5,_0x12b9ab(0xd8)+_0x476e00['companyId'],_0x12b9ab(0x80),String(_0x3c13a5['id']));for(const [_0x38eafa,_0x3c1711]of _0x3c13a5[_0x12b9ab(0x74)][_0x12b9ab(0xb1)]()){const _0x24f13c={'fieldname':_0x12b9ab(0xbe),'originalname':_0x3c1711[_0x12b9ab(0x93)],'encoding':_0x12b9ab(0x97),'mimetype':_0x3c1711['mediaType'],'filename':_0x3c1711[_0x12b9ab(0x93)],'path':path_1['default'][_0x12b9ab(0x98)](_0x26563b,_0x3c1711[_0x12b9ab(0x93)])};await(0x0,SendWhatsAppMedia_1[_0x12b9ab(0xcb)])({'media':_0x24f13c,'ticket':_0x476e00,'body':_0x3c1711[_0x12b9ab(0xa1)],'isForwarded':![]});};}catch(_0x40df86){await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0xf10900['id'],_0x476e00);}return _0xf10900['closeTicket']&&await sendMsgAndCloseTicket(_0x43bb37,_0x476e00['contact'],_0x476e00),_0x34d391;}}if(_0x2c7d6e){const _0x4bb73a=isNumeric(_0x5f194c)?_0x5f194c:0x1,_0x27bcae=await(0x0,ShowChatBotServices_1[_0x12b9ab(0xcb)])(_0x2c7d6e[_0x12b9ab(0x8c)]),_0x30ec45=_0x27bcae[_0x12b9ab(0x74)][+_0x4bb73a-0x1]?_0x27bcae['options'][+_0x4bb73a-0x1]:_0x27bcae[_0x12b9ab(0x74)][0x0];if(!_0x30ec45[_0x12b9ab(0xde)]){await(0x0,DeleteDialogChatBotsServices_1[_0x12b9ab(0xcb)])(_0x142aa1['id']);return;}if(_0x30ec45){if(_0x30ec45[_0x12b9ab(0x71)]===_0x12b9ab(0xdd))try{const _0x3134e8={'ticketData':{'integrationId':_0x30ec45['optIntegrationId'],'useIntegration':!![],'status':_0x12b9ab(0x81)},'ticketId':_0x476e00['id']};await(0x0,UpdateTicketService_1['default'])({'ticketData':{..._0x3134e8[_0x12b9ab(0xbd)]},'ticketId':_0x3134e8['ticketId'],'companyId':_0x476e00[_0x12b9ab(0x7a)]});}catch(_0x170a1a){await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0x30ec45['id'],_0x476e00);}else{if(_0x30ec45[_0x12b9ab(0x71)]==='queue')try{const _0x1da3e4={'ticketData':{'queueId':_0x30ec45[_0x12b9ab(0xda)],'status':_0x12b9ab(0x81)},'ticketId':_0x476e00['id']};await(0x0,UpdateTicketService_1[_0x12b9ab(0xcb)])({'ticketData':{..._0x1da3e4['ticketData']},'ticketId':_0x1da3e4[_0x12b9ab(0x9c)],'companyId':_0x476e00['companyId']});}catch(_0x198a5b){await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0x30ec45['id'],_0x476e00);}else{if(_0x30ec45[_0x12b9ab(0x71)]===_0x12b9ab(0x89))try{const _0x54eaa9={'ticketData':{'queueId':_0x30ec45[_0x12b9ab(0xda)],'userId':_0x30ec45['optUserId'],'status':'pending'},'ticketId':_0x476e00['id']};await(0x0,UpdateTicketService_1['default'])({'ticketData':{..._0x54eaa9['ticketData']},'ticketId':_0x54eaa9[_0x12b9ab(0x9c)],'companyId':_0x476e00[_0x12b9ab(0x7a)]});}catch(_0x4e55f8){await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0x30ec45['id'],_0x476e00);}}}await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0x30ec45['id'],_0x476e00);if(_0x30ec45[_0x12b9ab(0x71)]==='file')try{const _0x471f60=path_1[_0x12b9ab(0xcb)]['resolve'](__dirname,'..','..','..','public'),_0x36add1=await(0x0,ShowService_1['default'])(_0x30ec45[_0x12b9ab(0xcd)],_0x476e00[_0x12b9ab(0x7a)]),_0x492588=path_1[_0x12b9ab(0xcb)]['resolve'](_0x471f60,_0x12b9ab(0xd8)+_0x476e00['companyId'],_0x12b9ab(0x80),String(_0x36add1['id']));for(const [_0x454ef4,_0x16846b]of _0x36add1['options'][_0x12b9ab(0xb1)]()){const _0x51935e={'fieldname':_0x12b9ab(0xbe),'originalname':_0x16846b[_0x12b9ab(0x93)],'encoding':_0x12b9ab(0x97),'mimetype':_0x16846b[_0x12b9ab(0xa8)],'filename':_0x16846b[_0x12b9ab(0x93)],'path':path_1[_0x12b9ab(0xcb)]['resolve'](_0x492588,_0x16846b[_0x12b9ab(0x93)])};await(0x0,SendWhatsAppMedia_1[_0x12b9ab(0xcb)])({'media':_0x51935e,'ticket':_0x476e00,'body':_0x16846b[_0x12b9ab(0xa1)],'isForwarded':![]});};}catch(_0x397876){await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0x30ec45['id'],_0x476e00);}_0x30ec45[_0x12b9ab(0x79)]&&await sendMsgAndCloseTicket(_0x43bb37,_0x476e00[_0x12b9ab(0x90)],_0x476e00);await(0x0,exports[_0x12b9ab(0xc0)])(_0x142aa1,_0x30ec45['id'],_0x476e00);const _0x182391=await sendDialog(_0x30ec45,_0x43bb37,_0x142aa1,_0x476e00);return _0x182391;}}};exports['sayChatbot']=sayChatbot;
>>>>>>> ab722bfbcf394d74dd0b99a984c0dcf6ffbcff7f
