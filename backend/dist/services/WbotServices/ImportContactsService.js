'use strict';function a617_0x2edd(_0x14ba57,_0x3c924d){const _0x389709=a617_0x3897();return a617_0x2edd=function(_0x2eddfb,_0x39683c){_0x2eddfb=_0x2eddfb-0x93;let _0x514821=_0x389709[_0x2eddfb];return _0x514821;},a617_0x2edd(_0x14ba57,_0x3c924d);}const a617_0x5e7da1=a617_0x2edd;(function(_0x442b5d,_0x397e6a){const _0x3f604c=a617_0x2edd,_0x39af30=_0x442b5d();while(!![]){try{const _0x4fc432=parseInt(_0x3f604c(0x98))/0x1+parseInt(_0x3f604c(0xa7))/0x2*(-parseInt(_0x3f604c(0xa2))/0x3)+-parseInt(_0x3f604c(0x9b))/0x4+parseInt(_0x3f604c(0xb0))/0x5+parseInt(_0x3f604c(0xaf))/0x6*(-parseInt(_0x3f604c(0xa3))/0x7)+-parseInt(_0x3f604c(0xa5))/0x8+parseInt(_0x3f604c(0xa8))/0x9;if(_0x4fc432===_0x397e6a)break;else _0x39af30['push'](_0x39af30['shift']());}catch(_0x43a526){_0x39af30['push'](_0x39af30['shift']());}}}(a617_0x3897,0xaa056));function a617_0x3897(){const _0x4f1491=['path','replace','../../libs/wbot','Failed\x20to\x20write\x20contacts\x20to\x20file:\x20','get','__setModuleDefault','captureException','hasOwnProperty','contacts','parse','join','defineProperty','warn','configurable','../../models/Contact','../ContactServices/CreateContactService','findOne','writable','1000443VOioKW','__esModule','default','4486716gpgunW','writeFile','__importStar','../../helpers/GetDefaultWhatsApp','resolve','getWbot','stringify','1809xOwpYs','4036193xOpBcs','create','7581936rcZtFi','../../utils/logger','1942MTEFwn','20503494IqHLAj','prototype','forEach','Could\x20not\x20get\x20whatsapp\x20contacts\x20from\x20phone.\x20Err:\x20','includes','error','logger','6eoYGMo','3246650nCqWKJ','save','getOwnPropertyDescriptor','public','__importDefault','../BaileysServices/ShowBaileysService','g.us','isString'];a617_0x3897=function(){return _0x4f1491;};return a617_0x3897();}var __createBinding=this&&this['__createBinding']||(Object[a617_0x5e7da1(0xa4)]?function(_0xb605f4,_0x2efec5,_0x1155cd,_0x5d9b3d){const _0x384305=a617_0x5e7da1;if(_0x5d9b3d===undefined)_0x5d9b3d=_0x1155cd;var _0x1c611b=Object[_0x384305(0xb2)](_0x2efec5,_0x1155cd);(!_0x1c611b||(_0x384305(0xbc)in _0x1c611b?!_0x2efec5[_0x384305(0x99)]:_0x1c611b[_0x384305(0x97)]||_0x1c611b[_0x384305(0x93)]))&&(_0x1c611b={'enumerable':!![],'get':function(){return _0x2efec5[_0x1155cd];}}),Object[_0x384305(0xc3)](_0xb605f4,_0x5d9b3d,_0x1c611b);}:function(_0x92c97f,_0x489740,_0x2c2144,_0x16318c){if(_0x16318c===undefined)_0x16318c=_0x2c2144;_0x92c97f[_0x16318c]=_0x489740[_0x2c2144];}),__setModuleDefault=this&&this[a617_0x5e7da1(0xbd)]||(Object[a617_0x5e7da1(0xa4)]?function(_0x4fe220,_0x32f53c){const _0x3c8e49=a617_0x5e7da1;Object[_0x3c8e49(0xc3)](_0x4fe220,_0x3c8e49(0x9a),{'enumerable':!![],'value':_0x32f53c});}:function(_0x2cd480,_0x52e932){const _0x1267bf=a617_0x5e7da1;_0x2cd480[_0x1267bf(0x9a)]=_0x52e932;}),__importStar=this&&this[a617_0x5e7da1(0x9d)]||function(_0x3c4677){const _0x5a7fdc=a617_0x5e7da1;if(_0x3c4677&&_0x3c4677['__esModule'])return _0x3c4677;var _0x398b21={};if(_0x3c4677!=null){for(var _0x39da3b in _0x3c4677)if(_0x39da3b!==_0x5a7fdc(0x9a)&&Object[_0x5a7fdc(0xa9)][_0x5a7fdc(0xbf)]['call'](_0x3c4677,_0x39da3b))__createBinding(_0x398b21,_0x3c4677,_0x39da3b);}return __setModuleDefault(_0x398b21,_0x3c4677),_0x398b21;},__importDefault=this&&this[a617_0x5e7da1(0xb4)]||function(_0x4ef76f){const _0x414a3b=a617_0x5e7da1;return _0x4ef76f&&_0x4ef76f[_0x414a3b(0x99)]?_0x4ef76f:{'default':_0x4ef76f};};Object[a617_0x5e7da1(0xc3)](exports,'__esModule',{'value':!![]});const Sentry=__importStar(require('@sentry/node')),GetDefaultWhatsApp_1=__importDefault(require(a617_0x5e7da1(0x9e))),wbot_1=require(a617_0x5e7da1(0xba)),Contact_1=__importDefault(require(a617_0x5e7da1(0x94))),logger_1=require(a617_0x5e7da1(0xa6)),ShowBaileysService_1=__importDefault(require(a617_0x5e7da1(0xb5))),CreateContactService_1=__importDefault(require(a617_0x5e7da1(0x95))),lodash_1=require('lodash'),path_1=__importDefault(require(a617_0x5e7da1(0xb8))),fs_1=__importDefault(require('fs')),ImportContactsService=async _0x380573=>{const _0x9bf08d=a617_0x5e7da1,_0x49a5f9=await(0x0,GetDefaultWhatsApp_1[_0x9bf08d(0x9a)])(_0x380573),_0x5447e0=(0x0,wbot_1[_0x9bf08d(0xa0)])(_0x49a5f9['id']);let _0xba6c6c;try{const _0x207357=await(0x0,ShowBaileysService_1[_0x9bf08d(0x9a)])(_0x5447e0['id']);_0xba6c6c=JSON[_0x9bf08d(0xc1)](JSON[_0x9bf08d(0xa1)](_0x207357[_0x9bf08d(0xc0)]));const _0x341cef=path_1[_0x9bf08d(0x9a)]['resolve'](__dirname,'..','..','..',_0x9bf08d(0xb3)),_0xb0787d=path_1[_0x9bf08d(0x9a)][_0x9bf08d(0xc2)](_0x341cef,'company'+_0x380573,'contatos_antes.txt');fs_1[_0x9bf08d(0x9a)][_0x9bf08d(0x9c)](_0xb0787d,JSON[_0x9bf08d(0xa1)](_0xba6c6c,null,0x2),_0x31f459=>{const _0x151537=_0x9bf08d;if(_0x31f459){logger_1['logger'][_0x151537(0xad)](_0x151537(0xbb)+_0x31f459);throw _0x31f459;}});}catch(_0x1f25f8){Sentry[_0x9bf08d(0xbe)](_0x1f25f8),logger_1[_0x9bf08d(0xae)]['error'](_0x9bf08d(0xab)+_0x1f25f8);}const _0x31af87=path_1[_0x9bf08d(0x9a)][_0x9bf08d(0x9f)](__dirname,'..','..','..',_0x9bf08d(0xb3)),_0x4e8aa7=path_1['default']['join'](_0x31af87,'company'+_0x380573,'contatos_depois.txt');fs_1['default']['writeFile'](_0x4e8aa7,JSON[_0x9bf08d(0xa1)](_0xba6c6c,null,0x2),_0x29a3c5=>{const _0xd42ff4=_0x9bf08d;if(_0x29a3c5){logger_1[_0xd42ff4(0xae)]['error'](_0xd42ff4(0xbb)+_0x29a3c5);throw _0x29a3c5;}});const _0x57e826=(0x0,lodash_1[_0x9bf08d(0xb7)])(_0xba6c6c)?JSON[_0x9bf08d(0xc1)](_0xba6c6c):_0xba6c6c;(0x0,lodash_1['isArray'])(_0x57e826)&&_0x57e826[_0x9bf08d(0xaa)](async({id:_0x38925c,name:_0x5b6483,notify:_0x5286d5})=>{const _0x367985=_0x9bf08d;if(_0x38925c==='status@broadcast'||_0x38925c[_0x367985(0xac)](_0x367985(0xb6)))return;const _0x5a78d1=_0x38925c[_0x367985(0xb9)](/\D/g,''),_0x1e7799=await Contact_1[_0x367985(0x9a)][_0x367985(0x96)]({'where':{'number':_0x5a78d1,'companyId':_0x380573}});if(_0x1e7799)_0x1e7799['name']=_0x5b6483||_0x5286d5,await _0x1e7799[_0x367985(0xb1)]();else try{await(0x0,CreateContactService_1['default'])({'number':_0x5a78d1,'name':_0x5b6483||_0x5286d5,'companyId':_0x380573});}catch(_0x22a9aa){Sentry[_0x367985(0xbe)](_0x22a9aa),logger_1['logger'][_0x367985(0xc4)](_0x367985(0xab)+_0x22a9aa);}});};exports[a617_0x5e7da1(0x9a)]=ImportContactsService;