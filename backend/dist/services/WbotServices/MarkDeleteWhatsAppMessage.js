'use strict';const a626_0x41221b=a626_0x386c;(function(_0x2d1062,_0x500802){const _0x17ff8c=a626_0x386c,_0x5aa428=_0x2d1062();while(!![]){try{const _0x1a2216=-parseInt(_0x17ff8c(0x171))/0x1+-parseInt(_0x17ff8c(0x16b))/0x2*(-parseInt(_0x17ff8c(0x161))/0x3)+parseInt(_0x17ff8c(0x16e))/0x4+parseInt(_0x17ff8c(0x176))/0x5*(parseInt(_0x17ff8c(0x17d))/0x6)+parseInt(_0x17ff8c(0x163))/0x7+parseInt(_0x17ff8c(0x16f))/0x8+-parseInt(_0x17ff8c(0x168))/0x9;if(_0x1a2216===_0x500802)break;else _0x5aa428['push'](_0x5aa428['shift']());}catch(_0x502145){_0x5aa428['push'](_0x5aa428['shift']());}}}(a626_0x32b3,0xce679));function a626_0x386c(_0x327b84,_0x5526e5){const _0x32b3db=a626_0x32b3();return a626_0x386c=function(_0x386cf8,_0x56425a){_0x386cf8=_0x386cf8-0x161;let _0x1e71b9=_0x32b3db[_0x386cf8];return _0x1e71b9;},a626_0x386c(_0x327b84,_0x5526e5);}var __importDefault=this&&this[a626_0x41221b(0x17e)]||function(_0x4e4524){const _0x48c743=a626_0x41221b;return _0x4e4524&&_0x4e4524[_0x48c743(0x175)]?_0x4e4524:{'default':_0x4e4524};};function a626_0x32b3(){const _0x2d2f7a=['Erro\x20ao\x20tentar\x20marcar\x20a\x20mensagem\x20com\x20excluÃ­da','887556eQjaWU','defineProperty','105280HVVELN','ðŸš«\x20_Mensagem\x20Apagada_','emit','findAll','../TicketServices/UpdateTicketService','20375685opvrid','update','enabled','6QpUBsV','quotedMsg','replace','2316956vuzRLZ','12762384KnMuxX','findOne','1598159JxABip','@s.whatsapp.net','contact','toString','__esModule','5vRTVzI','wid','lgpdDeleteMessage','appMessage-','default','../../models/Ticket','../../models/CompaniesSettings','9782544VagbhA','__importDefault','ticketId','../../models/Message'];a626_0x32b3=function(){return _0x2d2f7a;};return a626_0x32b3();}Object[a626_0x41221b(0x162)](exports,a626_0x41221b(0x175),{'value':!![]});const Message_1=__importDefault(require(a626_0x41221b(0x180))),socket_1=require('../../libs/socket'),Ticket_1=__importDefault(require(a626_0x41221b(0x17b))),UpdateTicketService_1=__importDefault(require(a626_0x41221b(0x167))),CompaniesSettings_1=__importDefault(require(a626_0x41221b(0x17c))),MarkDeleteWhatsAppMessage=async(_0x527c25,_0x57cf91,_0x38df6e,_0x379be3)=>{const _0x1640d2=a626_0x41221b;_0x527c25=_0x527c25[_0x1640d2(0x16d)]('@c.us','')[_0x1640d2(0x16d)](_0x1640d2(0x172),'');if(_0x38df6e){const _0x2461f4=await Message_1[_0x1640d2(0x17a)][_0x1640d2(0x166)]({'where':{'wid':_0x38df6e,'companyId':_0x379be3}});try{const _0x3a8d36=await Message_1[_0x1640d2(0x17a)][_0x1640d2(0x170)]({'where':{'wid':_0x2461f4[0x0][_0x1640d2(0x177)]},'include':['contact',{'model':Message_1[_0x1640d2(0x17a)],'as':_0x1640d2(0x16c),'include':[_0x1640d2(0x173)]}]});if(_0x3a8d36){const _0x18b7ed=await CompaniesSettings_1[_0x1640d2(0x17a)][_0x1640d2(0x170)]({'where':{'companyId':_0x379be3}}),_0x3d1d23=await Ticket_1[_0x1640d2(0x17a)][_0x1640d2(0x170)]({'where':{'id':_0x3a8d36[_0x1640d2(0x17f)],'companyId':_0x379be3}});_0x18b7ed[_0x1640d2(0x178)]==='enabled'&&_0x18b7ed['enableLGPD']===_0x1640d2(0x16a)?await _0x3a8d36[_0x1640d2(0x169)]({'body':'ðŸš«\x20_Mensagem\x20Apagada_','isDeleted':!![]}):await _0x3a8d36[_0x1640d2(0x169)]({'isDeleted':!![]});await(0x0,UpdateTicketService_1[_0x1640d2(0x17a)])({'ticketData':{'lastMessage':_0x1640d2(0x164)},'ticketId':_0x3d1d23['id'],'companyId':_0x379be3});const _0x4f8d58=(0x0,socket_1['getIO'])();_0x4f8d58['to'](_0x3a8d36[_0x1640d2(0x17f)][_0x1640d2(0x174)]())[_0x1640d2(0x165)](_0x1640d2(0x179)+_0x3a8d36,{'action':'update','message':_0x3a8d36});}}catch(_0x2a4717){console['log'](_0x1640d2(0x181));}return _0x57cf91;};};exports['default']=MarkDeleteWhatsAppMessage;