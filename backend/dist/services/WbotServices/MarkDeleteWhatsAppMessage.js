'use strict';const a618_0x1b2e41=a618_0x25e3;function a618_0x25e3(_0x18a9cb,_0x100b4e){const _0xb55413=a618_0xb554();return a618_0x25e3=function(_0x25e319,_0x10981f){_0x25e319=_0x25e319-0x12e;let _0x4989ce=_0xb55413[_0x25e319];return _0x4989ce;},a618_0x25e3(_0x18a9cb,_0x100b4e);}function a618_0xb554(){const _0x5ab684=['../../libs/socket','../../models/Ticket','204PNMLQf','3593313pWfTrT','findOne','update','1410370rBQgNS','defineProperty','16UnfLfl','../TicketServices/UpdateTicketService','__esModule','enabled','164bmRIKY','appMessage-','enableLGPD','43585EBWyDd','391649xtFEdM','../../models/Message','lgpdDeleteMessage','log','emit','replace','toString','132704LpPFka','Erro\x20ao\x20tentar\x20marcar\x20a\x20mensagem\x20com\x20excluÃ­da','@c.us','ticketId','5427562kmgYoR','contact','default','2570rymCLU','ðŸš«\x20_Mensagem\x20Apagada_','23367jKdTam','__importDefault','quotedMsg'];a618_0xb554=function(){return _0x5ab684;};return a618_0xb554();}(function(_0x3e3158,_0x1e0e81){const _0x5638d9=a618_0x25e3,_0x53cf07=_0x3e3158();while(!![]){try{const _0x21f0e0=-parseInt(_0x5638d9(0x150))/0x1+-parseInt(_0x5638d9(0x146))/0x2+-parseInt(_0x5638d9(0x13d))/0x3*(parseInt(_0x5638d9(0x14c))/0x4)+-parseInt(_0x5638d9(0x14f))/0x5*(-parseInt(_0x5638d9(0x142))/0x6)+-parseInt(_0x5638d9(0x138))/0x7+parseInt(_0x5638d9(0x148))/0x8*(-parseInt(_0x5638d9(0x143))/0x9)+-parseInt(_0x5638d9(0x13b))/0xa*(-parseInt(_0x5638d9(0x134))/0xb);if(_0x21f0e0===_0x1e0e81)break;else _0x53cf07['push'](_0x53cf07['shift']());}catch(_0x290bd3){_0x53cf07['push'](_0x53cf07['shift']());}}}(a618_0xb554,0x634eb));var __importDefault=this&&this[a618_0x1b2e41(0x13e)]||function(_0x15fb95){return _0x15fb95&&_0x15fb95['__esModule']?_0x15fb95:{'default':_0x15fb95};};Object[a618_0x1b2e41(0x147)](exports,a618_0x1b2e41(0x14a),{'value':!![]});const Message_1=__importDefault(require(a618_0x1b2e41(0x12e))),socket_1=require(a618_0x1b2e41(0x140)),Ticket_1=__importDefault(require(a618_0x1b2e41(0x141))),UpdateTicketService_1=__importDefault(require(a618_0x1b2e41(0x149))),CompaniesSettings_1=__importDefault(require('../../models/CompaniesSettings')),MarkDeleteWhatsAppMessage=async(_0x1ca8c8,_0x31ece0,_0x47872e,_0x5e532e)=>{const _0x29acca=a618_0x1b2e41;_0x1ca8c8=_0x1ca8c8[_0x29acca(0x132)](_0x29acca(0x136),'')[_0x29acca(0x132)]('@s.whatsapp.net','');if(_0x47872e){const _0x3882fe=await Message_1[_0x29acca(0x13a)]['findAll']({'where':{'wid':_0x47872e,'companyId':_0x5e532e}});try{const _0x3e75da=await Message_1[_0x29acca(0x13a)][_0x29acca(0x144)]({'where':{'wid':_0x3882fe[0x0]['wid']},'include':['contact',{'model':Message_1[_0x29acca(0x13a)],'as':_0x29acca(0x13f),'include':[_0x29acca(0x139)]}]});if(_0x3e75da){const _0x532251=await CompaniesSettings_1[_0x29acca(0x13a)][_0x29acca(0x144)]({'where':{'companyId':_0x5e532e}}),_0x279793=await Ticket_1[_0x29acca(0x13a)][_0x29acca(0x144)]({'where':{'id':_0x3e75da[_0x29acca(0x137)],'companyId':_0x5e532e}});_0x532251[_0x29acca(0x12f)]===_0x29acca(0x14b)&&_0x532251[_0x29acca(0x14e)]===_0x29acca(0x14b)?await _0x3e75da[_0x29acca(0x145)]({'body':'ðŸš«\x20_Mensagem\x20Apagada_','isDeleted':!![]}):await _0x3e75da[_0x29acca(0x145)]({'isDeleted':!![]});await(0x0,UpdateTicketService_1[_0x29acca(0x13a)])({'ticketData':{'lastMessage':_0x29acca(0x13c)},'ticketId':_0x279793['id'],'companyId':_0x5e532e});const _0x3c8bab=(0x0,socket_1['getIO'])();_0x3c8bab['to'](_0x3e75da[_0x29acca(0x137)][_0x29acca(0x133)]())[_0x29acca(0x131)](_0x29acca(0x14d)+_0x3e75da,{'action':_0x29acca(0x145),'message':_0x3e75da});}}catch(_0x160533){console[_0x29acca(0x130)](_0x29acca(0x135));}return _0x31ece0;};};exports[a618_0x1b2e41(0x13a)]=MarkDeleteWhatsAppMessage;