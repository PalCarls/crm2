'use strict';const a516_0x2088d1=a516_0x33c6;(function(_0x17ad15,_0x243f23){const _0x314516=a516_0x33c6,_0x5e7b67=_0x17ad15();while(!![]){try{const _0x519607=-parseInt(_0x314516(0x1db))/0x1+-parseInt(_0x314516(0x1d9))/0x2+-parseInt(_0x314516(0x1d3))/0x3*(-parseInt(_0x314516(0x1cf))/0x4)+parseInt(_0x314516(0x1cc))/0x5+parseInt(_0x314516(0x1da))/0x6*(parseInt(_0x314516(0x1dd))/0x7)+-parseInt(_0x314516(0x1e1))/0x8*(parseInt(_0x314516(0x1d2))/0x9)+parseInt(_0x314516(0x1e3))/0xa;if(_0x519607===_0x243f23)break;else _0x5e7b67['push'](_0x5e7b67['shift']());}catch(_0x33ea27){_0x5e7b67['push'](_0x5e7b67['shift']());}}}(a516_0x3d4c,0xdd06a));var __importDefault=this&&this[a516_0x2088d1(0x1d4)]||function(_0x4e318b){return _0x4e318b&&_0x4e318b['__esModule']?_0x4e318b:{'default':_0x4e318b};};function a516_0x3d4c(){const _0x567164=['status','../../libs/socket','2295000JItrWB','emit','update','20XsZsFQ','-ticket','ERR_CREATING_TICKET','2055807ZjaaHe','865929EwdSQf','__importDefault','../ContactServices/ShowContactService','log','../WhatsappService/ShowWhatsAppService','../../helpers/GetDefaultWhatsAppByUser','3576336LmNeYd','114INNqaZ','689538oOSkFw','defineProperty','184709wgKAFV','getIO','../../helpers/CheckContactOpenTickets','default','40VCHGlN','group','21215750KKRpTb','contact'];a516_0x3d4c=function(){return _0x567164;};return a516_0x3d4c();}Object[a516_0x2088d1(0x1dc)](exports,'__esModule',{'value':!![]});const AppError_1=__importDefault(require('../../errors/AppError')),GetDefaultWhatsApp_1=__importDefault(require('../../helpers/GetDefaultWhatsApp')),GetDefaultWhatsAppByUser_1=__importDefault(require(a516_0x2088d1(0x1d8))),Ticket_1=__importDefault(require('../../models/Ticket')),ShowContactService_1=__importDefault(require(a516_0x2088d1(0x1d5))),socket_1=require(a516_0x2088d1(0x1e6)),ShowWhatsAppService_1=__importDefault(require(a516_0x2088d1(0x1d7))),CheckContactOpenTickets_1=__importDefault(require(a516_0x2088d1(0x1df))),CreateTicketService=async({contactId:_0x100c0a,status:_0x3d21e5,userId:_0x16daa9,queueId:_0x4b15e6,companyId:_0x5a68ab,whatsappId:_0x115b0d})=>{const _0xd6d303=a516_0x2088d1,_0xcefd86=(0x0,socket_1[_0xd6d303(0x1de)])();console[_0xd6d303(0x1d6)](_0x100c0a,_0x3d21e5,_0x16daa9,_0x4b15e6,_0x5a68ab,_0x115b0d);let _0x1daa72;_0x115b0d!==undefined&&_0x115b0d!==null&&_0x115b0d!==''&&(_0x1daa72=await(0x0,ShowWhatsAppService_1[_0xd6d303(0x1e0)])(_0x115b0d,_0x5a68ab));let _0x5668cf=await(0x0,GetDefaultWhatsAppByUser_1[_0xd6d303(0x1e0)])(_0x16daa9);_0x1daa72&&(_0x5668cf=_0x1daa72);if(!_0x5668cf)_0x5668cf=await(0x0,GetDefaultWhatsApp_1[_0xd6d303(0x1e0)])(_0x5a68ab);await(0x0,CheckContactOpenTickets_1[_0xd6d303(0x1e0)])(_0x100c0a,_0x5668cf['id']);const {isGroup:_0x43af87}=await(0x0,ShowContactService_1['default'])(_0x100c0a,_0x5a68ab),[{id:_0x3a010a}]=await Ticket_1['default']['findOrCreate']({'where':{'contactId':_0x100c0a,'companyId':_0x5a68ab,'whatsappId':_0x5668cf['id']},'defaults':{'contactId':_0x100c0a,'companyId':_0x5a68ab,'status':_0x3d21e5,'whatsappId':_0x5668cf['id'],'isGroup':_0x43af87,'userId':_0x16daa9,'isBot':!![]}});await Ticket_1['default'][_0xd6d303(0x1ce)]({'companyId':_0x5a68ab,'queueId':_0x4b15e6,'userId':_0x16daa9,'status':_0x43af87?_0xd6d303(0x1e2):'open','isBot':!![]},{'where':{'id':_0x3a010a}});const _0x4bce9a=await Ticket_1[_0xd6d303(0x1e0)]['findByPk'](_0x3a010a,{'include':[_0xd6d303(0x1e4),'queue']});if(!_0x4bce9a)throw new AppError_1['default'](_0xd6d303(0x1d1));return _0xcefd86['to'](_0x4bce9a[_0xd6d303(0x1e5)])['to']('notification')['to'](_0x3a010a['toString']())[_0xd6d303(0x1cd)]('company-'+_0x5a68ab+_0xd6d303(0x1d0),{'action':_0xd6d303(0x1ce),'ticket':_0x4bce9a}),_0x4bce9a;};function a516_0x33c6(_0x34a9a0,_0x210c72){const _0x3d4cdb=a516_0x3d4c();return a516_0x33c6=function(_0x33c68d,_0x5481dc){_0x33c68d=_0x33c68d-0x1cc;let _0xed0f79=_0x3d4cdb[_0x33c68d];return _0xed0f79;},a516_0x33c6(_0x34a9a0,_0x210c72);}exports['default']=CreateTicketService;