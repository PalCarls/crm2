'use strict';function a481_0x3525(_0x56edaf,_0x22a745){const _0x56cc97=a481_0x56cc();return a481_0x3525=function(_0x3525d2,_0x170cc6){_0x3525d2=_0x3525d2-0xb6;let _0x1e447f=_0x56cc97[_0x3525d2];return _0x1e447f;},a481_0x3525(_0x56edaf,_0x22a745);}const a481_0x3db7d1=a481_0x3525;(function(_0x3d5f7f,_0x424fbf){const _0x2d0d1e=a481_0x3525,_0x53c430=_0x3d5f7f();while(!![]){try{const _0x90e2c9=parseInt(_0x2d0d1e(0xbf))/0x1*(-parseInt(_0x2d0d1e(0xd0))/0x2)+parseInt(_0x2d0d1e(0xb7))/0x3+-parseInt(_0x2d0d1e(0xcb))/0x4*(-parseInt(_0x2d0d1e(0xd4))/0x5)+parseInt(_0x2d0d1e(0xcf))/0x6*(parseInt(_0x2d0d1e(0xce))/0x7)+parseInt(_0x2d0d1e(0xc2))/0x8*(parseInt(_0x2d0d1e(0xda))/0x9)+parseInt(_0x2d0d1e(0xd8))/0xa*(parseInt(_0x2d0d1e(0xcd))/0xb)+parseInt(_0x2d0d1e(0xb8))/0xc*(-parseInt(_0x2d0d1e(0xc7))/0xd);if(_0x90e2c9===_0x424fbf)break;else _0x53c430['push'](_0x53c430['shift']());}catch(_0xf31d2f){_0x53c430['push'](_0x53c430['shift']());}}}(a481_0x56cc,0xd9dfe));function a481_0x56cc(){const _0x20d297=['findOrCreate','../ContactServices/ShowContactService','236296wWOJfN','contact','toString','112FKxQJm','../../models/Ticket','open','../../errors/AppError','__esModule','2679352QNsHEN','../../helpers/CheckContactOpenTickets','defineProperty','-ticket','20AhJiYM','../../helpers/GetDefaultWhatsAppByUser','34947JcjbDd','7WXjFyp','3251172gPifOC','10HoieoL','../WhatsappService/ShowWhatsAppService','getIO','ERR_CREATING_TICKET','1378195HXSguN','notification','log','__importDefault','1010aonTrY','findByPk','688617xLUxUA','default','update','1231830rbtcis','96QntvWN','../../helpers/GetDefaultWhatsApp','group','emit','../../libs/socket'];a481_0x56cc=function(){return _0x20d297;};return a481_0x56cc();}var __importDefault=this&&this[a481_0x3db7d1(0xd7)]||function(_0x366054){const _0x54ac81=a481_0x3db7d1;return _0x366054&&_0x366054[_0x54ac81(0xc6)]?_0x366054:{'default':_0x366054};};Object[a481_0x3db7d1(0xc9)](exports,'__esModule',{'value':!![]});const AppError_1=__importDefault(require(a481_0x3db7d1(0xc5))),GetDefaultWhatsApp_1=__importDefault(require(a481_0x3db7d1(0xb9))),GetDefaultWhatsAppByUser_1=__importDefault(require(a481_0x3db7d1(0xcc))),Ticket_1=__importDefault(require(a481_0x3db7d1(0xc3))),ShowContactService_1=__importDefault(require(a481_0x3db7d1(0xbe))),socket_1=require(a481_0x3db7d1(0xbc)),ShowWhatsAppService_1=__importDefault(require(a481_0x3db7d1(0xd1))),CheckContactOpenTickets_1=__importDefault(require(a481_0x3db7d1(0xc8))),CreateTicketService=async({contactId:_0x45f1d7,status:_0x180baa,userId:_0x16b195,queueId:_0x3e4ce2,companyId:_0x16e5e1,whatsappId:_0x4f892f})=>{const _0x208e6f=a481_0x3db7d1,_0x30605d=(0x0,socket_1[_0x208e6f(0xd2)])();console[_0x208e6f(0xd6)](_0x45f1d7,_0x180baa,_0x16b195,_0x3e4ce2,_0x16e5e1,_0x4f892f);let _0xd9d99c;_0x4f892f!==undefined&&_0x4f892f!==null&&_0x4f892f!==''&&(_0xd9d99c=await(0x0,ShowWhatsAppService_1[_0x208e6f(0xdb)])(_0x4f892f,_0x16e5e1));let _0x678b09=await(0x0,GetDefaultWhatsAppByUser_1[_0x208e6f(0xdb)])(_0x16b195);_0xd9d99c&&(_0x678b09=_0xd9d99c);if(!_0x678b09)_0x678b09=await(0x0,GetDefaultWhatsApp_1[_0x208e6f(0xdb)])(_0x16e5e1);await(0x0,CheckContactOpenTickets_1['default'])(_0x45f1d7,_0x678b09['id']);const {isGroup:_0x3d6fb4}=await(0x0,ShowContactService_1[_0x208e6f(0xdb)])(_0x45f1d7,_0x16e5e1),[{id:_0x507e8b}]=await Ticket_1[_0x208e6f(0xdb)][_0x208e6f(0xbd)]({'where':{'contactId':_0x45f1d7,'companyId':_0x16e5e1,'whatsappId':_0x678b09['id']},'defaults':{'contactId':_0x45f1d7,'companyId':_0x16e5e1,'status':_0x180baa,'whatsappId':_0x678b09['id'],'isGroup':_0x3d6fb4,'userId':_0x16b195,'isBot':!![]}});await Ticket_1[_0x208e6f(0xdb)][_0x208e6f(0xb6)]({'companyId':_0x16e5e1,'queueId':_0x3e4ce2,'userId':_0x16b195,'status':_0x3d6fb4?_0x208e6f(0xba):_0x208e6f(0xc4),'isBot':!![]},{'where':{'id':_0x507e8b}});const _0x3beac1=await Ticket_1[_0x208e6f(0xdb)][_0x208e6f(0xd9)](_0x507e8b,{'include':[_0x208e6f(0xc0),'queue']});if(!_0x3beac1)throw new AppError_1[(_0x208e6f(0xdb))](_0x208e6f(0xd3));return _0x30605d['to'](_0x3beac1['status'])['to'](_0x208e6f(0xd5))['to'](_0x507e8b[_0x208e6f(0xc1)]())[_0x208e6f(0xbb)]('company-'+_0x16e5e1+_0x208e6f(0xca),{'action':'update','ticket':_0x3beac1}),_0x3beac1;};exports[a481_0x3db7d1(0xdb)]=CreateTicketService;