'use strict';function a538_0x19fd(_0x49109f,_0x134ea1){const _0x581ad7=a538_0x581a();return a538_0x19fd=function(_0x19fdcb,_0x5d72b9){_0x19fdcb=_0x19fdcb-0xf1;let _0x3203f1=_0x581ad7[_0x19fdcb];return _0x3203f1;},a538_0x19fd(_0x49109f,_0x134ea1);}const a538_0x36ee93=a538_0x19fd;(function(_0x1be617,_0x4a5745){const _0xc21eb2=a538_0x19fd,_0x5bf728=_0x1be617();while(!![]){try{const _0x1bd13b=-parseInt(_0xc21eb2(0xf8))/0x1*(-parseInt(_0xc21eb2(0xfb))/0x2)+parseInt(_0xc21eb2(0x105))/0x3*(parseInt(_0xc21eb2(0xf6))/0x4)+-parseInt(_0xc21eb2(0x111))/0x5+-parseInt(_0xc21eb2(0x104))/0x6*(parseInt(_0xc21eb2(0x10f))/0x7)+-parseInt(_0xc21eb2(0xfc))/0x8*(parseInt(_0xc21eb2(0x101))/0x9)+-parseInt(_0xc21eb2(0x106))/0xa+parseInt(_0xc21eb2(0x100))/0xb*(parseInt(_0xc21eb2(0x112))/0xc);if(_0x1bd13b===_0x4a5745)break;else _0x5bf728['push'](_0x5bf728['shift']());}catch(_0x55f53a){_0x5bf728['push'](_0x5bf728['shift']());}}}(a538_0x581a,0xa6102));var __importDefault=this&&this[a538_0x36ee93(0xf7)]||function(_0x4993a5){const _0x3df51c=a538_0x36ee93;return _0x4993a5&&_0x4993a5[_0x3df51c(0x113)]?_0x4993a5:{'default':_0x4993a5};};Object[a538_0x36ee93(0x103)](exports,a538_0x36ee93(0x113),{'value':!![]});const AppError_1=__importDefault(require(a538_0x36ee93(0x10b))),GetDefaultWhatsApp_1=__importDefault(require('../../helpers/GetDefaultWhatsApp')),GetDefaultWhatsAppByUser_1=__importDefault(require(a538_0x36ee93(0xf3))),Ticket_1=__importDefault(require('../../models/Ticket')),ShowContactService_1=__importDefault(require('../ContactServices/ShowContactService')),socket_1=require('../../libs/socket'),ShowWhatsAppService_1=__importDefault(require(a538_0x36ee93(0xfa))),CheckContactOpenTickets_1=__importDefault(require(a538_0x36ee93(0xfe))),CreateLogTicketService_1=__importDefault(require(a538_0x36ee93(0x108))),CreateTicketService=async({contactId:_0x57d29e,status:_0x459569,userId:_0x119ee7,queueId:_0x5b1684,companyId:_0x3383f8,whatsappId:_0x462810})=>{const _0x3cd443=a538_0x36ee93,_0x541860=(0x0,socket_1[_0x3cd443(0x110)])();let _0x230445;_0x462810!==undefined&&_0x462810!==null&&_0x462810!==''&&(_0x230445=await(0x0,ShowWhatsAppService_1[_0x3cd443(0x10d)])(_0x462810,_0x3383f8));let _0x59a610=await(0x0,GetDefaultWhatsAppByUser_1[_0x3cd443(0x10d)])(_0x119ee7);_0x230445&&(_0x59a610=_0x230445);if(!_0x59a610)_0x59a610=await(0x0,GetDefaultWhatsApp_1[_0x3cd443(0x10d)])(_0x3383f8);await(0x0,CheckContactOpenTickets_1[_0x3cd443(0x10d)])(_0x57d29e,_0x59a610['id']);const {isGroup:_0x3cd2b0}=await(0x0,ShowContactService_1[_0x3cd443(0x10d)])(_0x57d29e,_0x3383f8),[{id:_0x1924e7}]=await Ticket_1[_0x3cd443(0x10d)][_0x3cd443(0x10c)]({'where':{'contactId':_0x57d29e,'companyId':_0x3383f8,'whatsappId':_0x59a610['id']},'defaults':{'contactId':_0x57d29e,'companyId':_0x3383f8,'status':_0x459569,'whatsappId':_0x59a610['id'],'isGroup':_0x3cd2b0,'userId':_0x119ee7,'isBot':!![]}});await Ticket_1['default'][_0x3cd443(0x107)]({'companyId':_0x3383f8,'queueId':_0x5b1684,'userId':_0x119ee7,'status':_0x3cd2b0?_0x3cd443(0x114):_0x3cd443(0x109),'isBot':!![]},{'where':{'id':_0x1924e7}});const _0x2096ce=await Ticket_1[_0x3cd443(0x10d)][_0x3cd443(0x10e)](_0x1924e7,{'include':[_0x3cd443(0xf4),_0x3cd443(0x10a),_0x3cd443(0xf1)]});if(!_0x2096ce)throw new AppError_1[(_0x3cd443(0x10d))](_0x3cd443(0xf2));return _0x541860['to'](_0x2096ce[_0x3cd443(0xff)])['to'](_0x3cd443(0x102))['to'](_0x1924e7[_0x3cd443(0xfd)]())['emit']('company-'+_0x3383f8+_0x3cd443(0xf5),{'action':_0x3cd443(0x107),'ticket':_0x2096ce}),await(0x0,CreateLogTicketService_1[_0x3cd443(0x10d)])({'userId':_0x119ee7,'queueId':_0x5b1684,'ticketId':_0x2096ce['id'],'type':_0x3cd443(0xf9)}),_0x2096ce;};exports[a538_0x36ee93(0x10d)]=CreateTicketService;function a538_0x581a(){const _0x5a1120=['691607JXlKZP','create','../WhatsappService/ShowWhatsAppService','2EvKtuD','817288lqeTly','toString','../../helpers/CheckContactOpenTickets','status','1419OEvXZx','117mUdYoF','notification','defineProperty','6yyqPFh','45fKOikh','3165720qzGSAb','update','./CreateLogTicketService','open','queue','../../errors/AppError','findOrCreate','default','findByPk','611548eXjJxd','getIO','3696815SdoIpM','203052ZTZjam','__esModule','group','whatsapp','ERR_CREATING_TICKET','../../helpers/GetDefaultWhatsAppByUser','contact','-ticket','73912mLpYcI','__importDefault'];a538_0x581a=function(){return _0x5a1120;};return a538_0x581a();}