'use strict';function a589_0x4b57(_0x7bd0ea,_0x4a75bb){const _0x26563f=a589_0x2656();return a589_0x4b57=function(_0x4b57ec,_0x23e111){_0x4b57ec=_0x4b57ec-0x8e;let _0x1a2b6c=_0x26563f[_0x4b57ec];return _0x1a2b6c;},a589_0x4b57(_0x7bd0ea,_0x4a75bb);}const a589_0x1c0782=a589_0x4b57;(function(_0x8415b9,_0x16e146){const _0x1a605f=a589_0x4b57,_0x546b10=_0x8415b9();while(!![]){try{const _0x12b602=parseInt(_0x1a605f(0xa5))/0x1+parseInt(_0x1a605f(0xa8))/0x2*(parseInt(_0x1a605f(0xab))/0x3)+-parseInt(_0x1a605f(0x8f))/0x4+parseInt(_0x1a605f(0x9f))/0x5*(parseInt(_0x1a605f(0x99))/0x6)+parseInt(_0x1a605f(0x97))/0x7*(parseInt(_0x1a605f(0xac))/0x8)+-parseInt(_0x1a605f(0x8e))/0x9*(parseInt(_0x1a605f(0xa2))/0xa)+parseInt(_0x1a605f(0x90))/0xb*(parseInt(_0x1a605f(0x9b))/0xc);if(_0x12b602===_0x16e146)break;else _0x546b10['push'](_0x546b10['shift']());}catch(_0x4820d8){_0x546b10['push'](_0x546b10['shift']());}}}(a589_0x2656,0xa5b90));var __importDefault=this&&this['__importDefault']||function(_0x538c6d){const _0x1fb5e2=a589_0x4b57;return _0x538c6d&&_0x538c6d[_0x1fb5e2(0xa0)]?_0x538c6d:{'default':_0x538c6d};};Object['defineProperty'](exports,a589_0x1c0782(0xa0),{'value':!![]});const AppError_1=__importDefault(require(a589_0x1c0782(0xa9))),GetDefaultWhatsApp_1=__importDefault(require(a589_0x1c0782(0x9d))),GetDefaultWhatsAppByUser_1=__importDefault(require('../../helpers/GetDefaultWhatsAppByUser')),Ticket_1=__importDefault(require(a589_0x1c0782(0x9e))),ShowContactService_1=__importDefault(require(a589_0x1c0782(0xa6))),socket_1=require(a589_0x1c0782(0x9a)),ShowWhatsAppService_1=__importDefault(require(a589_0x1c0782(0xa1))),CheckContactOpenTickets_1=__importDefault(require(a589_0x1c0782(0x92))),CreateLogTicketService_1=__importDefault(require('./CreateLogTicketService')),ShowTicketService_1=__importDefault(require(a589_0x1c0782(0x96))),CreateTicketService=async({contactId:_0x107284,status:_0x40a3ca,userId:_0x386480,queueId:_0x49d553,companyId:_0x4eddc1,whatsappId:_0x251b31})=>{const _0x403616=a589_0x1c0782,_0x740aef=(0x0,socket_1[_0x403616(0xaa)])();let _0x1f793;_0x251b31!==undefined&&_0x251b31!==null&&_0x251b31!==''&&(_0x1f793=await(0x0,ShowWhatsAppService_1[_0x403616(0x98)])(_0x251b31,_0x4eddc1));let _0xb4d484=await(0x0,GetDefaultWhatsAppByUser_1['default'])(_0x386480);_0x1f793&&(_0xb4d484=_0x1f793);if(!_0xb4d484)_0xb4d484=await(0x0,GetDefaultWhatsApp_1[_0x403616(0x98)])(_0x4eddc1);await(0x0,CheckContactOpenTickets_1[_0x403616(0x98)])(_0x107284,_0xb4d484['id']);const {isGroup:_0x3d7796}=await(0x0,ShowContactService_1['default'])(_0x107284,_0x4eddc1);let _0x5c24f6=await Ticket_1['default'][_0x403616(0x91)]({'contactId':_0x107284,'companyId':_0x4eddc1,'whatsappId':_0xb4d484['id'],'isGroup':_0x3d7796,'userId':_0x386480,'isBot':!![],'queueId':_0x49d553,'status':_0x3d7796?_0x403616(0x94):_0x403616(0xa7),'isActiveDemand':!![]});_0x5c24f6=await(0x0,ShowTicketService_1[_0x403616(0x98)])(_0x5c24f6['id'],_0x4eddc1);if(!_0x5c24f6)throw new AppError_1['default'](_0x403616(0x93));return _0x740aef['to'](_0x5c24f6[_0x403616(0x9c)])['to'](_0x403616(0xa4))['to'](_0x5c24f6['id'][_0x403616(0xad)]())['emit'](_0x403616(0x95)+_0x4eddc1+_0x403616(0xa3),{'action':'update','ticket':_0x5c24f6}),await(0x0,CreateLogTicketService_1[_0x403616(0x98)])({'userId':_0x386480,'queueId':_0x49d553,'ticketId':_0x5c24f6['id'],'type':_0x403616(0x91)}),_0x5c24f6;};function a589_0x2656(){const _0x55703c=['__esModule','../WhatsappService/ShowWhatsAppService','11276810HZmFQY','-ticket','notification','278665jjoLNz','../ContactServices/ShowContactService','open','13654ANhqjz','../../errors/AppError','getIO','450daQtdS','5190096WVlSYN','toString','9zDKQcU','5427396JQNxAl','451OnUthj','create','../../helpers/CheckContactOpenTickets','ERR_CREATING_TICKET','group','company-','./ShowTicketService','14OnTYvb','default','60rQPRNZ','../../libs/socket','7572oCInCo','status','../../helpers/GetDefaultWhatsApp','../../models/Ticket','268610RZwyDb'];a589_0x2656=function(){return _0x55703c;};return a589_0x2656();}exports[a589_0x1c0782(0x98)]=CreateTicketService;