'use strict';const a596_0x554b47=a596_0x294a;(function(_0x1580df,_0x41cbe0){const _0x28cb71=a596_0x294a,_0x4ba52d=_0x1580df();while(!![]){try{const _0x52498c=parseInt(_0x28cb71(0x11d))/0x1+parseInt(_0x28cb71(0x117))/0x2+-parseInt(_0x28cb71(0x129))/0x3*(-parseInt(_0x28cb71(0x123))/0x4)+parseInt(_0x28cb71(0x11e))/0x5*(parseInt(_0x28cb71(0x126))/0x6)+-parseInt(_0x28cb71(0x12b))/0x7+-parseInt(_0x28cb71(0x112))/0x8+-parseInt(_0x28cb71(0x124))/0x9;if(_0x52498c===_0x41cbe0)break;else _0x4ba52d['push'](_0x4ba52d['shift']());}catch(_0x3af6d2){_0x4ba52d['push'](_0x4ba52d['shift']());}}}(a596_0x1cc6,0x9535e));function a596_0x294a(_0x34bdd0,_0x2ab68d){const _0x1cc633=a596_0x1cc6();return a596_0x294a=function(_0x294aef,_0x4bfda3){_0x294aef=_0x294aef-0x111;let _0x16282f=_0x1cc633[_0x294aef];return _0x16282f;},a596_0x294a(_0x34bdd0,_0x2ab68d);}var __importDefault=this&&this[a596_0x554b47(0x122)]||function(_0x1b8c97){const _0xe0a0d9=a596_0x554b47;return _0x1b8c97&&_0x1b8c97[_0xe0a0d9(0x11b)]?_0x1b8c97:{'default':_0x1b8c97};};function a596_0x1cc6(){const _0x23b2d3=['25218864jwEUSu','open','6WBlkGI','../../libs/socket','../ContactServices/ShowContactService','558AtHJlk','-ticket','4621561TWFtWv','./ShowTicketService','ERR_CREATING_TICKET','notification','150216JwgEJC','toString','../WhatsappService/ShowWhatsAppService','create','getIO','2097030dLDYOC','status','company-','group','__esModule','update','1064770hMSaRM','4085175qDwhQQ','../../helpers/CheckContactOpenTickets','emit','default','__importDefault','24988pZIKTD'];a596_0x1cc6=function(){return _0x23b2d3;};return a596_0x1cc6();}Object['defineProperty'](exports,a596_0x554b47(0x11b),{'value':!![]});const AppError_1=__importDefault(require('../../errors/AppError')),GetDefaultWhatsApp_1=__importDefault(require('../../helpers/GetDefaultWhatsApp')),GetDefaultWhatsAppByUser_1=__importDefault(require('../../helpers/GetDefaultWhatsAppByUser')),Ticket_1=__importDefault(require('../../models/Ticket')),ShowContactService_1=__importDefault(require(a596_0x554b47(0x128))),socket_1=require(a596_0x554b47(0x127)),ShowWhatsAppService_1=__importDefault(require(a596_0x554b47(0x114))),CheckContactOpenTickets_1=__importDefault(require(a596_0x554b47(0x11f))),CreateLogTicketService_1=__importDefault(require('./CreateLogTicketService')),ShowTicketService_1=__importDefault(require(a596_0x554b47(0x12c))),CreateTicketService=async({contactId:_0x591b86,status:_0x1ea463,userId:_0x3fb7e6,queueId:_0x37b217,companyId:_0x2d2190,whatsappId:_0x131a06})=>{const _0x3ad7ea=a596_0x554b47,_0x3363a3=(0x0,socket_1[_0x3ad7ea(0x116)])();let _0xdeb3aa;_0x131a06!==undefined&&_0x131a06!==null&&_0x131a06!==''&&(_0xdeb3aa=await(0x0,ShowWhatsAppService_1[_0x3ad7ea(0x121)])(_0x131a06,_0x2d2190));let _0x5a3324=await(0x0,GetDefaultWhatsAppByUser_1[_0x3ad7ea(0x121)])(_0x3fb7e6);_0xdeb3aa&&(_0x5a3324=_0xdeb3aa);if(!_0x5a3324)_0x5a3324=await(0x0,GetDefaultWhatsApp_1[_0x3ad7ea(0x121)])(_0x2d2190);await(0x0,CheckContactOpenTickets_1['default'])(_0x591b86,_0x5a3324['id']);const {isGroup:_0x4079b0}=await(0x0,ShowContactService_1[_0x3ad7ea(0x121)])(_0x591b86,_0x2d2190);let _0x43d47a=await Ticket_1[_0x3ad7ea(0x121)][_0x3ad7ea(0x115)]({'contactId':_0x591b86,'companyId':_0x2d2190,'whatsappId':_0x5a3324['id'],'isGroup':_0x4079b0,'userId':_0x3fb7e6,'isBot':!![],'queueId':_0x37b217,'status':_0x4079b0?_0x3ad7ea(0x11a):_0x3ad7ea(0x125),'isActiveDemand':!![]});_0x43d47a=await(0x0,ShowTicketService_1[_0x3ad7ea(0x121)])(_0x43d47a['id'],_0x2d2190);if(!_0x43d47a)throw new AppError_1[(_0x3ad7ea(0x121))](_0x3ad7ea(0x12d));return _0x3363a3['to'](_0x43d47a[_0x3ad7ea(0x118)])['to'](_0x3ad7ea(0x111))['to'](_0x43d47a['id'][_0x3ad7ea(0x113)]())[_0x3ad7ea(0x120)](_0x3ad7ea(0x119)+_0x2d2190+_0x3ad7ea(0x12a),{'action':_0x3ad7ea(0x11c),'ticket':_0x43d47a}),await(0x0,CreateLogTicketService_1[_0x3ad7ea(0x121)])({'userId':_0x3fb7e6,'queueId':_0x37b217,'ticketId':_0x43d47a['id'],'type':_0x3ad7ea(0x115)}),_0x43d47a;};exports['default']=CreateTicketService;