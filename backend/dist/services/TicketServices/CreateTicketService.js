'use strict';function a589_0xd060(){const _0x2cbc25=['company-','__esModule','10bepsPJ','337jOsAAL','update','1049008BovCXo','80FesdPs','2430114ZBHeYJ','notification','../../helpers/CheckContactOpenTickets','./ShowTicketService','2289753zLeUmx','default','24374JeUyAd','-ticket','defineProperty','create','1311405sYOcAK','37995PpLgtC','getIO','emit','open','toString','../../helpers/GetDefaultWhatsApp','group','934jaXfVJ'];a589_0xd060=function(){return _0x2cbc25;};return a589_0xd060();}const a589_0x51aea0=a589_0x4814;(function(_0x1d3837,_0xfb1a08){const _0x3504c7=a589_0x4814,_0xd54bc7=_0x1d3837();while(!![]){try{const _0xd3f87d=-parseInt(_0x3504c7(0x1a7))/0x1*(parseInt(_0x3504c7(0x1a3))/0x2)+-parseInt(_0x3504c7(0x19b))/0x3+parseInt(_0x3504c7(0x1a9))/0x4+-parseInt(_0x3504c7(0x19c))/0x5+parseInt(_0x3504c7(0x191))/0x6+parseInt(_0x3504c7(0x197))/0x7*(-parseInt(_0x3504c7(0x1aa))/0x8)+parseInt(_0x3504c7(0x195))/0x9*(parseInt(_0x3504c7(0x1a6))/0xa);if(_0xd3f87d===_0xfb1a08)break;else _0xd54bc7['push'](_0xd54bc7['shift']());}catch(_0x196c82){_0xd54bc7['push'](_0xd54bc7['shift']());}}}(a589_0xd060,0x45853));var __importDefault=this&&this['__importDefault']||function(_0x5832df){const _0xe17243=a589_0x4814;return _0x5832df&&_0x5832df[_0xe17243(0x1a5)]?_0x5832df:{'default':_0x5832df};};Object[a589_0x51aea0(0x199)](exports,a589_0x51aea0(0x1a5),{'value':!![]});function a589_0x4814(_0x115d69,_0x26a9de){const _0xd06078=a589_0xd060();return a589_0x4814=function(_0x481428,_0x525fc2){_0x481428=_0x481428-0x191;let _0x96df9e=_0xd06078[_0x481428];return _0x96df9e;},a589_0x4814(_0x115d69,_0x26a9de);}const AppError_1=__importDefault(require('../../errors/AppError')),GetDefaultWhatsApp_1=__importDefault(require(a589_0x51aea0(0x1a1))),GetDefaultWhatsAppByUser_1=__importDefault(require('../../helpers/GetDefaultWhatsAppByUser')),Ticket_1=__importDefault(require('../../models/Ticket')),ShowContactService_1=__importDefault(require('../ContactServices/ShowContactService')),socket_1=require('../../libs/socket'),ShowWhatsAppService_1=__importDefault(require('../WhatsappService/ShowWhatsAppService')),CheckContactOpenTickets_1=__importDefault(require(a589_0x51aea0(0x193))),CreateLogTicketService_1=__importDefault(require('./CreateLogTicketService')),ShowTicketService_1=__importDefault(require(a589_0x51aea0(0x194))),CreateTicketService=async({contactId:_0x44abf1,status:_0x5cff98,userId:_0x171a72,queueId:_0x2ff6c6,companyId:_0x4daacc,whatsappId:_0x1a92e4})=>{const _0x24b287=a589_0x51aea0,_0x39e3d4=(0x0,socket_1[_0x24b287(0x19d)])();let _0x19fa9f;_0x1a92e4!==undefined&&_0x1a92e4!==null&&_0x1a92e4!==''&&(_0x19fa9f=await(0x0,ShowWhatsAppService_1[_0x24b287(0x196)])(_0x1a92e4,_0x4daacc));let _0x5478e8=await(0x0,GetDefaultWhatsAppByUser_1['default'])(_0x171a72);_0x19fa9f&&(_0x5478e8=_0x19fa9f);if(!_0x5478e8)_0x5478e8=await(0x0,GetDefaultWhatsApp_1['default'])(_0x4daacc);await(0x0,CheckContactOpenTickets_1[_0x24b287(0x196)])(_0x44abf1,_0x5478e8['id']);const {isGroup:_0x2f3f69}=await(0x0,ShowContactService_1[_0x24b287(0x196)])(_0x44abf1,_0x4daacc);let _0x1e16d0=await Ticket_1[_0x24b287(0x196)][_0x24b287(0x19a)]({'contactId':_0x44abf1,'companyId':_0x4daacc,'whatsappId':_0x5478e8['id'],'isGroup':_0x2f3f69,'userId':_0x171a72,'isBot':!![],'queueId':_0x2ff6c6,'status':_0x2f3f69?_0x24b287(0x1a2):_0x24b287(0x19f),'isActiveDemand':!![]});_0x1e16d0=await(0x0,ShowTicketService_1['default'])(_0x1e16d0['id'],_0x4daacc);if(!_0x1e16d0)throw new AppError_1[(_0x24b287(0x196))]('ERR_CREATING_TICKET');return _0x39e3d4['to'](_0x1e16d0['status'])['to'](_0x24b287(0x192))['to'](_0x1e16d0['id'][_0x24b287(0x1a0)]())[_0x24b287(0x19e)](_0x24b287(0x1a4)+_0x4daacc+_0x24b287(0x198),{'action':_0x24b287(0x1a8),'ticket':_0x1e16d0}),await(0x0,CreateLogTicketService_1[_0x24b287(0x196)])({'userId':_0x171a72,'queueId':_0x2ff6c6,'ticketId':_0x1e16d0['id'],'type':_0x24b287(0x19a)}),_0x1e16d0;};exports[a589_0x51aea0(0x196)]=CreateTicketService;