'use strict';const a536_0x860ff9=a536_0x5132;(function(_0x17d444,_0x1cafd9){const _0x152e24=a536_0x5132,_0x3a88d3=_0x17d444();while(!![]){try{const _0xbfad39=parseInt(_0x152e24(0x145))/0x1+parseInt(_0x152e24(0x147))/0x2+parseInt(_0x152e24(0x14a))/0x3+-parseInt(_0x152e24(0x158))/0x4+parseInt(_0x152e24(0x154))/0x5+-parseInt(_0x152e24(0x14c))/0x6+parseInt(_0x152e24(0x152))/0x7*(-parseInt(_0x152e24(0x156))/0x8);if(_0xbfad39===_0x1cafd9)break;else _0x3a88d3['push'](_0x3a88d3['shift']());}catch(_0x344054){_0x3a88d3['push'](_0x3a88d3['shift']());}}}(a536_0x44fd,0xf214e));function a536_0x5132(_0x95ca6c,_0x2db167){const _0x44fd12=a536_0x44fd();return a536_0x5132=function(_0x513220,_0x4f603a){_0x513220=_0x513220-0x13c;let _0x181c33=_0x44fd12[_0x513220];return _0x181c33;},a536_0x5132(_0x95ca6c,_0x2db167);}function a536_0x44fd(){const _0x33a98f=['220610VEnRwA','subHours','timeCreateNewTicket','833916MENAhc','./FindOrCreateATicketTrakingService','4017828ghheAN','DESC','../../models/Ticket','sequelize','closed','pending','7jZlYku','create','3205020cnIaNY','whatsappId','3090848ksDaTb','value','2815680VjcxNQ','updatedAt','date-fns','between','open','userId','findOne','../../models/Setting','default','update','__esModule','1722199VXHstT','./ShowTicketService'];a536_0x44fd=function(){return _0x33a98f;};return a536_0x44fd();}var __importDefault=this&&this['__importDefault']||function(_0x1869dc){const _0x230d2a=a536_0x5132;return _0x1869dc&&_0x1869dc[_0x230d2a(0x144)]?_0x1869dc:{'default':_0x1869dc};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const date_fns_1=require(a536_0x860ff9(0x13c)),sequelize_1=require(a536_0x860ff9(0x14f)),Ticket_1=__importDefault(require(a536_0x860ff9(0x14e))),ShowTicketService_1=__importDefault(require(a536_0x860ff9(0x146))),FindOrCreateATicketTrakingService_1=__importDefault(require(a536_0x860ff9(0x14b))),Setting_1=__importDefault(require(a536_0x860ff9(0x141))),FindOrCreateTicketServiceMeta=async(_0x231130,_0x5c1655,_0x23ea53,_0x318b1b,_0x2d7fde)=>{const _0x4abc24=a536_0x860ff9;let _0x48f3ba=await Ticket_1[_0x4abc24(0x142)][_0x4abc24(0x140)]({'where':{'status':{[sequelize_1['Op']['or']]:[_0x4abc24(0x13e),'pending',_0x4abc24(0x150)]},'contactId':_0x231130['id'],'companyId':_0x318b1b,'channel':_0x2d7fde},'order':[['id','DESC']]});_0x48f3ba&&await _0x48f3ba['update']({'unreadMessages':_0x23ea53});if(!_0x48f3ba){_0x48f3ba=await Ticket_1[_0x4abc24(0x142)]['findOne']({'where':{'contactId':_0x231130['id'],'channel':_0x2d7fde},'order':[[_0x4abc24(0x159),_0x4abc24(0x14d)]]});_0x48f3ba&&(await _0x48f3ba[_0x4abc24(0x143)]({'status':_0x4abc24(0x151),'userId':null,'unreadMessages':_0x23ea53,'companyId':_0x318b1b,'channel':_0x2d7fde}),await(0x0,FindOrCreateATicketTrakingService_1[_0x4abc24(0x142)])({'ticketId':_0x48f3ba['id'],'companyId':_0x318b1b,'whatsappId':_0x48f3ba[_0x4abc24(0x155)],'userId':_0x48f3ba['userId']}));const _0x1aecda=await Setting_1[_0x4abc24(0x142)]['findOne']({'where':{'key':_0x4abc24(0x149)}}),_0x5e180c=_0x1aecda?parseInt(_0x1aecda[_0x4abc24(0x157)],0xa):0x1c20;}return!_0x48f3ba&&(_0x48f3ba=await Ticket_1[_0x4abc24(0x142)][_0x4abc24(0x140)]({'where':{'updatedAt':{[sequelize_1['Op'][_0x4abc24(0x13d)]]:[+(0x0,date_fns_1[_0x4abc24(0x148)])(new Date(),0x2),+new Date()]},'contactId':_0x231130['id']},'order':[[_0x4abc24(0x159),_0x4abc24(0x14d)]]}),_0x48f3ba&&(await _0x48f3ba[_0x4abc24(0x143)]({'status':_0x4abc24(0x151),'userId':null,'unreadMessages':_0x23ea53,'companyId':_0x318b1b,'channel':_0x2d7fde}),await(0x0,FindOrCreateATicketTrakingService_1[_0x4abc24(0x142)])({'ticketId':_0x48f3ba['id'],'companyId':_0x318b1b,'whatsappId':_0x48f3ba[_0x4abc24(0x155)],'userId':_0x48f3ba[_0x4abc24(0x13f)]}))),!_0x48f3ba?(_0x48f3ba=await Ticket_1['default'][_0x4abc24(0x153)]({'contactId':_0x231130['id'],'status':_0x4abc24(0x151),'isGroup':![],'unreadMessages':_0x23ea53,'whatsappId':_0x5c1655,'companyId':_0x318b1b,'channel':_0x2d7fde}),await(0x0,FindOrCreateATicketTrakingService_1['default'])({'ticketId':_0x48f3ba['id'],'companyId':_0x318b1b,'whatsappId':_0x5c1655,'userId':_0x48f3ba[_0x4abc24(0x13f)]})):await _0x48f3ba['update']({'whatsappId':_0x5c1655}),_0x48f3ba=await(0x0,ShowTicketService_1[_0x4abc24(0x142)])(_0x48f3ba['id'],_0x318b1b),_0x48f3ba;};exports[a536_0x860ff9(0x142)]=FindOrCreateTicketServiceMeta;