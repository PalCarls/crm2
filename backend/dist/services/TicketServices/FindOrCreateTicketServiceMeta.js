<<<<<<< HEAD
'use strict';const a583_0x38f3bd=a583_0x679b;(function(_0x2a85d9,_0x24d5ca){const _0x203574=a583_0x679b,_0x3119ff=_0x2a85d9();while(!![]){try{const _0x592dbf=-parseInt(_0x203574(0x180))/0x1+-parseInt(_0x203574(0x184))/0x2*(-parseInt(_0x203574(0x16e))/0x3)+-parseInt(_0x203574(0x175))/0x4*(parseInt(_0x203574(0x181))/0x5)+-parseInt(_0x203574(0x171))/0x6+parseInt(_0x203574(0x185))/0x7*(-parseInt(_0x203574(0x17c))/0x8)+parseInt(_0x203574(0x16f))/0x9+parseInt(_0x203574(0x189))/0xa;if(_0x592dbf===_0x24d5ca)break;else _0x3119ff['push'](_0x3119ff['shift']());}catch(_0x249b6b){_0x3119ff['push'](_0x3119ff['shift']());}}}(a583_0x136f,0xab559));var __importDefault=this&&this[a583_0x38f3bd(0x17d)]||function(_0x38ad38){const _0x3e4817=a583_0x38f3bd;return _0x38ad38&&_0x38ad38[_0x3e4817(0x187)]?_0x38ad38:{'default':_0x38ad38};};Object[a583_0x38f3bd(0x17e)](exports,a583_0x38f3bd(0x187),{'value':!![]});const date_fns_1=require(a583_0x38f3bd(0x176)),sequelize_1=require(a583_0x38f3bd(0x178)),Ticket_1=__importDefault(require(a583_0x38f3bd(0x17a))),ShowTicketService_1=__importDefault(require(a583_0x38f3bd(0x183))),FindOrCreateATicketTrakingService_1=__importDefault(require(a583_0x38f3bd(0x173))),Setting_1=__importDefault(require(a583_0x38f3bd(0x188))),FindOrCreateTicketServiceMeta=async(_0x17edc7,_0x206f1b,_0x1e6c94,_0x437e4a,_0x4c5cee)=>{const _0x33e747=a583_0x38f3bd;let _0x26dcde=await Ticket_1[_0x33e747(0x177)][_0x33e747(0x174)]({'where':{'status':{[sequelize_1['Op']['or']]:[_0x33e747(0x17b),_0x33e747(0x172),_0x33e747(0x16d)]},'contactId':_0x17edc7['id'],'companyId':_0x437e4a,'channel':_0x4c5cee},'order':[['id','DESC']]});_0x26dcde&&await _0x26dcde['update']({'unreadMessages':_0x1e6c94});if(!_0x26dcde){_0x26dcde=await Ticket_1[_0x33e747(0x177)][_0x33e747(0x174)]({'where':{'contactId':_0x17edc7['id'],'channel':_0x4c5cee},'order':[[_0x33e747(0x18a),'DESC']]});_0x26dcde&&(await _0x26dcde[_0x33e747(0x17f)]({'status':_0x33e747(0x172),'userId':null,'unreadMessages':_0x1e6c94,'companyId':_0x437e4a,'channel':_0x4c5cee}),await(0x0,FindOrCreateATicketTrakingService_1['default'])({'ticketId':_0x26dcde['id'],'companyId':_0x437e4a,'whatsappId':_0x26dcde[_0x33e747(0x170)],'userId':_0x26dcde[_0x33e747(0x16c)]}));const _0x3032a6=await Setting_1[_0x33e747(0x177)][_0x33e747(0x174)]({'where':{'key':'timeCreateNewTicket'}}),_0x509959=_0x3032a6?parseInt(_0x3032a6['value'],0xa):0x1c20;}return!_0x26dcde&&(_0x26dcde=await Ticket_1[_0x33e747(0x177)][_0x33e747(0x174)]({'where':{'updatedAt':{[sequelize_1['Op'][_0x33e747(0x182)]]:[+(0x0,date_fns_1['subHours'])(new Date(),0x2),+new Date()]},'contactId':_0x17edc7['id']},'order':[[_0x33e747(0x18a),_0x33e747(0x179)]]}),_0x26dcde&&(await _0x26dcde[_0x33e747(0x17f)]({'status':_0x33e747(0x172),'userId':null,'unreadMessages':_0x1e6c94,'companyId':_0x437e4a,'channel':_0x4c5cee}),await(0x0,FindOrCreateATicketTrakingService_1['default'])({'ticketId':_0x26dcde['id'],'companyId':_0x437e4a,'whatsappId':_0x26dcde['whatsappId'],'userId':_0x26dcde['userId']}))),!_0x26dcde?(_0x26dcde=await Ticket_1['default'][_0x33e747(0x186)]({'contactId':_0x17edc7['id'],'status':_0x33e747(0x172),'isGroup':![],'unreadMessages':_0x1e6c94,'whatsappId':_0x206f1b,'companyId':_0x437e4a,'channel':_0x4c5cee}),await(0x0,FindOrCreateATicketTrakingService_1['default'])({'ticketId':_0x26dcde['id'],'companyId':_0x437e4a,'whatsappId':_0x206f1b,'userId':_0x26dcde[_0x33e747(0x16c)]})):await _0x26dcde[_0x33e747(0x17f)]({'whatsappId':_0x206f1b}),_0x26dcde=await(0x0,ShowTicketService_1['default'])(_0x26dcde['id'],_0x437e4a),_0x26dcde;};function a583_0x136f(){const _0x102795=['update','255125tBPuvy','22265yBScUq','between','./ShowTicketService','2888TEhLII','14URxBdV','create','__esModule','../../models/Setting','17811130wUhmPM','updatedAt','userId','closed','1002lqYzhz','2646432VtHIKm','whatsappId','1698Dbnkib','pending','./FindOrCreateATicketTrakingService','findOne','240kxvqoy','date-fns','default','sequelize','DESC','../../models/Ticket','open','5332336QHOTvT','__importDefault','defineProperty'];a583_0x136f=function(){return _0x102795;};return a583_0x136f();}function a583_0x679b(_0x1bc735,_0x1cab00){const _0x136fdf=a583_0x136f();return a583_0x679b=function(_0x679bf0,_0x4a3639){_0x679bf0=_0x679bf0-0x16c;let _0x5ddc6f=_0x136fdf[_0x679bf0];return _0x5ddc6f;},a583_0x679b(_0x1bc735,_0x1cab00);}exports[a583_0x38f3bd(0x177)]=FindOrCreateTicketServiceMeta;
=======
'use strict';const a582_0x3ceaea=a582_0x1b6e;(function(_0x306c40,_0x1fdbc2){const _0x29014c=a582_0x1b6e,_0x3bcce4=_0x306c40();while(!![]){try{const _0xa705f2=-parseInt(_0x29014c(0x1c3))/0x1*(-parseInt(_0x29014c(0x1bb))/0x2)+-parseInt(_0x29014c(0x1b5))/0x3*(-parseInt(_0x29014c(0x1c0))/0x4)+-parseInt(_0x29014c(0x1c4))/0x5*(-parseInt(_0x29014c(0x1ba))/0x6)+parseInt(_0x29014c(0x1bc))/0x7+-parseInt(_0x29014c(0x1cb))/0x8*(-parseInt(_0x29014c(0x1cf))/0x9)+parseInt(_0x29014c(0x1c8))/0xa+-parseInt(_0x29014c(0x1d0))/0xb;if(_0xa705f2===_0x1fdbc2)break;else _0x3bcce4['push'](_0x3bcce4['shift']());}catch(_0x5ae60c){_0x3bcce4['push'](_0x3bcce4['shift']());}}}(a582_0x5dba,0x9bb3c));var __importDefault=this&&this[a582_0x3ceaea(0x1c6)]||function(_0xf2bd76){return _0xf2bd76&&_0xf2bd76['__esModule']?_0xf2bd76:{'default':_0xf2bd76};};Object[a582_0x3ceaea(0x1c1)](exports,a582_0x3ceaea(0x1be),{'value':!![]});const date_fns_1=require('date-fns'),sequelize_1=require('sequelize'),Ticket_1=__importDefault(require(a582_0x3ceaea(0x1b8))),ShowTicketService_1=__importDefault(require(a582_0x3ceaea(0x1b6))),FindOrCreateATicketTrakingService_1=__importDefault(require('./FindOrCreateATicketTrakingService')),Setting_1=__importDefault(require(a582_0x3ceaea(0x1b4))),FindOrCreateTicketServiceMeta=async(_0x31db7c,_0x470526,_0x39d258,_0x3b5751,_0x3a82c0)=>{const _0x284b5e=a582_0x3ceaea;let _0x4e1da5=await Ticket_1['default'][_0x284b5e(0x1cc)]({'where':{'status':{[sequelize_1['Op']['or']]:['open',_0x284b5e(0x1ce),_0x284b5e(0x1b9)]},'contactId':_0x31db7c['id'],'companyId':_0x3b5751,'channel':_0x3a82c0},'order':[['id','DESC']]});_0x4e1da5&&await _0x4e1da5[_0x284b5e(0x1b3)]({'unreadMessages':_0x39d258});if(!_0x4e1da5){_0x4e1da5=await Ticket_1['default'][_0x284b5e(0x1cc)]({'where':{'contactId':_0x31db7c['id'],'channel':_0x3a82c0},'order':[[_0x284b5e(0x1c9),_0x284b5e(0x1ca)]]});_0x4e1da5&&(await _0x4e1da5[_0x284b5e(0x1b3)]({'status':'pending','userId':null,'unreadMessages':_0x39d258,'companyId':_0x3b5751,'channel':_0x3a82c0}),await(0x0,FindOrCreateATicketTrakingService_1['default'])({'ticketId':_0x4e1da5['id'],'companyId':_0x3b5751,'whatsappId':_0x4e1da5[_0x284b5e(0x1c7)],'userId':_0x4e1da5['userId']}));const _0x569935=await Setting_1[_0x284b5e(0x1c5)][_0x284b5e(0x1cc)]({'where':{'key':'timeCreateNewTicket'}}),_0x47911c=_0x569935?parseInt(_0x569935[_0x284b5e(0x1bd)],0xa):0x1c20;}return!_0x4e1da5&&(_0x4e1da5=await Ticket_1[_0x284b5e(0x1c5)]['findOne']({'where':{'updatedAt':{[sequelize_1['Op'][_0x284b5e(0x1b7)]]:[+(0x0,date_fns_1[_0x284b5e(0x1bf)])(new Date(),0x2),+new Date()]},'contactId':_0x31db7c['id']},'order':[[_0x284b5e(0x1c9),_0x284b5e(0x1ca)]]}),_0x4e1da5&&(await _0x4e1da5[_0x284b5e(0x1b3)]({'status':_0x284b5e(0x1ce),'userId':null,'unreadMessages':_0x39d258,'companyId':_0x3b5751,'channel':_0x3a82c0}),await(0x0,FindOrCreateATicketTrakingService_1['default'])({'ticketId':_0x4e1da5['id'],'companyId':_0x3b5751,'whatsappId':_0x4e1da5[_0x284b5e(0x1c7)],'userId':_0x4e1da5[_0x284b5e(0x1c2)]}))),!_0x4e1da5?(_0x4e1da5=await Ticket_1[_0x284b5e(0x1c5)][_0x284b5e(0x1cd)]({'contactId':_0x31db7c['id'],'status':'pending','isGroup':![],'unreadMessages':_0x39d258,'whatsappId':_0x470526,'companyId':_0x3b5751,'channel':_0x3a82c0}),await(0x0,FindOrCreateATicketTrakingService_1[_0x284b5e(0x1c5)])({'ticketId':_0x4e1da5['id'],'companyId':_0x3b5751,'whatsappId':_0x470526,'userId':_0x4e1da5[_0x284b5e(0x1c2)]})):await _0x4e1da5[_0x284b5e(0x1b3)]({'whatsappId':_0x470526}),_0x4e1da5=await(0x0,ShowTicketService_1[_0x284b5e(0x1c5)])(_0x4e1da5['id'],_0x3b5751),_0x4e1da5;};exports['default']=FindOrCreateTicketServiceMeta;function a582_0x1b6e(_0x414534,_0x210bf9){const _0x5dba34=a582_0x5dba();return a582_0x1b6e=function(_0x1b6e69,_0x5e287e){_0x1b6e69=_0x1b6e69-0x1b3;let _0x5d11bc=_0x5dba34[_0x1b6e69];return _0x5d11bc;},a582_0x1b6e(_0x414534,_0x210bf9);}function a582_0x5dba(){const _0x4a656c=['whatsappId','10651550XgvEVO','updatedAt','DESC','1826976JBHFZp','findOne','create','pending','36aEFxMI','31623735KDTjnS','update','../../models/Setting','3estdbs','./ShowTicketService','between','../../models/Ticket','closed','6vsSesP','27644zNRBqe','4273738pWXVPV','value','__esModule','subHours','1910548daUVSZ','defineProperty','userId','9IdGuvf','1607145piWzSf','default','__importDefault'];a582_0x5dba=function(){return _0x4a656c;};return a582_0x5dba();}
>>>>>>> ab722bfbcf394d74dd0b99a984c0dcf6ffbcff7f
