'use strict';const a602_0x359554=a602_0x3f0f;(function(_0x304a9b,_0xc87953){const _0x1f31a1=a602_0x3f0f,_0x135ecc=_0x304a9b();while(!![]){try{const _0x584638=-parseInt(_0x1f31a1(0xe4))/0x1+-parseInt(_0x1f31a1(0xb9))/0x2*(parseInt(_0x1f31a1(0xb0))/0x3)+parseInt(_0x1f31a1(0xdd))/0x4+parseInt(_0x1f31a1(0xc5))/0x5+parseInt(_0x1f31a1(0xd4))/0x6*(-parseInt(_0x1f31a1(0xde))/0x7)+-parseInt(_0x1f31a1(0xd3))/0x8*(-parseInt(_0x1f31a1(0xc3))/0x9)+parseInt(_0x1f31a1(0xdc))/0xa;if(_0x584638===_0xc87953)break;else _0x135ecc['push'](_0x135ecc['shift']());}catch(_0x376ecd){_0x135ecc['push'](_0x135ecc['shift']());}}}(a602_0x2965,0xd04b5));var __importDefault=this&&this[a602_0x359554(0xdb)]||function(_0x472e48){const _0x524ae5=a602_0x359554;return _0x472e48&&_0x472e48[_0x524ae5(0xd9)]?_0x472e48:{'default':_0x472e48};};Object[a602_0x359554(0xba)](exports,'__esModule',{'value':!![]});const sequelize_1=require(a602_0x359554(0xb5)),date_fns_1=require(a602_0x359554(0xb8)),Ticket_1=__importDefault(require(a602_0x359554(0xe7))),Contact_1=__importDefault(require(a602_0x359554(0xb4))),Message_1=__importDefault(require(a602_0x359554(0xbc))),Queue_1=__importDefault(require(a602_0x359554(0xb7))),User_1=__importDefault(require(a602_0x359554(0xb2))),ShowUserService_1=__importDefault(require(a602_0x359554(0xd6))),Tag_1=__importDefault(require(a602_0x359554(0xcc))),TicketTag_1=__importDefault(require(a602_0x359554(0xdf))),lodash_1=require(a602_0x359554(0xe6)),Whatsapp_1=__importDefault(require(a602_0x359554(0xd1))),ListTicketsServiceKanban=async({searchParam:searchParam='',pageNumber:pageNumber='1',queueIds:_0xb02326,tags:_0x41293b,users:_0x4afb76,status:_0x50d852,date:_0x15562e,updatedAt:_0x3edad5,showAll:_0x4d5526,userId:_0x37017e,withUnreadMessages:_0x159395,companyId:_0x2c3bcd})=>{const _0x577876=a602_0x359554;let _0x26c657={[sequelize_1['Op']['or']]:[{'userId':_0x37017e},{'status':_0x577876(0xd7)}],'queueId':{[sequelize_1['Op']['or']]:[_0xb02326,null]}},_0x5dc7aa;_0x5dc7aa=[{'model':Contact_1[_0x577876(0xda)],'as':_0x577876(0xe1),'attributes':['id',_0x577876(0xe0),_0x577876(0xb3),_0x577876(0xe3),_0x577876(0xcf),_0x577876(0xbf)]},{'model':Queue_1['default'],'as':'queue','attributes':['id',_0x577876(0xe0),_0x577876(0xaf)]},{'model':User_1[_0x577876(0xda)],'as':'user','attributes':['id','name']},{'model':Tag_1['default'],'as':'tags','attributes':['id',_0x577876(0xe0),'color']},{'model':Whatsapp_1['default'],'as':_0x577876(0xbe),'attributes':[_0x577876(0xe0)]}];_0x4d5526===_0x577876(0xc4)&&(_0x26c657={'queueId':{[sequelize_1['Op']['or']]:[_0xb02326,null]}});_0x26c657={..._0x26c657,'status':{[sequelize_1['Op']['or']]:[_0x577876(0xd7),_0x577876(0xd5)]}};if(searchParam){const _0x470be6=searchParam['toLocaleLowerCase']()[_0x577876(0xc8)]();_0x5dc7aa=[..._0x5dc7aa,{'model':Message_1[_0x577876(0xda)],'as':_0x577876(0xd0),'attributes':['id',_0x577876(0xd2)],'where':{'body':(0x0,sequelize_1[_0x577876(0xca)])((0x0,sequelize_1['fn'])(_0x577876(0xcd),(0x0,sequelize_1['col'])(_0x577876(0xd2))),'LIKE','%'+_0x470be6+'%')},'required':![],'duplicating':![]}],_0x26c657={..._0x26c657,[sequelize_1['Op']['or']]:[{'$contact.name$':(0x0,sequelize_1[_0x577876(0xca)])((0x0,sequelize_1['fn'])(_0x577876(0xcd),(0x0,sequelize_1['col'])(_0x577876(0xae))),_0x577876(0xc2),'%'+_0x470be6+'%')},{'$contact.number$':{[sequelize_1['Op'][_0x577876(0xcb)]]:'%'+_0x470be6+'%'}},{'$message.body$':(0x0,sequelize_1[_0x577876(0xca)])((0x0,sequelize_1['fn'])(_0x577876(0xcd),(0x0,sequelize_1[_0x577876(0xb1)])(_0x577876(0xd2))),'LIKE','%'+_0x470be6+'%')}]};}_0x15562e&&(_0x26c657={'createdAt':{[sequelize_1['Op'][_0x577876(0xb6)]]:[+(0x0,date_fns_1[_0x577876(0xc9)])((0x0,date_fns_1[_0x577876(0xbd)])(_0x15562e)),+(0x0,date_fns_1[_0x577876(0xc0)])((0x0,date_fns_1[_0x577876(0xbd)])(_0x15562e))]}});_0x3edad5&&(_0x26c657={'updatedAt':{[sequelize_1['Op'][_0x577876(0xb6)]]:[+(0x0,date_fns_1[_0x577876(0xc9)])((0x0,date_fns_1['parseISO'])(_0x3edad5)),+(0x0,date_fns_1['endOfDay'])((0x0,date_fns_1[_0x577876(0xbd)])(_0x3edad5))]}});if(_0x159395===_0x577876(0xc4)){const _0x562462=await(0x0,ShowUserService_1[_0x577876(0xda)])(_0x37017e,_0x2c3bcd),_0x53498c=_0x562462[_0x577876(0xe5)][_0x577876(0xd8)](_0x233d4e=>_0x233d4e['id']);_0x26c657={[sequelize_1['Op']['or']]:[{'userId':_0x37017e},{'status':_0x577876(0xd7)}],'queueId':{[sequelize_1['Op']['or']]:[_0x53498c,null]},'unreadMessages':{[sequelize_1['Op']['gt']]:0x0}};}if(Array['isArray'](_0x41293b)&&_0x41293b['length']>0x0){const _0x40b9c4=[];for(let _0x4eaada of _0x41293b){const _0x25a80d=await TicketTag_1['default'][_0x577876(0xe2)]({'where':{'tagId':_0x4eaada}});_0x25a80d&&_0x40b9c4[_0x577876(0xc7)](_0x25a80d[_0x577876(0xd8)](_0x27d3bf=>_0x27d3bf[_0x577876(0xad)]));}const _0x94ef4c=(0x0,lodash_1[_0x577876(0xbb)])(..._0x40b9c4);_0x26c657={..._0x26c657,'id':{[sequelize_1['Op']['in']]:_0x94ef4c}};}if(Array['isArray'](_0x4afb76)&&_0x4afb76[_0x577876(0xc6)]>0x0){const _0x106fa3=[];for(let _0x2a5825 of _0x4afb76){const _0x2b0fc4=await Ticket_1[_0x577876(0xda)][_0x577876(0xe2)]({'where':{'userId':_0x2a5825}});_0x2b0fc4&&_0x106fa3[_0x577876(0xc7)](_0x2b0fc4[_0x577876(0xd8)](_0x2d814f=>_0x2d814f['id']));}const _0x3f85ea=(0x0,lodash_1[_0x577876(0xbb)])(..._0x106fa3);_0x26c657={..._0x26c657,'id':{[sequelize_1['Op']['in']]:_0x3f85ea}};}const _0x1c625a=0x28,_0x55489d=_0x1c625a*(+pageNumber-0x1);_0x26c657={..._0x26c657,'companyId':_0x2c3bcd};const {count:_0x26ae00,rows:_0x108579}=await Ticket_1['default']['findAndCountAll']({'where':_0x26c657,'include':_0x5dc7aa,'distinct':!![],'limit':_0x1c625a,'offset':_0x55489d,'order':[[_0x577876(0xce),_0x577876(0xc1)]],'subQuery':![]}),_0x379a72=_0x26ae00>_0x55489d+_0x108579[_0x577876(0xc6)];return{'tickets':_0x108579,'count':_0x26ae00,'hasMore':_0x379a72};};function a602_0x3f0f(_0x47f9f4,_0x56b3e5){const _0x296500=a602_0x2965();return a602_0x3f0f=function(_0x3f0fa5,_0x9d050d){_0x3f0fa5=_0x3f0fa5-0xad;let _0x2485fb=_0x296500[_0x3f0fa5];return _0x2485fb;},a602_0x3f0f(_0x47f9f4,_0x56b3e5);}exports[a602_0x359554(0xda)]=ListTicketsServiceKanban;function a602_0x2965(){const _0x6d30da=['../UserServices/ShowUserService','pending','map','__esModule','default','__importDefault','15809380wfvehq','1333020JvRssf','5348763WEDgzB','../../models/TicketTag','name','contact','findAll','email','896580cgTnZW','queues','lodash','../../models/Ticket','ticketId','contact.name','color','57Doxswu','col','../../models/User','number','../../models/Contact','sequelize','between','../../models/Queue','date-fns','45742niCWdo','defineProperty','intersection','../../models/Message','parseISO','whatsapp','urlPicture','endOfDay','DESC','LIKE','970605LCsvtz','true','857290RWtpOc','length','push','trim','startOfDay','where','like','../../models/Tag','LOWER','updatedAt','companyId','messages','../../models/Whatsapp','body','64KLuQGp','6aMrVLu','open'];a602_0x2965=function(){return _0x6d30da;};return a602_0x2965();}