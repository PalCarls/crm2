'use strict';const a526_0x17c58a=a526_0x4d6d;function a526_0x250c(){const _0x218857=['../../models/Contact','sequelize','90mAhJQl','push','col','2506469lGGpin','whatsappId','1517351JNhTCm','10698bfeNvI','contact','Sequelize','queue','2070aRSuog','__esModule','../../models/User','profile','parseISO','companyId','between','max','DESC','user','name','profilePicUrl','340936OnznZP','660ziPGae','278386feCbFZ','defineProperty','../../models/Queue','1180HgMWgx','27zYlmAo','findAll','361530aRmHAk','updatedAt','endOfDay','contactId','queueId','map','default'];a526_0x250c=function(){return _0x218857;};return a526_0x250c();}function a526_0x4d6d(_0x3fd6a1,_0x34abba){const _0x250c3b=a526_0x250c();return a526_0x4d6d=function(_0x4d6d37,_0x5567e9){_0x4d6d37=_0x4d6d37-0x7b;let _0x181e0f=_0x250c3b[_0x4d6d37];return _0x181e0f;},a526_0x4d6d(_0x3fd6a1,_0x34abba);}(function(_0x5033bc,_0x3a9abc){const _0x5a75ee=a526_0x4d6d,_0x31bbeb=_0x5033bc();while(!![]){try{const _0x232a43=parseInt(_0x5a75ee(0x9c))/0x1+parseInt(_0x5a75ee(0x96))/0x2+parseInt(_0x5a75ee(0x88))/0x3*(parseInt(_0x5a75ee(0x99))/0x4)+parseInt(_0x5a75ee(0x95))/0x5*(parseInt(_0x5a75ee(0x84))/0x6)+parseInt(_0x5a75ee(0x81))/0x7+parseInt(_0x5a75ee(0x94))/0x8*(parseInt(_0x5a75ee(0x9a))/0x9)+parseInt(_0x5a75ee(0x7e))/0xa*(-parseInt(_0x5a75ee(0x83))/0xb);if(_0x232a43===_0x3a9abc)break;else _0x31bbeb['push'](_0x31bbeb['shift']());}catch(_0x432ab7){_0x31bbeb['push'](_0x31bbeb['shift']());}}}(a526_0x250c,0x2cf0e));var __importDefault=this&&this['__importDefault']||function(_0x3c783a){const _0x6a600b=a526_0x4d6d;return _0x3c783a&&_0x3c783a[_0x6a600b(0x89)]?_0x3c783a:{'default':_0x3c783a};};Object[a526_0x17c58a(0x97)](exports,a526_0x17c58a(0x89),{'value':!![]});const sequelize_1=require(a526_0x17c58a(0x7d)),date_fns_1=require('date-fns'),Ticket_1=__importDefault(require('../../models/Ticket')),User_1=__importDefault(require(a526_0x17c58a(0x8a))),Contact_1=__importDefault(require(a526_0x17c58a(0x7c))),Queue_1=__importDefault(require(a526_0x17c58a(0x98))),lodash_1=require('lodash'),TicketsQueuesService=async({dateStart:_0x2c436e,dateEnd:_0x3def9c,status:_0x316878,userId:_0x159785,queuesIds:_0x2f9ae4,companyId:_0x16455d,showAll:_0x146163,profile:_0x58b30c})=>{const _0x2d5122=a526_0x17c58a;let _0x2f184f={};const _0x30a566=[{'model':Contact_1[_0x2d5122(0x7b)],'as':_0x2d5122(0x85),'attributes':['id',_0x2d5122(0x92),'number',_0x2d5122(0x93)]},{'model':User_1[_0x2d5122(0x7b)],'as':_0x2d5122(0x91),'attributes':['id',_0x2d5122(0x92),_0x2d5122(0x8b)]},{'model':Queue_1[_0x2d5122(0x7b)],'as':_0x2d5122(0x87)}];if(_0x316878){const _0x4d0c3c=[],_0xd5661c=await Ticket_1[_0x2d5122(0x7b)][_0x2d5122(0x9b)]({'where':{'status':'open'},'group':[_0x2d5122(0x8d),'contactId',_0x2d5122(0xa0),'whatsappId'],'attributes':['companyId',_0x2d5122(0x9f),'queueId',_0x2d5122(0x82),[sequelize_1[_0x2d5122(0x86)]['fn'](_0x2d5122(0x8f),sequelize_1['Sequelize'][_0x2d5122(0x80)]('id')),'id']]});_0xd5661c&&_0x4d0c3c[_0x2d5122(0x7f)](_0xd5661c[_0x2d5122(0xa1)](_0x300426=>_0x300426['id']));const _0x7db676=(0x0,lodash_1['intersection'])(..._0x4d0c3c);_0x2f184f={..._0x2f184f,'id':{[sequelize_1['Op']['in']]:_0x7db676}};}_0x58b30c===_0x2d5122(0x91)&&(_0x2f184f={..._0x2f184f,'userId':_0x159785});_0x2c436e&&_0x3def9c&&(_0x2f184f={..._0x2f184f,'createdAt':{[sequelize_1['Op'][_0x2d5122(0x8e)]]:[+(0x0,date_fns_1['startOfDay'])((0x0,date_fns_1[_0x2d5122(0x8c)])(_0x2c436e)),+(0x0,date_fns_1[_0x2d5122(0x9e)])((0x0,date_fns_1['parseISO'])(_0x3def9c))]}});const _0x27939f=await Ticket_1['default'][_0x2d5122(0x9b)]({'where':{..._0x2f184f,'companyId':_0x16455d},'include':_0x30a566,'order':[[_0x2d5122(0x9d),_0x2d5122(0x90)]]});return _0x27939f;};exports[a526_0x17c58a(0x7b)]=TicketsQueuesService;