'use strict';const a637_0x5ce035=a637_0x1f52;function a637_0x1f52(_0x17a9db,_0x5bcd41){const _0x447473=a637_0x4474();return a637_0x1f52=function(_0x1f52a0,_0x392c22){_0x1f52a0=_0x1f52a0-0x134;let _0x5e231d=_0x447473[_0x1f52a0];return _0x5e231d;},a637_0x1f52(_0x17a9db,_0x5bcd41);}(function(_0x3e7774,_0x500e5b){const _0x55e8a8=a637_0x1f52,_0x227cb3=_0x3e7774();while(!![]){try{const _0x46deed=parseInt(_0x55e8a8(0x148))/0x1*(-parseInt(_0x55e8a8(0x143))/0x2)+-parseInt(_0x55e8a8(0x14f))/0x3*(parseInt(_0x55e8a8(0x142))/0x4)+-parseInt(_0x55e8a8(0x144))/0x5*(parseInt(_0x55e8a8(0x13e))/0x6)+-parseInt(_0x55e8a8(0x14c))/0x7+-parseInt(_0x55e8a8(0x141))/0x8*(-parseInt(_0x55e8a8(0x14e))/0x9)+-parseInt(_0x55e8a8(0x146))/0xa*(-parseInt(_0x55e8a8(0x13c))/0xb)+-parseInt(_0x55e8a8(0x150))/0xc*(-parseInt(_0x55e8a8(0x137))/0xd);if(_0x46deed===_0x500e5b)break;else _0x227cb3['push'](_0x227cb3['shift']());}catch(_0x1a5680){_0x227cb3['push'](_0x227cb3['shift']());}}}(a637_0x4474,0x24d27));var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x486e17,_0x51a07e,_0xa454ac,_0x2b20c8){const _0x4d003d=a637_0x1f52;if(_0x2b20c8===undefined)_0x2b20c8=_0xa454ac;var _0x12c876=Object['getOwnPropertyDescriptor'](_0x51a07e,_0xa454ac);(!_0x12c876||('get'in _0x12c876?!_0x51a07e[_0x4d003d(0x136)]:_0x12c876[_0x4d003d(0x13f)]||_0x12c876['configurable']))&&(_0x12c876={'enumerable':!![],'get':function(){return _0x51a07e[_0xa454ac];}}),Object[_0x4d003d(0x151)](_0x486e17,_0x2b20c8,_0x12c876);}:function(_0x489e18,_0x1ad8b3,_0x3ca01d,_0x244773){if(_0x244773===undefined)_0x244773=_0x3ca01d;_0x489e18[_0x244773]=_0x1ad8b3[_0x3ca01d];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0xfb04de,_0x44aaf7){const _0x2a408a=a637_0x1f52;Object['defineProperty'](_0xfb04de,_0x2a408a(0x14a),{'enumerable':!![],'value':_0x44aaf7});}:function(_0xee5dcd,_0x1e2f87){const _0x454edf=a637_0x1f52;_0xee5dcd[_0x454edf(0x14a)]=_0x1e2f87;}),__importStar=this&&this['__importStar']||function(_0x467a0a){const _0x101529=a637_0x1f52;if(_0x467a0a&&_0x467a0a[_0x101529(0x136)])return _0x467a0a;var _0x12e2db={};if(_0x467a0a!=null){for(var _0x5b1dd4 in _0x467a0a)if(_0x5b1dd4!==_0x101529(0x14a)&&Object['prototype'][_0x101529(0x14b)][_0x101529(0x135)](_0x467a0a,_0x5b1dd4))__createBinding(_0x12e2db,_0x467a0a,_0x5b1dd4);}return __setModuleDefault(_0x12e2db,_0x467a0a),_0x12e2db;},__importDefault=this&&this[a637_0x5ce035(0x147)]||function(_0x46e651){const _0x57d9c8=a637_0x5ce035;return _0x46e651&&_0x46e651[_0x57d9c8(0x136)]?_0x46e651:{'default':_0x46e651};};Object[a637_0x5ce035(0x151)](exports,a637_0x5ce035(0x136),{'value':!![]});function a637_0x4474(){const _0x3f0653=['9395BEbGDy','string','10lRXonZ','__importDefault','2581hpoTjz','object','default','hasOwnProperty','497945eVuzBD','update','108LZcmya','3939UqePtK','1180308lnsSTI','defineProperty','message','call','__esModule','65EYbJbd','../../errors/AppError','length','not','./ShowWhatsAppService','1434466OMmWFv','validate','138KBaQSV','writable','boolean','58952EIvblm','500EEkDAz','218ssuoxY'];a637_0x4474=function(){return _0x3f0653;};return a637_0x4474();}const Yup=__importStar(require('yup')),sequelize_1=require('sequelize'),AppError_1=__importDefault(require(a637_0x5ce035(0x138))),Whatsapp_1=__importDefault(require('../../models/Whatsapp')),ShowWhatsAppService_1=__importDefault(require(a637_0x5ce035(0x13b))),AssociateWhatsappQueue_1=__importDefault(require('./AssociateWhatsappQueue')),UpdateWhatsAppService=async({whatsappData:_0x5c1214,whatsappId:_0x52b5e4,companyId:_0x5db63e})=>{const _0x54cd89=a637_0x5ce035,_0xb781bd=Yup[_0x54cd89(0x149)]()['shape']({'name':Yup[_0x54cd89(0x145)]()['min'](0x2),'status':Yup['string'](),'isDefault':Yup[_0x54cd89(0x140)]()}),{name:_0x432a43,status:_0x19cb75,isDefault:_0x5e49fb,session:_0x4bd2a5,greetingMessage:_0xa217ca,complationMessage:_0x3cbc1d,outOfHoursMessage:_0x27b3b2,queueIds:queueIds=[],token:_0x5ede17,maxUseBotQueues:maxUseBotQueues=0x0,timeUseBotQueues:timeUseBotQueues=0x0,expiresTicket:expiresTicket=0x0,allowGroup:_0x180a58,timeSendQueue:timeSendQueue=0x0,sendIdQueue:sendIdQueue=null,timeInactiveMessage:timeInactiveMessage=0x0,inactiveMessage:_0x236531,ratingMessage:_0x25e7a2,maxUseBotQueuesNPS:_0x5ef153,expiresTicketNPS:expiresTicketNPS=0x0,whenExpiresTicket:_0x5b4904,expiresInactiveMessage:_0x119408,groupAsTicket:_0x22bb7e,importOldMessages:_0x108765,importRecentMessages:_0xeaa214,closedTicketsPostImported:_0x27b265,importOldMessagesGroups:_0x367854,timeCreateNewTicket:timeCreateNewTicket=null,integrationId:_0x576285,schedules:_0x20f6e1,promptId:_0x297a21,requestQR:requestQR=![]}=_0x5c1214;try{await _0xb781bd[_0x54cd89(0x13d)]({'name':_0x432a43,'status':_0x19cb75,'isDefault':_0x5e49fb});}catch(_0x37e7da){throw new AppError_1['default'](_0x37e7da[_0x54cd89(0x134)]);}if(queueIds[_0x54cd89(0x139)]>0x1&&!_0xa217ca)throw new AppError_1[(_0x54cd89(0x14a))]('ERR_WAPP_GREETING_REQUIRED');let _0x481da7=null;_0x5e49fb&&(_0x481da7=await Whatsapp_1[_0x54cd89(0x14a)]['findOne']({'where':{'isDefault':!![],'id':{[sequelize_1['Op'][_0x54cd89(0x13a)]]:_0x52b5e4},'companyId':_0x5db63e}}),_0x481da7&&await _0x481da7[_0x54cd89(0x14d)]({'isDefault':![]}));const _0x19cc7c=await(0x0,ShowWhatsAppService_1[_0x54cd89(0x14a)])(_0x52b5e4,_0x5db63e);return await _0x19cc7c[_0x54cd89(0x14d)]({'name':_0x432a43,'status':_0x19cb75,'session':_0x4bd2a5,'greetingMessage':_0xa217ca,'complationMessage':_0x3cbc1d,'outOfHoursMessage':_0x27b3b2,'isDefault':_0x5e49fb,'companyId':_0x5db63e,'token':_0x5ede17,'maxUseBotQueues':maxUseBotQueues||0x0,'timeUseBotQueues':timeUseBotQueues||0x0,'expiresTicket':expiresTicket||0x0,'allowGroup':_0x180a58,'timeSendQueue':timeSendQueue,'sendIdQueue':sendIdQueue,'timeInactiveMessage':timeInactiveMessage,'inactiveMessage':_0x236531,'ratingMessage':_0x25e7a2,'maxUseBotQueuesNPS':_0x5ef153,'expiresTicketNPS':expiresTicketNPS,'whenExpiresTicket':_0x5b4904,'expiresInactiveMessage':_0x119408,'groupAsTicket':_0x22bb7e,'importOldMessages':_0x108765,'importRecentMessages':_0xeaa214,'closedTicketsPostImported':_0x27b265,'importOldMessagesGroups':_0x367854,'timeCreateNewTicket':timeCreateNewTicket,'integrationId':_0x576285,'schedules':_0x20f6e1,'promptId':_0x297a21}),!requestQR&&await(0x0,AssociateWhatsappQueue_1[_0x54cd89(0x14a)])(_0x19cc7c,queueIds),{'whatsapp':_0x19cc7c,'oldDefaultWhatsapp':_0x481da7};};exports[a637_0x5ce035(0x14a)]=UpdateWhatsAppService;