'use strict';const a528_0x5b0b97=a528_0x5f7e;(function(_0x31adf8,_0x1d625b){const _0x1eea8d=a528_0x5f7e,_0x370416=_0x31adf8();while(!![]){try{const _0x200b55=-parseInt(_0x1eea8d(0x9a))/0x1+-parseInt(_0x1eea8d(0xa7))/0x2+-parseInt(_0x1eea8d(0x9f))/0x3+parseInt(_0x1eea8d(0xaa))/0x4+-parseInt(_0x1eea8d(0xa0))/0x5*(-parseInt(_0x1eea8d(0x93))/0x6)+parseInt(_0x1eea8d(0x95))/0x7+parseInt(_0x1eea8d(0xa2))/0x8;if(_0x200b55===_0x1d625b)break;else _0x370416['push'](_0x370416['shift']());}catch(_0x1cafbc){_0x370416['push'](_0x370416['shift']());}}}(a528_0x2c56,0xd1fc2));var __importDefault=this&&this[a528_0x5b0b97(0x99)]||function(_0x13e272){const _0x327a8d=a528_0x5b0b97;return _0x13e272&&_0x13e272[_0x327a8d(0xa1)]?_0x13e272:{'default':_0x13e272};};function a528_0x5f7e(_0x2b9df0,_0x248c90){const _0x2c561e=a528_0x2c56();return a528_0x5f7e=function(_0x5f7e2d,_0x1d1132){_0x5f7e2d=_0x5f7e2d-0x91;let _0x3fa568=_0x2c561e[_0x5f7e2d];return _0x3fa568;},a528_0x5f7e(_0x2b9df0,_0x248c90);}Object[a528_0x5b0b97(0x94)](exports,a528_0x5b0b97(0xa1),{'value':!![]});function a528_0x2c56(){const _0x4be0dd=['findOne','76672oripun','companyId','../../models/Setting','default','ERR_INVALID_CREDENTIALS','36OulWDV','defineProperty','4536385KaTsOa','createRefreshToken','checkPassword','../../models/User','__importDefault','1054075kIiHuY','endWork','../../models/Company','getMinutes','../../helpers/CreateTokens','3270126eeByhB','560765Rqktzn','__esModule','26116936Cibbxg','split','../../errors/AppError','../../helpers/SerializeUser','getHours','3201086TOaeFr','env'];a528_0x2c56=function(){return _0x4be0dd;};return a528_0x2c56();}const User_1=__importDefault(require(a528_0x5b0b97(0x98))),AppError_1=__importDefault(require(a528_0x5b0b97(0xa4))),CreateTokens_1=require(a528_0x5b0b97(0x9e)),SerializeUser_1=require(a528_0x5b0b97(0xa5)),Company_1=__importDefault(require(a528_0x5b0b97(0x9c))),Setting_1=__importDefault(require(a528_0x5b0b97(0xac))),AuthUserService=async({email:_0x542c54,password:_0x13519e})=>{const _0x2b7784=a528_0x5b0b97,_0x392a0d=await User_1[_0x2b7784(0x91)][_0x2b7784(0xa9)]({'where':{'email':_0x542c54},'include':['queues',{'model':Company_1[_0x2b7784(0x91)],'include':[{'model':Setting_1['default']}]}]});if(!_0x392a0d)throw new AppError_1['default']('ERR_INVALID_CREDENTIALS',0x191);const _0x59dcc1=new Date(),_0x12fc33=_0x59dcc1[_0x2b7784(0xa6)]()*0x3c*0x3c,_0x4bf095=_0x59dcc1[_0x2b7784(0x9d)]()*0x3c,_0x353ea5=_0x12fc33+_0x4bf095,_0x5a3ec2=_0x392a0d['startWork'],_0x975f38=Number(_0x5a3ec2[_0x2b7784(0xa3)](':')[0x0])*0x3c*0x3c,_0x438189=Number(_0x5a3ec2[_0x2b7784(0xa3)](':')[0x1])*0x3c,_0x20747a=_0x975f38+_0x438189,_0x186c7d=_0x392a0d[_0x2b7784(0x9b)],_0x241b81=Number(_0x186c7d[_0x2b7784(0xa3)](':')[0x0])*0x3c*0x3c,_0x420a48=Number(_0x186c7d['split'](':')[0x1])*0x3c,_0xa58f74=_0x241b81+_0x420a48;if(_0x353ea5<_0x20747a||_0x353ea5>_0xa58f74)throw new AppError_1[(_0x2b7784(0x91))]('ERR_OUT_OF_HOURS',0x191);if(_0x13519e===process[_0x2b7784(0xa8)]['MASTER_KEY']){}else{if(await _0x392a0d[_0x2b7784(0x97)](_0x13519e)){const _0x21148b=await Company_1['default']['findByPk'](_0x392a0d?.[_0x2b7784(0xab)]);await _0x21148b['update']({'lastLogin':new Date()});}else throw new AppError_1[(_0x2b7784(0x91))](_0x2b7784(0x92),0x191);}const _0x52c62b=(0x0,CreateTokens_1['createAccessToken'])(_0x392a0d),_0x4f8580=(0x0,CreateTokens_1[_0x2b7784(0x96)])(_0x392a0d),_0x52c192=await(0x0,SerializeUser_1['SerializeUser'])(_0x392a0d);return{'serializedUser':_0x52c192,'token':_0x52c62b,'refreshToken':_0x4f8580};};exports[a528_0x5b0b97(0x91)]=AuthUserService;