'use strict';const a510_0x3b5c74=a510_0x42a4;function a510_0x42a4(_0x1efe50,_0x9628fc){const _0x192e3a=a510_0x192e();return a510_0x42a4=function(_0x42a42d,_0x9b9187){_0x42a42d=_0x42a42d-0x1c0;let _0x296168=_0x192e3a[_0x42a42d];return _0x296168;},a510_0x42a4(_0x1efe50,_0x9628fc);}(function(_0x50d11c,_0x336e7e){const _0x20bab9=a510_0x42a4,_0x2de46d=_0x50d11c();while(!![]){try{const _0x3075a2=-parseInt(_0x20bab9(0x1da))/0x1*(parseInt(_0x20bab9(0x1c7))/0x2)+parseInt(_0x20bab9(0x1d1))/0x3+-parseInt(_0x20bab9(0x1d7))/0x4+parseInt(_0x20bab9(0x1de))/0x5*(parseInt(_0x20bab9(0x1e4))/0x6)+-parseInt(_0x20bab9(0x1c4))/0x7*(-parseInt(_0x20bab9(0x1c5))/0x8)+parseInt(_0x20bab9(0x1dc))/0x9+parseInt(_0x20bab9(0x1db))/0xa*(-parseInt(_0x20bab9(0x1c0))/0xb);if(_0x3075a2===_0x336e7e)break;else _0x2de46d['push'](_0x2de46d['shift']());}catch(_0x1c8f07){_0x2de46d['push'](_0x2de46d['shift']());}}}(a510_0x192e,0x9f73b));function a510_0x192e(){const _0x1a0567=['2960880EHjDMl','validate','getOwnPropertyDescriptor','__setModuleDefault','queues','min','4196208hRRaKS','message','../../helpers/SerializeUser','235309nfGhYk','50BLdNou','9286632CmatDH','__esModule','1415450WXxDDW','../../errors/AppError','plan','required','call','__importDefault','18uZhVPy','Check-email','test','object','shape','string','SerializeUser','2066603MdxCKF','$set','__importStar','admin','61341XmVjRQ','8PMPJtg','findOne','2lqAivz','defineProperty','users','company','yup','create','default','../../models/Company','An\x20user\x20with\x20this\x20email\x20already\x20exists.','hasOwnProperty'];a510_0x192e=function(){return _0x1a0567;};return a510_0x192e();}var __createBinding=this&&this['__createBinding']||(Object[a510_0x3b5c74(0x1cc)]?function(_0x87ebde,_0x5db412,_0xb6aed6,_0x413024){const _0x1764c0=a510_0x3b5c74;if(_0x413024===undefined)_0x413024=_0xb6aed6;var _0x386f8c=Object[_0x1764c0(0x1d3)](_0x5db412,_0xb6aed6);(!_0x386f8c||('get'in _0x386f8c?!_0x5db412[_0x1764c0(0x1dd)]:_0x386f8c['writable']||_0x386f8c['configurable']))&&(_0x386f8c={'enumerable':!![],'get':function(){return _0x5db412[_0xb6aed6];}}),Object[_0x1764c0(0x1c8)](_0x87ebde,_0x413024,_0x386f8c);}:function(_0x443256,_0x246af3,_0x1b0764,_0x578d1f){if(_0x578d1f===undefined)_0x578d1f=_0x1b0764;_0x443256[_0x578d1f]=_0x246af3[_0x1b0764];}),__setModuleDefault=this&&this[a510_0x3b5c74(0x1d4)]||(Object['create']?function(_0x1c33bf,_0x3c73fe){const _0x135dd2=a510_0x3b5c74;Object[_0x135dd2(0x1c8)](_0x1c33bf,_0x135dd2(0x1cd),{'enumerable':!![],'value':_0x3c73fe});}:function(_0x3e351a,_0x5b264c){const _0x27101b=a510_0x3b5c74;_0x3e351a[_0x27101b(0x1cd)]=_0x5b264c;}),__importStar=this&&this[a510_0x3b5c74(0x1c2)]||function(_0x53cbda){const _0x588713=a510_0x3b5c74;if(_0x53cbda&&_0x53cbda['__esModule'])return _0x53cbda;var _0x2b4515={};if(_0x53cbda!=null){for(var _0x2932e8 in _0x53cbda)if(_0x2932e8!==_0x588713(0x1cd)&&Object['prototype'][_0x588713(0x1d0)][_0x588713(0x1e2)](_0x53cbda,_0x2932e8))__createBinding(_0x2b4515,_0x53cbda,_0x2932e8);}return __setModuleDefault(_0x2b4515,_0x53cbda),_0x2b4515;},__importDefault=this&&this[a510_0x3b5c74(0x1e3)]||function(_0x70f10c){const _0x2e1a8a=a510_0x3b5c74;return _0x70f10c&&_0x70f10c[_0x2e1a8a(0x1dd)]?_0x70f10c:{'default':_0x70f10c};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const Yup=__importStar(require(a510_0x3b5c74(0x1cb))),AppError_1=__importDefault(require(a510_0x3b5c74(0x1df))),SerializeUser_1=require(a510_0x3b5c74(0x1d9)),User_1=__importDefault(require('../../models/User')),Plan_1=__importDefault(require('../../models/Plan')),Company_1=__importDefault(require(a510_0x3b5c74(0x1ce))),CreateUserService=async({email:_0x740ca2,password:_0xeebcc,name:_0x2a6048,queueIds:queueIds=[],companyId:_0x5996a6,profile:profile=a510_0x3b5c74(0x1c3),startWork:_0x57223e,endWork:_0x4a6e04,whatsappId:_0x54c025,allTicket:_0x4981b2,defaultTheme:_0x1a6922,defaultMenu:_0x5ed956,allowGroup:_0x5db502})=>{const _0x29c5aa=a510_0x3b5c74;if(_0x5996a6!==undefined){const _0x15ab8f=await Company_1[_0x29c5aa(0x1cd)]['findOne']({'where':{'id':_0x5996a6},'include':[{'model':Plan_1['default'],'as':_0x29c5aa(0x1e0)}]});if(_0x15ab8f!==null){const _0xfb2f10=await User_1[_0x29c5aa(0x1cd)]['count']({'where':{'companyId':_0x5996a6}});if(_0xfb2f10>=_0x15ab8f['plan'][_0x29c5aa(0x1c9)])throw new AppError_1['default']('Número\x20máximo\x20de\x20usuários\x20já\x20alcançado:\x20'+_0xfb2f10);}}const _0x1779b1=Yup[_0x29c5aa(0x1e7)]()[_0x29c5aa(0x1e8)]({'name':Yup[_0x29c5aa(0x1e9)]()[_0x29c5aa(0x1e1)]()[_0x29c5aa(0x1d6)](0x2),'email':Yup[_0x29c5aa(0x1e9)]()['email']()['required']()[_0x29c5aa(0x1e6)](_0x29c5aa(0x1e5),_0x29c5aa(0x1cf),async _0x3e3335=>{const _0x4bcab3=_0x29c5aa;if(!_0x3e3335)return![];const _0x39c087=await User_1['default'][_0x4bcab3(0x1c6)]({'where':{'email':_0x3e3335}});return!_0x39c087;}),'password':Yup['string']()[_0x29c5aa(0x1e1)]()['min'](0x5)});try{await _0x1779b1[_0x29c5aa(0x1d2)]({'email':_0x740ca2,'password':_0xeebcc,'name':_0x2a6048});}catch(_0x2224f9){throw new AppError_1['default'](_0x2224f9[_0x29c5aa(0x1d8)]);}const _0x1882fa=await User_1['default'][_0x29c5aa(0x1cc)]({'email':_0x740ca2,'password':_0xeebcc,'name':_0x2a6048,'companyId':_0x5996a6,'profile':profile,'startWork':_0x57223e,'endWork':_0x4a6e04,'whatsappId':_0x54c025||null,'allTicket':_0x4981b2,'defaultTheme':_0x1a6922,'defaultMenu':_0x5ed956,'allowGroup':_0x5db502},{'include':[_0x29c5aa(0x1d5),_0x29c5aa(0x1ca)]});await _0x1882fa[_0x29c5aa(0x1c1)](_0x29c5aa(0x1d5),queueIds),await _0x1882fa['reload']();const _0x232bf7=(0x0,SerializeUser_1[_0x29c5aa(0x1ea)])(_0x1882fa);return _0x232bf7;};exports[a510_0x3b5c74(0x1cd)]=CreateUserService;