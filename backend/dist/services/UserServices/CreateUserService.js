'use strict';function a530_0x2e14(){const _0x14719d=['885626hKsxFY','6968124boNtED','string','Check-email','test','__importStar','message','30TfrPfK','SerializeUser','../../helpers/SerializeUser','writable','create','603ELlpyp','company','Número\x20máximo\x20de\x20usuários\x20já\x20alcançado:\x20','count','configurable','240242fyTmCP','167613zIoVIh','min','An\x20user\x20with\x20this\x20email\x20already\x20exists.','getOwnPropertyDescriptor','defineProperty','../../models/Company','default','yup','20hcaRkA','get','object','findOne','email','queues','../../errors/AppError','597612WVhIKL','8bsEXJp','../../models/User','__createBinding','hasOwnProperty','admin','48416BoSyBp','3QMzQJu','reload','$set','validate','required','566379lVvKPW','__importDefault','plan','__esModule'];a530_0x2e14=function(){return _0x14719d;};return a530_0x2e14();}const a530_0x43efea=a530_0x45d2;(function(_0x58b364,_0x38dbab){const _0x5330e5=a530_0x45d2,_0x430698=_0x58b364();while(!![]){try{const _0x1cd5e2=-parseInt(_0x5330e5(0x10d))/0x1*(-parseInt(_0x5330e5(0x127))/0x2)+parseInt(_0x5330e5(0x128))/0x3*(parseInt(_0x5330e5(0x107))/0x4)+parseInt(_0x5330e5(0xff))/0x5*(-parseInt(_0x5330e5(0x106))/0x6)+-parseInt(_0x5330e5(0x116))/0x7+parseInt(_0x5330e5(0x10c))/0x8*(-parseInt(_0x5330e5(0x122))/0x9)+parseInt(_0x5330e5(0x11d))/0xa*(parseInt(_0x5330e5(0x112))/0xb)+parseInt(_0x5330e5(0x117))/0xc;if(_0x1cd5e2===_0x38dbab)break;else _0x430698['push'](_0x430698['shift']());}catch(_0x38b456){_0x430698['push'](_0x430698['shift']());}}}(a530_0x2e14,0x43967));var __createBinding=this&&this[a530_0x43efea(0x109)]||(Object[a530_0x43efea(0x121)]?function(_0x11a416,_0x2d5e2f,_0x23ae26,_0x7a608d){const _0x20f36c=a530_0x43efea;if(_0x7a608d===undefined)_0x7a608d=_0x23ae26;var _0x4c1022=Object[_0x20f36c(0xfa)](_0x2d5e2f,_0x23ae26);(!_0x4c1022||(_0x20f36c(0x100)in _0x4c1022?!_0x2d5e2f['__esModule']:_0x4c1022[_0x20f36c(0x120)]||_0x4c1022[_0x20f36c(0x126)]))&&(_0x4c1022={'enumerable':!![],'get':function(){return _0x2d5e2f[_0x23ae26];}}),Object[_0x20f36c(0xfb)](_0x11a416,_0x7a608d,_0x4c1022);}:function(_0x265015,_0x29b9a5,_0x9cfe56,_0x3219e8){if(_0x3219e8===undefined)_0x3219e8=_0x9cfe56;_0x265015[_0x3219e8]=_0x29b9a5[_0x9cfe56];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a530_0x43efea(0x121)]?function(_0x5401b5,_0x266887){const _0x152691=a530_0x43efea;Object[_0x152691(0xfb)](_0x5401b5,_0x152691(0xfd),{'enumerable':!![],'value':_0x266887});}:function(_0x226ced,_0x586bad){const _0x28903f=a530_0x43efea;_0x226ced[_0x28903f(0xfd)]=_0x586bad;}),__importStar=this&&this[a530_0x43efea(0x11b)]||function(_0x13131a){const _0x5cca94=a530_0x43efea;if(_0x13131a&&_0x13131a['__esModule'])return _0x13131a;var _0x5c9d5c={};if(_0x13131a!=null){for(var _0x204836 in _0x13131a)if(_0x204836!==_0x5cca94(0xfd)&&Object['prototype'][_0x5cca94(0x10a)]['call'](_0x13131a,_0x204836))__createBinding(_0x5c9d5c,_0x13131a,_0x204836);}return __setModuleDefault(_0x5c9d5c,_0x13131a),_0x5c9d5c;},__importDefault=this&&this[a530_0x43efea(0x113)]||function(_0x11d1ed){const _0x2aef15=a530_0x43efea;return _0x11d1ed&&_0x11d1ed[_0x2aef15(0x115)]?_0x11d1ed:{'default':_0x11d1ed};};function a530_0x45d2(_0x514bb0,_0x4f7268){const _0x2e14a2=a530_0x2e14();return a530_0x45d2=function(_0x45d2d7,_0x3b67c7){_0x45d2d7=_0x45d2d7-0xf8;let _0x56d4e3=_0x2e14a2[_0x45d2d7];return _0x56d4e3;},a530_0x45d2(_0x514bb0,_0x4f7268);}Object[a530_0x43efea(0xfb)](exports,a530_0x43efea(0x115),{'value':!![]});const Yup=__importStar(require(a530_0x43efea(0xfe))),AppError_1=__importDefault(require(a530_0x43efea(0x105))),SerializeUser_1=require(a530_0x43efea(0x11f)),User_1=__importDefault(require(a530_0x43efea(0x108))),Plan_1=__importDefault(require('../../models/Plan')),Company_1=__importDefault(require(a530_0x43efea(0xfc))),CreateUserService=async({email:_0x361a7f,password:_0x20fb91,name:_0xd6fd9d,queueIds:queueIds=[],companyId:_0x1fdf68,profile:profile=a530_0x43efea(0x10b),startWork:_0x3bbbc2,endWork:_0x472e01,whatsappId:_0x3bb0f1,allTicket:_0x5309ed,defaultTheme:_0x2d9239,defaultMenu:_0x530574,allowGroup:_0x3bd5b6})=>{const _0x54e7ac=a530_0x43efea;if(_0x1fdf68!==undefined){const _0x24170c=await Company_1['default'][_0x54e7ac(0x102)]({'where':{'id':_0x1fdf68},'include':[{'model':Plan_1['default'],'as':_0x54e7ac(0x114)}]});if(_0x24170c!==null){const _0x42be77=await User_1['default'][_0x54e7ac(0x125)]({'where':{'companyId':_0x1fdf68}});if(_0x42be77>=_0x24170c[_0x54e7ac(0x114)]['users'])throw new AppError_1['default'](_0x54e7ac(0x124)+_0x42be77);}}const _0x29b4b5=Yup[_0x54e7ac(0x101)]()['shape']({'name':Yup['string']()[_0x54e7ac(0x111)]()[_0x54e7ac(0xf8)](0x2),'email':Yup[_0x54e7ac(0x118)]()[_0x54e7ac(0x103)]()[_0x54e7ac(0x111)]()[_0x54e7ac(0x11a)](_0x54e7ac(0x119),_0x54e7ac(0xf9),async _0x4a414a=>{if(!_0x4a414a)return![];const _0x5b7dc3=await User_1['default']['findOne']({'where':{'email':_0x4a414a}});return!_0x5b7dc3;}),'password':Yup['string']()['required']()[_0x54e7ac(0xf8)](0x5)});try{await _0x29b4b5[_0x54e7ac(0x110)]({'email':_0x361a7f,'password':_0x20fb91,'name':_0xd6fd9d});}catch(_0xf6a45){throw new AppError_1['default'](_0xf6a45[_0x54e7ac(0x11c)]);}const _0x49b281=await User_1[_0x54e7ac(0xfd)][_0x54e7ac(0x121)]({'email':_0x361a7f,'password':_0x20fb91,'name':_0xd6fd9d,'companyId':_0x1fdf68,'profile':profile,'startWork':_0x3bbbc2,'endWork':_0x472e01,'whatsappId':_0x3bb0f1||null,'allTicket':_0x5309ed,'defaultTheme':_0x2d9239,'defaultMenu':_0x530574,'allowGroup':_0x3bd5b6},{'include':[_0x54e7ac(0x104),_0x54e7ac(0x123)]});await _0x49b281[_0x54e7ac(0x10f)]('queues',queueIds),await _0x49b281[_0x54e7ac(0x10e)]();const _0x41875b=(0x0,SerializeUser_1[_0x54e7ac(0x11e)])(_0x49b281);return _0x41875b;};exports['default']=CreateUserService;