'use strict';const a529_0x306f9a=a529_0x241e;function a529_0x32f0(){const _0x1e4134=['3JpDngu','default','object','message','98665PWUCyF','company','../../helpers/SerializeUser','__setModuleDefault','call','522TPnMig','defineProperty','users','../../errors/AppError','../../models/Plan','12131584frTyUh','create','getOwnPropertyDescriptor','__esModule','findOne','email','97000DPCGFH','__importDefault','SerializeUser','__importStar','hasOwnProperty','validate','1257710jpltZi','An\x20user\x20with\x20this\x20email\x20already\x20exists.','../../models/User','Check-email','configurable','writable','shape','1203972XDcGBs','queues','plan','yup','342bumHdD','Número\x20máximo\x20de\x20usuários\x20já\x20alcançado:\x20','1467256laRWkd','1056084MATgAI','__createBinding','required','prototype','reload','test','string'];a529_0x32f0=function(){return _0x1e4134;};return a529_0x32f0();}(function(_0x3bce16,_0x5cc015){const _0x58cc4d=a529_0x241e,_0x33b053=_0x3bce16();while(!![]){try{const _0x7a3c8d=-parseInt(_0x58cc4d(0x167))/0x1+-parseInt(_0x58cc4d(0x18f))/0x2+-parseInt(_0x58cc4d(0x175))/0x3*(parseInt(_0x58cc4d(0x16e))/0x4)+-parseInt(_0x58cc4d(0x179))/0x5*(-parseInt(_0x58cc4d(0x16b))/0x6)+-parseInt(_0x58cc4d(0x16d))/0x7+parseInt(_0x58cc4d(0x183))/0x8+parseInt(_0x58cc4d(0x17e))/0x9*(parseInt(_0x58cc4d(0x189))/0xa);if(_0x7a3c8d===_0x5cc015)break;else _0x33b053['push'](_0x33b053['shift']());}catch(_0x46ac5a){_0x33b053['push'](_0x33b053['shift']());}}}(a529_0x32f0,0xdb15d));function a529_0x241e(_0x46cb80,_0x6e6935){const _0x32f086=a529_0x32f0();return a529_0x241e=function(_0x241e3e,_0x43ac78){_0x241e3e=_0x241e3e-0x162;let _0x27b9b8=_0x32f086[_0x241e3e];return _0x27b9b8;},a529_0x241e(_0x46cb80,_0x6e6935);}var __createBinding=this&&this[a529_0x306f9a(0x16f)]||(Object[a529_0x306f9a(0x184)]?function(_0x3629ad,_0x788da8,_0x5d5cd9,_0xc20cd7){const _0x3f48f8=a529_0x306f9a;if(_0xc20cd7===undefined)_0xc20cd7=_0x5d5cd9;var _0x4cc0ea=Object[_0x3f48f8(0x185)](_0x788da8,_0x5d5cd9);(!_0x4cc0ea||('get'in _0x4cc0ea?!_0x788da8['__esModule']:_0x4cc0ea[_0x3f48f8(0x165)]||_0x4cc0ea[_0x3f48f8(0x164)]))&&(_0x4cc0ea={'enumerable':!![],'get':function(){return _0x788da8[_0x5d5cd9];}}),Object[_0x3f48f8(0x17f)](_0x3629ad,_0xc20cd7,_0x4cc0ea);}:function(_0x40be74,_0x56639c,_0x43c74c,_0xec6ff1){if(_0xec6ff1===undefined)_0xec6ff1=_0x43c74c;_0x40be74[_0xec6ff1]=_0x56639c[_0x43c74c];}),__setModuleDefault=this&&this[a529_0x306f9a(0x17c)]||(Object[a529_0x306f9a(0x184)]?function(_0x37c4e7,_0xc3a0ce){const _0x4895fe=a529_0x306f9a;Object['defineProperty'](_0x37c4e7,_0x4895fe(0x176),{'enumerable':!![],'value':_0xc3a0ce});}:function(_0x5a9a2d,_0x283b92){_0x5a9a2d['default']=_0x283b92;}),__importStar=this&&this[a529_0x306f9a(0x18c)]||function(_0x3bf908){const _0x5975a0=a529_0x306f9a;if(_0x3bf908&&_0x3bf908['__esModule'])return _0x3bf908;var _0x2cef01={};if(_0x3bf908!=null){for(var _0x11fd93 in _0x3bf908)if(_0x11fd93!==_0x5975a0(0x176)&&Object[_0x5975a0(0x171)][_0x5975a0(0x18d)][_0x5975a0(0x17d)](_0x3bf908,_0x11fd93))__createBinding(_0x2cef01,_0x3bf908,_0x11fd93);}return __setModuleDefault(_0x2cef01,_0x3bf908),_0x2cef01;},__importDefault=this&&this[a529_0x306f9a(0x18a)]||function(_0x5e599e){return _0x5e599e&&_0x5e599e['__esModule']?_0x5e599e:{'default':_0x5e599e};};Object[a529_0x306f9a(0x17f)](exports,a529_0x306f9a(0x186),{'value':!![]});const Yup=__importStar(require(a529_0x306f9a(0x16a))),AppError_1=__importDefault(require(a529_0x306f9a(0x181))),SerializeUser_1=require(a529_0x306f9a(0x17b)),User_1=__importDefault(require(a529_0x306f9a(0x162))),Plan_1=__importDefault(require(a529_0x306f9a(0x182))),Company_1=__importDefault(require('../../models/Company')),CreateUserService=async({email:_0x34020f,password:_0x277257,name:_0x2c3dd0,queueIds:queueIds=[],companyId:_0x3b1aef,profile:profile='admin',startWork:_0x3e0661,endWork:_0x2be725,whatsappId:_0x266a55,allTicket:_0x5b3c2b,defaultTheme:_0x490c3b,defaultMenu:_0x447b74,allowGroup:_0xf81e97})=>{const _0x3916ff=a529_0x306f9a;if(_0x3b1aef!==undefined){const _0x3d71c8=await Company_1[_0x3916ff(0x176)]['findOne']({'where':{'id':_0x3b1aef},'include':[{'model':Plan_1['default'],'as':_0x3916ff(0x169)}]});if(_0x3d71c8!==null){const _0x1b4e07=await User_1['default']['count']({'where':{'companyId':_0x3b1aef}});if(_0x1b4e07>=_0x3d71c8['plan'][_0x3916ff(0x180)])throw new AppError_1['default'](_0x3916ff(0x16c)+_0x1b4e07);}}const _0x4e9456=Yup[_0x3916ff(0x177)]()[_0x3916ff(0x166)]({'name':Yup[_0x3916ff(0x174)]()[_0x3916ff(0x170)]()['min'](0x2),'email':Yup[_0x3916ff(0x174)]()[_0x3916ff(0x188)]()[_0x3916ff(0x170)]()[_0x3916ff(0x173)](_0x3916ff(0x163),_0x3916ff(0x190),async _0x56eda0=>{const _0x2daef5=_0x3916ff;if(!_0x56eda0)return![];const _0xc4bd2b=await User_1[_0x2daef5(0x176)][_0x2daef5(0x187)]({'where':{'email':_0x56eda0}});return!_0xc4bd2b;}),'password':Yup['string']()['required']()['min'](0x5)});try{await _0x4e9456[_0x3916ff(0x18e)]({'email':_0x34020f,'password':_0x277257,'name':_0x2c3dd0});}catch(_0x4f0003){throw new AppError_1[(_0x3916ff(0x176))](_0x4f0003[_0x3916ff(0x178)]);}const _0x2618e5=await User_1[_0x3916ff(0x176)][_0x3916ff(0x184)]({'email':_0x34020f,'password':_0x277257,'name':_0x2c3dd0,'companyId':_0x3b1aef,'profile':profile,'startWork':_0x3e0661,'endWork':_0x2be725,'whatsappId':_0x266a55||null,'allTicket':_0x5b3c2b,'defaultTheme':_0x490c3b,'defaultMenu':_0x447b74,'allowGroup':_0xf81e97},{'include':[_0x3916ff(0x168),_0x3916ff(0x17a)]});await _0x2618e5['$set']('queues',queueIds),await _0x2618e5[_0x3916ff(0x172)]();const _0xd1b4e6=(0x0,SerializeUser_1[_0x3916ff(0x18b)])(_0x2618e5);return _0xd1b4e6;};exports[a529_0x306f9a(0x176)]=CreateUserService;