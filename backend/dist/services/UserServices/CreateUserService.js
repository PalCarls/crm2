'use strict';const a604_0x1dcf71=a604_0x3037;(function(_0x3dc259,_0x2c18d0){const _0x198ba1=a604_0x3037,_0x50c040=_0x3dc259();while(!![]){try{const _0x48b628=-parseInt(_0x198ba1(0x7a))/0x1+-parseInt(_0x198ba1(0x90))/0x2+parseInt(_0x198ba1(0x8f))/0x3+parseInt(_0x198ba1(0x89))/0x4+-parseInt(_0x198ba1(0x7c))/0x5+parseInt(_0x198ba1(0x8b))/0x6+parseInt(_0x198ba1(0x93))/0x7;if(_0x48b628===_0x2c18d0)break;else _0x50c040['push'](_0x50c040['shift']());}catch(_0x5d196){_0x50c040['push'](_0x50c040['shift']());}}}(a604_0x1daf,0x6625a));function a604_0x3037(_0x35ce48,_0x466e92){const _0x1daf7f=a604_0x1daf();return a604_0x3037=function(_0x3037b1,_0x51f28e){_0x3037b1=_0x3037b1-0x76;let _0x3e243a=_0x1daf7f[_0x3037b1];return _0x3e243a;},a604_0x3037(_0x35ce48,_0x466e92);}function a604_0x1daf(){const _0x2396ad=['2377220wYfsZm','An\x20user\x20with\x20this\x20email\x20already\x20exists.','1786860zyppoz','Número\x20máximo\x20de\x20usuários\x20já\x20alcançado:\x20','message','__esModule','710361KhxTDf','1329176ybRJsd','../../models/Plan','reload','7561820jxSqkl','../../models/User','yup','hasOwnProperty','users','__setModuleDefault','validate','defineProperty','email','__importDefault','string','required','__createBinding','object','create','configurable','../../errors/AppError','__importStar','prototype','603406LdytYo','min','2613870ZeXNRm','call','../../helpers/SerializeUser','count','Check-email','../../models/Company','queues','$set','test','plan','findOne','getOwnPropertyDescriptor','default'];a604_0x1daf=function(){return _0x2396ad;};return a604_0x1daf();}var __createBinding=this&&this[a604_0x1dcf71(0x9f)]||(Object[a604_0x1dcf71(0xa1)]?function(_0x1c998c,_0x201d8c,_0x21180e,_0x30de62){const _0x3123e1=a604_0x1dcf71;if(_0x30de62===undefined)_0x30de62=_0x21180e;var _0x40b0ca=Object[_0x3123e1(0x87)](_0x201d8c,_0x21180e);(!_0x40b0ca||('get'in _0x40b0ca?!_0x201d8c[_0x3123e1(0x8e)]:_0x40b0ca['writable']||_0x40b0ca[_0x3123e1(0x76)]))&&(_0x40b0ca={'enumerable':!![],'get':function(){return _0x201d8c[_0x21180e];}}),Object[_0x3123e1(0x9a)](_0x1c998c,_0x30de62,_0x40b0ca);}:function(_0x322d6e,_0x2f55be,_0x231f10,_0x4ebcc3){if(_0x4ebcc3===undefined)_0x4ebcc3=_0x231f10;_0x322d6e[_0x4ebcc3]=_0x2f55be[_0x231f10];}),__setModuleDefault=this&&this[a604_0x1dcf71(0x98)]||(Object[a604_0x1dcf71(0xa1)]?function(_0x64b493,_0xeea103){const _0x4b1e20=a604_0x1dcf71;Object[_0x4b1e20(0x9a)](_0x64b493,_0x4b1e20(0x88),{'enumerable':!![],'value':_0xeea103});}:function(_0x2d882a,_0x158959){const _0x1bbb92=a604_0x1dcf71;_0x2d882a[_0x1bbb92(0x88)]=_0x158959;}),__importStar=this&&this[a604_0x1dcf71(0x78)]||function(_0x3072b5){const _0x44f638=a604_0x1dcf71;if(_0x3072b5&&_0x3072b5[_0x44f638(0x8e)])return _0x3072b5;var _0x7b148c={};if(_0x3072b5!=null){for(var _0x122096 in _0x3072b5)if(_0x122096!==_0x44f638(0x88)&&Object[_0x44f638(0x79)][_0x44f638(0x96)][_0x44f638(0x7d)](_0x3072b5,_0x122096))__createBinding(_0x7b148c,_0x3072b5,_0x122096);}return __setModuleDefault(_0x7b148c,_0x3072b5),_0x7b148c;},__importDefault=this&&this[a604_0x1dcf71(0x9c)]||function(_0x5af2a2){return _0x5af2a2&&_0x5af2a2['__esModule']?_0x5af2a2:{'default':_0x5af2a2};};Object[a604_0x1dcf71(0x9a)](exports,a604_0x1dcf71(0x8e),{'value':!![]});const Yup=__importStar(require(a604_0x1dcf71(0x95))),AppError_1=__importDefault(require(a604_0x1dcf71(0x77))),SerializeUser_1=require(a604_0x1dcf71(0x7e)),User_1=__importDefault(require(a604_0x1dcf71(0x94))),Plan_1=__importDefault(require(a604_0x1dcf71(0x91))),Company_1=__importDefault(require(a604_0x1dcf71(0x81))),CreateUserService=async({email:_0x396163,password:_0x2df136,name:_0x300a34,queueIds:queueIds=[],companyId:_0x210ce1,profile:profile='admin',startWork:_0x2d2c4c,endWork:_0x459af4,whatsappId:_0x479f3a,allTicket:_0x4b9a0b,defaultTheme:_0x195638,defaultMenu:_0x334490,allowGroup:_0x10eeb5,allHistoric:_0x2d080b,allUserChat:_0x3cd7e2})=>{const _0x4f2648=a604_0x1dcf71;if(_0x210ce1!==undefined){const _0xed29ab=await Company_1[_0x4f2648(0x88)][_0x4f2648(0x86)]({'where':{'id':_0x210ce1},'include':[{'model':Plan_1[_0x4f2648(0x88)],'as':_0x4f2648(0x85)}]});if(_0xed29ab!==null){const _0x4ba276=await User_1[_0x4f2648(0x88)][_0x4f2648(0x7f)]({'where':{'companyId':_0x210ce1}});if(_0x4ba276>=_0xed29ab[_0x4f2648(0x85)][_0x4f2648(0x97)])throw new AppError_1[(_0x4f2648(0x88))](_0x4f2648(0x8c)+_0x4ba276);}}const _0xe919b5=Yup[_0x4f2648(0xa0)]()['shape']({'name':Yup[_0x4f2648(0x9d)]()[_0x4f2648(0x9e)]()[_0x4f2648(0x7b)](0x2),'allHistoric':Yup['string'](),'email':Yup[_0x4f2648(0x9d)]()[_0x4f2648(0x9b)]()[_0x4f2648(0x9e)]()[_0x4f2648(0x84)](_0x4f2648(0x80),_0x4f2648(0x8a),async _0x42209b=>{const _0x44cc35=_0x4f2648;if(!_0x42209b)return![];const _0x293b47=await User_1[_0x44cc35(0x88)][_0x44cc35(0x86)]({'where':{'email':_0x42209b}});return!_0x293b47;}),'password':Yup[_0x4f2648(0x9d)]()[_0x4f2648(0x9e)]()[_0x4f2648(0x7b)](0x5)});try{await _0xe919b5[_0x4f2648(0x99)]({'email':_0x396163,'password':_0x2df136,'name':_0x300a34});}catch(_0x30b7e8){throw new AppError_1[(_0x4f2648(0x88))](_0x30b7e8[_0x4f2648(0x8d)]);}const _0x7d5dfb=await User_1['default'][_0x4f2648(0xa1)]({'email':_0x396163,'password':_0x2df136,'name':_0x300a34,'companyId':_0x210ce1,'profile':profile,'startWork':_0x2d2c4c,'endWork':_0x459af4,'whatsappId':_0x479f3a||null,'allTicket':_0x4b9a0b,'defaultTheme':_0x195638,'defaultMenu':_0x334490,'allowGroup':_0x10eeb5,'allHistoric':_0x2d080b,'allUserChat':_0x3cd7e2},{'include':[_0x4f2648(0x82),'company']});await _0x7d5dfb[_0x4f2648(0x83)]('queues',queueIds),await _0x7d5dfb[_0x4f2648(0x92)]();const _0x1a4fb1=(0x0,SerializeUser_1['SerializeUser'])(_0x7d5dfb);return _0x1a4fb1;};exports[a604_0x1dcf71(0x88)]=CreateUserService;