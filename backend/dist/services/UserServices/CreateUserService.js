'use strict';const a529_0x13bea9=a529_0x1d40;(function(_0x3dd960,_0xbd20c0){const _0xa87474=a529_0x1d40,_0x2a3e4b=_0x3dd960();while(!![]){try{const _0x4e1051=parseInt(_0xa87474(0x147))/0x1+-parseInt(_0xa87474(0x143))/0x2*(-parseInt(_0xa87474(0x134))/0x3)+parseInt(_0xa87474(0x13d))/0x4*(-parseInt(_0xa87474(0x127))/0x5)+-parseInt(_0xa87474(0x144))/0x6*(parseInt(_0xa87474(0x12f))/0x7)+parseInt(_0xa87474(0x13f))/0x8*(parseInt(_0xa87474(0x12d))/0x9)+-parseInt(_0xa87474(0x136))/0xa*(parseInt(_0xa87474(0x126))/0xb)+parseInt(_0xa87474(0x141))/0xc*(-parseInt(_0xa87474(0x11c))/0xd);if(_0x4e1051===_0xbd20c0)break;else _0x2a3e4b['push'](_0x2a3e4b['shift']());}catch(_0x31356f){_0x2a3e4b['push'](_0x2a3e4b['shift']());}}}(a529_0x1da4,0xa2617));var __createBinding=this&&this[a529_0x13bea9(0x130)]||(Object[a529_0x13bea9(0x142)]?function(_0x1b367a,_0x2a921c,_0xbe037c,_0x4751af){const _0x5cd2af=a529_0x13bea9;if(_0x4751af===undefined)_0x4751af=_0xbe037c;var _0x5f2104=Object[_0x5cd2af(0x135)](_0x2a921c,_0xbe037c);(!_0x5f2104||(_0x5cd2af(0x13e)in _0x5f2104?!_0x2a921c[_0x5cd2af(0x14c)]:_0x5f2104[_0x5cd2af(0x146)]||_0x5f2104['configurable']))&&(_0x5f2104={'enumerable':!![],'get':function(){return _0x2a921c[_0xbe037c];}}),Object[_0x5cd2af(0x122)](_0x1b367a,_0x4751af,_0x5f2104);}:function(_0xec2a91,_0x183351,_0x5a7ffd,_0x60cb7b){if(_0x60cb7b===undefined)_0x60cb7b=_0x5a7ffd;_0xec2a91[_0x60cb7b]=_0x183351[_0x5a7ffd];}),__setModuleDefault=this&&this[a529_0x13bea9(0x12a)]||(Object[a529_0x13bea9(0x142)]?function(_0x4daa66,_0x75d815){const _0x2d621a=a529_0x13bea9;Object[_0x2d621a(0x122)](_0x4daa66,'default',{'enumerable':!![],'value':_0x75d815});}:function(_0x1fa840,_0x559269){_0x1fa840['default']=_0x559269;}),__importStar=this&&this[a529_0x13bea9(0x139)]||function(_0x17f012){const _0x5f1b74=a529_0x13bea9;if(_0x17f012&&_0x17f012[_0x5f1b74(0x14c)])return _0x17f012;var _0x393439={};if(_0x17f012!=null){for(var _0x522da2 in _0x17f012)if(_0x522da2!=='default'&&Object[_0x5f1b74(0x129)]['hasOwnProperty']['call'](_0x17f012,_0x522da2))__createBinding(_0x393439,_0x17f012,_0x522da2);}return __setModuleDefault(_0x393439,_0x17f012),_0x393439;},__importDefault=this&&this[a529_0x13bea9(0x149)]||function(_0x38351f){return _0x38351f&&_0x38351f['__esModule']?_0x38351f:{'default':_0x38351f};};Object[a529_0x13bea9(0x122)](exports,a529_0x13bea9(0x14c),{'value':!![]});const Yup=__importStar(require(a529_0x13bea9(0x14d))),AppError_1=__importDefault(require(a529_0x13bea9(0x13c))),SerializeUser_1=require(a529_0x13bea9(0x13a)),User_1=__importDefault(require(a529_0x13bea9(0x137))),Plan_1=__importDefault(require('../../models/Plan')),Company_1=__importDefault(require('../../models/Company')),CreateUserService=async({email:_0x79fcba,password:_0x16fc20,name:_0x2db75a,queueIds:queueIds=[],companyId:_0x140740,profile:profile=a529_0x13bea9(0x12b),startWork:_0x566e2b,endWork:_0x43c9da,whatsappId:_0x475bbd,allTicket:_0x40d4df,defaultTheme:_0x5057d7,defaultMenu:_0x3964d9,allowGroup:_0x332617})=>{const _0x48220e=a529_0x13bea9;if(_0x140740!==undefined){const _0x3fe1ca=await Company_1['default'][_0x48220e(0x125)]({'where':{'id':_0x140740},'include':[{'model':Plan_1['default'],'as':_0x48220e(0x140)}]});if(_0x3fe1ca!==null){const _0x5eade1=await User_1[_0x48220e(0x133)][_0x48220e(0x132)]({'where':{'companyId':_0x140740}});if(_0x5eade1>=_0x3fe1ca[_0x48220e(0x140)][_0x48220e(0x14b)])throw new AppError_1[(_0x48220e(0x133))](_0x48220e(0x121)+_0x5eade1);}}const _0x39c398=Yup[_0x48220e(0x145)]()[_0x48220e(0x123)]({'name':Yup[_0x48220e(0x11e)]()['required']()[_0x48220e(0x131)](0x2),'email':Yup[_0x48220e(0x11e)]()[_0x48220e(0x128)]()[_0x48220e(0x12c)]()[_0x48220e(0x148)](_0x48220e(0x124),_0x48220e(0x13b),async _0x41baa3=>{const _0x239e66=_0x48220e;if(!_0x41baa3)return![];const _0x9e2177=await User_1[_0x239e66(0x133)]['findOne']({'where':{'email':_0x41baa3}});return!_0x9e2177;}),'password':Yup[_0x48220e(0x11e)]()[_0x48220e(0x12c)]()[_0x48220e(0x131)](0x5)});try{await _0x39c398[_0x48220e(0x14a)]({'email':_0x79fcba,'password':_0x16fc20,'name':_0x2db75a});}catch(_0x3b050e){throw new AppError_1[(_0x48220e(0x133))](_0x3b050e[_0x48220e(0x11f)]);}const _0x23f8a4=await User_1[_0x48220e(0x133)]['create']({'email':_0x79fcba,'password':_0x16fc20,'name':_0x2db75a,'companyId':_0x140740,'profile':profile,'startWork':_0x566e2b,'endWork':_0x43c9da,'whatsappId':_0x475bbd||null,'allTicket':_0x40d4df,'defaultTheme':_0x5057d7,'defaultMenu':_0x3964d9,'allowGroup':_0x332617},{'include':[_0x48220e(0x138),_0x48220e(0x120)]});await _0x23f8a4['$set']('queues',queueIds),await _0x23f8a4[_0x48220e(0x11d)]();const _0x1bf66c=(0x0,SerializeUser_1[_0x48220e(0x12e)])(_0x23f8a4);return _0x1bf66c;};function a529_0x1da4(){const _0x2f6170=['test','__importDefault','validate','users','__esModule','yup','1807LJgRad','reload','string','message','company','Número\x20máximo\x20de\x20usuários\x20já\x20alcançado:\x20','defineProperty','shape','Check-email','findOne','11XpSXkX','1639085eyNtSF','email','prototype','__setModuleDefault','admin','required','1989ZFrzpp','SerializeUser','7umXQWh','__createBinding','min','count','default','572898AwNyYC','getOwnPropertyDescriptor','4820270hPuqSO','../../models/User','queues','__importStar','../../helpers/SerializeUser','An\x20user\x20with\x20this\x20email\x20already\x20exists.','../../errors/AppError','4DfAtod','get','42800XKPTxR','plan','15468MNyHHT','create','10lqueNU','5109114xMGVXI','object','writable','368465rwkmYg'];a529_0x1da4=function(){return _0x2f6170;};return a529_0x1da4();}function a529_0x1d40(_0x4a0cea,_0x5d36d2){const _0x1da4f8=a529_0x1da4();return a529_0x1d40=function(_0x1d4026,_0x35ab56){_0x1d4026=_0x1d4026-0x11c;let _0x1db141=_0x1da4f8[_0x1d4026];return _0x1db141;},a529_0x1d40(_0x4a0cea,_0x5d36d2);}exports['default']=CreateUserService;