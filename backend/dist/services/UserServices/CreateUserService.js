'use strict';const a604_0x2745ae=a604_0x785e;(function(_0x51b175,_0x557e8f){const _0x11f133=a604_0x785e,_0xd7ef13=_0x51b175();while(!![]){try{const _0xbd2c64=-parseInt(_0x11f133(0x1e2))/0x1*(-parseInt(_0x11f133(0x1f3))/0x2)+-parseInt(_0x11f133(0x1d8))/0x3+-parseInt(_0x11f133(0x1e5))/0x4*(-parseInt(_0x11f133(0x1f5))/0x5)+-parseInt(_0x11f133(0x1d2))/0x6*(parseInt(_0x11f133(0x1ce))/0x7)+-parseInt(_0x11f133(0x1e9))/0x8+-parseInt(_0x11f133(0x1d7))/0x9+-parseInt(_0x11f133(0x1d3))/0xa*(-parseInt(_0x11f133(0x1dc))/0xb);if(_0xbd2c64===_0x557e8f)break;else _0xd7ef13['push'](_0xd7ef13['shift']());}catch(_0x132907){_0xd7ef13['push'](_0xd7ef13['shift']());}}}(a604_0x4019,0xcc0f8));function a604_0x4019(){const _0x31dec4=['SerializeUser','getOwnPropertyDescriptor','required','10194795AICZmo','2374053OuIehN','min','object','users','11402182QQmEDe','$set','__importStar','test','string','call','4083cqpCnr','__createBinding','plan','555596VhZkiZ','An\x20user\x20with\x20this\x20email\x20already\x20exists.','create','default','9900416BIrAtS','count','company','prototype','shape','../../models/Plan','Check-email','../../errors/AppError','hasOwnProperty','defineProperty','166dzhkqp','../../models/User','15ttSSNj','__esModule','message','queues','__setModuleDefault','findOne','../../helpers/SerializeUser','configurable','1029tvehhi','Número\x20máximo\x20de\x20usuários\x20já\x20alcançado:\x20','email','reload','36912IaalgA','40JOOACL'];a604_0x4019=function(){return _0x31dec4;};return a604_0x4019();}function a604_0x785e(_0x4d9e96,_0x22d144){const _0x4019cf=a604_0x4019();return a604_0x785e=function(_0x785e3c,_0xde034a){_0x785e3c=_0x785e3c-0x1cd;let _0x2e8304=_0x4019cf[_0x785e3c];return _0x2e8304;},a604_0x785e(_0x4d9e96,_0x22d144);}var __createBinding=this&&this[a604_0x2745ae(0x1e3)]||(Object[a604_0x2745ae(0x1e7)]?function(_0x916fb9,_0x5bd50c,_0x4a5915,_0x5582a5){const _0xc158b5=a604_0x2745ae;if(_0x5582a5===undefined)_0x5582a5=_0x4a5915;var _0x5e9e36=Object[_0xc158b5(0x1d5)](_0x5bd50c,_0x4a5915);(!_0x5e9e36||('get'in _0x5e9e36?!_0x5bd50c[_0xc158b5(0x1f6)]:_0x5e9e36['writable']||_0x5e9e36[_0xc158b5(0x1cd)]))&&(_0x5e9e36={'enumerable':!![],'get':function(){return _0x5bd50c[_0x4a5915];}}),Object[_0xc158b5(0x1f2)](_0x916fb9,_0x5582a5,_0x5e9e36);}:function(_0x36bb1f,_0xcf8077,_0x311fbf,_0x1e6a72){if(_0x1e6a72===undefined)_0x1e6a72=_0x311fbf;_0x36bb1f[_0x1e6a72]=_0xcf8077[_0x311fbf];}),__setModuleDefault=this&&this[a604_0x2745ae(0x1f9)]||(Object[a604_0x2745ae(0x1e7)]?function(_0x3be24a,_0x3a3f80){const _0x171db4=a604_0x2745ae;Object[_0x171db4(0x1f2)](_0x3be24a,_0x171db4(0x1e8),{'enumerable':!![],'value':_0x3a3f80});}:function(_0x44aa86,_0xfa06da){const _0x327e72=a604_0x2745ae;_0x44aa86[_0x327e72(0x1e8)]=_0xfa06da;}),__importStar=this&&this[a604_0x2745ae(0x1de)]||function(_0x273518){const _0x563206=a604_0x2745ae;if(_0x273518&&_0x273518[_0x563206(0x1f6)])return _0x273518;var _0x462958={};if(_0x273518!=null){for(var _0x42c770 in _0x273518)if(_0x42c770!==_0x563206(0x1e8)&&Object[_0x563206(0x1ec)][_0x563206(0x1f1)][_0x563206(0x1e1)](_0x273518,_0x42c770))__createBinding(_0x462958,_0x273518,_0x42c770);}return __setModuleDefault(_0x462958,_0x273518),_0x462958;},__importDefault=this&&this['__importDefault']||function(_0x29f56d){return _0x29f56d&&_0x29f56d['__esModule']?_0x29f56d:{'default':_0x29f56d};};Object[a604_0x2745ae(0x1f2)](exports,'__esModule',{'value':!![]});const Yup=__importStar(require('yup')),AppError_1=__importDefault(require(a604_0x2745ae(0x1f0))),SerializeUser_1=require(a604_0x2745ae(0x1fb)),User_1=__importDefault(require(a604_0x2745ae(0x1f4))),Plan_1=__importDefault(require(a604_0x2745ae(0x1ee))),Company_1=__importDefault(require('../../models/Company')),CreateUserService=async({email:_0x149681,password:_0x518823,name:_0x320569,queueIds:queueIds=[],companyId:_0x3a7acc,profile:profile='admin',startWork:_0x3cc3d9,endWork:_0x32a208,whatsappId:_0x4863f9,allTicket:_0x12146e,defaultTheme:_0x425c93,defaultMenu:_0x1f226b,allowGroup:_0x5346ae,allHistoric:_0x17d625,allUserChat:_0x1f30bb})=>{const _0x2f487b=a604_0x2745ae;if(_0x3a7acc!==undefined){const _0x2f88aa=await Company_1['default'][_0x2f487b(0x1fa)]({'where':{'id':_0x3a7acc},'include':[{'model':Plan_1[_0x2f487b(0x1e8)],'as':_0x2f487b(0x1e4)}]});if(_0x2f88aa!==null){const _0x55413c=await User_1[_0x2f487b(0x1e8)][_0x2f487b(0x1ea)]({'where':{'companyId':_0x3a7acc}});if(_0x55413c>=_0x2f88aa['plan'][_0x2f487b(0x1db)])throw new AppError_1[(_0x2f487b(0x1e8))](_0x2f487b(0x1cf)+_0x55413c);}}const _0x3fd2f6=Yup[_0x2f487b(0x1da)]()[_0x2f487b(0x1ed)]({'name':Yup[_0x2f487b(0x1e0)]()[_0x2f487b(0x1d6)]()[_0x2f487b(0x1d9)](0x2),'allHistoric':Yup[_0x2f487b(0x1e0)](),'email':Yup[_0x2f487b(0x1e0)]()[_0x2f487b(0x1d0)]()[_0x2f487b(0x1d6)]()[_0x2f487b(0x1df)](_0x2f487b(0x1ef),_0x2f487b(0x1e6),async _0x4a4c58=>{const _0x80a6a7=_0x2f487b;if(!_0x4a4c58)return![];const _0x27ef77=await User_1[_0x80a6a7(0x1e8)][_0x80a6a7(0x1fa)]({'where':{'email':_0x4a4c58}});return!_0x27ef77;}),'password':Yup[_0x2f487b(0x1e0)]()['required']()[_0x2f487b(0x1d9)](0x5)});try{await _0x3fd2f6['validate']({'email':_0x149681,'password':_0x518823,'name':_0x320569});}catch(_0x18dd47){throw new AppError_1[(_0x2f487b(0x1e8))](_0x18dd47[_0x2f487b(0x1f7)]);}const _0x29bba4=await User_1['default'][_0x2f487b(0x1e7)]({'email':_0x149681,'password':_0x518823,'name':_0x320569,'companyId':_0x3a7acc,'profile':profile,'startWork':_0x3cc3d9,'endWork':_0x32a208,'whatsappId':_0x4863f9||null,'allTicket':_0x12146e,'defaultTheme':_0x425c93,'defaultMenu':_0x1f226b,'allowGroup':_0x5346ae,'allHistoric':_0x17d625,'allUserChat':_0x1f30bb},{'include':[_0x2f487b(0x1f8),_0x2f487b(0x1eb)]});await _0x29bba4[_0x2f487b(0x1dd)]('queues',queueIds),await _0x29bba4[_0x2f487b(0x1d1)]();const _0x2ccc6d=(0x0,SerializeUser_1[_0x2f487b(0x1d4)])(_0x29bba4);return _0x2ccc6d;};exports[a604_0x2745ae(0x1e8)]=CreateUserService;