'use strict';function a493_0x543e(_0x30dbe6,_0x5da1f1){const _0x4c6613=a493_0x4c66();return a493_0x543e=function(_0x543ef5,_0x1061fb){_0x543ef5=_0x543ef5-0x124;let _0x11ee47=_0x4c6613[_0x543ef5];return _0x11ee47;},a493_0x543e(_0x30dbe6,_0x5da1f1);}function a493_0x4c66(){const _0x352495=['writable','shape','admin','../../models/User','email','10PZXbRI','plan','call','defineProperty','1408MUIaTa','../../models/Company','findOne','../../models/Plan','23315058EcxDfH','../../helpers/SerializeUser','company','validate','124dUmmmk','string','get','6402649OZldhu','2328nTPEhL','15138iCpCzF','An\x20user\x20with\x20this\x20email\x20already\x20exists.','6sFLYKc','users','__createBinding','Número\x20máximo\x20de\x20usuários\x20já\x20alcançado:\x20','__setModuleDefault','12FPPXuP','1362010NCHFgn','default','$set','getOwnPropertyDescriptor','object','required','__importStar','test','1169nIwVoC','6737388MGsMmc','configurable','queues','create','../../errors/AppError','__esModule','20067UnwuCF'];a493_0x4c66=function(){return _0x352495;};return a493_0x4c66();}const a493_0x154ae7=a493_0x543e;(function(_0x45462d,_0x8fca10){const _0x42b2d9=a493_0x543e,_0x4acde0=_0x45462d();while(!![]){try{const _0x29ce8a=parseInt(_0x42b2d9(0x143))/0x1*(parseInt(_0x42b2d9(0x126))/0x2)+-parseInt(_0x42b2d9(0x14a))/0x3*(parseInt(_0x42b2d9(0x12e))/0x4)+parseInt(_0x42b2d9(0x13b))/0x5*(-parseInt(_0x42b2d9(0x135))/0x6)+parseInt(_0x42b2d9(0x144))/0x7+parseInt(_0x42b2d9(0x132))/0x8*(parseInt(_0x42b2d9(0x133))/0x9)+-parseInt(_0x42b2d9(0x150))/0xa*(-parseInt(_0x42b2d9(0x131))/0xb)+-parseInt(_0x42b2d9(0x13a))/0xc*(parseInt(_0x42b2d9(0x12a))/0xd);if(_0x29ce8a===_0x8fca10)break;else _0x4acde0['push'](_0x4acde0['shift']());}catch(_0x261be1){_0x4acde0['push'](_0x4acde0['shift']());}}}(a493_0x4c66,0x8e84a));var __createBinding=this&&this[a493_0x154ae7(0x137)]||(Object['create']?function(_0x1803a3,_0x3d2237,_0x358551,_0x5046ef){const _0x1368f8=a493_0x154ae7;if(_0x5046ef===undefined)_0x5046ef=_0x358551;var _0x5d85b5=Object[_0x1368f8(0x13e)](_0x3d2237,_0x358551);(!_0x5d85b5||(_0x1368f8(0x130)in _0x5d85b5?!_0x3d2237['__esModule']:_0x5d85b5[_0x1368f8(0x14b)]||_0x5d85b5[_0x1368f8(0x145)]))&&(_0x5d85b5={'enumerable':!![],'get':function(){return _0x3d2237[_0x358551];}}),Object['defineProperty'](_0x1803a3,_0x5046ef,_0x5d85b5);}:function(_0x417996,_0x202225,_0x51176a,_0x598a45){if(_0x598a45===undefined)_0x598a45=_0x51176a;_0x417996[_0x598a45]=_0x202225[_0x51176a];}),__setModuleDefault=this&&this[a493_0x154ae7(0x139)]||(Object[a493_0x154ae7(0x147)]?function(_0xa1cfa5,_0x395e5d){const _0x1d7085=a493_0x154ae7;Object['defineProperty'](_0xa1cfa5,_0x1d7085(0x13c),{'enumerable':!![],'value':_0x395e5d});}:function(_0x88ccb3,_0x4282fe){const _0x2fc020=a493_0x154ae7;_0x88ccb3[_0x2fc020(0x13c)]=_0x4282fe;}),__importStar=this&&this[a493_0x154ae7(0x141)]||function(_0xaa11e5){const _0xca9100=a493_0x154ae7;if(_0xaa11e5&&_0xaa11e5[_0xca9100(0x149)])return _0xaa11e5;var _0x13c493={};if(_0xaa11e5!=null){for(var _0x366f68 in _0xaa11e5)if(_0x366f68!==_0xca9100(0x13c)&&Object['prototype']['hasOwnProperty'][_0xca9100(0x124)](_0xaa11e5,_0x366f68))__createBinding(_0x13c493,_0xaa11e5,_0x366f68);}return __setModuleDefault(_0x13c493,_0xaa11e5),_0x13c493;},__importDefault=this&&this['__importDefault']||function(_0x54dc3a){const _0x1c2aab=a493_0x154ae7;return _0x54dc3a&&_0x54dc3a[_0x1c2aab(0x149)]?_0x54dc3a:{'default':_0x54dc3a};};Object[a493_0x154ae7(0x125)](exports,a493_0x154ae7(0x149),{'value':!![]});const Yup=__importStar(require('yup')),AppError_1=__importDefault(require(a493_0x154ae7(0x148))),SerializeUser_1=require(a493_0x154ae7(0x12b)),User_1=__importDefault(require(a493_0x154ae7(0x14e))),Plan_1=__importDefault(require(a493_0x154ae7(0x129))),Company_1=__importDefault(require(a493_0x154ae7(0x127))),CreateUserService=async({email:_0x40f1c0,password:_0x24fa85,name:_0x23c710,queueIds:queueIds=[],companyId:_0x5333f6,profile:profile=a493_0x154ae7(0x14d),startWork:_0xec4957,endWork:_0x432272,whatsappId:_0x5ec570,allTicket:_0x4debf7,defaultTheme:_0x223559,defaultMenu:_0x6cc27c,allowGroup:_0x44652e})=>{const _0x29c2e6=a493_0x154ae7;if(_0x5333f6!==undefined){const _0x5aae2e=await Company_1[_0x29c2e6(0x13c)][_0x29c2e6(0x128)]({'where':{'id':_0x5333f6},'include':[{'model':Plan_1[_0x29c2e6(0x13c)],'as':_0x29c2e6(0x151)}]});if(_0x5aae2e!==null){const _0x2b2d15=await User_1['default']['count']({'where':{'companyId':_0x5333f6}});if(_0x2b2d15>=_0x5aae2e[_0x29c2e6(0x151)][_0x29c2e6(0x136)])throw new AppError_1[(_0x29c2e6(0x13c))](_0x29c2e6(0x138)+_0x2b2d15);}}const _0x5ebb27=Yup[_0x29c2e6(0x13f)]()[_0x29c2e6(0x14c)]({'name':Yup['string']()[_0x29c2e6(0x140)]()['min'](0x2),'email':Yup['string']()[_0x29c2e6(0x14f)]()[_0x29c2e6(0x140)]()[_0x29c2e6(0x142)]('Check-email',_0x29c2e6(0x134),async _0x405ac8=>{const _0x1b7e0e=_0x29c2e6;if(!_0x405ac8)return![];const _0x53f407=await User_1['default'][_0x1b7e0e(0x128)]({'where':{'email':_0x405ac8}});return!_0x53f407;}),'password':Yup[_0x29c2e6(0x12f)]()[_0x29c2e6(0x140)]()['min'](0x5)});try{await _0x5ebb27[_0x29c2e6(0x12d)]({'email':_0x40f1c0,'password':_0x24fa85,'name':_0x23c710});}catch(_0x40983b){throw new AppError_1[(_0x29c2e6(0x13c))](_0x40983b['message']);}const _0x27c183=await User_1['default'][_0x29c2e6(0x147)]({'email':_0x40f1c0,'password':_0x24fa85,'name':_0x23c710,'companyId':_0x5333f6,'profile':profile,'startWork':_0xec4957,'endWork':_0x432272,'whatsappId':_0x5ec570||null,'allTicket':_0x4debf7,'defaultTheme':_0x223559,'defaultMenu':_0x6cc27c,'allowGroup':_0x44652e},{'include':[_0x29c2e6(0x146),_0x29c2e6(0x12c)]});await _0x27c183[_0x29c2e6(0x13d)](_0x29c2e6(0x146),queueIds),await _0x27c183['reload']();const _0x822c71=(0x0,SerializeUser_1['SerializeUser'])(_0x27c183);return _0x822c71;};exports[a493_0x154ae7(0x13c)]=CreateUserService;