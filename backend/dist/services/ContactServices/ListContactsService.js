'use strict';const a420_0x2cb1f0=a420_0xe1b6;(function(_0x56f2c8,_0x3dc406){const _0x3737b2=a420_0xe1b6,_0x2014bc=_0x56f2c8();while(!![]){try{const _0x244bbb=parseInt(_0x3737b2(0x14f))/0x1+-parseInt(_0x3737b2(0x14a))/0x2+-parseInt(_0x3737b2(0x13b))/0x3+-parseInt(_0x3737b2(0x153))/0x4+-parseInt(_0x3737b2(0x157))/0x5+-parseInt(_0x3737b2(0x147))/0x6+parseInt(_0x3737b2(0x13e))/0x7*(parseInt(_0x3737b2(0x152))/0x8);if(_0x244bbb===_0x3dc406)break;else _0x2014bc['push'](_0x2014bc['shift']());}catch(_0xc2812a){_0x2014bc['push'](_0x2014bc['shift']());}}}(a420_0x1cf3,0xdbaa1));function a420_0x1cf3(){const _0x447a3c=['name','526404Kcrlvc','where','findAndCountAll','9191240BMFkrI','4062272JNYwKJ','toLowerCase','status','__esModule','3311865lNDMEs','updatedAt','like','LIKE','../../models/Contact','defineProperty','findAll','1579383XChDyd','Sequelize','ASC','21KoADme','isArray','default','col','trim','createdAt','../../models/ContactTag','map','../../models/Tag','4908018YZlewb','Contact.name','tags','101938miVbUf','length','intersection','contactId'];a420_0x1cf3=function(){return _0x447a3c;};return a420_0x1cf3();}function a420_0xe1b6(_0x4199ac,_0x4908e6){const _0x1cf32b=a420_0x1cf3();return a420_0xe1b6=function(_0xe1b60a,_0xcfe3fe){_0xe1b60a=_0xe1b60a-0x135;let _0x3ce0e3=_0x1cf32b[_0xe1b60a];return _0x3ce0e3;},a420_0xe1b6(_0x4199ac,_0x4908e6);}var __importDefault=this&&this['__importDefault']||function(_0x50f98b){const _0x393953=a420_0xe1b6;return _0x50f98b&&_0x50f98b[_0x393953(0x156)]?_0x50f98b:{'default':_0x50f98b};};Object[a420_0x2cb1f0(0x139)](exports,'__esModule',{'value':!![]});const sequelize_1=require('sequelize'),Contact_1=__importDefault(require(a420_0x2cb1f0(0x138))),Ticket_1=__importDefault(require('../../models/Ticket')),ContactTag_1=__importDefault(require(a420_0x2cb1f0(0x144))),lodash_1=require('lodash'),Tag_1=__importDefault(require(a420_0x2cb1f0(0x146))),ListContactsService=async({searchParam:searchParam='',pageNumber:pageNumber='1',companyId:_0x4544b3,tagsIds:_0x2ea1ca,isGroup:_0xe27314})=>{const _0x364ead=a420_0x2cb1f0;let _0x4aa6f5={[sequelize_1['Op']['or']]:[{'name':sequelize_1[_0x364ead(0x13c)][_0x364ead(0x150)](sequelize_1[_0x364ead(0x13c)]['fn']('LOWER',sequelize_1[_0x364ead(0x13c)][_0x364ead(0x141)](_0x364ead(0x148))),_0x364ead(0x137),'%'+searchParam['toLowerCase']()['trim']()+'%')},{'number':{[sequelize_1['Op'][_0x364ead(0x136)]]:'%'+searchParam[_0x364ead(0x154)]()[_0x364ead(0x142)]()+'%'}}]};_0x4aa6f5={..._0x4aa6f5,'companyId':_0x4544b3};if(Array[_0x364ead(0x13f)](_0x2ea1ca)&&_0x2ea1ca[_0x364ead(0x14b)]>0x0){const _0x4393e7=[],_0x3aa3fd=await ContactTag_1[_0x364ead(0x140)][_0x364ead(0x13a)]({'where':{'tagId':{[sequelize_1['Op']['in']]:_0x2ea1ca}}});_0x3aa3fd&&_0x4393e7['push'](_0x3aa3fd[_0x364ead(0x145)](_0x1bbdc0=>_0x1bbdc0[_0x364ead(0x14d)]));const _0x405599=(0x0,lodash_1[_0x364ead(0x14c)])(..._0x4393e7);_0x4aa6f5={..._0x4aa6f5,'id':{[sequelize_1['Op']['in']]:_0x405599}};}_0xe27314==='false'&&(_0x4aa6f5={..._0x4aa6f5,'isGroup':![]});const _0x4ee393=0x64,_0x400155=_0x4ee393*(+pageNumber-0x1),{count:_0x27430c,rows:_0x17a78f}=await Contact_1[_0x364ead(0x140)][_0x364ead(0x151)]({'where':_0x4aa6f5,'limit':_0x4ee393,'include':[{'model':Ticket_1[_0x364ead(0x140)],'as':'tickets','attributes':['id',_0x364ead(0x155),_0x364ead(0x143),_0x364ead(0x135)]},{'model':Tag_1[_0x364ead(0x140)],'as':_0x364ead(0x149)}],'offset':_0x400155,'order':[[_0x364ead(0x14e),_0x364ead(0x13d)]]}),_0x3bcc5d=_0x27430c>_0x400155+_0x17a78f['length'];return{'contacts':_0x17a78f,'count':_0x27430c,'hasMore':_0x3bcc5d};};exports[a420_0x2cb1f0(0x140)]=ListContactsService;