'use strict';const a387_0x3cab64=a387_0x524d;(function(_0x3e6416,_0x5605bb){const _0x24dec7=a387_0x524d,_0x287582=_0x3e6416();while(!![]){try{const _0x59c518=-parseInt(_0x24dec7(0x95))/0x1*(-parseInt(_0x24dec7(0x89))/0x2)+parseInt(_0x24dec7(0x81))/0x3*(parseInt(_0x24dec7(0x7d))/0x4)+parseInt(_0x24dec7(0x88))/0x5+-parseInt(_0x24dec7(0x8e))/0x6*(parseInt(_0x24dec7(0x8f))/0x7)+parseInt(_0x24dec7(0x84))/0x8+-parseInt(_0x24dec7(0x91))/0x9*(-parseInt(_0x24dec7(0x78))/0xa)+-parseInt(_0x24dec7(0x77))/0xb;if(_0x59c518===_0x5605bb)break;else _0x287582['push'](_0x287582['shift']());}catch(_0x1318f0){_0x287582['push'](_0x287582['shift']());}}}(a387_0x436c,0x98b43));var __importDefault=this&&this['__importDefault']||function(_0x2dc522){return _0x2dc522&&_0x2dc522['__esModule']?_0x2dc522:{'default':_0x2dc522};};Object['defineProperty'](exports,a387_0x3cab64(0x85),{'value':!![]});const sequelize_1=require(a387_0x3cab64(0x80)),Contact_1=__importDefault(require('../../models/Contact')),Ticket_1=__importDefault(require(a387_0x3cab64(0x86))),ContactTag_1=__importDefault(require(a387_0x3cab64(0x8d))),lodash_1=require(a387_0x3cab64(0x79)),Tag_1=__importDefault(require(a387_0x3cab64(0x96))),ListContactsService=async({searchParam:searchParam='',pageNumber:pageNumber='1',companyId:_0x51f1c1,tagsIds:_0xe07dca})=>{const _0x1b0059=a387_0x3cab64;let _0x34adf5={[sequelize_1['Op']['or']]:[{'name':sequelize_1[_0x1b0059(0x8c)][_0x1b0059(0x94)](sequelize_1[_0x1b0059(0x8c)]['fn'](_0x1b0059(0x93),sequelize_1['Sequelize'][_0x1b0059(0x7a)](_0x1b0059(0x7e))),'LIKE','%'+searchParam[_0x1b0059(0x8b)]()[_0x1b0059(0x76)]()+'%')},{'number':{[sequelize_1['Op'][_0x1b0059(0x82)]]:'%'+searchParam[_0x1b0059(0x8b)]()['trim']()+'%'}}]};_0x34adf5={..._0x34adf5,'companyId':_0x51f1c1};if(Array[_0x1b0059(0x7b)](_0xe07dca)&&_0xe07dca[_0x1b0059(0x92)]>0x0){const _0x23fa53=[],_0x4a9f63=await ContactTag_1[_0x1b0059(0x83)][_0x1b0059(0x8a)]({'where':{'tagId':{[sequelize_1['Op']['in']]:_0xe07dca}}});_0x4a9f63&&_0x23fa53[_0x1b0059(0x7c)](_0x4a9f63[_0x1b0059(0x75)](_0x27c953=>_0x27c953['contactId']));console[_0x1b0059(0x87)](_0x4a9f63);const _0x30e56a=(0x0,lodash_1[_0x1b0059(0x90)])(..._0x23fa53);_0x34adf5={..._0x34adf5,'id':{[sequelize_1['Op']['in']]:_0x30e56a}};}const _0x1de321=0x64,_0x4b5bb4=_0x1de321*(+pageNumber-0x1),{count:_0x5cf24b,rows:_0x26e8f0}=await Contact_1[_0x1b0059(0x83)]['findAndCountAll']({'where':_0x34adf5,'limit':_0x1de321,'include':[{'model':Ticket_1[_0x1b0059(0x83)],'as':'tickets','attributes':['id','status','createdAt','updatedAt']},{'model':Tag_1['default'],'as':'tags'}],'offset':_0x4b5bb4,'order':[[_0x1b0059(0x7f),'ASC']]}),_0x3ad14b=_0x5cf24b>_0x4b5bb4+_0x26e8f0['length'];return{'contacts':_0x26e8f0,'count':_0x5cf24b,'hasMore':_0x3ad14b};};exports[a387_0x3cab64(0x83)]=ListContactsService;function a387_0x524d(_0x3e23cd,_0x3f2308){const _0x436c9b=a387_0x436c();return a387_0x524d=function(_0x524d78,_0x27a2df){_0x524d78=_0x524d78-0x75;let _0x58e074=_0x436c9b[_0x524d78];return _0x58e074;},a387_0x524d(_0x3e23cd,_0x3f2308);}function a387_0x436c(){const _0x1f455f=['sequelize','6828LhmtbJ','like','default','1624280WEDvUP','__esModule','../../models/Ticket','log','841890gvtsXM','101092TJLOzG','findAll','toLowerCase','Sequelize','../../models/ContactTag','60UzTwOF','601727jNVDDP','intersection','2269998mQPDAl','length','LOWER','where','15lcCsnP','../../models/Tag','map','trim','16175390cbjgUb','40WotJBY','lodash','col','isArray','push','1436kOxYqx','Contact.name','name'];a387_0x436c=function(){return _0x1f455f;};return a387_0x436c();}