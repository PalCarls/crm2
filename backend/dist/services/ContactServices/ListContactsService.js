'use strict';const a435_0x3eabc2=a435_0x1b7a;(function(_0x576ecc,_0x43ded6){const _0x374c8b=a435_0x1b7a,_0x43d53c=_0x576ecc();while(!![]){try{const _0x3d7c11=-parseInt(_0x374c8b(0x135))/0x1+-parseInt(_0x374c8b(0x149))/0x2+-parseInt(_0x374c8b(0x133))/0x3*(parseInt(_0x374c8b(0x13a))/0x4)+-parseInt(_0x374c8b(0x14a))/0x5+-parseInt(_0x374c8b(0x132))/0x6+parseInt(_0x374c8b(0x145))/0x7+-parseInt(_0x374c8b(0x13d))/0x8*(-parseInt(_0x374c8b(0x13c))/0x9);if(_0x3d7c11===_0x43ded6)break;else _0x43d53c['push'](_0x43d53c['shift']());}catch(_0x27853b){_0x43d53c['push'](_0x43d53c['shift']());}}}(a435_0x4279,0x7d512));function a435_0x4279(){const _0x44e9ed=['tickets','../../models/Tag','Sequelize','false','../../models/Contact','defineProperty','ASC','2286174iCEZNB','1038jHqtyw','default','182707Gzgdwl','__importDefault','findAll','tags','findAndCountAll','3428llDbDv','Contact.name','7183071NClXyT','16oMQvvx','lodash','intersection','col','length','like','updatedAt','isArray','6396334xkTnhR','trim','createdAt','push','1598256AAYfWH','1686580WuHhvJ','__esModule','where','name'];a435_0x4279=function(){return _0x44e9ed;};return a435_0x4279();}var __importDefault=this&&this[a435_0x3eabc2(0x136)]||function(_0x16b78e){const _0x44d7d4=a435_0x3eabc2;return _0x16b78e&&_0x16b78e[_0x44d7d4(0x14b)]?_0x16b78e:{'default':_0x16b78e};};Object[a435_0x3eabc2(0x130)](exports,a435_0x3eabc2(0x14b),{'value':!![]});function a435_0x1b7a(_0x493fbd,_0x1c294f){const _0x4279af=a435_0x4279();return a435_0x1b7a=function(_0x1b7a42,_0x603971){_0x1b7a42=_0x1b7a42-0x12f;let _0x23c7ec=_0x4279af[_0x1b7a42];return _0x23c7ec;},a435_0x1b7a(_0x493fbd,_0x1c294f);}const sequelize_1=require('sequelize'),Contact_1=__importDefault(require(a435_0x3eabc2(0x12f))),Ticket_1=__importDefault(require('../../models/Ticket')),ContactTag_1=__importDefault(require('../../models/ContactTag')),lodash_1=require(a435_0x3eabc2(0x13e)),Tag_1=__importDefault(require(a435_0x3eabc2(0x14f))),remove_accents_1=__importDefault(require('remove-accents')),ListContactsService=async({searchParam:searchParam='',pageNumber:pageNumber='1',companyId:_0x25303f,tagsIds:_0x21460f,isGroup:_0x2d674b})=>{const _0x14c772=a435_0x3eabc2,_0x1c434a=(0x0,remove_accents_1[_0x14c772(0x134)])(searchParam['toLocaleLowerCase']()[_0x14c772(0x146)]());let _0x260e7b={[sequelize_1['Op']['or']]:[{'name':sequelize_1[_0x14c772(0x150)][_0x14c772(0x14c)](sequelize_1[_0x14c772(0x150)]['fn']('LOWER',sequelize_1[_0x14c772(0x150)][_0x14c772(0x140)](_0x14c772(0x13b))),'LIKE','%'+_0x1c434a+'%')},{'number':{[sequelize_1['Op'][_0x14c772(0x142)]]:'%'+_0x1c434a+'%'}}]};_0x260e7b={..._0x260e7b,'companyId':_0x25303f};if(Array[_0x14c772(0x144)](_0x21460f)&&_0x21460f[_0x14c772(0x141)]>0x0){const _0x5dc3d6=[],_0x4c084b=await ContactTag_1[_0x14c772(0x134)][_0x14c772(0x137)]({'where':{'tagId':{[sequelize_1['Op']['in']]:_0x21460f}}});_0x4c084b&&_0x5dc3d6[_0x14c772(0x148)](_0x4c084b['map'](_0x2a5553=>_0x2a5553['contactId']));const _0x2c9c39=(0x0,lodash_1[_0x14c772(0x13f)])(..._0x5dc3d6);_0x260e7b={..._0x260e7b,'id':{[sequelize_1['Op']['in']]:_0x2c9c39}};}_0x2d674b===_0x14c772(0x151)&&(_0x260e7b={..._0x260e7b,'isGroup':![]});const _0x4d56fc=0x64,_0x59d8e5=_0x4d56fc*(+pageNumber-0x1),{count:_0x476e12,rows:_0x633a49}=await Contact_1[_0x14c772(0x134)][_0x14c772(0x139)]({'where':_0x260e7b,'limit':_0x4d56fc,'include':[{'model':Ticket_1[_0x14c772(0x134)],'as':_0x14c772(0x14e),'attributes':['id','status',_0x14c772(0x147),_0x14c772(0x143)]},{'model':Tag_1[_0x14c772(0x134)],'as':_0x14c772(0x138)}],'offset':_0x59d8e5,'order':[[_0x14c772(0x14d),_0x14c772(0x131)]]}),_0x49eb45=_0x476e12>_0x59d8e5+_0x633a49[_0x14c772(0x141)];return{'contacts':_0x633a49,'count':_0x476e12,'hasMore':_0x49eb45};};exports[a435_0x3eabc2(0x134)]=ListContactsService;