'use strict';function a457_0x3f00(_0x3a5468,_0x41fa46){const _0x3092dc=a457_0x3092();return a457_0x3f00=function(_0x3f009b,_0x596e9b){_0x3f009b=_0x3f009b-0xb2;let _0x13e83d=_0x3092dc[_0x3f009b];return _0x13e83d;},a457_0x3f00(_0x3a5468,_0x41fa46);}const a457_0x620561=a457_0x3f00;function a457_0x3092(){const _0x10c39e=['contactId','default','name','1052619WyamCB','col','updatedAt','findAll','intersection','remove-accents','Contact.name','6byUtOI','tags','../../models/Ticket','defineProperty','tickets','2WEeQeM','false','LOWER','where','18754142sMYzhb','like','unaccent','../../models/ContactTag','__esModule','../../models/Tag','7evCNfr','4571310LdMPta','length','40cZTECS','5412472mbubUy','1268487WazJin','createdAt','9569624iUsMiH','__importDefault','LIKE','push','944901EPKilR','toLocaleLowerCase'];a457_0x3092=function(){return _0x10c39e;};return a457_0x3092();}(function(_0x4a2f52,_0x316d70){const _0xacda71=a457_0x3f00,_0x5dfd6c=_0x4a2f52();while(!![]){try{const _0x2d48f4=-parseInt(_0xacda71(0xd7))/0x1*(-parseInt(_0xacda71(0xc8))/0x2)+-parseInt(_0xacda71(0xbc))/0x3+parseInt(_0xacda71(0xd6))/0x4+-parseInt(_0xacda71(0xd3))/0x5*(-parseInt(_0xacda71(0xc3))/0x6)+parseInt(_0xacda71(0xd2))/0x7*(-parseInt(_0xacda71(0xb3))/0x8)+-parseInt(_0xacda71(0xb7))/0x9*(-parseInt(_0xacda71(0xd5))/0xa)+-parseInt(_0xacda71(0xcc))/0xb;if(_0x2d48f4===_0x316d70)break;else _0x5dfd6c['push'](_0x5dfd6c['shift']());}catch(_0x166884){_0x5dfd6c['push'](_0x5dfd6c['shift']());}}}(a457_0x3092,0xabd51));var __importDefault=this&&this[a457_0x620561(0xb4)]||function(_0x3de2d6){return _0x3de2d6&&_0x3de2d6['__esModule']?_0x3de2d6:{'default':_0x3de2d6};};Object[a457_0x620561(0xc6)](exports,a457_0x620561(0xd0),{'value':!![]});const sequelize_1=require('sequelize'),Contact_1=__importDefault(require('../../models/Contact')),Ticket_1=__importDefault(require(a457_0x620561(0xc5))),ContactTag_1=__importDefault(require(a457_0x620561(0xcf))),lodash_1=require('lodash'),Tag_1=__importDefault(require(a457_0x620561(0xd1))),remove_accents_1=__importDefault(require(a457_0x620561(0xc1))),ListContactsService=async({searchParam:searchParam='',pageNumber:pageNumber='1',companyId:_0x257587,tagsIds:_0x3d1591,isGroup:_0x32be73})=>{const _0x2e419d=a457_0x620561,_0x9c3d4b=(0x0,remove_accents_1[_0x2e419d(0xba)])(searchParam[_0x2e419d(0xb8)]()['trim']());let _0x3f886b={[sequelize_1['Op']['or']]:[{'name':(0x0,sequelize_1[_0x2e419d(0xcb)])((0x0,sequelize_1['fn'])(_0x2e419d(0xca),(0x0,sequelize_1['fn'])(_0x2e419d(0xce),(0x0,sequelize_1[_0x2e419d(0xbd)])(_0x2e419d(0xc2)))),_0x2e419d(0xb5),'%'+_0x9c3d4b+'%')},{'number':{[sequelize_1['Op'][_0x2e419d(0xcd)]]:'%'+_0x9c3d4b+'%'}}]};_0x3f886b={..._0x3f886b,'companyId':_0x257587};if(Array['isArray'](_0x3d1591)&&_0x3d1591[_0x2e419d(0xd4)]>0x0){const _0x1e0304=[],_0x38006c=await ContactTag_1['default'][_0x2e419d(0xbf)]({'where':{'tagId':{[sequelize_1['Op']['in']]:_0x3d1591}}});_0x38006c&&_0x1e0304[_0x2e419d(0xb6)](_0x38006c['map'](_0x4793c4=>_0x4793c4[_0x2e419d(0xb9)]));const _0x4b76e3=(0x0,lodash_1[_0x2e419d(0xc0)])(..._0x1e0304);_0x3f886b={..._0x3f886b,'id':{[sequelize_1['Op']['in']]:_0x4b76e3}};}_0x32be73===_0x2e419d(0xc9)&&(_0x3f886b={..._0x3f886b,'isGroup':![]});const _0x141055=0x64,_0x40789d=_0x141055*(+pageNumber-0x1),{count:_0x36636a,rows:_0x50486e}=await Contact_1[_0x2e419d(0xba)]['findAndCountAll']({'where':_0x3f886b,'limit':_0x141055,'include':[{'model':Ticket_1[_0x2e419d(0xba)],'as':_0x2e419d(0xc7),'attributes':['id','status',_0x2e419d(0xb2),_0x2e419d(0xbe)]},{'model':Tag_1[_0x2e419d(0xba)],'as':_0x2e419d(0xc4)}],'offset':_0x40789d,'order':[[_0x2e419d(0xbb),'ASC']]}),_0x391522=_0x36636a>_0x40789d+_0x50486e['length'];return{'contacts':_0x50486e,'count':_0x36636a,'hasMore':_0x391522};};exports[a457_0x620561(0xba)]=ListContactsService;