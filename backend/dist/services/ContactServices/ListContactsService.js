'use strict';const a466_0x12a12a=a466_0x58f7;(function(_0x492c80,_0x3f8c88){const _0x101487=a466_0x58f7,_0x492055=_0x492c80();while(!![]){try{const _0x52f21b=parseInt(_0x101487(0x1c0))/0x1+-parseInt(_0x101487(0x1b1))/0x2+parseInt(_0x101487(0x1c4))/0x3+-parseInt(_0x101487(0x1c7))/0x4*(parseInt(_0x101487(0x1ad))/0x5)+-parseInt(_0x101487(0x1b7))/0x6+parseInt(_0x101487(0x1cb))/0x7*(-parseInt(_0x101487(0x1bd))/0x8)+parseInt(_0x101487(0x1cf))/0x9;if(_0x52f21b===_0x3f8c88)break;else _0x492055['push'](_0x492055['shift']());}catch(_0x51e91a){_0x492055['push'](_0x492055['shift']());}}}(a466_0x49ae,0xbdc07));var __importDefault=this&&this[a466_0x12a12a(0x1ce)]||function(_0x52d3d9){const _0x101787=a466_0x12a12a;return _0x52d3d9&&_0x52d3d9[_0x101787(0x1ca)]?_0x52d3d9:{'default':_0x52d3d9};};Object[a466_0x12a12a(0x1af)](exports,'__esModule',{'value':!![]});function a466_0x58f7(_0x2b8228,_0x13bc4a){const _0x49ae3c=a466_0x49ae();return a466_0x58f7=function(_0x58f7f4,_0x4be176){_0x58f7f4=_0x58f7f4-0x1ac;let _0x211b96=_0x49ae3c[_0x58f7f4];return _0x211b96;},a466_0x58f7(_0x2b8228,_0x13bc4a);}const sequelize_1=require('sequelize'),Contact_1=__importDefault(require(a466_0x12a12a(0x1b0))),Ticket_1=__importDefault(require(a466_0x12a12a(0x1bc))),ContactTag_1=__importDefault(require(a466_0x12a12a(0x1c2))),lodash_1=require(a466_0x12a12a(0x1cd)),Tag_1=__importDefault(require('../../models/Tag')),remove_accents_1=__importDefault(require(a466_0x12a12a(0x1bb))),ListContactsService=async({searchParam:searchParam='',pageNumber:pageNumber='1',companyId:_0x137b7f,tagsIds:_0x1763be,isGroup:_0x3baacb})=>{const _0x2fcb91=a466_0x12a12a,_0x290d3a=(0x0,remove_accents_1['default'])(searchParam[_0x2fcb91(0x1ac)]()[_0x2fcb91(0x1c3)]());let _0x58e297={[sequelize_1['Op']['or']]:[{'name':(0x0,sequelize_1[_0x2fcb91(0x1b8)])((0x0,sequelize_1['fn'])(_0x2fcb91(0x1ba),(0x0,sequelize_1['fn'])('unaccent',(0x0,sequelize_1[_0x2fcb91(0x1cc)])('Contact.name'))),'LIKE','%'+_0x290d3a+'%')},{'number':{[sequelize_1['Op'][_0x2fcb91(0x1b5)]]:'%'+_0x290d3a+'%'}}]};_0x58e297={..._0x58e297,'companyId':_0x137b7f};if(Array[_0x2fcb91(0x1b6)](_0x1763be)&&_0x1763be[_0x2fcb91(0x1b2)]>0x0){const _0x58609a=[],_0x87518a=await ContactTag_1[_0x2fcb91(0x1b4)][_0x2fcb91(0x1bf)]({'where':{'tagId':{[sequelize_1['Op']['in']]:_0x1763be}}});_0x87518a&&_0x58609a[_0x2fcb91(0x1c5)](_0x87518a['map'](_0x539cbd=>_0x539cbd[_0x2fcb91(0x1b3)]));const _0x4012a3=(0x0,lodash_1[_0x2fcb91(0x1c6)])(..._0x58609a);_0x58e297={..._0x58e297,'id':{[sequelize_1['Op']['in']]:_0x4012a3}};}_0x3baacb==='false'&&(_0x58e297={..._0x58e297,'isGroup':![]});const _0x3fd712=0x64,_0x53f966=_0x3fd712*(+pageNumber-0x1),{count:_0x238076,rows:_0x300a52}=await Contact_1[_0x2fcb91(0x1b4)][_0x2fcb91(0x1c1)]({'where':_0x58e297,'limit':_0x3fd712,'include':[{'model':Ticket_1['default'],'as':_0x2fcb91(0x1b9),'attributes':['id','status',_0x2fcb91(0x1c9),_0x2fcb91(0x1ae)]},{'model':Tag_1['default'],'as':_0x2fcb91(0x1d0)}],'offset':_0x53f966,'order':[[_0x2fcb91(0x1c8),_0x2fcb91(0x1be)]]}),_0x51cc0b=_0x238076>_0x53f966+_0x300a52[_0x2fcb91(0x1b2)];return{'contacts':_0x300a52,'count':_0x238076,'hasMore':_0x51cc0b};};function a466_0x49ae(){const _0x585aa1=['8htkLxg','ASC','findAll','33937bBSaFn','findAndCountAll','../../models/ContactTag','trim','3315390vXXRbl','push','intersection','90956PxxZMd','name','createdAt','__esModule','38829uwWzzq','col','lodash','__importDefault','12338631BykAUM','tags','toLocaleLowerCase','155dMOIvs','updatedAt','defineProperty','../../models/Contact','169676tbcysA','length','contactId','default','like','isArray','5625054HtCqlH','where','tickets','LOWER','remove-accents','../../models/Ticket'];a466_0x49ae=function(){return _0x585aa1;};return a466_0x49ae();}exports['default']=ListContactsService;