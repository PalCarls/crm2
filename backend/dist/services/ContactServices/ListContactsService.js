'use strict';const a404_0x1c1745=a404_0x3e01;(function(_0x481049,_0x16a2c7){const _0x5dad16=a404_0x3e01,_0x14f4c4=_0x481049();while(!![]){try{const _0x2ae6dd=-parseInt(_0x5dad16(0x1b4))/0x1+parseInt(_0x5dad16(0x1b7))/0x2*(parseInt(_0x5dad16(0x1c9))/0x3)+-parseInt(_0x5dad16(0x1d4))/0x4*(-parseInt(_0x5dad16(0x1ae))/0x5)+-parseInt(_0x5dad16(0x1c5))/0x6*(parseInt(_0x5dad16(0x1b5))/0x7)+-parseInt(_0x5dad16(0x1d2))/0x8*(-parseInt(_0x5dad16(0x1cc))/0x9)+-parseInt(_0x5dad16(0x1d1))/0xa+-parseInt(_0x5dad16(0x1c4))/0xb*(-parseInt(_0x5dad16(0x1af))/0xc);if(_0x2ae6dd===_0x16a2c7)break;else _0x14f4c4['push'](_0x14f4c4['shift']());}catch(_0x98bf5e){_0x14f4c4['push'](_0x14f4c4['shift']());}}}(a404_0x180e,0x650ba));function a404_0x180e(){const _0x3ce990=['sequelize','createdAt','name','141ZAfMZX','map','status','54jnvvJj','trim','ASC','push','__esModule','136090DyxXkd','155360Zkxnef','tags','160840izDEsD','log','../../models/Contact','Sequelize','15ZfOeWB','4780668kJPuab','default','contactId','intersection','Contact.name','395309KESbgc','55741LRMRaa','__importDefault','13380pfpydq','../../models/Ticket','where','findAndCountAll','findAll','LIKE','toLowerCase','LOWER','updatedAt','defineProperty','lodash','length','../../models/Tag','22AxffRM','396ZJgmCG'];a404_0x180e=function(){return _0x3ce990;};return a404_0x180e();}var __importDefault=this&&this[a404_0x1c1745(0x1b6)]||function(_0x58c7cf){const _0xc87dee=a404_0x1c1745;return _0x58c7cf&&_0x58c7cf[_0xc87dee(0x1d0)]?_0x58c7cf:{'default':_0x58c7cf};};Object[a404_0x1c1745(0x1c0)](exports,a404_0x1c1745(0x1d0),{'value':!![]});const sequelize_1=require(a404_0x1c1745(0x1c6)),Contact_1=__importDefault(require(a404_0x1c1745(0x1ac))),Ticket_1=__importDefault(require(a404_0x1c1745(0x1b8))),ContactTag_1=__importDefault(require('../../models/ContactTag')),lodash_1=require(a404_0x1c1745(0x1c1)),Tag_1=__importDefault(require(a404_0x1c1745(0x1c3))),ListContactsService=async({searchParam:searchParam='',pageNumber:pageNumber='1',companyId:_0x199e95,tagsIds:_0x1c61f7})=>{const _0x497a20=a404_0x1c1745;let _0x537872={[sequelize_1['Op']['or']]:[{'name':sequelize_1['Sequelize'][_0x497a20(0x1b9)](sequelize_1[_0x497a20(0x1ad)]['fn'](_0x497a20(0x1be),sequelize_1[_0x497a20(0x1ad)]['col'](_0x497a20(0x1b3))),_0x497a20(0x1bc),'%'+searchParam[_0x497a20(0x1bd)]()[_0x497a20(0x1cd)]()+'%')},{'number':{[sequelize_1['Op']['like']]:'%'+searchParam[_0x497a20(0x1bd)]()['trim']()+'%'}}]};_0x537872={..._0x537872,'companyId':_0x199e95};if(Array['isArray'](_0x1c61f7)&&_0x1c61f7[_0x497a20(0x1c2)]>0x0){const _0x1b37d9=[],_0x699517=await ContactTag_1['default'][_0x497a20(0x1bb)]({'where':{'tagId':{[sequelize_1['Op']['in']]:_0x1c61f7}}});_0x699517&&_0x1b37d9[_0x497a20(0x1cf)](_0x699517[_0x497a20(0x1ca)](_0x5c433e=>_0x5c433e[_0x497a20(0x1b1)]));console[_0x497a20(0x1d5)](_0x699517);const _0x45df1b=(0x0,lodash_1[_0x497a20(0x1b2)])(..._0x1b37d9);_0x537872={..._0x537872,'id':{[sequelize_1['Op']['in']]:_0x45df1b}};}const _0x390858=0x64,_0x55a994=_0x390858*(+pageNumber-0x1),{count:_0x403cc1,rows:_0x25aa28}=await Contact_1['default'][_0x497a20(0x1ba)]({'where':_0x537872,'limit':_0x390858,'include':[{'model':Ticket_1['default'],'as':'tickets','attributes':['id',_0x497a20(0x1cb),_0x497a20(0x1c7),_0x497a20(0x1bf)]},{'model':Tag_1[_0x497a20(0x1b0)],'as':_0x497a20(0x1d3)}],'offset':_0x55a994,'order':[[_0x497a20(0x1c8),_0x497a20(0x1ce)]]}),_0x5b54df=_0x403cc1>_0x55a994+_0x25aa28[_0x497a20(0x1c2)];return{'contacts':_0x25aa28,'count':_0x403cc1,'hasMore':_0x5b54df};};function a404_0x3e01(_0xca25a4,_0x444dce){const _0x180e56=a404_0x180e();return a404_0x3e01=function(_0x3e01c2,_0x30271c){_0x3e01c2=_0x3e01c2-0x1ac;let _0x46d4c1=_0x180e56[_0x3e01c2];return _0x46d4c1;},a404_0x3e01(_0xca25a4,_0x444dce);}exports[a404_0x1c1745(0x1b0)]=ListContactsService;