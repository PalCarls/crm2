'use strict';function a386_0x1cae(_0x57b6cd,_0x1e27ed){const _0x4c3d53=a386_0x4c3d();return a386_0x1cae=function(_0x1cae18,_0x15bf47){_0x1cae18=_0x1cae18-0x184;let _0x396804=_0x4c3d53[_0x1cae18];return _0x396804;},a386_0x1cae(_0x57b6cd,_0x1e27ed);}const a386_0x17d470=a386_0x1cae;function a386_0x4c3d(){const _0x15cea3=['sheet_to_json','Sheets','head','39KwfQEC','11kKuKPB','numero','nome','48762ouRJyD','default','1533YauvBx','2250ItMogo','xlsx','map','Numero','14475150mDRvjw','companyId','path','38296tkBQwV','../../models/Contact','16894TdGUCS','readFile','email','e-mail','lodash','__esModule','número','2515092xZLmFH','Nome','Número','ImportContactsService','utils','220jTCHLS','has','1495379YGrYKw','Email','43264SvIzZX','replace','E-mail','findOrCreate'];a386_0x4c3d=function(){return _0x15cea3;};return a386_0x4c3d();}(function(_0x40e6cb,_0x65975b){const _0x59e8bc=a386_0x1cae,_0x8b60a9=_0x40e6cb();while(!![]){try{const _0x19f16e=-parseInt(_0x59e8bc(0x1a5))/0x1+parseInt(_0x59e8bc(0x197))/0x2*(parseInt(_0x59e8bc(0x187))/0x3)+-parseInt(_0x59e8bc(0x1a7))/0x4*(-parseInt(_0x59e8bc(0x1a3))/0x5)+parseInt(_0x59e8bc(0x18b))/0x6*(parseInt(_0x59e8bc(0x18d))/0x7)+-parseInt(_0x59e8bc(0x195))/0x8*(parseInt(_0x59e8bc(0x18e))/0x9)+parseInt(_0x59e8bc(0x192))/0xa+parseInt(_0x59e8bc(0x188))/0xb*(-parseInt(_0x59e8bc(0x19e))/0xc);if(_0x19f16e===_0x65975b)break;else _0x8b60a9['push'](_0x8b60a9['shift']());}catch(_0x3f8a43){_0x8b60a9['push'](_0x8b60a9['shift']());}}}(a386_0x4c3d,0xde7db));var __importDefault=this&&this['__importDefault']||function(_0x3831c9){const _0x429faa=a386_0x1cae;return _0x3831c9&&_0x3831c9[_0x429faa(0x19c)]?_0x3831c9:{'default':_0x3831c9};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a386_0x17d470(0x1a1)]=void 0x0;const lodash_1=require(a386_0x17d470(0x19b)),xlsx_1=__importDefault(require(a386_0x17d470(0x18f))),lodash_2=require(a386_0x17d470(0x19b)),Contact_1=__importDefault(require(a386_0x17d470(0x196)));async function ImportContactsService(_0x44eddc,_0x2c46c1){const _0x55ce83=a386_0x17d470,_0x2b996b=xlsx_1[_0x55ce83(0x18c)][_0x55ce83(0x198)](_0x2c46c1?.[_0x55ce83(0x194)]),_0x2348fa=(0x0,lodash_1[_0x55ce83(0x186)])(Object['values'](_0x2b996b[_0x55ce83(0x185)])),_0x143def=xlsx_1[_0x55ce83(0x18c)][_0x55ce83(0x1a2)][_0x55ce83(0x184)](_0x2348fa,{'header':0x0}),_0x2443c6=_0x143def[_0x55ce83(0x190)](_0x135954=>{const _0x538895=_0x55ce83;let _0x187b5a='',_0x55334a='',_0x50f8bf='';return((0x0,lodash_2[_0x538895(0x1a4)])(_0x135954,_0x538895(0x18a))||(0x0,lodash_2[_0x538895(0x1a4)])(_0x135954,_0x538895(0x19f)))&&(_0x187b5a=_0x135954[_0x538895(0x18a)]||_0x135954[_0x538895(0x19f)]),((0x0,lodash_2[_0x538895(0x1a4)])(_0x135954,_0x538895(0x189))||(0x0,lodash_2[_0x538895(0x1a4)])(_0x135954,_0x538895(0x19d))||(0x0,lodash_2[_0x538895(0x1a4)])(_0x135954,_0x538895(0x191))||(0x0,lodash_2['has'])(_0x135954,'Número'))&&(_0x55334a=_0x135954[_0x538895(0x189)]||_0x135954['número']||_0x135954['Numero']||_0x135954[_0x538895(0x1a0)],_0x55334a=(''+_0x55334a)[_0x538895(0x1a8)](/\D/g,'')),((0x0,lodash_2[_0x538895(0x1a4)])(_0x135954,_0x538895(0x199))||(0x0,lodash_2[_0x538895(0x1a4)])(_0x135954,_0x538895(0x19a))||(0x0,lodash_2[_0x538895(0x1a4)])(_0x135954,_0x538895(0x1a6))||(0x0,lodash_2['has'])(_0x135954,_0x538895(0x1a9)))&&(_0x50f8bf=_0x135954['email']||_0x135954['e-mail']||_0x135954[_0x538895(0x1a6)]||_0x135954['E-mail']),{'name':_0x187b5a,'number':_0x55334a,'email':_0x50f8bf,'companyId':_0x44eddc};}),_0x1d07e9=[];for(const _0x33b096 of _0x2443c6){const [_0x328227,_0x45da24]=await Contact_1[_0x55ce83(0x18c)][_0x55ce83(0x1aa)]({'where':{'number':''+_0x33b096['number'],'companyId':_0x33b096[_0x55ce83(0x193)]},'defaults':_0x33b096});_0x45da24&&_0x1d07e9['push'](_0x328227);}return _0x1d07e9;}exports[a386_0x17d470(0x1a1)]=ImportContactsService;