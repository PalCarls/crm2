'use strict';const a419_0x2ac4bc=a419_0x52b3;function a419_0x3063(){const _0x33b812=['push','lodash','E-mail','../../models/Contact','number','email','__importDefault','6812616mvJfuT','102110ybZuky','e-mail','Email','603IsOlxd','8681EySEfp','Sheets','default','defineProperty','nome','Número','has','__esModule','número','3GKoQey','23809248eLjzCo','values','findOrCreate','ImportContactsService','2GcgTdV','Nome','10967605CnuVOg','numero','15659tMOJDn','replace','5jejjap','4528wcvxlY','readFile','utils','Numero','978452VdokQl'];a419_0x3063=function(){return _0x33b812;};return a419_0x3063();}(function(_0x234ef5,_0x4ab8f1){const _0x377a6d=a419_0x52b3,_0x303429=_0x234ef5();while(!![]){try{const _0x216e96=parseInt(_0x377a6d(0xdf))/0x1*(parseInt(_0x377a6d(0xed))/0x2)+-parseInt(_0x377a6d(0xe8))/0x3*(-parseInt(_0x377a6d(0xd2))/0x4)+parseInt(_0x377a6d(0xcd))/0x5*(-parseInt(_0x377a6d(0xda))/0x6)+parseInt(_0x377a6d(0xcb))/0x7*(parseInt(_0x377a6d(0xce))/0x8)+-parseInt(_0x377a6d(0xde))/0x9*(parseInt(_0x377a6d(0xdb))/0xa)+-parseInt(_0x377a6d(0xef))/0xb+parseInt(_0x377a6d(0xe9))/0xc;if(_0x216e96===_0x4ab8f1)break;else _0x303429['push'](_0x303429['shift']());}catch(_0x1c7110){_0x303429['push'](_0x303429['shift']());}}}(a419_0x3063,0xa7b40));function a419_0x52b3(_0x1f2c5e,_0x20a809){const _0x306344=a419_0x3063();return a419_0x52b3=function(_0x52b3fb,_0x494a72){_0x52b3fb=_0x52b3fb-0xcb;let _0x47a84b=_0x306344[_0x52b3fb];return _0x47a84b;},a419_0x52b3(_0x1f2c5e,_0x20a809);}var __importDefault=this&&this[a419_0x2ac4bc(0xd9)]||function(_0x20ff31){return _0x20ff31&&_0x20ff31['__esModule']?_0x20ff31:{'default':_0x20ff31};};Object[a419_0x2ac4bc(0xe2)](exports,a419_0x2ac4bc(0xe6),{'value':!![]}),exports[a419_0x2ac4bc(0xec)]=void 0x0;const lodash_1=require(a419_0x2ac4bc(0xd4)),xlsx_1=__importDefault(require('xlsx')),lodash_2=require('lodash'),Contact_1=__importDefault(require(a419_0x2ac4bc(0xd6)));async function ImportContactsService(_0x4ba44f,_0x29163e){const _0x2bb11a=a419_0x2ac4bc,_0x2df879=xlsx_1[_0x2bb11a(0xe1)][_0x2bb11a(0xcf)](_0x29163e?.['path']),_0x4f06ed=(0x0,lodash_1['head'])(Object[_0x2bb11a(0xea)](_0x2df879[_0x2bb11a(0xe0)])),_0x44380e=xlsx_1[_0x2bb11a(0xe1)][_0x2bb11a(0xd0)]['sheet_to_json'](_0x4f06ed,{'header':0x0}),_0x444ff6=_0x44380e['map'](_0x1aecd1=>{const _0x2bb103=_0x2bb11a;let _0x3eba5a='',_0x115918='',_0x463d80='';return((0x0,lodash_2[_0x2bb103(0xe5)])(_0x1aecd1,_0x2bb103(0xe3))||(0x0,lodash_2['has'])(_0x1aecd1,_0x2bb103(0xee)))&&(_0x3eba5a=_0x1aecd1['nome']||_0x1aecd1[_0x2bb103(0xee)]),((0x0,lodash_2[_0x2bb103(0xe5)])(_0x1aecd1,'numero')||(0x0,lodash_2[_0x2bb103(0xe5)])(_0x1aecd1,'número')||(0x0,lodash_2[_0x2bb103(0xe5)])(_0x1aecd1,_0x2bb103(0xd1))||(0x0,lodash_2['has'])(_0x1aecd1,_0x2bb103(0xe4)))&&(_0x115918=_0x1aecd1[_0x2bb103(0xf0)]||_0x1aecd1[_0x2bb103(0xe7)]||_0x1aecd1[_0x2bb103(0xd1)]||_0x1aecd1[_0x2bb103(0xe4)],_0x115918=(''+_0x115918)[_0x2bb103(0xcc)](/\D/g,'')),((0x0,lodash_2[_0x2bb103(0xe5)])(_0x1aecd1,_0x2bb103(0xd8))||(0x0,lodash_2['has'])(_0x1aecd1,_0x2bb103(0xdc))||(0x0,lodash_2['has'])(_0x1aecd1,_0x2bb103(0xdd))||(0x0,lodash_2[_0x2bb103(0xe5)])(_0x1aecd1,'E-mail'))&&(_0x463d80=_0x1aecd1['email']||_0x1aecd1[_0x2bb103(0xdc)]||_0x1aecd1[_0x2bb103(0xdd)]||_0x1aecd1[_0x2bb103(0xd5)]),{'name':_0x3eba5a,'number':_0x115918,'email':_0x463d80,'companyId':_0x4ba44f};}),_0x159b8b=[];for(const _0x3dadae of _0x444ff6){const [_0x173338,_0x51561a]=await Contact_1[_0x2bb11a(0xe1)][_0x2bb11a(0xeb)]({'where':{'number':''+_0x3dadae[_0x2bb11a(0xd7)],'companyId':_0x3dadae['companyId']},'defaults':_0x3dadae});_0x51561a&&_0x159b8b[_0x2bb11a(0xd3)](_0x173338);}return _0x159b8b;}exports['ImportContactsService']=ImportContactsService;