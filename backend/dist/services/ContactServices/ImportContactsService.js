'use strict';const a465_0xe43e67=a465_0x1460;function a465_0x304b(){const _0x221f5f=['email','número','findOrCreate','25255nmbBtX','Email','441717bhmfBD','nome','e-mail','9ZqxUpo','values','1972368XbTayo','map','../../models/Contact','head','push','sheet_to_json','replace','default','xlsx','E-mail','Número','defineProperty','20AQnrlN','820qsetyU','1791181uTDQGg','1207162ibdRKm','path','number','10MPFXWU','utils','has','Sheets','9996qHkqmD','541064FUhMvo','Numero','Nome','__esModule','ImportContactsService','lodash'];a465_0x304b=function(){return _0x221f5f;};return a465_0x304b();}(function(_0x401d91,_0x46baa0){const _0x1326db=a465_0x1460,_0x5e723d=_0x401d91();while(!![]){try{const _0x51f468=parseInt(_0x1326db(0x164))/0x1*(parseInt(_0x1326db(0x150))/0x2)+parseInt(_0x1326db(0x166))/0x3+parseInt(_0x1326db(0x15b))/0x4+-parseInt(_0x1326db(0x151))/0x5*(parseInt(_0x1326db(0x15a))/0x6)+-parseInt(_0x1326db(0x152))/0x7+parseInt(_0x1326db(0x144))/0x8*(parseInt(_0x1326db(0x142))/0x9)+parseInt(_0x1326db(0x156))/0xa*(-parseInt(_0x1326db(0x153))/0xb);if(_0x51f468===_0x46baa0)break;else _0x5e723d['push'](_0x5e723d['shift']());}catch(_0x2f3945){_0x5e723d['push'](_0x5e723d['shift']());}}}(a465_0x304b,0x22da0));function a465_0x1460(_0xfd4c58,_0xa08328){const _0x304b96=a465_0x304b();return a465_0x1460=function(_0x146082,_0x311305){_0x146082=_0x146082-0x140;let _0x4e6490=_0x304b96[_0x146082];return _0x4e6490;},a465_0x1460(_0xfd4c58,_0xa08328);}var __importDefault=this&&this['__importDefault']||function(_0x4c4c51){const _0x96b1cf=a465_0x1460;return _0x4c4c51&&_0x4c4c51[_0x96b1cf(0x15e)]?_0x4c4c51:{'default':_0x4c4c51};};Object[a465_0xe43e67(0x14f)](exports,'__esModule',{'value':!![]}),exports[a465_0xe43e67(0x15f)]=void 0x0;const lodash_1=require('lodash'),xlsx_1=__importDefault(require(a465_0xe43e67(0x14c))),lodash_2=require(a465_0xe43e67(0x160)),Contact_1=__importDefault(require(a465_0xe43e67(0x146)));async function ImportContactsService(_0x292547,_0x3eaf60){const _0x150f3a=a465_0xe43e67,_0x328027=xlsx_1[_0x150f3a(0x14b)]['readFile'](_0x3eaf60?.[_0x150f3a(0x154)]),_0x5f1f39=(0x0,lodash_1[_0x150f3a(0x147)])(Object[_0x150f3a(0x143)](_0x328027[_0x150f3a(0x159)])),_0x3c1f3a=xlsx_1['default'][_0x150f3a(0x157)][_0x150f3a(0x149)](_0x5f1f39,{'header':0x0}),_0x244b70=_0x3c1f3a[_0x150f3a(0x145)](_0x535631=>{const _0x450151=_0x150f3a;let _0x82813c='',_0x290493='',_0x184ca9='';return((0x0,lodash_2[_0x450151(0x158)])(_0x535631,'nome')||(0x0,lodash_2[_0x450151(0x158)])(_0x535631,_0x450151(0x15d)))&&(_0x82813c=_0x535631[_0x450151(0x140)]||_0x535631['Nome']),((0x0,lodash_2[_0x450151(0x158)])(_0x535631,'numero')||(0x0,lodash_2[_0x450151(0x158)])(_0x535631,'número')||(0x0,lodash_2[_0x450151(0x158)])(_0x535631,_0x450151(0x15c))||(0x0,lodash_2['has'])(_0x535631,_0x450151(0x14e)))&&(_0x290493=_0x535631['numero']||_0x535631[_0x450151(0x162)]||_0x535631[_0x450151(0x15c)]||_0x535631[_0x450151(0x14e)],_0x290493=(''+_0x290493)[_0x450151(0x14a)](/\D/g,'')),((0x0,lodash_2[_0x450151(0x158)])(_0x535631,_0x450151(0x161))||(0x0,lodash_2[_0x450151(0x158)])(_0x535631,_0x450151(0x141))||(0x0,lodash_2[_0x450151(0x158)])(_0x535631,_0x450151(0x165))||(0x0,lodash_2['has'])(_0x535631,_0x450151(0x14d)))&&(_0x184ca9=_0x535631[_0x450151(0x161)]||_0x535631['e-mail']||_0x535631[_0x450151(0x165)]||_0x535631[_0x450151(0x14d)]),{'name':_0x82813c,'number':_0x290493,'email':_0x184ca9,'companyId':_0x292547};}),_0x3ee1d6=[];for(const _0x3a02b9 of _0x244b70){const [_0x325057,_0x50c3c5]=await Contact_1[_0x150f3a(0x14b)][_0x150f3a(0x163)]({'where':{'number':''+_0x3a02b9[_0x150f3a(0x155)],'companyId':_0x3a02b9['companyId']},'defaults':_0x3a02b9});_0x50c3c5&&_0x3ee1d6[_0x150f3a(0x148)](_0x325057);}return _0x3ee1d6;}exports[a465_0xe43e67(0x15f)]=ImportContactsService;