'use strict';const a403_0x2fd347=a403_0x186e;function a403_0x186e(_0x4fb0a9,_0x1fc441){const _0x3892e3=a403_0x3892();return a403_0x186e=function(_0x186e99,_0x21ce8e){_0x186e99=_0x186e99-0x1d8;let _0x396bf8=_0x3892e3[_0x186e99];return _0x396bf8;},a403_0x186e(_0x4fb0a9,_0x1fc441);}(function(_0x1ce4db,_0x3a6c0f){const _0x40dcfd=a403_0x186e,_0xeeefec=_0x1ce4db();while(!![]){try{const _0x1c4a67=-parseInt(_0x40dcfd(0x1e3))/0x1+parseInt(_0x40dcfd(0x1e1))/0x2+parseInt(_0x40dcfd(0x1f0))/0x3+-parseInt(_0x40dcfd(0x1eb))/0x4*(parseInt(_0x40dcfd(0x1e6))/0x5)+-parseInt(_0x40dcfd(0x1f7))/0x6*(parseInt(_0x40dcfd(0x1f9))/0x7)+-parseInt(_0x40dcfd(0x1fb))/0x8+-parseInt(_0x40dcfd(0x1e2))/0x9*(-parseInt(_0x40dcfd(0x1da))/0xa);if(_0x1c4a67===_0x3a6c0f)break;else _0xeeefec['push'](_0xeeefec['shift']());}catch(_0x10aab1){_0xeeefec['push'](_0xeeefec['shift']());}}}(a403_0x3892,0x5d42f));var __importDefault=this&&this[a403_0x2fd347(0x1f3)]||function(_0x5d6ee8){const _0x6ff482=a403_0x2fd347;return _0x5d6ee8&&_0x5d6ee8[_0x6ff482(0x1f2)]?_0x5d6ee8:{'default':_0x5d6ee8};};Object[a403_0x2fd347(0x1e4)](exports,'__esModule',{'value':!![]}),exports[a403_0x2fd347(0x1ee)]=void 0x0;const lodash_1=require('lodash'),xlsx_1=__importDefault(require(a403_0x2fd347(0x1fc))),lodash_2=require(a403_0x2fd347(0x1e8)),Contact_1=__importDefault(require(a403_0x2fd347(0x1ed)));function a403_0x3892(){const _0x34f8d1=['E-mail','1590159cAIXeW','map','__esModule','__importDefault','utils','numero','path','67062CMukwP','Email','147DEImHH','has','488176qQMrQw','xlsx','push','default','companyId','readFile','Nome','Numero','35860yZWAuB','findOrCreate','head','replace','e-mail','Número','email','833036jidgLL','1413fgMAcW','293812XqXiUn','defineProperty','nome','47195JeCwYR','values','lodash','number','Sheets','228ijfNUA','número','../../models/Contact','ImportContactsService'];a403_0x3892=function(){return _0x34f8d1;};return a403_0x3892();}async function ImportContactsService(_0x54ccd0,_0xb31c8c){const _0x48c3b9=a403_0x2fd347,_0x48c64a=xlsx_1[_0x48c3b9(0x1fe)][_0x48c3b9(0x200)](_0xb31c8c?.[_0x48c3b9(0x1f6)]),_0x3d16ed=(0x0,lodash_1[_0x48c3b9(0x1dc)])(Object[_0x48c3b9(0x1e7)](_0x48c64a[_0x48c3b9(0x1ea)])),_0x2e466a=xlsx_1['default'][_0x48c3b9(0x1f4)]['sheet_to_json'](_0x3d16ed,{'header':0x0}),_0x14c55d=_0x2e466a[_0x48c3b9(0x1f1)](_0x5338d1=>{const _0x5d3b6a=_0x48c3b9;let _0x404326='',_0x1b1ec6='',_0x3880d8='';return((0x0,lodash_2[_0x5d3b6a(0x1fa)])(_0x5338d1,'nome')||(0x0,lodash_2[_0x5d3b6a(0x1fa)])(_0x5338d1,_0x5d3b6a(0x1d8)))&&(_0x404326=_0x5338d1[_0x5d3b6a(0x1e5)]||_0x5338d1[_0x5d3b6a(0x1d8)]),((0x0,lodash_2[_0x5d3b6a(0x1fa)])(_0x5338d1,'numero')||(0x0,lodash_2[_0x5d3b6a(0x1fa)])(_0x5338d1,_0x5d3b6a(0x1ec))||(0x0,lodash_2[_0x5d3b6a(0x1fa)])(_0x5338d1,_0x5d3b6a(0x1d9))||(0x0,lodash_2[_0x5d3b6a(0x1fa)])(_0x5338d1,_0x5d3b6a(0x1df)))&&(_0x1b1ec6=_0x5338d1[_0x5d3b6a(0x1f5)]||_0x5338d1[_0x5d3b6a(0x1ec)]||_0x5338d1[_0x5d3b6a(0x1d9)]||_0x5338d1[_0x5d3b6a(0x1df)],_0x1b1ec6=(''+_0x1b1ec6)[_0x5d3b6a(0x1dd)](/\D/g,'')),((0x0,lodash_2[_0x5d3b6a(0x1fa)])(_0x5338d1,'email')||(0x0,lodash_2[_0x5d3b6a(0x1fa)])(_0x5338d1,_0x5d3b6a(0x1de))||(0x0,lodash_2[_0x5d3b6a(0x1fa)])(_0x5338d1,_0x5d3b6a(0x1f8))||(0x0,lodash_2[_0x5d3b6a(0x1fa)])(_0x5338d1,_0x5d3b6a(0x1ef)))&&(_0x3880d8=_0x5338d1[_0x5d3b6a(0x1e0)]||_0x5338d1[_0x5d3b6a(0x1de)]||_0x5338d1[_0x5d3b6a(0x1f8)]||_0x5338d1[_0x5d3b6a(0x1ef)]),{'name':_0x404326,'number':_0x1b1ec6,'email':_0x3880d8,'companyId':_0x54ccd0};}),_0x2dcc16=[];for(const _0xe5fbd4 of _0x14c55d){const [_0x20f6ae,_0x36e3fd]=await Contact_1[_0x48c3b9(0x1fe)][_0x48c3b9(0x1db)]({'where':{'number':''+_0xe5fbd4[_0x48c3b9(0x1e9)],'companyId':_0xe5fbd4[_0x48c3b9(0x1ff)]},'defaults':_0xe5fbd4});_0x36e3fd&&_0x2dcc16[_0x48c3b9(0x1fd)](_0x20f6ae);}return _0x2dcc16;}exports[a403_0x2fd347(0x1ee)]=ImportContactsService;