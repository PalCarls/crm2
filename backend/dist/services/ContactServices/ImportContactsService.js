'use strict';function a465_0x4ef9(){const _0x45f21f=['6190518ireCsP','7efKftb','476372UdtGgX','Número','nome','values','utils','__esModule','../../models/Contact','push','__importDefault','12238456rwlpBQ','número','ImportContactsService','numero','defineProperty','2651900PjBiGl','Nome','1gbWwIa','e-mail','findOrCreate','Numero','map','2516703VOmwmg','has','E-mail','2041584EURmCC','replace','9AXNwmz','readFile','2270150pCcGVF','default','lodash'];a465_0x4ef9=function(){return _0x45f21f;};return a465_0x4ef9();}const a465_0x4faae2=a465_0x33f7;function a465_0x33f7(_0x237afb,_0x4dd2be){const _0x4ef999=a465_0x4ef9();return a465_0x33f7=function(_0x33f73e,_0x3b029a){_0x33f73e=_0x33f73e-0xb9;let _0xa0482a=_0x4ef999[_0x33f73e];return _0xa0482a;},a465_0x33f7(_0x237afb,_0x4dd2be);}(function(_0x10679a,_0x124636){const _0x5d15b1=a465_0x33f7,_0x5ecf6a=_0x10679a();while(!![]){try{const _0x5799f6=parseInt(_0x5d15b1(0xc1))/0x1*(-parseInt(_0x5d15b1(0xc9))/0x2)+-parseInt(_0x5d15b1(0xc6))/0x3+-parseInt(_0x5d15b1(0xd2))/0x4+parseInt(_0x5d15b1(0xcd))/0x5+parseInt(_0x5d15b1(0xd0))/0x6*(parseInt(_0x5d15b1(0xd1))/0x7)+parseInt(_0x5d15b1(0xba))/0x8*(parseInt(_0x5d15b1(0xcb))/0x9)+-parseInt(_0x5d15b1(0xbf))/0xa;if(_0x5799f6===_0x124636)break;else _0x5ecf6a['push'](_0x5ecf6a['shift']());}catch(_0xb68cc7){_0x5ecf6a['push'](_0x5ecf6a['shift']());}}}(a465_0x4ef9,0xbc61e));var __importDefault=this&&this[a465_0x4faae2(0xb9)]||function(_0x5c37d0){const _0x194e69=a465_0x4faae2;return _0x5c37d0&&_0x5c37d0[_0x194e69(0xd7)]?_0x5c37d0:{'default':_0x5c37d0};};Object[a465_0x4faae2(0xbe)](exports,a465_0x4faae2(0xd7),{'value':!![]}),exports['ImportContactsService']=void 0x0;const lodash_1=require(a465_0x4faae2(0xcf)),xlsx_1=__importDefault(require('xlsx')),lodash_2=require(a465_0x4faae2(0xcf)),Contact_1=__importDefault(require(a465_0x4faae2(0xd8)));async function ImportContactsService(_0x13f893,_0x4e0073){const _0x369eca=a465_0x4faae2,_0x9fee01=xlsx_1['default'][_0x369eca(0xcc)](_0x4e0073?.['path']),_0x3cc830=(0x0,lodash_1['head'])(Object[_0x369eca(0xd5)](_0x9fee01['Sheets'])),_0x3768cc=xlsx_1['default'][_0x369eca(0xd6)]['sheet_to_json'](_0x3cc830,{'header':0x0}),_0x57f4a0=_0x3768cc[_0x369eca(0xc5)](_0x252cad=>{const _0x3c2f94=_0x369eca;let _0x5957aa='',_0x3990ab='',_0xd9f2bd='';return((0x0,lodash_2[_0x3c2f94(0xc7)])(_0x252cad,_0x3c2f94(0xd4))||(0x0,lodash_2[_0x3c2f94(0xc7)])(_0x252cad,_0x3c2f94(0xc0)))&&(_0x5957aa=_0x252cad[_0x3c2f94(0xd4)]||_0x252cad[_0x3c2f94(0xc0)]),((0x0,lodash_2[_0x3c2f94(0xc7)])(_0x252cad,_0x3c2f94(0xbd))||(0x0,lodash_2[_0x3c2f94(0xc7)])(_0x252cad,_0x3c2f94(0xbb))||(0x0,lodash_2[_0x3c2f94(0xc7)])(_0x252cad,_0x3c2f94(0xc4))||(0x0,lodash_2['has'])(_0x252cad,'Número'))&&(_0x3990ab=_0x252cad[_0x3c2f94(0xbd)]||_0x252cad[_0x3c2f94(0xbb)]||_0x252cad['Numero']||_0x252cad[_0x3c2f94(0xd3)],_0x3990ab=(''+_0x3990ab)[_0x3c2f94(0xca)](/\D/g,'')),((0x0,lodash_2[_0x3c2f94(0xc7)])(_0x252cad,'email')||(0x0,lodash_2[_0x3c2f94(0xc7)])(_0x252cad,_0x3c2f94(0xc2))||(0x0,lodash_2['has'])(_0x252cad,'Email')||(0x0,lodash_2[_0x3c2f94(0xc7)])(_0x252cad,_0x3c2f94(0xc8)))&&(_0xd9f2bd=_0x252cad['email']||_0x252cad[_0x3c2f94(0xc2)]||_0x252cad['Email']||_0x252cad[_0x3c2f94(0xc8)]),{'name':_0x5957aa,'number':_0x3990ab,'email':_0xd9f2bd,'companyId':_0x13f893};}),_0x457a79=[];for(const _0x3cf1f6 of _0x57f4a0){const [_0x3da9ac,_0x1f5bc8]=await Contact_1[_0x369eca(0xce)][_0x369eca(0xc3)]({'where':{'number':''+_0x3cf1f6['number'],'companyId':_0x3cf1f6['companyId']},'defaults':_0x3cf1f6});_0x1f5bc8&&_0x457a79[_0x369eca(0xd9)](_0x3da9ac);}return _0x457a79;}exports[a465_0x4faae2(0xbc)]=ImportContactsService;