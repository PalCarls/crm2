'use strict';const a472_0x5be1a5=a472_0x1487;(function(_0x3e54fd,_0x5b1bfa){const _0x11cb68=a472_0x1487,_0x193936=_0x3e54fd();while(!![]){try{const _0x5d7438=-parseInt(_0x11cb68(0xb9))/0x1*(-parseInt(_0x11cb68(0xac))/0x2)+parseInt(_0x11cb68(0xbe))/0x3*(-parseInt(_0x11cb68(0xc5))/0x4)+parseInt(_0x11cb68(0xb2))/0x5*(-parseInt(_0x11cb68(0xa8))/0x6)+-parseInt(_0x11cb68(0xb4))/0x7*(parseInt(_0x11cb68(0xba))/0x8)+-parseInt(_0x11cb68(0xc6))/0x9+parseInt(_0x11cb68(0xab))/0xa*(-parseInt(_0x11cb68(0xce))/0xb)+-parseInt(_0x11cb68(0xca))/0xc*(-parseInt(_0x11cb68(0xbb))/0xd);if(_0x5d7438===_0x5b1bfa)break;else _0x193936['push'](_0x193936['shift']());}catch(_0x421c1b){_0x193936['push'](_0x193936['shift']());}}}(a472_0x1084,0x5bdc3));var __importDefault=this&&this[a472_0x5be1a5(0xbd)]||function(_0x1a9eb5){const _0x322d2f=a472_0x5be1a5;return _0x1a9eb5&&_0x1a9eb5[_0x322d2f(0xc9)]?_0x1a9eb5:{'default':_0x1a9eb5};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['ImportContactsService']=void 0x0;function a472_0x1487(_0x1269f4,_0x2cf21f){const _0x10849d=a472_0x1084();return a472_0x1487=function(_0x14873,_0x1ebc98){_0x14873=_0x14873-0xa8;let _0x3b43a6=_0x10849d[_0x14873];return _0x3b43a6;},a472_0x1487(_0x1269f4,_0x2cf21f);}const lodash_1=require(a472_0x5be1a5(0xae)),xlsx_1=__importDefault(require('xlsx')),lodash_2=require('lodash'),Contact_1=__importDefault(require(a472_0x5be1a5(0xc0)));function a472_0x1084(){const _0x4b18ac=['Nome','número','sheet_to_json','1453315whsUOZ','default','1421AsJOQq','readFile','Email','findOrCreate','utils','10832XzpObd','29608tYBizD','13mMiQBp','companyId','__importDefault','1116vlIezs','values','../../models/Contact','map','Número','E-mail','path','1032PCxsKo','5891922hjmEeT','e-mail','Sheets','__esModule','31537596FQjlBJ','has','nome','replace','333047AdUYgm','12eRANtf','email','numero','70GlPvqc','8GEjCQy','push','lodash'];a472_0x1084=function(){return _0x4b18ac;};return a472_0x1084();}async function ImportContactsService(_0x99973c,_0x2f11e5){const _0x6fe67c=a472_0x5be1a5,_0x782eea=xlsx_1['default'][_0x6fe67c(0xb5)](_0x2f11e5?.[_0x6fe67c(0xc4)]),_0x3d638a=(0x0,lodash_1['head'])(Object[_0x6fe67c(0xbf)](_0x782eea[_0x6fe67c(0xc8)])),_0x353168=xlsx_1[_0x6fe67c(0xb3)][_0x6fe67c(0xb8)][_0x6fe67c(0xb1)](_0x3d638a,{'header':0x0}),_0x3a61d5=_0x353168[_0x6fe67c(0xc1)](_0x3dff0f=>{const _0x24813f=_0x6fe67c;let _0x21ef98='',_0x36907e='',_0x17c067='';return((0x0,lodash_2[_0x24813f(0xcb)])(_0x3dff0f,_0x24813f(0xcc))||(0x0,lodash_2[_0x24813f(0xcb)])(_0x3dff0f,_0x24813f(0xaf)))&&(_0x21ef98=_0x3dff0f[_0x24813f(0xcc)]||_0x3dff0f[_0x24813f(0xaf)]),((0x0,lodash_2[_0x24813f(0xcb)])(_0x3dff0f,_0x24813f(0xaa))||(0x0,lodash_2[_0x24813f(0xcb)])(_0x3dff0f,_0x24813f(0xb0))||(0x0,lodash_2[_0x24813f(0xcb)])(_0x3dff0f,'Numero')||(0x0,lodash_2[_0x24813f(0xcb)])(_0x3dff0f,_0x24813f(0xc2)))&&(_0x36907e=_0x3dff0f['numero']||_0x3dff0f[_0x24813f(0xb0)]||_0x3dff0f['Numero']||_0x3dff0f[_0x24813f(0xc2)],_0x36907e=(''+_0x36907e)[_0x24813f(0xcd)](/\D/g,'')),((0x0,lodash_2[_0x24813f(0xcb)])(_0x3dff0f,'email')||(0x0,lodash_2[_0x24813f(0xcb)])(_0x3dff0f,_0x24813f(0xc7))||(0x0,lodash_2[_0x24813f(0xcb)])(_0x3dff0f,_0x24813f(0xb6))||(0x0,lodash_2[_0x24813f(0xcb)])(_0x3dff0f,'E-mail'))&&(_0x17c067=_0x3dff0f[_0x24813f(0xa9)]||_0x3dff0f[_0x24813f(0xc7)]||_0x3dff0f[_0x24813f(0xb6)]||_0x3dff0f[_0x24813f(0xc3)]),{'name':_0x21ef98,'number':_0x36907e,'email':_0x17c067,'companyId':_0x99973c};}),_0x2b3093=[];for(const _0x57af95 of _0x3a61d5){const [_0x3d91a1,_0x39daa2]=await Contact_1[_0x6fe67c(0xb3)][_0x6fe67c(0xb7)]({'where':{'number':''+_0x57af95['number'],'companyId':_0x57af95[_0x6fe67c(0xbc)]},'defaults':_0x57af95});_0x39daa2&&_0x2b3093[_0x6fe67c(0xad)](_0x3d91a1);}return _0x2b3093;}exports['ImportContactsService']=ImportContactsService;