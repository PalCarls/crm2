'use strict';const a419_0x45a3d7=a419_0x59c8;function a419_0x40ea(){const _0x3b0d63=['5105706orvRdy','Numero','replace','número','values','Número','number','push','default','__esModule','email','__importDefault','utils','../../models/Contact','Sheets','345TcMZwv','path','25935150GttxCi','9360639pzcZEa','2VZEVAX','1693321jgqliA','numero','head','Nome','defineProperty','Email','lodash','11412415unDUsV','6490272BecIfi','E-mail','readFile','has','41862bfYXzM','findOrCreate','nome','8bPoplB'];a419_0x40ea=function(){return _0x3b0d63;};return a419_0x40ea();}function a419_0x59c8(_0x38d04b,_0x1aa605){const _0x40ea3f=a419_0x40ea();return a419_0x59c8=function(_0x59c87e,_0x141fd1){_0x59c87e=_0x59c87e-0x1d9;let _0x347e17=_0x40ea3f[_0x59c87e];return _0x347e17;},a419_0x59c8(_0x38d04b,_0x1aa605);}(function(_0x25884e,_0x44fd89){const _0x4ae0ce=a419_0x59c8,_0x5699b1=_0x25884e();while(!![]){try{const _0x500cab=parseInt(_0x4ae0ce(0x1d9))/0x1*(-parseInt(_0x4ae0ce(0x1fc))/0x2)+parseInt(_0x4ae0ce(0x1e9))/0x3+-parseInt(_0x4ae0ce(0x1e1))/0x4+parseInt(_0x4ae0ce(0x1f8))/0x5*(parseInt(_0x4ae0ce(0x1e5))/0x6)+-parseInt(_0x4ae0ce(0x1e0))/0x7+-parseInt(_0x4ae0ce(0x1e8))/0x8*(-parseInt(_0x4ae0ce(0x1fb))/0x9)+parseInt(_0x4ae0ce(0x1fa))/0xa;if(_0x500cab===_0x44fd89)break;else _0x5699b1['push'](_0x5699b1['shift']());}catch(_0x4f6a29){_0x5699b1['push'](_0x5699b1['shift']());}}}(a419_0x40ea,0xd490b));var __importDefault=this&&this[a419_0x45a3d7(0x1f4)]||function(_0x4f06d0){return _0x4f06d0&&_0x4f06d0['__esModule']?_0x4f06d0:{'default':_0x4f06d0};};Object[a419_0x45a3d7(0x1dd)](exports,a419_0x45a3d7(0x1f2),{'value':!![]}),exports['ImportContactsService']=void 0x0;const lodash_1=require('lodash'),xlsx_1=__importDefault(require('xlsx')),lodash_2=require(a419_0x45a3d7(0x1df)),Contact_1=__importDefault(require(a419_0x45a3d7(0x1f6)));async function ImportContactsService(_0x4d5795,_0x2147f9){const _0x26f470=a419_0x45a3d7,_0x593776=xlsx_1[_0x26f470(0x1f1)][_0x26f470(0x1e3)](_0x2147f9?.[_0x26f470(0x1f9)]),_0x186f8d=(0x0,lodash_1[_0x26f470(0x1db)])(Object[_0x26f470(0x1ed)](_0x593776[_0x26f470(0x1f7)])),_0x5b54fc=xlsx_1[_0x26f470(0x1f1)][_0x26f470(0x1f5)]['sheet_to_json'](_0x186f8d,{'header':0x0}),_0x21e33d=_0x5b54fc['map'](_0x4f1e80=>{const _0x58791d=_0x26f470;let _0x4c70a='',_0x3ece72='',_0x4a3775='';return((0x0,lodash_2[_0x58791d(0x1e4)])(_0x4f1e80,_0x58791d(0x1e7))||(0x0,lodash_2['has'])(_0x4f1e80,_0x58791d(0x1dc)))&&(_0x4c70a=_0x4f1e80[_0x58791d(0x1e7)]||_0x4f1e80[_0x58791d(0x1dc)]),((0x0,lodash_2[_0x58791d(0x1e4)])(_0x4f1e80,_0x58791d(0x1da))||(0x0,lodash_2['has'])(_0x4f1e80,_0x58791d(0x1ec))||(0x0,lodash_2[_0x58791d(0x1e4)])(_0x4f1e80,_0x58791d(0x1ea))||(0x0,lodash_2[_0x58791d(0x1e4)])(_0x4f1e80,_0x58791d(0x1ee)))&&(_0x3ece72=_0x4f1e80[_0x58791d(0x1da)]||_0x4f1e80[_0x58791d(0x1ec)]||_0x4f1e80[_0x58791d(0x1ea)]||_0x4f1e80[_0x58791d(0x1ee)],_0x3ece72=(''+_0x3ece72)[_0x58791d(0x1eb)](/\D/g,'')),((0x0,lodash_2[_0x58791d(0x1e4)])(_0x4f1e80,_0x58791d(0x1f3))||(0x0,lodash_2['has'])(_0x4f1e80,'e-mail')||(0x0,lodash_2[_0x58791d(0x1e4)])(_0x4f1e80,'Email')||(0x0,lodash_2[_0x58791d(0x1e4)])(_0x4f1e80,'E-mail'))&&(_0x4a3775=_0x4f1e80[_0x58791d(0x1f3)]||_0x4f1e80['e-mail']||_0x4f1e80[_0x58791d(0x1de)]||_0x4f1e80[_0x58791d(0x1e2)]),{'name':_0x4c70a,'number':_0x3ece72,'email':_0x4a3775,'companyId':_0x4d5795};}),_0x21dbbb=[];for(const _0x53c268 of _0x21e33d){const [_0x2d2335,_0x343ca7]=await Contact_1[_0x26f470(0x1f1)][_0x26f470(0x1e6)]({'where':{'number':''+_0x53c268[_0x26f470(0x1ef)],'companyId':_0x53c268['companyId']},'defaults':_0x53c268});_0x343ca7&&_0x21dbbb[_0x26f470(0x1f0)](_0x2d2335);}return _0x21dbbb;}exports['ImportContactsService']=ImportContactsService;