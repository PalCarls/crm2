'use strict';const a439_0x5d13fb=a439_0x2f34;function a439_0x2f34(_0x4a5b53,_0x4f84ad){const _0x2f845a=a439_0x2f84();return a439_0x2f34=function(_0x2f34bc,_0xba0e86){_0x2f34bc=_0x2f34bc-0x1c5;let _0x286d37=_0x2f845a[_0x2f34bc];return _0x286d37;},a439_0x2f34(_0x4a5b53,_0x4f84ad);}(function(_0x25a848,_0x2647da){const _0x384c6c=a439_0x2f34,_0xfdccaa=_0x25a848();while(!![]){try{const _0x48cab7=parseInt(_0x384c6c(0x1da))/0x1+parseInt(_0x384c6c(0x1e6))/0x2*(-parseInt(_0x384c6c(0x1d8))/0x3)+parseInt(_0x384c6c(0x1de))/0x4*(parseInt(_0x384c6c(0x1d6))/0x5)+-parseInt(_0x384c6c(0x1dd))/0x6*(parseInt(_0x384c6c(0x1e4))/0x7)+parseInt(_0x384c6c(0x1db))/0x8*(parseInt(_0x384c6c(0x1d9))/0x9)+parseInt(_0x384c6c(0x1c7))/0xa+-parseInt(_0x384c6c(0x1d0))/0xb;if(_0x48cab7===_0x2647da)break;else _0xfdccaa['push'](_0xfdccaa['shift']());}catch(_0x4eb8f8){_0xfdccaa['push'](_0xfdccaa['shift']());}}}(a439_0x2f84,0x7bcb7));function a439_0x2f84(){const _0x2b98f9=['utils','nome','head','numero','default','30HdZDMu','Email','24FiwDnL','36QKMKbl','809168qwWGNa','470248jwaYHE','number','12bEqguz','103084jSsbGN','Sheets','values','readFile','e-mail','E-mail','2182502GAydst','Número','67090PtOfiR','lodash','Numero','Nome','email','número','__importDefault','xlsx','9351830fJKkfe','defineProperty','push','path','has','map','findOrCreate','__esModule','replace','8086166zLcxjg'];a439_0x2f84=function(){return _0x2b98f9;};return a439_0x2f84();}var __importDefault=this&&this[a439_0x5d13fb(0x1c5)]||function(_0x463408){const _0x35d250=a439_0x5d13fb;return _0x463408&&_0x463408[_0x35d250(0x1ce)]?_0x463408:{'default':_0x463408};};Object[a439_0x5d13fb(0x1c8)](exports,a439_0x5d13fb(0x1ce),{'value':!![]}),exports['ImportContactsService']=void 0x0;const lodash_1=require(a439_0x5d13fb(0x1e7)),xlsx_1=__importDefault(require(a439_0x5d13fb(0x1c6))),lodash_2=require('lodash'),Contact_1=__importDefault(require('../../models/Contact'));async function ImportContactsService(_0x1fc7b6,_0x2aad09){const _0x5081b9=a439_0x5d13fb,_0x22c31f=xlsx_1[_0x5081b9(0x1d5)][_0x5081b9(0x1e1)](_0x2aad09?.[_0x5081b9(0x1ca)]),_0x2c7904=(0x0,lodash_1[_0x5081b9(0x1d3)])(Object[_0x5081b9(0x1e0)](_0x22c31f[_0x5081b9(0x1df)])),_0x4d7aa5=xlsx_1['default'][_0x5081b9(0x1d1)]['sheet_to_json'](_0x2c7904,{'header':0x0}),_0xcac8d1=_0x4d7aa5[_0x5081b9(0x1cc)](_0x29a8ec=>{const _0xec06d4=_0x5081b9;let _0x39c4b8='',_0x3db89c='',_0x4171a4='';return((0x0,lodash_2['has'])(_0x29a8ec,'nome')||(0x0,lodash_2['has'])(_0x29a8ec,_0xec06d4(0x1e9)))&&(_0x39c4b8=_0x29a8ec[_0xec06d4(0x1d2)]||_0x29a8ec[_0xec06d4(0x1e9)]),((0x0,lodash_2[_0xec06d4(0x1cb)])(_0x29a8ec,_0xec06d4(0x1d4))||(0x0,lodash_2[_0xec06d4(0x1cb)])(_0x29a8ec,_0xec06d4(0x1eb))||(0x0,lodash_2[_0xec06d4(0x1cb)])(_0x29a8ec,_0xec06d4(0x1e8))||(0x0,lodash_2[_0xec06d4(0x1cb)])(_0x29a8ec,'Número'))&&(_0x3db89c=_0x29a8ec[_0xec06d4(0x1d4)]||_0x29a8ec[_0xec06d4(0x1eb)]||_0x29a8ec[_0xec06d4(0x1e8)]||_0x29a8ec[_0xec06d4(0x1e5)],_0x3db89c=(''+_0x3db89c)[_0xec06d4(0x1cf)](/\D/g,'')),((0x0,lodash_2[_0xec06d4(0x1cb)])(_0x29a8ec,_0xec06d4(0x1ea))||(0x0,lodash_2[_0xec06d4(0x1cb)])(_0x29a8ec,_0xec06d4(0x1e2))||(0x0,lodash_2[_0xec06d4(0x1cb)])(_0x29a8ec,'Email')||(0x0,lodash_2['has'])(_0x29a8ec,_0xec06d4(0x1e3)))&&(_0x4171a4=_0x29a8ec[_0xec06d4(0x1ea)]||_0x29a8ec[_0xec06d4(0x1e2)]||_0x29a8ec[_0xec06d4(0x1d7)]||_0x29a8ec[_0xec06d4(0x1e3)]),{'name':_0x39c4b8,'number':_0x3db89c,'email':_0x4171a4,'companyId':_0x1fc7b6};}),_0x21c9a0=[];for(const _0x595864 of _0xcac8d1){const [_0x3ec235,_0x3b8757]=await Contact_1[_0x5081b9(0x1d5)][_0x5081b9(0x1cd)]({'where':{'number':''+_0x595864[_0x5081b9(0x1dc)],'companyId':_0x595864['companyId']},'defaults':_0x595864});_0x3b8757&&_0x21c9a0[_0x5081b9(0x1c9)](_0x3ec235);}return _0x21c9a0;}exports['ImportContactsService']=ImportContactsService;