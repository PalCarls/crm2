'use strict';const a433_0x81bfc3=a433_0x50dc;(function(_0x1de0c0,_0x523b67){const _0x2138e4=a433_0x50dc,_0xdb15dc=_0x1de0c0();while(!![]){try{const _0x8641cc=-parseInt(_0x2138e4(0x93))/0x1+-parseInt(_0x2138e4(0x9b))/0x2*(parseInt(_0x2138e4(0x85))/0x3)+-parseInt(_0x2138e4(0x9c))/0x4*(parseInt(_0x2138e4(0x90))/0x5)+-parseInt(_0x2138e4(0x8a))/0x6+-parseInt(_0x2138e4(0xae))/0x7+-parseInt(_0x2138e4(0x8d))/0x8+parseInt(_0x2138e4(0xa3))/0x9;if(_0x8641cc===_0x523b67)break;else _0xdb15dc['push'](_0xdb15dc['shift']());}catch(_0x25aa58){_0xdb15dc['push'](_0xdb15dc['shift']());}}}(a433_0x389c,0x5e80f));var __createBinding=this&&this[a433_0x81bfc3(0x92)]||(Object[a433_0x81bfc3(0x9d)]?function(_0x592e32,_0x3aec1c,_0xc6fc9e,_0x36971a){const _0x101e06=a433_0x81bfc3;if(_0x36971a===undefined)_0x36971a=_0xc6fc9e;var _0x2a9133=Object[_0x101e06(0xa8)](_0x3aec1c,_0xc6fc9e);(!_0x2a9133||(_0x101e06(0x98)in _0x2a9133?!_0x3aec1c[_0x101e06(0xa4)]:_0x2a9133[_0x101e06(0xb3)]||_0x2a9133['configurable']))&&(_0x2a9133={'enumerable':!![],'get':function(){return _0x3aec1c[_0xc6fc9e];}}),Object[_0x101e06(0x82)](_0x592e32,_0x36971a,_0x2a9133);}:function(_0xbddae0,_0x255ba8,_0x523ba8,_0x20d723){if(_0x20d723===undefined)_0x20d723=_0x523ba8;_0xbddae0[_0x20d723]=_0x255ba8[_0x523ba8];}),__setModuleDefault=this&&this[a433_0x81bfc3(0xa9)]||(Object[a433_0x81bfc3(0x9d)]?function(_0x107b2f,_0x277b42){const _0x460144=a433_0x81bfc3;Object['defineProperty'](_0x107b2f,_0x460144(0x8b),{'enumerable':!![],'value':_0x277b42});}:function(_0x2118f9,_0x1b6d42){const _0x1e4b29=a433_0x81bfc3;_0x2118f9[_0x1e4b29(0x8b)]=_0x1b6d42;}),__importStar=this&&this[a433_0x81bfc3(0xa6)]||function(_0x168514){const _0x165906=a433_0x81bfc3;if(_0x168514&&_0x168514[_0x165906(0xa4)])return _0x168514;var _0x1870b0={};if(_0x168514!=null){for(var _0x58fe95 in _0x168514)if(_0x58fe95!=='default'&&Object['prototype']['hasOwnProperty'][_0x165906(0x8e)](_0x168514,_0x58fe95))__createBinding(_0x1870b0,_0x168514,_0x58fe95);}return __setModuleDefault(_0x1870b0,_0x168514),_0x1870b0;},__importDefault=this&&this['__importDefault']||function(_0x5a3ab8){const _0x55a37d=a433_0x81bfc3;return _0x5a3ab8&&_0x5a3ab8[_0x55a37d(0xa4)]?_0x5a3ab8:{'default':_0x5a3ab8};};function a433_0x50dc(_0x56d07a,_0xbc9dc4){const _0x389c78=a433_0x389c();return a433_0x50dc=function(_0x50dce6,_0x43121d){_0x50dce6=_0x50dce6-0x82;let _0x467fcb=_0x389c78[_0x50dce6];return _0x467fcb;},a433_0x50dc(_0x56d07a,_0xbc9dc4);}function a433_0x389c(){const _0x26ed10=['remoteJid','../../models/Contact','error','chmodSync','71802sCJQtM','default','replace','3588920kfhGyh','call','enabled','15DUYOmS','resolve','__createBinding','468077Kwisnk','writeFileSync','-contact','public','../../models/CompaniesSettings','get','arraybuffer','axios','70LbCCqP','555852fvktto','create','.jpeg','save','path','existsSync','nopicture','23811705iXeedQ','__esModule','Error\x20to\x20find\x20or\x20create\x20a\x20contact:','__importStar','name','getOwnPropertyDescriptor','__setModuleDefault','../../utils/logger','emit','contacts','mkdirSync','2478140yDIxpq','profilePicUrl','findOne','logger','reload','writable','data','company-','defineProperty','nopicture.png','whatsapp','47922lCYgMd'];a433_0x389c=function(){return _0x26ed10;};return a433_0x389c();}Object[a433_0x81bfc3(0x82)](exports,a433_0x81bfc3(0xa4),{'value':!![]});const socket_1=require('../../libs/socket'),CompaniesSettings_1=__importDefault(require(a433_0x81bfc3(0x97))),Contact_1=__importDefault(require(a433_0x81bfc3(0x87))),fs_1=__importDefault(require('fs')),path_1=__importStar(require(a433_0x81bfc3(0xa0))),logger_1=require(a433_0x81bfc3(0xaa)),axios=require(a433_0x81bfc3(0x9a)),CreateOrUpdateContactService=async({name:_0x451fe9,number:_0x2479d0,profilePicUrl:_0xa88fa9,isGroup:_0xa9d146,email:email='',channel:channel=a433_0x81bfc3(0x84),companyId:_0x260f2c,extraInfo:extraInfo=[],remoteJid:remoteJid=''})=>{const _0x5f4e8d=a433_0x81bfc3;try{const _0x4dfcb7=path_1['default'][_0x5f4e8d(0x91)](__dirname,'..','..','..',_0x5f4e8d(0x96)),_0x595ace=_0xa9d146?_0x2479d0:_0x2479d0[_0x5f4e8d(0x8c)](/[^0-9]/g,''),_0x5200fc=(0x0,socket_1['getIO'])();let _0x1ca29a;const _0x1640f9=_0x1ca29a?.[_0x5f4e8d(0xaf)]||''!==_0xa88fa9;_0x1ca29a=await Contact_1['default'][_0x5f4e8d(0xb0)]({'where':{'number':_0x595ace,'companyId':_0x260f2c}});if(_0x1ca29a)_0x1ca29a[_0x5f4e8d(0x86)]=remoteJid,_0x1ca29a['profilePicUrl']=_0xa88fa9||null,(_0xa9d146||_0x1ca29a[_0x5f4e8d(0xa7)]===_0x595ace)&&(_0x1ca29a[_0x5f4e8d(0xa7)]=_0x451fe9),_0x1ca29a[_0x5f4e8d(0x9f)](),_0x1ca29a[_0x5f4e8d(0xb2)](),_0x5200fc[_0x5f4e8d(0xab)]('company-'+_0x260f2c+_0x5f4e8d(0x95),{'action':'update','contact':_0x1ca29a});else{const _0x48009c=await CompaniesSettings_1[_0x5f4e8d(0x8b)][_0x5f4e8d(0xb0)]({'where':{'companyId':_0x260f2c}}),{acceptAudioMessageContact:_0x360a7d}=_0x48009c;_0x1ca29a=await Contact_1[_0x5f4e8d(0x8b)][_0x5f4e8d(0x9d)]({'name':_0x451fe9,'number':_0x595ace,'email':email,'isGroup':_0xa9d146,'extraInfo':extraInfo,'companyId':_0x260f2c,'channel':channel,'acceptAudioMessage':_0x360a7d===_0x5f4e8d(0x8f)?!![]:![],'remoteJid':remoteJid,'urlPicture':_0xa88fa9}),_0x5200fc[_0x5f4e8d(0xab)](_0x5f4e8d(0xb5)+_0x260f2c+_0x5f4e8d(0x95),{'action':'create','contact':_0x1ca29a});}const _0x386912=path_1[_0x5f4e8d(0x8b)][_0x5f4e8d(0x91)](_0x4dfcb7,'company'+_0x260f2c,_0x5f4e8d(0xac));!fs_1['default'][_0x5f4e8d(0xa1)](_0x386912)&&(fs_1[_0x5f4e8d(0x8b)][_0x5f4e8d(0xad)](_0x386912,{'recursive':!![]}),fs_1['default'][_0x5f4e8d(0x89)](_0x386912,0x1ff));if(_0x1640f9){let _0x1d1d22;if(_0xa88fa9['includes'](_0x5f4e8d(0xa2)))_0x1d1d22=_0x5f4e8d(0x83);else{const _0x1ff9e7=await axios[_0x5f4e8d(0x98)](_0xa88fa9,{'responseType':_0x5f4e8d(0x99)});_0x1d1d22=_0x1ca29a['id']+_0x5f4e8d(0x9e),fs_1['default'][_0x5f4e8d(0x94)]((0x0,path_1['join'])(_0x386912,_0x1d1d22),_0x1ff9e7[_0x5f4e8d(0xb4)]);}_0x1ca29a['update']({'urlPicture':_0x1d1d22,'pictureUpdated':!![]}),_0x5200fc[_0x5f4e8d(0xab)](_0x5f4e8d(0xb5)+_0x260f2c+_0x5f4e8d(0x95),{'action':'update','contact':_0x1ca29a});}return _0x1ca29a;}catch(_0x48c795){logger_1[_0x5f4e8d(0xb1)][_0x5f4e8d(0x88)](_0x5f4e8d(0xa5),_0x48c795);}};exports[a433_0x81bfc3(0x8b)]=CreateOrUpdateContactService;