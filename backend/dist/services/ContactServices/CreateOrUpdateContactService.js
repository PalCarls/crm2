'use strict';const a450_0x5a0d36=a450_0x33e0;(function(_0x75d912,_0x29deee){const _0x5e4552=a450_0x33e0,_0x2f63d2=_0x75d912();while(!![]){try{const _0x4b0496=-parseInt(_0x5e4552(0x1f3))/0x1*(parseInt(_0x5e4552(0x1cc))/0x2)+-parseInt(_0x5e4552(0x1dc))/0x3+-parseInt(_0x5e4552(0x1fa))/0x4*(parseInt(_0x5e4552(0x1f4))/0x5)+parseInt(_0x5e4552(0x1d8))/0x6+parseInt(_0x5e4552(0x1f5))/0x7*(parseInt(_0x5e4552(0x1ec))/0x8)+-parseInt(_0x5e4552(0x1cb))/0x9+parseInt(_0x5e4552(0x1e2))/0xa;if(_0x4b0496===_0x29deee)break;else _0x2f63d2['push'](_0x2f63d2['shift']());}catch(_0x38c42d){_0x2f63d2['push'](_0x2f63d2['shift']());}}}(a450_0x672c,0x640df));var __createBinding=this&&this[a450_0x5a0d36(0x1cd)]||(Object[a450_0x5a0d36(0x1d7)]?function(_0x218072,_0x48391b,_0x2a99ab,_0x2bcf4d){const _0x417a2a=a450_0x5a0d36;if(_0x2bcf4d===undefined)_0x2bcf4d=_0x2a99ab;var _0x3f75ba=Object[_0x417a2a(0x1e9)](_0x48391b,_0x2a99ab);(!_0x3f75ba||(_0x417a2a(0x1f6)in _0x3f75ba?!_0x48391b['__esModule']:_0x3f75ba[_0x417a2a(0x1db)]||_0x3f75ba['configurable']))&&(_0x3f75ba={'enumerable':!![],'get':function(){return _0x48391b[_0x2a99ab];}}),Object[_0x417a2a(0x1d5)](_0x218072,_0x2bcf4d,_0x3f75ba);}:function(_0x17e2c7,_0x36dae0,_0x221000,_0x5c2424){if(_0x5c2424===undefined)_0x5c2424=_0x221000;_0x17e2c7[_0x5c2424]=_0x36dae0[_0x221000];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a450_0x5a0d36(0x1d7)]?function(_0x16ec64,_0x23c447){const _0x4b6994=a450_0x5a0d36;Object[_0x4b6994(0x1d5)](_0x16ec64,_0x4b6994(0x1da),{'enumerable':!![],'value':_0x23c447});}:function(_0x5e3252,_0x83b3c){const _0x1b111c=a450_0x5a0d36;_0x5e3252[_0x1b111c(0x1da)]=_0x83b3c;}),__importStar=this&&this[a450_0x5a0d36(0x1ce)]||function(_0x498812){const _0x599936=a450_0x5a0d36;if(_0x498812&&_0x498812[_0x599936(0x1dd)])return _0x498812;var _0x39b4f6={};if(_0x498812!=null){for(var _0x58062b in _0x498812)if(_0x58062b!==_0x599936(0x1da)&&Object[_0x599936(0x1d0)][_0x599936(0x1fc)][_0x599936(0x1e6)](_0x498812,_0x58062b))__createBinding(_0x39b4f6,_0x498812,_0x58062b);}return __setModuleDefault(_0x39b4f6,_0x498812),_0x39b4f6;},__importDefault=this&&this['__importDefault']||function(_0x378b03){return _0x378b03&&_0x378b03['__esModule']?_0x378b03:{'default':_0x378b03};};function a450_0x672c(){const _0x585579=['__createBinding','__importStar','emit','prototype','data','update','remoteJid','profilePicUrl','defineProperty','reload','create','1705848zyXegv','existsSync','default','writable','1558698QfZHvl','__esModule','findOne','contacts','../../models/Contact','name','13718000HXwDlO','public','company-','enabled','call','-contact','../../utils/logger','getOwnPropertyDescriptor','getTime','resolve','343696PFNhDN','nopicture.png','includes','whatsapp','chmodSync','path','replace','39ftUREp','3095HdpQwF','35DZGBTu','get','unlinkSync','mkdirSync','../../models/CompaniesSettings','3104pqMQEN','join','hasOwnProperty','urlPicture','save','2028168sxYEJv','12094IgoNxc'];a450_0x672c=function(){return _0x585579;};return a450_0x672c();}function a450_0x33e0(_0x2d63cb,_0x262a97){const _0x672c02=a450_0x672c();return a450_0x33e0=function(_0x33e07d,_0x1dbf42){_0x33e07d=_0x33e07d-0x1ca;let _0x47e725=_0x672c02[_0x33e07d];return _0x47e725;},a450_0x33e0(_0x2d63cb,_0x262a97);}Object[a450_0x5a0d36(0x1d5)](exports,a450_0x5a0d36(0x1dd),{'value':!![]});const socket_1=require('../../libs/socket'),CompaniesSettings_1=__importDefault(require(a450_0x5a0d36(0x1f9))),Contact_1=__importDefault(require(a450_0x5a0d36(0x1e0))),fs_1=__importDefault(require('fs')),path_1=__importStar(require(a450_0x5a0d36(0x1f1))),logger_1=require(a450_0x5a0d36(0x1e8)),axios=require('axios'),CreateOrUpdateContactService=async({name:_0xfaa5e,number:_0x2782c4,profilePicUrl:_0x18d8a8,isGroup:_0x1b09e3,email:email='',channel:channel=a450_0x5a0d36(0x1ef),companyId:_0x2395e6,extraInfo:extraInfo=[],remoteJid:remoteJid=''})=>{const _0x1bee27=a450_0x5a0d36;try{const _0x119041=path_1[_0x1bee27(0x1da)][_0x1bee27(0x1eb)](__dirname,'..','..','..',_0x1bee27(0x1e3)),_0x5a7fe2=_0x1b09e3?_0x2782c4:_0x2782c4[_0x1bee27(0x1f2)](/[^0-9]/g,''),_0x109061=(0x0,socket_1['getIO'])();let _0x44708c;_0x44708c=await Contact_1[_0x1bee27(0x1da)][_0x1bee27(0x1de)]({'where':{'number':_0x5a7fe2,'companyId':_0x2395e6}});const _0x387e6c=_0x44708c?.[_0x1bee27(0x1d4)]!==_0x18d8a8;if(_0x44708c)_0x44708c[_0x1bee27(0x1d3)]=remoteJid,_0x44708c[_0x1bee27(0x1d4)]=_0x18d8a8||null,(_0x1b09e3||_0x44708c['name']===_0x5a7fe2)&&(_0x44708c[_0x1bee27(0x1e1)]=_0xfaa5e),_0x44708c[_0x1bee27(0x1ca)](),_0x44708c[_0x1bee27(0x1d6)]();else{const _0x20669f=await CompaniesSettings_1[_0x1bee27(0x1da)][_0x1bee27(0x1de)]({'where':{'companyId':_0x2395e6}}),{acceptAudioMessageContact:_0x2a3a68}=_0x20669f;_0x44708c=await Contact_1['default'][_0x1bee27(0x1d7)]({'name':_0xfaa5e,'number':_0x5a7fe2,'email':email,'isGroup':_0x1b09e3,'extraInfo':extraInfo,'companyId':_0x2395e6,'channel':channel,'acceptAudioMessage':_0x2a3a68===_0x1bee27(0x1e5)?!![]:![],'remoteJid':remoteJid,'urlPicture':_0x18d8a8}),_0x109061[_0x1bee27(0x1cf)](_0x1bee27(0x1e4)+_0x2395e6+_0x1bee27(0x1e7),{'action':_0x1bee27(0x1d7),'contact':_0x44708c});}const _0x45e442=path_1[_0x1bee27(0x1da)][_0x1bee27(0x1eb)](_0x119041,'company'+_0x2395e6,_0x1bee27(0x1df));!fs_1['default']['existsSync'](_0x45e442)&&(fs_1['default'][_0x1bee27(0x1f8)](_0x45e442,{'recursive':!![]}),fs_1[_0x1bee27(0x1da)][_0x1bee27(0x1f0)](_0x45e442,0x1ff));if(_0x387e6c){let _0x34e7cd;if(_0x18d8a8[_0x1bee27(0x1ee)]('nopicture'))_0x34e7cd=_0x1bee27(0x1ed);else{const _0x111c91=path_1[_0x1bee27(0x1da)][_0x1bee27(0x1eb)](_0x44708c[_0x1bee27(0x1fd)]);fs_1[_0x1bee27(0x1da)][_0x1bee27(0x1d9)](_0x111c91)&&fs_1['default'][_0x1bee27(0x1f7)](_0x111c91);const _0x125a02=await axios[_0x1bee27(0x1f6)](_0x18d8a8,{'responseType':'arraybuffer'});_0x34e7cd=''+_0x44708c['id']+new Date()[_0x1bee27(0x1ea)]()+'.jpeg',fs_1[_0x1bee27(0x1da)]['writeFileSync']((0x0,path_1[_0x1bee27(0x1fb)])(_0x45e442,_0x34e7cd),_0x125a02[_0x1bee27(0x1d1)]);}_0x44708c[_0x1bee27(0x1d2)]({'urlPicture':_0x34e7cd,'pictureUpdated':!![]});}return _0x109061[_0x1bee27(0x1cf)](_0x1bee27(0x1e4)+_0x2395e6+_0x1bee27(0x1e7),{'action':_0x1bee27(0x1d2),'contact':_0x44708c}),_0x44708c;}catch(_0x5906fa){logger_1['logger']['error']('Error\x20to\x20find\x20or\x20create\x20a\x20contact:',_0x5906fa);}};exports['default']=CreateOrUpdateContactService;