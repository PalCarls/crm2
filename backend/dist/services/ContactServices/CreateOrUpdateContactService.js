'use strict';function a428_0x2ffc(){const _0x13f970=['__importStar','data','1629477FaIHyH','prototype','resolve','findOne','getIO','174594VnBdjm','352539wraKHv','contacts','get','join','-contact','8IMdNpu','existsSync','enabled','save','remoteJid','6ubahuk','writable','configurable','replace','nopicture.png','default','30Hmztqj','public','.jpeg','name','../../libs/socket','profilePicUrl','reload','37871iHWZVm','call','hasOwnProperty','axios','emit','__esModule','3ckihTA','defineProperty','191116TzbXfq','update','mkdirSync','company-','865515Yomyia','206902HeosPa','__createBinding','create'];a428_0x2ffc=function(){return _0x13f970;};return a428_0x2ffc();}const a428_0xbd44cd=a428_0x59dc;function a428_0x59dc(_0x47f741,_0x20512f){const _0x2ffce2=a428_0x2ffc();return a428_0x59dc=function(_0x59dc1a,_0x2fc72d){_0x59dc1a=_0x59dc1a-0xf1;let _0x2e507c=_0x2ffce2[_0x59dc1a];return _0x2e507c;},a428_0x59dc(_0x47f741,_0x20512f);}(function(_0x35b324,_0x3f6743){const _0x73d193=a428_0x59dc,_0x3522b1=_0x35b324();while(!![]){try{const _0x475f5b=parseInt(_0x73d193(0xf6))/0x1+parseInt(_0x73d193(0x103))/0x2+parseInt(_0x73d193(0xfc))/0x3*(parseInt(_0x73d193(0xfe))/0x4)+parseInt(_0x73d193(0x102))/0x5+-parseInt(_0x73d193(0x118))/0x6*(-parseInt(_0x73d193(0x10d))/0x7)+parseInt(_0x73d193(0x113))/0x8*(-parseInt(_0x73d193(0x108))/0x9)+parseInt(_0x73d193(0x11e))/0xa*(-parseInt(_0x73d193(0x10e))/0xb);if(_0x475f5b===_0x3f6743)break;else _0x3522b1['push'](_0x3522b1['shift']());}catch(_0x47bfa4){_0x3522b1['push'](_0x3522b1['shift']());}}}(a428_0x2ffc,0x1ad7a));var __createBinding=this&&this[a428_0xbd44cd(0x104)]||(Object['create']?function(_0x18b0c1,_0x1183c4,_0x503ec4,_0x2f4ab3){const _0x52412d=a428_0xbd44cd;if(_0x2f4ab3===undefined)_0x2f4ab3=_0x503ec4;var _0x3b3e3d=Object['getOwnPropertyDescriptor'](_0x1183c4,_0x503ec4);(!_0x3b3e3d||('get'in _0x3b3e3d?!_0x1183c4[_0x52412d(0xfb)]:_0x3b3e3d[_0x52412d(0x119)]||_0x3b3e3d[_0x52412d(0x11a)]))&&(_0x3b3e3d={'enumerable':!![],'get':function(){return _0x1183c4[_0x503ec4];}}),Object['defineProperty'](_0x18b0c1,_0x2f4ab3,_0x3b3e3d);}:function(_0x129155,_0x1dfde7,_0x592f1a,_0x5bbadf){if(_0x5bbadf===undefined)_0x5bbadf=_0x592f1a;_0x129155[_0x5bbadf]=_0x1dfde7[_0x592f1a];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a428_0xbd44cd(0x105)]?function(_0x2b88c2,_0x5dd39f){Object['defineProperty'](_0x2b88c2,'default',{'enumerable':!![],'value':_0x5dd39f});}:function(_0x46e8e5,_0x532197){const _0x1072be=a428_0xbd44cd;_0x46e8e5[_0x1072be(0x11d)]=_0x532197;}),__importStar=this&&this[a428_0xbd44cd(0x106)]||function(_0x5306d2){const _0x2fd2de=a428_0xbd44cd;if(_0x5306d2&&_0x5306d2[_0x2fd2de(0xfb)])return _0x5306d2;var _0x5092cf={};if(_0x5306d2!=null){for(var _0x1d4151 in _0x5306d2)if(_0x1d4151!==_0x2fd2de(0x11d)&&Object[_0x2fd2de(0x109)][_0x2fd2de(0xf8)][_0x2fd2de(0xf7)](_0x5306d2,_0x1d4151))__createBinding(_0x5092cf,_0x5306d2,_0x1d4151);}return __setModuleDefault(_0x5092cf,_0x5306d2),_0x5092cf;},__importDefault=this&&this['__importDefault']||function(_0x3b6d16){return _0x3b6d16&&_0x3b6d16['__esModule']?_0x3b6d16:{'default':_0x3b6d16};};Object[a428_0xbd44cd(0xfd)](exports,a428_0xbd44cd(0xfb),{'value':!![]});const socket_1=require(a428_0xbd44cd(0xf3)),CompaniesSettings_1=__importDefault(require('../../models/CompaniesSettings')),Contact_1=__importDefault(require('../../models/Contact')),fs_1=__importDefault(require('fs')),path_1=__importStar(require('path')),axios=require(a428_0xbd44cd(0xf9)),CreateOrUpdateContactService=async({name:_0x406580,number:_0x3638e5,profilePicUrl:_0x3a250f,isGroup:_0x4ea3a6,email:email='',channel:channel='whatsapp',companyId:_0x4a4fd5,extraInfo:extraInfo=[],remoteJid:remoteJid=''})=>{const _0x1a8d60=a428_0xbd44cd,_0x4468a8=path_1[_0x1a8d60(0x11d)][_0x1a8d60(0x10a)](__dirname,'..','..','..',_0x1a8d60(0x11f)),_0x3d9b30=_0x4ea3a6?_0x3638e5:_0x3638e5[_0x1a8d60(0x11b)](/[^0-9]/g,''),_0x137609=(0x0,socket_1[_0x1a8d60(0x10c)])();let _0x3553ca;const _0x28421b=_0x3553ca?.[_0x1a8d60(0xf4)]||''!==_0x3a250f;_0x3553ca=await Contact_1[_0x1a8d60(0x11d)][_0x1a8d60(0x10b)]({'where':{'number':_0x3d9b30,'companyId':_0x4a4fd5}});if(_0x3553ca)_0x3553ca[_0x1a8d60(0x117)]=remoteJid,_0x3553ca[_0x1a8d60(0xf4)]=_0x3a250f,(_0x4ea3a6||_0x3553ca[_0x1a8d60(0xf2)]===_0x3d9b30)&&(_0x3553ca[_0x1a8d60(0xf2)]=_0x406580),_0x3553ca[_0x1a8d60(0x116)](),_0x3553ca[_0x1a8d60(0xf5)](),_0x137609[_0x1a8d60(0xfa)](_0x1a8d60(0x101)+_0x4a4fd5+_0x1a8d60(0x112),{'action':_0x1a8d60(0xff),'contact':_0x3553ca});else{const _0x138e92=await CompaniesSettings_1['default'][_0x1a8d60(0x10b)]({'where':{'companyId':_0x4a4fd5}}),{acceptAudioMessageContact:_0x4f06ff}=_0x138e92;_0x3553ca=await Contact_1['default']['create']({'name':_0x406580,'number':_0x3d9b30,'email':email,'isGroup':_0x4ea3a6,'extraInfo':extraInfo,'companyId':_0x4a4fd5,'channel':channel,'acceptAudioMessage':_0x4f06ff===_0x1a8d60(0x115)?!![]:![],'remoteJid':remoteJid,'urlPicture':_0x3a250f}),_0x137609[_0x1a8d60(0xfa)](_0x1a8d60(0x101)+_0x4a4fd5+_0x1a8d60(0x112),{'action':_0x1a8d60(0x105),'contact':_0x3553ca});}const _0x39f4c7=path_1[_0x1a8d60(0x11d)]['resolve'](_0x4468a8,'company'+_0x4a4fd5,_0x1a8d60(0x10f));!fs_1[_0x1a8d60(0x11d)][_0x1a8d60(0x114)](_0x39f4c7)&&(fs_1[_0x1a8d60(0x11d)][_0x1a8d60(0x100)](_0x39f4c7,{'recursive':!![]}),fs_1[_0x1a8d60(0x11d)]['chmodSync'](_0x39f4c7,0x1ff));if(_0x28421b){let _0x143251;if(_0x3a250f['includes']('nopicture'))_0x143251=_0x1a8d60(0x11c);else{const _0x3978f1=await axios[_0x1a8d60(0x110)](_0x3a250f,{'responseType':'arraybuffer'});_0x143251=_0x3553ca['id']+_0x1a8d60(0xf1),fs_1[_0x1a8d60(0x11d)]['writeFileSync']((0x0,path_1[_0x1a8d60(0x111)])(_0x39f4c7,_0x143251),_0x3978f1[_0x1a8d60(0x107)]);}_0x3553ca[_0x1a8d60(0xff)]({'urlPicture':_0x143251,'pictureUpdated':!![]}),_0x137609[_0x1a8d60(0xfa)](_0x1a8d60(0x101)+_0x4a4fd5+_0x1a8d60(0x112),{'action':_0x1a8d60(0xff),'contact':_0x3553ca});}return _0x3553ca;};exports['default']=CreateOrUpdateContactService;