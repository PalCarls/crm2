'use strict';const a419_0x4764bf=a419_0x27bd;(function(_0x5f075d,_0x19337c){const _0x1480f8=a419_0x27bd,_0x4b6293=_0x5f075d();while(!![]){try{const _0x16f305=-parseInt(_0x1480f8(0xe7))/0x1+-parseInt(_0x1480f8(0xee))/0x2*(-parseInt(_0x1480f8(0xf7))/0x3)+-parseInt(_0x1480f8(0xdb))/0x4+-parseInt(_0x1480f8(0xe0))/0x5+parseInt(_0x1480f8(0xf8))/0x6*(-parseInt(_0x1480f8(0xfa))/0x7)+parseInt(_0x1480f8(0xd9))/0x8+-parseInt(_0x1480f8(0xed))/0x9*(-parseInt(_0x1480f8(0xd7))/0xa);if(_0x16f305===_0x19337c)break;else _0x4b6293['push'](_0x4b6293['shift']());}catch(_0x178c00){_0x4b6293['push'](_0x4b6293['shift']());}}}(a419_0x2a60,0x81d10));function a419_0x2a60(){const _0x5e2871=['6840jwSifl','../../models/FilesOptions','5001232hoPCZT','length','4237752Zdjbka','configurable','default','map','hasOwnProperty','709515CbAkRI','validate','get','upsert','message','test','findOrCreate','291018xHfXui','__esModule','__importDefault','string','defineProperty','name','14175sxmvbo','8diZMRw','ERR_FILE_NAME_ALREADY_EXISTS','Check-unique-name','required','__setModuleDefault','create','object','min','reload','417270XqvHUn','6pImXdA','options','1643089IFJuti','../../models/Files','../../errors/AppError'];a419_0x2a60=function(){return _0x5e2871;};return a419_0x2a60();}var __createBinding=this&&this['__createBinding']||(Object[a419_0x4764bf(0xf3)]?function(_0xae8d73,_0x38e90a,_0x19ee71,_0x1c4107){const _0x37c040=a419_0x4764bf;if(_0x1c4107===undefined)_0x1c4107=_0x19ee71;var _0x5bcb76=Object['getOwnPropertyDescriptor'](_0x38e90a,_0x19ee71);(!_0x5bcb76||(_0x37c040(0xe2)in _0x5bcb76?!_0x38e90a[_0x37c040(0xe8)]:_0x5bcb76['writable']||_0x5bcb76[_0x37c040(0xdc)]))&&(_0x5bcb76={'enumerable':!![],'get':function(){return _0x38e90a[_0x19ee71];}}),Object[_0x37c040(0xeb)](_0xae8d73,_0x1c4107,_0x5bcb76);}:function(_0x165823,_0x4a3bf4,_0xbd6b60,_0x2e3861){if(_0x2e3861===undefined)_0x2e3861=_0xbd6b60;_0x165823[_0x2e3861]=_0x4a3bf4[_0xbd6b60];}),__setModuleDefault=this&&this[a419_0x4764bf(0xf2)]||(Object['create']?function(_0x3fd565,_0x13e2f0){const _0x1400ae=a419_0x4764bf;Object['defineProperty'](_0x3fd565,_0x1400ae(0xdd),{'enumerable':!![],'value':_0x13e2f0});}:function(_0x48233f,_0x1c1111){const _0x14a4df=a419_0x4764bf;_0x48233f[_0x14a4df(0xdd)]=_0x1c1111;}),__importStar=this&&this['__importStar']||function(_0x4b7523){const _0x2cd08b=a419_0x4764bf;if(_0x4b7523&&_0x4b7523[_0x2cd08b(0xe8)])return _0x4b7523;var _0x3dd1bb={};if(_0x4b7523!=null){for(var _0x1b68f7 in _0x4b7523)if(_0x1b68f7!==_0x2cd08b(0xdd)&&Object['prototype'][_0x2cd08b(0xdf)]['call'](_0x4b7523,_0x1b68f7))__createBinding(_0x3dd1bb,_0x4b7523,_0x1b68f7);}return __setModuleDefault(_0x3dd1bb,_0x4b7523),_0x3dd1bb;},__importDefault=this&&this[a419_0x4764bf(0xe9)]||function(_0x34cb39){const _0x5a8d51=a419_0x4764bf;return _0x34cb39&&_0x34cb39[_0x5a8d51(0xe8)]?_0x34cb39:{'default':_0x34cb39};};Object[a419_0x4764bf(0xeb)](exports,'__esModule',{'value':!![]});const Yup=__importStar(require('yup')),AppError_1=__importDefault(require(a419_0x4764bf(0xd6))),Files_1=__importDefault(require(a419_0x4764bf(0xd5))),FilesOptions_1=__importDefault(require(a419_0x4764bf(0xd8))),CreateService=async({name:_0x45a6eb,message:_0x4fb04d,companyId:_0x197a8f,options:_0x5f087d})=>{const _0xf3969b=a419_0x4764bf,_0x399965=Yup[_0xf3969b(0xf4)]()['shape']({'name':Yup[_0xf3969b(0xea)]()[_0xf3969b(0xf1)]()[_0xf3969b(0xf5)](0x3)[_0xf3969b(0xe5)](_0xf3969b(0xf0),_0xf3969b(0xef),async _0xeca087=>{const _0x1ba1d4=_0xf3969b;if(_0xeca087){const _0x367a1d=await Files_1[_0x1ba1d4(0xdd)]['findOne']({'where':{'name':_0xeca087}});return!_0x367a1d;}return![];})});try{await _0x399965[_0xf3969b(0xe1)]({'name':_0x45a6eb});}catch(_0x327fd3){throw new AppError_1[(_0xf3969b(0xdd))](_0x327fd3[_0xf3969b(0xe4)]);}const [_0x1ffc43]=await Files_1['default'][_0xf3969b(0xe6)]({'where':{'name':_0x45a6eb,'message':_0x4fb04d},'defaults':{'name':_0x45a6eb,'companyId':_0x197a8f,'message':_0x4fb04d}});return _0x5f087d&&_0x5f087d[_0xf3969b(0xda)]>0x0&&await Promise['all'](_0x5f087d[_0xf3969b(0xde)](async _0x33e87a=>{const _0x599003=_0xf3969b;await FilesOptions_1[_0x599003(0xdd)][_0x599003(0xe3)]({..._0x33e87a,'fileId':_0x1ffc43['id']});})),await _0x1ffc43[_0xf3969b(0xf6)]({'attributes':['id',_0xf3969b(0xec),_0xf3969b(0xe4),'companyId'],'include':[_0xf3969b(0xf9),{'model':FilesOptions_1[_0xf3969b(0xdd)],'as':_0xf3969b(0xf9),'attributes':['id','name','path']}]}),_0x1ffc43;};function a419_0x27bd(_0x3367b8,_0x4662b0){const _0x2a609d=a419_0x2a60();return a419_0x27bd=function(_0x27bd39,_0x4ccb21){_0x27bd39=_0x27bd39-0xd5;let _0x431254=_0x2a609d[_0x27bd39];return _0x431254;},a419_0x27bd(_0x3367b8,_0x4662b0);}exports['default']=CreateService;