'use strict';const a305_0x35bd05=a305_0x2d93;(function(_0x164155,_0x1f3cbd){const _0x5590ab=a305_0x2d93,_0x1ff4e7=_0x164155();while(!![]){try{const _0x5da949=-parseInt(_0x5590ab(0x186))/0x1+-parseInt(_0x5590ab(0x1e8))/0x2*(-parseInt(_0x5590ab(0x1c4))/0x3)+parseInt(_0x5590ab(0x1cd))/0x4*(-parseInt(_0x5590ab(0x266))/0x5)+-parseInt(_0x5590ab(0x225))/0x6+parseInt(_0x5590ab(0x18e))/0x7+-parseInt(_0x5590ab(0x21d))/0x8+-parseInt(_0x5590ab(0x25c))/0x9*(-parseInt(_0x5590ab(0x199))/0xa);if(_0x5da949===_0x1f3cbd)break;else _0x1ff4e7['push'](_0x1ff4e7['shift']());}catch(_0x33b050){_0x1ff4e7['push'](_0x1ff4e7['shift']());}}}(a305_0x37d2,0x91d1e));var __createBinding=this&&this[a305_0x35bd05(0x1f7)]||(Object[a305_0x35bd05(0x20b)]?function(_0x436484,_0xccd28e,_0x4d28dc,_0x328ca2){const _0x866725=a305_0x35bd05;if(_0x328ca2===undefined)_0x328ca2=_0x4d28dc;var _0xc082e0=Object[_0x866725(0x179)](_0xccd28e,_0x4d28dc);(!_0xc082e0||(_0x866725(0x239)in _0xc082e0?!_0xccd28e[_0x866725(0x220)]:_0xc082e0[_0x866725(0x1e6)]||_0xc082e0[_0x866725(0x1e4)]))&&(_0xc082e0={'enumerable':!![],'get':function(){return _0xccd28e[_0x4d28dc];}}),Object[_0x866725(0x1d7)](_0x436484,_0x328ca2,_0xc082e0);}:function(_0x3113da,_0x5e8776,_0x390888,_0x1dee8b){if(_0x1dee8b===undefined)_0x1dee8b=_0x390888;_0x3113da[_0x1dee8b]=_0x5e8776[_0x390888];}),__setModuleDefault=this&&this[a305_0x35bd05(0x1ea)]||(Object['create']?function(_0x1fb569,_0x3a07e1){const _0x722518=a305_0x35bd05;Object['defineProperty'](_0x1fb569,_0x722518(0x1f1),{'enumerable':!![],'value':_0x3a07e1});}:function(_0x555e4c,_0x550337){const _0x3b5ccd=a305_0x35bd05;_0x555e4c[_0x3b5ccd(0x1f1)]=_0x550337;}),__importStar=this&&this['__importStar']||function(_0x55b59a){const _0x4e26a7=a305_0x35bd05;if(_0x55b59a&&_0x55b59a[_0x4e26a7(0x220)])return _0x55b59a;var _0x1671bf={};if(_0x55b59a!=null){for(var _0x2937bb in _0x55b59a)if(_0x2937bb!==_0x4e26a7(0x1f1)&&Object[_0x4e26a7(0x212)][_0x4e26a7(0x187)][_0x4e26a7(0x24d)](_0x55b59a,_0x2937bb))__createBinding(_0x1671bf,_0x55b59a,_0x2937bb);}return __setModuleDefault(_0x1671bf,_0x55b59a),_0x1671bf;},__importDefault=this&&this[a305_0x35bd05(0x20f)]||function(_0x4483c0){const _0x20c084=a305_0x35bd05;return _0x4483c0&&_0x4483c0[_0x20c084(0x220)]?_0x4483c0:{'default':_0x4483c0};};Object[a305_0x35bd05(0x1d7)](exports,a305_0x35bd05(0x220),{'value':!![]}),exports[a305_0x35bd05(0x1a7)]=exports[a305_0x35bd05(0x1fa)]=exports[a305_0x35bd05(0x1d5)]=exports[a305_0x35bd05(0x181)]=exports[a305_0x35bd05(0x230)]=exports[a305_0x35bd05(0x183)]=exports[a305_0x35bd05(0x19e)]=exports[a305_0x35bd05(0x18b)]=exports['userMonitor']=void 0x0;const Sentry=__importStar(require(a305_0x35bd05(0x240))),bull_1=__importDefault(require(a305_0x35bd05(0x1f9))),SendMessage_1=require(a305_0x35bd05(0x1e3)),Whatsapp_1=__importDefault(require(a305_0x35bd05(0x19a))),logger_1=require('./utils/logger'),moment_1=__importDefault(require(a305_0x35bd05(0x262))),Schedule_1=__importDefault(require('./models/Schedule')),sequelize_1=require(a305_0x35bd05(0x25a)),GetDefaultWhatsApp_1=__importDefault(require(a305_0x35bd05(0x211))),Campaign_1=__importDefault(require(a305_0x35bd05(0x21c))),Queue_1=__importDefault(require(a305_0x35bd05(0x18d))),ContactList_1=__importDefault(require(a305_0x35bd05(0x229))),ContactListItem_1=__importDefault(require('./models/ContactListItem')),lodash_1=require(a305_0x35bd05(0x256)),CampaignSetting_1=__importDefault(require(a305_0x35bd05(0x1a3))),CampaignShipping_1=__importDefault(require(a305_0x35bd05(0x21b))),GetWhatsappWbot_1=__importDefault(require(a305_0x35bd05(0x235))),database_1=__importDefault(require(a305_0x35bd05(0x22b))),SendWhatsAppMedia_1=require(a305_0x35bd05(0x1d8)),socket_1=require('./libs/socket'),path_1=__importDefault(require(a305_0x35bd05(0x26f))),User_1=__importDefault(require(a305_0x35bd05(0x1b6))),Company_1=__importDefault(require(a305_0x35bd05(0x1dc))),Contact_1=__importDefault(require(a305_0x35bd05(0x215))),Queue_2=__importDefault(require(a305_0x35bd05(0x18d))),wbotClosedTickets_1=require(a305_0x35bd05(0x1b9)),Ticket_1=__importDefault(require(a305_0x35bd05(0x22d))),ShowContactService_1=__importDefault(require('./services/ContactServices/ShowContactService')),UserQueue_1=__importDefault(require(a305_0x35bd05(0x234))),ShowTicketService_1=__importDefault(require(a305_0x35bd05(0x214))),SendWhatsAppMessage_1=__importDefault(require(a305_0x35bd05(0x22c))),UpdateTicketService_1=__importDefault(require(a305_0x35bd05(0x206))),date_fns_1=require(a305_0x35bd05(0x23f)),nodemailer=require(a305_0x35bd05(0x24e)),CronJob=require(a305_0x35bd05(0x196))[a305_0x35bd05(0x17e)],connection=process[a305_0x35bd05(0x1d6)]['REDIS_URI']||'',limiterMax=process['env'][a305_0x35bd05(0x246)]||0x1,limiterDuration=process[a305_0x35bd05(0x1d6)][a305_0x35bd05(0x1cb)]||0xbb8;exports[a305_0x35bd05(0x1fe)]=new bull_1[(a305_0x35bd05(0x1f1))](a305_0x35bd05(0x216),connection),exports[a305_0x35bd05(0x18b)]=new bull_1['default'](a305_0x35bd05(0x254),connection),exports['sendScheduledMessages']=new bull_1[(a305_0x35bd05(0x1f1))](a305_0x35bd05(0x25f),connection),exports[a305_0x35bd05(0x183)]=new bull_1[(a305_0x35bd05(0x1f1))](a305_0x35bd05(0x21f),connection),exports[a305_0x35bd05(0x230)]=new bull_1[(a305_0x35bd05(0x1f1))](a305_0x35bd05(0x251),connection),exports[a305_0x35bd05(0x181)]=new bull_1[(a305_0x35bd05(0x1f1))](a305_0x35bd05(0x1c5),connection,{'limiter':{'max':limiterMax,'duration':limiterDuration}});async function handleSendMessage(_0x13dafc){const _0x4749da=a305_0x35bd05;try{const {data:_0x1d9128}=_0x13dafc,_0x51b0f8=await Whatsapp_1['default']['findByPk'](_0x1d9128[_0x4749da(0x182)]);if(_0x51b0f8===null)throw Error(_0x4749da(0x184));const _0x1790d0=_0x1d9128[_0x4749da(0x265)];await(0x0,SendMessage_1[_0x4749da(0x1df)])(_0x51b0f8,_0x1790d0);}catch(_0x5a12e7){Sentry[_0x4749da(0x204)](_0x5a12e7),logger_1[_0x4749da(0x24b)]['error'](_0x4749da(0x1f3),_0x5a12e7[_0x4749da(0x176)]);throw _0x5a12e7;}}async function handleVerifySchedules(_0x2f8b27){const _0x54b752=a305_0x35bd05;try{const {count:_0x963060,rows:_0x10796f}=await Schedule_1[_0x54b752(0x1f1)][_0x54b752(0x258)]({'where':{'status':_0x54b752(0x191),'sentAt':null,'sendAt':{[sequelize_1['Op'][_0x54b752(0x21a)]]:(0x0,moment_1[_0x54b752(0x1f1)])()['format'](_0x54b752(0x249)),[sequelize_1['Op']['lte']]:(0x0,moment_1['default'])()['add']('30',_0x54b752(0x23b))['format']('YYYY-MM-DD\x20HH:mm:ss')}},'include':[{'model':Contact_1['default'],'as':'contact'}]});_0x963060>0x0&&_0x10796f[_0x54b752(0x19d)](async _0x2e2049=>{const _0x2dd5cd=_0x54b752;await _0x2e2049[_0x2dd5cd(0x267)]({'status':'AGENDADA'}),exports[_0x2dd5cd(0x19e)][_0x2dd5cd(0x1b1)](_0x2dd5cd(0x1df),{'schedule':_0x2e2049},{'delay':0x9c40}),logger_1[_0x2dd5cd(0x24b)]['info'](_0x2dd5cd(0x207)+_0x2e2049['contact'][_0x2dd5cd(0x218)]);});}catch(_0x5a1fd6){Sentry[_0x54b752(0x204)](_0x5a1fd6),logger_1['logger'][_0x54b752(0x192)](_0x54b752(0x26d),_0x5a1fd6[_0x54b752(0x176)]);throw _0x5a1fd6;}}async function handleSendScheduledMessage(_0x43f5a6){const _0x140242=a305_0x35bd05,{data:{schedule:_0x1cf0f0}}=_0x43f5a6;let _0x225c49=null;try{_0x225c49=await Schedule_1[_0x140242(0x1f1)][_0x140242(0x1a2)](_0x1cf0f0['id']);}catch(_0x144997){Sentry[_0x140242(0x204)](_0x144997),logger_1['logger'][_0x140242(0x1c2)](_0x140242(0x1a5)+_0x1cf0f0['id']);}try{const _0x222cda=await(0x0,GetDefaultWhatsApp_1[_0x140242(0x1f1)])(_0x1cf0f0[_0x140242(0x261)]);await(0x0,SendMessage_1[_0x140242(0x1df)])(_0x222cda,{'number':_0x1cf0f0[_0x140242(0x1b0)][_0x140242(0x19f)],'body':_0x1cf0f0[_0x140242(0x188)]}),await _0x225c49?.[_0x140242(0x267)]({'sentAt':(0x0,moment_1[_0x140242(0x1f1)])()['format']('YYYY-MM-DD\x20HH:mm'),'status':_0x140242(0x255)}),logger_1[_0x140242(0x24b)][_0x140242(0x1c2)](_0x140242(0x23a)+_0x1cf0f0[_0x140242(0x1b0)][_0x140242(0x218)]),exports['sendScheduledMessages'][_0x140242(0x202)](0x3a98,_0x140242(0x264));}catch(_0x343bf9){Sentry['captureException'](_0x343bf9),await _0x225c49?.[_0x140242(0x267)]({'status':_0x140242(0x1e9)}),logger_1[_0x140242(0x24b)][_0x140242(0x192)]('SendScheduledMessage\x20->\x20SendMessage:\x20error',_0x343bf9[_0x140242(0x176)]);throw _0x343bf9;}}async function handleVerifyCampaigns(_0x1e7732){const _0x147dd6=a305_0x35bd05,_0x195f12=await database_1['default'][_0x147dd6(0x1c9)](_0x147dd6(0x224),{'type':sequelize_1['QueryTypes']['SELECT']});logger_1['logger']['info']('Campanhas\x20encontradas:\x20'+_0x195f12[_0x147dd6(0x217)]);for(let _0x174c64 of _0x195f12){try{const _0xab4ae9=(0x0,moment_1[_0x147dd6(0x1f1)])(),_0xa4f090=(0x0,moment_1[_0x147dd6(0x1f1)])(_0x174c64[_0x147dd6(0x263)]),_0x3e05fb=_0xa4f090[_0x147dd6(0x1ac)](_0xab4ae9,_0x147dd6(0x1d3));logger_1['logger'][_0x147dd6(0x1c2)](_0x147dd6(0x1c1)+_0x174c64['id']+',\x20Delay\x20Inicial='+_0x3e05fb),exports[_0x147dd6(0x183)][_0x147dd6(0x1b1)](_0x147dd6(0x17c),{'id':_0x174c64['id'],'delay':_0x3e05fb},{'priority':0x3,'removeOnComplete':{'age':0x3c*0x3c,'count':0xa},'removeOnFail':{'age':0x3c*0x3c,'count':0xa}});}catch(_0x33bc5f){Sentry['captureException'](_0x33bc5f);}}}async function getCampaign(_0x355c34){const _0x811c53=a305_0x35bd05;return await Campaign_1['default']['findOne']({'where':{'id':_0x355c34},'include':[{'model':ContactList_1[_0x811c53(0x1f1)],'as':'contactList','attributes':['id',_0x811c53(0x218)],'include':[{'model':ContactListItem_1[_0x811c53(0x1f1)],'as':_0x811c53(0x24a),'attributes':['id',_0x811c53(0x218),_0x811c53(0x19f),_0x811c53(0x1fb),_0x811c53(0x1bf)],'where':{'isWhatsappValid':!![]}}]},{'model':Whatsapp_1['default'],'as':_0x811c53(0x25d),'attributes':['id',_0x811c53(0x218)]}]});}async function getContact(_0x5f43e5){const _0x3de635=a305_0x35bd05;return await ContactListItem_1[_0x3de635(0x1f1)][_0x3de635(0x1a2)](_0x5f43e5,{'attributes':['id',_0x3de635(0x218),_0x3de635(0x19f),_0x3de635(0x1fb)]});}async function getSettings(_0xdff027){const _0x48ee4e=a305_0x35bd05;try{const _0xa42358=await CampaignSetting_1['default'][_0x48ee4e(0x243)]({'where':{'companyId':_0xdff027[_0x48ee4e(0x261)]},'attributes':['key',_0x48ee4e(0x1c8)]}),_0x200447=_0xa42358[_0x48ee4e(0x1bd)]((_0x47cc21,_0x52dc5a)=>{const _0x3c82a7=_0x48ee4e;return _0x47cc21[_0x52dc5a[_0x3c82a7(0x203)]]=JSON['parse'](_0x52dc5a[_0x3c82a7(0x1c8)]),_0x47cc21;},{}),{messageInterval:messageInterval=0x14,longerIntervalAfter:longerIntervalAfter=0x14,greaterInterval:greaterInterval=0x3c,variables:variables=[]}=_0x200447;return{'messageInterval':messageInterval,'longerIntervalAfter':longerIntervalAfter,'greaterInterval':greaterInterval,'variables':variables};}catch(_0x1a393a){console[_0x48ee4e(0x1c0)](_0x1a393a);throw _0x1a393a;}}function parseToMilliseconds(_0x3f5945){return _0x3f5945*0x3e8;}exports[a305_0x35bd05(0x1d5)]=parseToMilliseconds;async function sleep(_0xbfeb11){const _0x227af1=a305_0x35bd05;return logger_1[_0x227af1(0x24b)][_0x227af1(0x1c2)](_0x227af1(0x269)+_0xbfeb11+_0x227af1(0x1cf)+(0x0,moment_1['default'])()[_0x227af1(0x233)](_0x227af1(0x1ee))),new Promise(_0x17ae10=>{setTimeout(()=>{const _0xd8f567=a305_0x2d93;logger_1[_0xd8f567(0x24b)][_0xd8f567(0x1c2)]('Sleep\x20de\x20'+_0xbfeb11+_0xd8f567(0x219)+(0x0,moment_1[_0xd8f567(0x1f1)])()[_0xd8f567(0x233)](_0xd8f567(0x1ee))),_0x17ae10(!![]);},parseToMilliseconds(_0xbfeb11));});}function a305_0x2d93(_0xeb4b56,_0x5baf1c){const _0x37d2f3=a305_0x37d2();return a305_0x2d93=function(_0x2d935d,_0x2386f9){_0x2d935d=_0x2d935d-0x176;let _0x2fb7e7=_0x37d2f3[_0x2d935d];return _0x2fb7e7;},a305_0x2d93(_0xeb4b56,_0x5baf1c);}function getCampaignValidMessages(_0x50b733){const _0x18436d=a305_0x35bd05,_0x4bade6=[];return!(0x0,lodash_1[_0x18436d(0x194)])(_0x50b733[_0x18436d(0x274)])&&!(0x0,lodash_1[_0x18436d(0x257)])(_0x50b733[_0x18436d(0x274)])&&_0x4bade6[_0x18436d(0x271)](_0x50b733[_0x18436d(0x274)]),!(0x0,lodash_1['isEmpty'])(_0x50b733[_0x18436d(0x17a)])&&!(0x0,lodash_1[_0x18436d(0x257)])(_0x50b733[_0x18436d(0x17a)])&&_0x4bade6[_0x18436d(0x271)](_0x50b733[_0x18436d(0x17a)]),!(0x0,lodash_1[_0x18436d(0x194)])(_0x50b733['message3'])&&!(0x0,lodash_1['isNil'])(_0x50b733['message3'])&&_0x4bade6['push'](_0x50b733[_0x18436d(0x1b2)]),!(0x0,lodash_1['isEmpty'])(_0x50b733[_0x18436d(0x1f8)])&&!(0x0,lodash_1[_0x18436d(0x257)])(_0x50b733[_0x18436d(0x1f8)])&&_0x4bade6[_0x18436d(0x271)](_0x50b733[_0x18436d(0x1f8)]),!(0x0,lodash_1['isEmpty'])(_0x50b733[_0x18436d(0x1be)])&&!(0x0,lodash_1[_0x18436d(0x257)])(_0x50b733[_0x18436d(0x1be)])&&_0x4bade6[_0x18436d(0x271)](_0x50b733[_0x18436d(0x1be)]),_0x4bade6;}function getCampaignValidConfirmationMessages(_0x53b9ae){const _0x45fa06=a305_0x35bd05,_0x2fc329=[];return!(0x0,lodash_1[_0x45fa06(0x194)])(_0x53b9ae['confirmationMessage1'])&&!(0x0,lodash_1[_0x45fa06(0x257)])(_0x53b9ae[_0x45fa06(0x1ed)])&&_0x2fc329[_0x45fa06(0x271)](_0x53b9ae['confirmationMessage1']),!(0x0,lodash_1[_0x45fa06(0x194)])(_0x53b9ae[_0x45fa06(0x23c)])&&!(0x0,lodash_1['isNil'])(_0x53b9ae['confirmationMessage2'])&&_0x2fc329[_0x45fa06(0x271)](_0x53b9ae[_0x45fa06(0x23c)]),!(0x0,lodash_1[_0x45fa06(0x194)])(_0x53b9ae[_0x45fa06(0x245)])&&!(0x0,lodash_1[_0x45fa06(0x257)])(_0x53b9ae[_0x45fa06(0x245)])&&_0x2fc329[_0x45fa06(0x271)](_0x53b9ae['confirmationMessage3']),!(0x0,lodash_1[_0x45fa06(0x194)])(_0x53b9ae[_0x45fa06(0x232)])&&!(0x0,lodash_1[_0x45fa06(0x257)])(_0x53b9ae[_0x45fa06(0x232)])&&_0x2fc329['push'](_0x53b9ae[_0x45fa06(0x232)]),!(0x0,lodash_1['isEmpty'])(_0x53b9ae[_0x45fa06(0x241)])&&!(0x0,lodash_1[_0x45fa06(0x257)])(_0x53b9ae[_0x45fa06(0x241)])&&_0x2fc329['push'](_0x53b9ae[_0x45fa06(0x241)]),_0x2fc329;}function getProcessedMessage(_0x506345,_0x266d5f,_0x215e64){const _0x2b37d4=a305_0x35bd05;let _0x1799a9=_0x506345;return _0x1799a9['includes'](_0x2b37d4(0x1c6))&&(_0x1799a9=_0x1799a9[_0x2b37d4(0x1b3)](/{nome}/g,_0x215e64['name'])),_0x1799a9[_0x2b37d4(0x1d9)](_0x2b37d4(0x1da))&&(_0x1799a9=_0x1799a9[_0x2b37d4(0x1b3)](/{email}/g,_0x215e64[_0x2b37d4(0x1fb)])),_0x1799a9[_0x2b37d4(0x1d9)](_0x2b37d4(0x1a1))&&(_0x1799a9=_0x1799a9[_0x2b37d4(0x1b3)](/{numero}/g,_0x215e64[_0x2b37d4(0x19f)])),_0x266d5f[_0x2b37d4(0x18c)](_0x5e021f=>{const _0x203064=_0x2b37d4;if(_0x1799a9[_0x203064(0x1d9)]('{'+_0x5e021f[_0x203064(0x203)]+'}')){const _0x41088c=new RegExp('{'+_0x5e021f[_0x203064(0x203)]+'}','g');_0x1799a9=_0x1799a9[_0x203064(0x1b3)](_0x41088c,_0x5e021f[_0x203064(0x1c8)]);}}),_0x1799a9;}function randomValue(_0xa52602,_0xb572ad){const _0x1084b7=a305_0x35bd05;return Math[_0x1084b7(0x17d)](Math[_0x1084b7(0x17b)]()*_0xb572ad)+_0xa52602;}exports[a305_0x35bd05(0x1fa)]=randomValue;async function verifyAndFinalizeCampaign(_0x487ff4){const _0x285d07=a305_0x35bd05,{contacts:_0x314e4c}=_0x487ff4[_0x285d07(0x252)],_0x2d9faa=_0x314e4c[_0x285d07(0x217)],_0x95cea6=await CampaignShipping_1[_0x285d07(0x1f1)][_0x285d07(0x253)]({'where':{'campaignId':_0x487ff4['id'],'deliveredAt':{[sequelize_1['Op'][_0x285d07(0x268)]]:null}}});_0x2d9faa===_0x95cea6&&await _0x487ff4[_0x285d07(0x267)]({'status':_0x285d07(0x247),'completedAt':(0x0,moment_1['default'])()});const _0x14cce7=(0x0,socket_1[_0x285d07(0x210)])();_0x14cce7['emit']('company-'+_0x487ff4['companyId']+'-campaign',{'action':_0x285d07(0x267),'record':_0x487ff4});}async function handleProcessCampaign(_0x3610e0){const _0x120e26=a305_0x35bd05;try{const {id:_0x3f3db1}=_0x3610e0[_0x120e26(0x265)],_0x30a159=await getCampaign(_0x3f3db1),_0x28ed60=await getSettings(_0x30a159);if(_0x30a159){const {contacts:_0x17bd29}=_0x30a159['contactList'];if((0x0,lodash_1[_0x120e26(0x26e)])(_0x17bd29)){const _0x52fe28=_0x17bd29['map'](_0x2f4136=>({'contactId':_0x2f4136['id'],'campaignId':_0x30a159['id'],'variables':_0x28ed60[_0x120e26(0x25b)]})),_0x825c13=parseToMilliseconds(_0x28ed60[_0x120e26(0x1d0)]),_0x37ab02=parseToMilliseconds(_0x28ed60[_0x120e26(0x1e1)]),_0x2f3c4d=_0x28ed60[_0x120e26(0x242)];let _0x4ecc37=_0x30a159['scheduledAt'];const _0x1737c5=[];for(let _0x23a927=0x0;_0x23a927<_0x52fe28[_0x120e26(0x217)];_0x23a927++){_0x4ecc37=(0x0,date_fns_1[_0x120e26(0x197)])(_0x4ecc37,_0x23a927>_0x825c13?_0x37ab02:_0x2f3c4d);const {contactId:_0xabc7f3,campaignId:_0x2cddd9,variables:_0x3211c1}=_0x52fe28[_0x23a927],_0x238660=calculateDelay(_0x23a927,_0x4ecc37,_0x825c13,_0x37ab02,_0x2f3c4d),_0x229c7f=exports[_0x120e26(0x183)][_0x120e26(0x1b1)](_0x120e26(0x1fd),{'contactId':_0xabc7f3,'campaignId':_0x2cddd9,'variables':_0x3211c1,'delay':_0x238660},{'removeOnComplete':!![]});_0x1737c5['push'](_0x229c7f),logger_1[_0x120e26(0x24b)][_0x120e26(0x1c2)](_0x120e26(0x1cc)+_0x30a159['id']+_0x120e26(0x1f5)+_0x17bd29[_0x23a927][_0x120e26(0x218)]+';delay='+_0x238660);}await Promise[_0x120e26(0x1c7)](_0x1737c5),await _0x30a159[_0x120e26(0x267)]({'status':_0x120e26(0x189)});}}}catch(_0x1cc8ea){Sentry[_0x120e26(0x204)](_0x1cc8ea);}}function calculateDelay(_0x2d60be,_0x225f01,_0x133171,_0x3cb8f6,_0x4122cf){const _0x2ded2e=a305_0x35bd05,_0x48f3d8=(0x0,date_fns_1[_0x2ded2e(0x24f)])(_0x225f01,new Date());return _0x2d60be>_0x133171?_0x48f3d8*0x3e8+_0x3cb8f6:_0x48f3d8*0x3e8+_0x4122cf;}async function handlePrepareContact(_0x46a81f){const _0x3fa566=a305_0x35bd05;try{const {contactId:_0x4d02f0,campaignId:_0x3d356c,delay:_0x14b175,variables:_0xa52162}=_0x46a81f[_0x3fa566(0x265)],_0x112da1=await getCampaign(_0x3d356c),_0x26f172=await getContact(_0x4d02f0),_0x1ed677={};_0x1ed677[_0x3fa566(0x19f)]=_0x26f172['number'],_0x1ed677['contactId']=_0x4d02f0,_0x1ed677[_0x3fa566(0x1a4)]=_0x3d356c;const _0x212da1=getCampaignValidMessages(_0x112da1);if(_0x212da1[_0x3fa566(0x217)]){const _0x386c36=randomValue(0x0,_0x212da1[_0x3fa566(0x217)]),_0x3c6c49=getProcessedMessage(_0x212da1[_0x386c36],_0xa52162,_0x26f172);_0x1ed677['message']='‌'+_0x3c6c49;}if(_0x112da1[_0x3fa566(0x1ab)]){const _0x92024c=getCampaignValidConfirmationMessages(_0x112da1);if(_0x92024c[_0x3fa566(0x217)]){const _0x6ffa1e=randomValue(0x0,_0x92024c[_0x3fa566(0x217)]),_0x2fec29=getProcessedMessage(_0x92024c[_0x6ffa1e],_0xa52162,_0x26f172);_0x1ed677[_0x3fa566(0x22a)]='‌'+_0x2fec29;}}const [_0x487760,_0x3e1131]=await CampaignShipping_1['default'][_0x3fa566(0x248)]({'where':{'campaignId':_0x1ed677[_0x3fa566(0x1a4)],'contactId':_0x1ed677[_0x3fa566(0x26b)]},'defaults':_0x1ed677});!_0x3e1131&&_0x487760['deliveredAt']===null&&_0x487760[_0x3fa566(0x1e2)]===null&&(_0x487760[_0x3fa566(0x185)](_0x1ed677),await _0x487760[_0x3fa566(0x21e)]());if(_0x487760[_0x3fa566(0x270)]===null&&_0x487760[_0x3fa566(0x1e2)]===null){const _0x4fa3fe=await exports['campaignQueue']['add'](_0x3fa566(0x23e),{'campaignId':_0x112da1['id'],'campaignShippingId':_0x487760['id'],'contactListItemId':_0x4d02f0},{'delay':_0x14b175});await _0x487760['update']({'jobId':_0x4fa3fe['id']});}await verifyAndFinalizeCampaign(_0x112da1);}catch(_0x149448){Sentry['captureException'](_0x149448),logger_1[_0x3fa566(0x24b)][_0x3fa566(0x192)](_0x3fa566(0x1db)+_0x149448[_0x3fa566(0x176)]);}}async function handleDispatchCampaign(_0x7bdf3a){const _0x236b7c=a305_0x35bd05;try{const {data:_0x4d3acf}=_0x7bdf3a,{campaignShippingId:_0x40ae7b,campaignId:_0x5576cd}=_0x4d3acf,_0x1576f3=await getCampaign(_0x5576cd),_0x45cc0d=await(0x0,GetWhatsappWbot_1[_0x236b7c(0x1f1)])(_0x1576f3[_0x236b7c(0x25d)]);if(!_0x45cc0d){logger_1[_0x236b7c(0x24b)][_0x236b7c(0x192)](_0x236b7c(0x20c));return;}if(!_0x1576f3[_0x236b7c(0x25d)]){logger_1[_0x236b7c(0x24b)]['error'](_0x236b7c(0x1de));return;}if(!_0x45cc0d?.[_0x236b7c(0x272)]?.['id']){logger_1[_0x236b7c(0x24b)][_0x236b7c(0x192)](_0x236b7c(0x20d));return;}logger_1['logger'][_0x236b7c(0x1c2)](_0x236b7c(0x227)+_0x5576cd+';Registro='+_0x40ae7b);const _0x36af4a=await CampaignShipping_1[_0x236b7c(0x1f1)][_0x236b7c(0x1a2)](_0x40ae7b,{'include':[{'model':ContactListItem_1['default'],'as':_0x236b7c(0x1b0)}]}),_0x43f665=_0x36af4a[_0x236b7c(0x19f)]+_0x236b7c(0x178);if(_0x1576f3[_0x236b7c(0x1ab)]&&_0x36af4a[_0x236b7c(0x1ab)]===null)await _0x45cc0d['sendMessage'](_0x43f665,{'text':_0x36af4a['confirmationMessage']}),await _0x36af4a['update']({'confirmationRequestedAt':(0x0,moment_1['default'])()});else{await _0x45cc0d['sendMessage'](_0x43f665,{'text':_0x36af4a[_0x236b7c(0x176)]});if(_0x1576f3[_0x236b7c(0x1e0)]){const _0x37ac31=path_1[_0x236b7c(0x1f1)][_0x236b7c(0x190)](__dirname,'..',_0x236b7c(0x1e7)),_0xd7d848=path_1[_0x236b7c(0x1f1)][_0x236b7c(0x1a8)](_0x37ac31,_0x236b7c(0x1c3)+_0x1576f3['companyId'],_0x1576f3['mediaPath']),_0x215cbc=await(0x0,SendWhatsAppMedia_1[_0x236b7c(0x222)])(_0x1576f3[_0x236b7c(0x180)],_0xd7d848,_0x1576f3[_0x236b7c(0x261)][_0x236b7c(0x213)]());Object['keys'](_0x215cbc)[_0x236b7c(0x217)]&&await _0x45cc0d[_0x236b7c(0x1b7)](_0x43f665,{..._0x215cbc});}await _0x36af4a[_0x236b7c(0x267)]({'deliveredAt':(0x0,moment_1[_0x236b7c(0x1f1)])()});}await verifyAndFinalizeCampaign(_0x1576f3);const _0x8e3229=(0x0,socket_1[_0x236b7c(0x210)])();_0x8e3229[_0x236b7c(0x1a6)](_0x236b7c(0x259)+_0x1576f3['companyId']+_0x236b7c(0x244),{'action':_0x236b7c(0x267),'record':_0x1576f3}),logger_1[_0x236b7c(0x24b)][_0x236b7c(0x1c2)](_0x236b7c(0x19c)+_0x5576cd+';Contato='+_0x36af4a[_0x236b7c(0x1b0)]['name']);}catch(_0x1a84cf){Sentry['captureException'](_0x1a84cf),logger_1[_0x236b7c(0x24b)][_0x236b7c(0x192)](_0x1a84cf[_0x236b7c(0x176)]),console[_0x236b7c(0x1c0)](_0x1a84cf[_0x236b7c(0x1aa)]);}}async function handleLoginStatus(_0x2dd844){const _0x5d739e=a305_0x35bd05,_0x524295=await database_1[_0x5d739e(0x1f1)][_0x5d739e(0x1c9)](_0x5d739e(0x18a),{'type':sequelize_1[_0x5d739e(0x1b4)]['SELECT']}),_0x1d853e=_0x524295[_0x5d739e(0x19d)](_0x44d659=>_0x44d659['id']),_0x1436df=_0x1d853e[_0x5d739e(0x1a8)](',\x20');try{const _0x140970=_0x5d739e(0x1af)+_0x1436df+');',_0x266ba4=await database_1[_0x5d739e(0x1f1)][_0x5d739e(0x1c9)](_0x140970,{'type':sequelize_1[_0x5d739e(0x1b4)][_0x5d739e(0x275)]});logger_1['logger'][_0x5d739e(0x1c2)](_0x524295['length']+_0x5d739e(0x226));}catch(_0x498cb8){Sentry[_0x5d739e(0x204)](_0x498cb8);}}async function handleVerifyQueue(_0x2de767){const _0x31638d=a305_0x35bd05;logger_1['logger']['info'](_0x31638d(0x250));try{const _0x2a1472=await Company_1[_0x31638d(0x1f1)][_0x31638d(0x243)]({'attributes':['id',_0x31638d(0x218)],'where':{'status':!![],'dueDate':{[sequelize_1['Op']['gt']]:sequelize_1['Sequelize'][_0x31638d(0x1ba)](_0x31638d(0x1b8))}},'include':[{'model':Whatsapp_1[_0x31638d(0x1f1)],'attributes':['id',_0x31638d(0x218),_0x31638d(0x1eb),_0x31638d(0x1f4),'sendIdQueue'],'where':{'timeSendQueue':{[sequelize_1['Op']['gt']]:0x0}}}]});_0x2a1472[_0x31638d(0x19d)](async _0x2b74f1=>{const _0x3958f8=_0x31638d;_0x2b74f1[_0x3958f8(0x260)][_0x3958f8(0x19d)](async _0x32af98=>{const _0x2ed396=_0x3958f8;if(_0x32af98[_0x2ed396(0x1eb)]===_0x2ed396(0x205)){var _0x226fae=_0x2b74f1['id'];const _0x5bf6e4=_0x32af98['timeSendQueue']?_0x32af98[_0x2ed396(0x1f4)]:0x0,_0x3eaa0e=_0x32af98['sendIdQueue'],_0x200572=_0x5bf6e4,_0xd07a4f=_0x3eaa0e,_0x951ef6=_0x200572;if(_0x5bf6e4>0x0){if(!isNaN(_0xd07a4f)&&Number['isInteger'](_0xd07a4f)&&!isNaN(_0x951ef6)&&Number[_0x2ed396(0x1ad)](_0x951ef6)){const _0xce708b=(0x0,moment_1[_0x2ed396(0x1f1)])()[_0x2ed396(0x1d1)](_0x951ef6,_0x2ed396(0x1d2))[_0x2ed396(0x1ca)]()[_0x2ed396(0x233)](),{count:_0x2e71fc,rows:_0x230606}=await Ticket_1['default'][_0x2ed396(0x258)]({'where':{'status':'pending','queueId':null,'companyId':_0x226fae,'whatsappId':_0x32af98['id'],'updatedAt':{[sequelize_1['Op']['lt']]:_0xce708b}},'include':[{'model':Contact_1[_0x2ed396(0x1f1)],'as':_0x2ed396(0x1b0),'attributes':['id','name','number','email',_0x2ed396(0x237),_0x2ed396(0x1bc),_0x2ed396(0x1ec),_0x2ed396(0x209)],'include':[_0x2ed396(0x193),_0x2ed396(0x25e),_0x2ed396(0x1f0)]},{'model':Queue_2[_0x2ed396(0x1f1)],'as':_0x2ed396(0x208),'attributes':['id',_0x2ed396(0x218),_0x2ed396(0x1a0)]}]});_0x2e71fc>0x0?_0x230606[_0x2ed396(0x19d)](async _0xe160f7=>{const _0x422e37=_0x2ed396;await _0xe160f7[_0x422e37(0x267)]({'queueId':_0xd07a4f}),await _0xe160f7['reload']();const _0x1d94fa=(0x0,socket_1[_0x422e37(0x210)])();_0x1d94fa['to'](_0xe160f7[_0x422e37(0x1eb)])['to'](_0x422e37(0x1bb))['to'](_0xe160f7['id'][_0x422e37(0x213)]())[_0x422e37(0x1a6)](_0x422e37(0x259)+_0x226fae+'-ticket',{'action':_0x422e37(0x267),'ticket':_0xe160f7,'ticketId':_0xe160f7['id']}),logger_1[_0x422e37(0x24b)][_0x422e37(0x1c2)](_0x422e37(0x228)+_0xe160f7['id']+_0x422e37(0x238)+_0x226fae);}):logger_1[_0x2ed396(0x24b)][_0x2ed396(0x1c2)](_0x2ed396(0x23d)+_0x226fae);}else logger_1[_0x2ed396(0x24b)][_0x2ed396(0x1c2)](_0x2ed396(0x17f)+_0x226fae);}}});});}catch(_0x4f3281){Sentry['captureException'](_0x4f3281),logger_1['logger'][_0x31638d(0x192)](_0x31638d(0x1f2),_0x4f3281[_0x31638d(0x176)]);throw _0x4f3281;}};async function handleRandomUser(){const _0x133c98=a305_0x35bd05;logger_1[_0x133c98(0x24b)][_0x133c98(0x1c2)](_0x133c98(0x26a));const _0x53a66b=new CronJob('*/5\x20*\x20*\x20*\x20*\x20*',async()=>{const _0x37d507=_0x133c98;try{const {count:_0x5a6307,rows:_0x338ff2}=await Ticket_1[_0x37d507(0x1f1)][_0x37d507(0x258)]({'where':{'status':_0x37d507(0x19b),'queueId':{[sequelize_1['Op']['ne']]:null,[sequelize_1['Op']['ne']]:0x0},'$queue.ativarRoteador$':!![],'$queue.tempoRoteador$':{[sequelize_1['Op']['ne']]:0x0}},'include':[{'model':Queue_1[_0x37d507(0x1f1)],'as':_0x37d507(0x208)}]}),_0x17e9b8=_0x47d5ea=>{const _0x437b8e=_0x37d507,_0x3d26c6=Math[_0x437b8e(0x17d)](Math[_0x437b8e(0x17b)]()*_0x47d5ea['length']);return _0x47d5ea[_0x3d26c6];},_0x356133=async _0x106b51=>{const _0x5b58eb=_0x37d507;try{const _0x360901=await User_1['default'][_0x5b58eb(0x200)]({'where':{'id':_0x106b51}});return _0x360901[_0x5b58eb(0x223)]==='user'?(logger_1['logger'][_0x5b58eb(0x1c2)](_0x5b58eb(0x20e)),_0x360901[_0x5b58eb(0x22e)]===!![]?_0x360901['id']:(logger_1[_0x5b58eb(0x24b)][_0x5b58eb(0x1c2)]('USER\x20OFFLINE'),0x0)):(logger_1[_0x5b58eb(0x24b)]['info'](_0x5b58eb(0x1fc)),0x0);}catch(_0x12762b){Sentry[_0x5b58eb(0x204)](_0x12762b),logger_1[_0x5b58eb(0x24b)]['error'](_0x5b58eb(0x1f6),_0x12762b[_0x5b58eb(0x176)]);throw _0x12762b;}};if(_0x5a6307>0x0)for(const _0x1eec2b of _0x338ff2){const {queue:_0x5a034d,queueId:_0x14fc08,userId:_0x263775}=_0x1eec2b,_0x366a78=_0x5a034d['tempoRoteador'],_0x2867d9=await UserQueue_1[_0x37d507(0x1f1)]['findAll']({'where':{'queueId':_0x14fc08}}),_0x5e0290=await(0x0,ShowContactService_1[_0x37d507(0x1f1)])(_0x1eec2b[_0x37d507(0x26b)],_0x1eec2b['companyId']),_0x2349b9=_0x2867d9[_0x37d507(0x19d)](_0x22ba8c=>_0x22ba8c['userId']),_0x37cc8e=(0x0,moment_1['default'])()[_0x37d507(0x1d1)](_0x366a78,_0x37d507(0x1d2))[_0x37d507(0x1ca)]()['toDate'](),_0xb2bc09=new Date(_0x1eec2b[_0x37d507(0x1b5)]);if(!_0x263775){const _0x2d12a2=_0x17e9b8(_0x2349b9);if(await _0x356133(_0x2d12a2)>0x0){const _0x477cde=await(0x0,ShowTicketService_1[_0x37d507(0x1f1)])(_0x1eec2b['id'],_0x1eec2b['companyId']),_0x4281b5=await(0x0,SendWhatsAppMessage_1[_0x37d507(0x1f1)])({'body':_0x37d507(0x1ef),'ticket':_0x477cde});await(0x0,UpdateTicketService_1['default'])({'ticketData':{'status':'open','userId':_0x2d12a2},'ticketId':_0x1eec2b['id'],'companyId':_0x1eec2b['companyId']}),logger_1[_0x37d507(0x24b)][_0x37d507(0x1c2)]('Ticket\x20ID\x20'+_0x1eec2b['id']+_0x37d507(0x1ae)+_0x2d12a2+_0x37d507(0x201)+_0x1eec2b[_0x37d507(0x1b5)]);}else{}}else{if(_0x2349b9[_0x37d507(0x1d9)](_0x263775)){if(_0x37cc8e>_0xb2bc09){const _0x895c89=_0x2349b9[_0x37d507(0x1dd)](_0x2ad4cc=>_0x2ad4cc!==_0x263775);if(_0x895c89['length']>0x0){const _0x374a60=_0x17e9b8(_0x895c89);if(await _0x356133(_0x374a60)>0x0){const _0x52e631=await(0x0,ShowTicketService_1[_0x37d507(0x1f1)])(_0x1eec2b['id'],_0x1eec2b[_0x37d507(0x261)]),_0x6847cb=await(0x0,SendWhatsAppMessage_1['default'])({'body':_0x37d507(0x1ef),'ticket':_0x52e631});await(0x0,UpdateTicketService_1[_0x37d507(0x1f1)])({'ticketData':{'status':_0x37d507(0x236),'userId':_0x374a60},'ticketId':_0x1eec2b['id'],'companyId':_0x1eec2b['companyId']}),await _0x1eec2b[_0x37d507(0x231)]();}else{}}else{}}else{}}else{}}}}catch(_0x2badee){Sentry[_0x37d507(0x204)](_0x2badee),logger_1[_0x37d507(0x24b)][_0x37d507(0x192)](_0x37d507(0x1f6),_0x2badee[_0x37d507(0x176)]);throw _0x2badee;}});_0x53a66b['start']();}async function handleCloseTicketsAutomatic(){const _0x3dad78=a305_0x35bd05,_0x250497=new CronJob('*/1\x20*\x20*\x20*\x20*',async()=>{const _0x5932b6=a305_0x2d93,_0x50bac0=await Company_1[_0x5932b6(0x1f1)]['findAll']();_0x50bac0[_0x5932b6(0x19d)](async _0x49fcb8=>{const _0x4406c7=_0x5932b6;try{const _0x2dd641=_0x49fcb8['id'];await(0x0,wbotClosedTickets_1['ClosedAllOpenTickets'])(_0x2dd641);}catch(_0x16b6e2){Sentry[_0x4406c7(0x204)](_0x16b6e2),logger_1[_0x4406c7(0x24b)][_0x4406c7(0x192)](_0x4406c7(0x221),_0x16b6e2['message']);throw _0x16b6e2;}});});_0x250497[_0x3dad78(0x1a9)]();}handleCloseTicketsAutomatic(),handleRandomUser();async function startQueueProcess(){const _0x10e50b=a305_0x35bd05;logger_1[_0x10e50b(0x24b)][_0x10e50b(0x1c2)](_0x10e50b(0x24c)),exports['messageQueue'][_0x10e50b(0x198)](_0x10e50b(0x1df),handleSendMessage),exports[_0x10e50b(0x18b)][_0x10e50b(0x198)](_0x10e50b(0x1ff),handleVerifySchedules),exports[_0x10e50b(0x19e)][_0x10e50b(0x198)](_0x10e50b(0x1df),handleSendScheduledMessage),exports[_0x10e50b(0x183)][_0x10e50b(0x198)]('VerifyCampaignsDaatabase',handleVerifyCampaigns),exports[_0x10e50b(0x183)][_0x10e50b(0x198)](_0x10e50b(0x17c),handleProcessCampaign),exports[_0x10e50b(0x183)][_0x10e50b(0x198)](_0x10e50b(0x1fd),handlePrepareContact),exports[_0x10e50b(0x183)][_0x10e50b(0x198)](_0x10e50b(0x23e),handleDispatchCampaign),exports[_0x10e50b(0x1fe)][_0x10e50b(0x198)]('VerifyLoginStatus',handleLoginStatus),exports[_0x10e50b(0x230)][_0x10e50b(0x198)]('VerifyQueueStatus',handleVerifyQueue),exports[_0x10e50b(0x18b)]['add']('Verify',{},{'repeat':{'cron':_0x10e50b(0x22f),'key':_0x10e50b(0x1e5)},'removeOnComplete':!![]}),exports[_0x10e50b(0x183)][_0x10e50b(0x1b1)](_0x10e50b(0x20a),{},{'repeat':{'cron':_0x10e50b(0x18f),'key':_0x10e50b(0x177)},'removeOnComplete':!![]}),exports[_0x10e50b(0x1fe)][_0x10e50b(0x1b1)](_0x10e50b(0x1ce),{},{'repeat':{'cron':_0x10e50b(0x273),'key':_0x10e50b(0x195)},'removeOnComplete':!![]}),exports[_0x10e50b(0x230)]['add'](_0x10e50b(0x26c),{},{'repeat':{'cron':_0x10e50b(0x18f),'key':_0x10e50b(0x1d4)},'removeOnComplete':!![]});}exports['startQueueProcess']=startQueueProcess;function a305_0x37d2(){const _0x239474=['REDIS_OPT_LIMITER_MAX','FINALIZADA','findOrCreate','YYYY-MM-DD\x20HH:mm:ss','contacts','logger','Iniciando\x20processamento\x20de\x20filas','call','nodemailer','differenceInSeconds','Buscando\x20atendimentos\x20perdidos\x20nas\x20filas','QueueMonitor','contactList','count','ScheduleMonitor','ENVIADA','lodash','isNil','findAndCountAll','company-','sequelize','variables','22731966nqLksz','whatsapp','contactTags','SendSacheduledMessages','whatsapps','companyId','moment','scheduledAt','completed','data','178925QnVIVh','update','not','Sleep\x20de\x20','Iniciando\x20a\x20randomização\x20dos\x20atendimentos...','contactId','VerifyQueueStatus','SendScheduledMessage\x20->\x20Verify:\x20error','isArray','path','deliveredAt','push','user','*\x20*\x20*\x20*\x20*','message1','UPDATE','message','verify-campaing','@s.whatsapp.net','getOwnPropertyDescriptor','message2','random','ProcessCampaign','floor','CronJob','Condição\x20não\x20respeitada\x20-\x20Empresa:\x20','mediaName','messageQueue','whatsappId','campaignQueue','Whatsapp\x20não\x20identificado','set','116825qHqNjG','hasOwnProperty','body','EM_ANDAMENTO','select\x20id\x20from\x20\x22Users\x22\x20where\x20\x22updatedAt\x22\x20<\x20now()\x20-\x20\x273\x20minutes\x27::interval\x20and\x20online\x20=\x20true','scheduleMonitor','forEach','./models/Queue','3801609gYViRx','*/20\x20*\x20*\x20*\x20*\x20*','resolve','PENDENTE','error','extraInfo','isEmpty','verify-login','cron','addSeconds','process','10FieoIp','./models/Whatsapp','pending','Campanha\x20enviada\x20para:\x20Campanha=','map','sendScheduledMessages','number','color','{numero}','findByPk','./models/CampaignSetting','campaignId','Erro\x20ao\x20tentar\x20consultar\x20agendamento:\x20','emit','startQueueProcess','join','start','stack','confirmation','diff','isInteger','\x20updated\x20with\x20UserId\x20','UPDATE\x20\x22Users\x22\x20SET\x20\x22online\x22\x20=\x20false,\x20\x22updatedAt\x22\x20=\x20now()\x20WHERE\x20id\x20IN\x20(','contact','add','message3','replace','QueryTypes','updatedAt','./models/User','sendMessage','CURRENT_DATE','./services/WbotServices/wbotClosedTickets','literal','notification','acceptAudioMessage','reduce','message5','isWhatsappValid','log','Campanha\x20enviada\x20para\x20a\x20fila\x20de\x20processamento:\x20Campanha=','info','company','5346qWkety','MessageQueue','{nome}','all','value','query','utc','REDIS_OPT_LIMITER_DURATION','Registro\x20enviado\x20pra\x20fila\x20de\x20disparo:\x20Campanha=','124dWhjOz','VerifyLoginStatus','\x20segundos\x20iniciado:\x20','longerIntervalAfter','subtract','minutes','milliseconds','verify-queue','parseToMilliseconds','env','defineProperty','./services/WbotServices/SendWhatsAppMedia','includes','{email}','campaignQueue\x20->\x20PrepareContact\x20->\x20error:\x20','./models/Company','filter','campaignQueue\x20->\x20DispatchCampaign\x20->\x20error:\x20whatsapp\x20not\x20found','SendMessage','mediaPath','greaterInterval','confirmationRequestedAt','./helpers/SendMessage','configurable','verify','writable','public','46rZJwEr','ERRO','__setModuleDefault','status','active','confirmationMessage1','HH:mm:ss','*Assistente\x20Virtual*:\x0aAguarde\x20enquanto\x20localizamos\x20um\x20atendente...\x20Você\x20será\x20atendido\x20em\x20breve!','tags','default','SearchForQueue\x20->\x20VerifyQueue:\x20error','MessageQueue\x20->\x20SendMessage:\x20error','timeSendQueue',';Contato=','SearchForUsersRandom\x20->\x20VerifyUsersRandom:\x20error','__createBinding','message4','bull','randomValue','email','ADMIN','PrepareContact','userMonitor','Verify','findOne','\x20-\x20','clean','key','captureException','CONNECTED','./services/TicketServices/UpdateTicketService','Disparo\x20agendado\x20para:\x20','queue','disableBot','VerifyCampaignsDaatabase','create','campaignQueue\x20->\x20DispatchCampaign\x20->\x20error:\x20wbot\x20not\x20found','campaignQueue\x20->\x20DispatchCampaign\x20->\x20error:\x20wbot\x20user\x20not\x20found','USER','__importDefault','getIO','./helpers/GetDefaultWhatsApp','prototype','toString','./services/TicketServices/ShowTicketService','./models/Contact','UserMonitor','length','name','\x20segundos\x20finalizado:\x20','gte','./models/CampaignShipping','./models/Campaign','4412456dRXnPy','save','CampaignQueue','__esModule','ClosedAllOpenTickets\x20->\x20Verify:\x20error','getMessageOptions','profile','select\x20id,\x20\x22scheduledAt\x22\x20from\x20\x22Campaigns\x22\x20c\x0a\x20\x20\x20\x20where\x20\x22scheduledAt\x22\x20between\x20now()\x20and\x20now()\x20+\x20\x273\x20hour\x27::interval\x20and\x20status\x20=\x20\x27PROGRAMADA\x27','4409112uObiQr','\x20usuarios\x20passados\x20para\x20offline','Disparo\x20de\x20campanha\x20solicitado:\x20Campanha=','Atendimento\x20Perdido:\x20','./models/ContactList','confirmationMessage','./database','./services/WbotServices/SendWhatsAppMessage','./models/Ticket','online','*/5\x20*\x20*\x20*\x20*\x20*','queueMonitor','reload','confirmationMessage4','format','./models/UserQueue','./helpers/GetWhatsappWbot','open','profilePicUrl','\x20-\x20Empresa:\x20','get','Mensagem\x20agendada\x20enviada\x20para:\x20','seconds','confirmationMessage2','Nenhum\x20atendimento\x20perdido\x20encontrado\x20-\x20Empresa:\x20','DispatchCampaign','date-fns','@sentry/node','confirmationMessage5','messageInterval','findAll','-campaign','confirmationMessage3'];a305_0x37d2=function(){return _0x239474;};return a305_0x37d2();}