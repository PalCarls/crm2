'use strict';const a342_0x5064f8=a342_0x4971;(function(_0x27263,_0x38befb){const _0x4fde88=a342_0x4971,_0x5b3dcc=_0x27263();while(!![]){try{const _0x5c2eac=-parseInt(_0x4fde88(0x7f))/0x1+parseInt(_0x4fde88(0x9b))/0x2+-parseInt(_0x4fde88(0x9a))/0x3+-parseInt(_0x4fde88(0x99))/0x4+-parseInt(_0x4fde88(0x94))/0x5*(-parseInt(_0x4fde88(0x79))/0x6)+parseInt(_0x4fde88(0x86))/0x7+-parseInt(_0x4fde88(0x8c))/0x8;if(_0x5c2eac===_0x38befb)break;else _0x5b3dcc['push'](_0x5b3dcc['shift']());}catch(_0x220d41){_0x5b3dcc['push'](_0x5b3dcc['shift']());}}}(a342_0x5796,0x5b786));function a342_0x5796(){const _0x4deca6=['env','1542tdXiBE','startQueueProcess','logger','then','./services/WbotServices/StartAllWhatsAppsSessions','clusterWorkerSize','22988osenqq','map','pid','cluster','default','\x20has\x20exitted.','toUTCString','4314674qpiciC','cpus','fork','uncaughtException','length','error','7782456CSTBzx','Worker','listen','exit','__esModule','./models/Company','unhandledRejection','\x20unhandledRejection:','11110cmOthl','message','isMaster','all','Express\x20server\x20listening\x20on\x20port\x20','862636ZOdPFx','42171vNbRTv','825474AMhqpr','PORT','push','\x20and\x20worker\x20','log','findAll'];a342_0x5796=function(){return _0x4deca6;};return a342_0x5796();}function a342_0x4971(_0x591a6c,_0x300f32){const _0x5796b0=a342_0x5796();return a342_0x4971=function(_0x49713c,_0x578a42){_0x49713c=_0x49713c-0x76;let _0x3e2201=_0x5796b0[_0x49713c];return _0x3e2201;},a342_0x4971(_0x591a6c,_0x300f32);}var __importDefault=this&&this['__importDefault']||function(_0x34714d){const _0x122580=a342_0x4971;return _0x34714d&&_0x34714d[_0x122580(0x90)]?_0x34714d:{'default':_0x34714d};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const http_graceful_shutdown_1=__importDefault(require('http-graceful-shutdown')),socket_1=require('./libs/socket'),logger_1=require('./utils/logger'),StartAllWhatsAppsSessions_1=require(a342_0x5064f8(0x7d)),Company_1=__importDefault(require(a342_0x5064f8(0x91))),queues_1=require('./queues'),express=require('express'),os=require('os'),cluster=require(a342_0x5064f8(0x82)),PORT=process[a342_0x5064f8(0x78)][a342_0x5064f8(0x9c)]||0xfa0,clusterWorkerSize=os[a342_0x5064f8(0x87)]()[a342_0x5064f8(0x8a)];console[a342_0x5064f8(0x76)](a342_0x5064f8(0x7e),clusterWorkerSize);if(clusterWorkerSize>0x1){if(cluster[a342_0x5064f8(0x96)]){for(let i=0x0;i<clusterWorkerSize;i++){cluster[a342_0x5064f8(0x88)]();}cluster['on'](a342_0x5064f8(0x8f),function(_0x3b385e){const _0x405515=a342_0x5064f8;console[_0x405515(0x76)](_0x405515(0x8d),_0x3b385e['id'],_0x405515(0x84));});}else{const app=express(),server=app[a342_0x5064f8(0x8e)](process['env'][a342_0x5064f8(0x9c)],async()=>{const _0x273601=a342_0x5064f8,_0x359cb5=await Company_1[_0x273601(0x83)][_0x273601(0x77)](),_0xec6929=[];_0x359cb5[_0x273601(0x80)](async _0xe26a78=>{const _0x2fb644=_0x273601,_0x331393=(0x0,StartAllWhatsAppsSessions_1['StartAllWhatsAppsSessions'])(_0xe26a78['id']);_0xec6929[_0x2fb644(0x9d)](_0x331393);}),Promise[_0x273601(0x97)](_0xec6929)[_0x273601(0x7c)](async()=>{const _0x2eb54c=_0x273601;await(0x0,queues_1[_0x2eb54c(0x7a)])();}),logger_1[_0x273601(0x7b)]['info']('Server\x20started\x20on\x20port:\x20'+process['env'][_0x273601(0x9c)]+_0x273601(0x9e)+process[_0x273601(0x81)]);});process['on'](a342_0x5064f8(0x89),_0x446cf6=>{const _0xdf3214=a342_0x5064f8;console[_0xdf3214(0x8b)](new Date()[_0xdf3214(0x85)]()+'\x20uncaughtException:',_0x446cf6[_0xdf3214(0x95)]),console['error'](_0x446cf6['stack']),process[_0xdf3214(0x8f)](0x1);}),process['on'](a342_0x5064f8(0x92),(_0x275b6e,_0x3d22ce)=>{const _0x17ccb9=a342_0x5064f8;console['error'](new Date()[_0x17ccb9(0x85)]()+_0x17ccb9(0x93),_0x275b6e,_0x3d22ce),process[_0x17ccb9(0x8f)](0x1);}),(0x0,socket_1['initIO'])(server),(0x0,http_graceful_shutdown_1['default'])(server);}}else{const app=express();app['listen'](PORT,function(){const _0x4305c=a342_0x5064f8;console[_0x4305c(0x76)](_0x4305c(0x98)+PORT+'\x20with\x20the\x20single\x20worker\x20'+process[_0x4305c(0x81)]);});}