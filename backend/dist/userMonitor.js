'use strict';const a625_0x520878=a625_0x31d6;(function(_0x16f28d,_0x1a7329){const _0x2268b4=a625_0x31d6,_0x527c41=_0x16f28d();while(!![]){try{const _0x454351=parseInt(_0x2268b4(0xda))/0x1+-parseInt(_0x2268b4(0xd8))/0x2+-parseInt(_0x2268b4(0xcc))/0x3*(-parseInt(_0x2268b4(0xdb))/0x4)+parseInt(_0x2268b4(0xc3))/0x5+parseInt(_0x2268b4(0xe9))/0x6*(-parseInt(_0x2268b4(0xee))/0x7)+parseInt(_0x2268b4(0xe4))/0x8*(parseInt(_0x2268b4(0xe2))/0x9)+-parseInt(_0x2268b4(0xed))/0xa;if(_0x454351===_0x1a7329)break;else _0x527c41['push'](_0x527c41['shift']());}catch(_0x4e64f8){_0x527c41['push'](_0x527c41['shift']());}}}(a625_0x49eb,0xb6627));var __createBinding=this&&this[a625_0x520878(0xdf)]||(Object[a625_0x520878(0xd0)]?function(_0x3fa19e,_0x25a520,_0x381f7f,_0x211d0e){const _0x24c809=a625_0x520878;if(_0x211d0e===undefined)_0x211d0e=_0x381f7f;var _0x71d7ac=Object[_0x24c809(0xd2)](_0x25a520,_0x381f7f);(!_0x71d7ac||(_0x24c809(0xe1)in _0x71d7ac?!_0x25a520[_0x24c809(0xc9)]:_0x71d7ac['writable']||_0x71d7ac[_0x24c809(0xe8)]))&&(_0x71d7ac={'enumerable':!![],'get':function(){return _0x25a520[_0x381f7f];}}),Object['defineProperty'](_0x3fa19e,_0x211d0e,_0x71d7ac);}:function(_0x5ac5df,_0x487d34,_0x4f4e7c,_0x5f4a93){if(_0x5f4a93===undefined)_0x5f4a93=_0x4f4e7c;_0x5ac5df[_0x5f4a93]=_0x487d34[_0x4f4e7c];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a625_0x520878(0xd0)]?function(_0xdb5a0d,_0x59bbf5){const _0x5bcbc3=a625_0x520878;Object[_0x5bcbc3(0xd9)](_0xdb5a0d,'default',{'enumerable':!![],'value':_0x59bbf5});}:function(_0x5f4390,_0x471964){const _0x1ea64e=a625_0x520878;_0x5f4390[_0x1ea64e(0xc0)]=_0x471964;}),__importStar=this&&this[a625_0x520878(0xc4)]||function(_0x3d3fdb){const _0x519b89=a625_0x520878;if(_0x3d3fdb&&_0x3d3fdb[_0x519b89(0xc9)])return _0x3d3fdb;var _0x17e593={};if(_0x3d3fdb!=null){for(var _0x114cfb in _0x3d3fdb)if(_0x114cfb!==_0x519b89(0xc0)&&Object[_0x519b89(0xd1)][_0x519b89(0xbf)][_0x519b89(0xd3)](_0x3d3fdb,_0x114cfb))__createBinding(_0x17e593,_0x3d3fdb,_0x114cfb);}return __setModuleDefault(_0x17e593,_0x3d3fdb),_0x17e593;},__importDefault=this&&this[a625_0x520878(0xe0)]||function(_0x2024bd){return _0x2024bd&&_0x2024bd['__esModule']?_0x2024bd:{'default':_0x2024bd};};Object[a625_0x520878(0xd9)](exports,a625_0x520878(0xc9),{'value':!![]}),exports[a625_0x520878(0xc8)]=exports[a625_0x520878(0xec)]=void 0x0;const bull_1=__importDefault(require(a625_0x520878(0xdc))),Sentry=__importStar(require('@sentry/node')),sequelize_1=require(a625_0x520878(0xc1)),lodash_1=require('lodash'),logger_1=require(a625_0x520878(0xce)),database_1=__importDefault(require(a625_0x520878(0xeb))),User_1=__importDefault(require(a625_0x520878(0xcf))),connection=process[a625_0x520878(0xd4)][a625_0x520878(0xe7)]||'';exports[a625_0x520878(0xec)]=new bull_1[(a625_0x520878(0xc0))](a625_0x520878(0xcb),connection);async function handleLoginStatus(_0x118d66){const _0x555139=a625_0x520878,_0x55326d=await database_1[_0x555139(0xc0)]['query'](_0x555139(0xe5),{'type':sequelize_1['QueryTypes'][_0x555139(0xd7)]});for(let _0x15bb4e of _0x55326d){try{const _0x2e1d61=await User_1[_0x555139(0xc0)]['findByPk'](_0x15bb4e['id']);await _0x2e1d61['update']({'online':![]}),logger_1[_0x555139(0xe6)][_0x555139(0xc2)](_0x555139(0xc7)+_0x15bb4e['id']);}catch(_0x5dfe82){Sentry[_0x555139(0xca)](_0x5dfe82);}}}async function handleUserConnection(_0x3744f1){const _0x2c54f9=a625_0x520878;try{const {id:_0x27a89d}=_0x3744f1[_0x2c54f9(0xe3)];if(!(0x0,lodash_1['isNil'])(_0x27a89d)&&_0x27a89d!==_0x2c54f9(0xf0)){const _0x24fb93=await User_1[_0x2c54f9(0xc0)][_0x2c54f9(0xd5)](_0x27a89d);_0x24fb93&&(_0x24fb93['online']=!![],await _0x24fb93[_0x2c54f9(0xef)]());}}catch(_0x37d1d3){Sentry['captureException'](_0x37d1d3);}}function a625_0x31d6(_0x4cd22c,_0xa9cb1d){const _0x49eb57=a625_0x49eb();return a625_0x31d6=function(_0x31d68b,_0x485900){_0x31d68b=_0x31d68b-0xbf;let _0x3c3e8f=_0x49eb57[_0x31d68b];return _0x3c3e8f;},a625_0x31d6(_0x4cd22c,_0xa9cb1d);}exports[a625_0x520878(0xec)]['process'](a625_0x520878(0xde),handleUserConnection),exports[a625_0x520878(0xec)]['process'](a625_0x520878(0xdd),handleLoginStatus);function a625_0x49eb(){const _0x350abf=['28SlWcNa','save','null','hasOwnProperty','default','sequelize','info','4899360relIGh','__importStar','Queue:\x20monitoramento\x20de\x20status\x20de\x20usuário\x20inicializado','add','Usuário\x20passado\x20para\x20offline:\x20','initUserMonitorQueues','__esModule','captureException','UserMonitor','201qsvpsD','removeRepeatableByKey','./utils/logger','./models/User','create','prototype','getOwnPropertyDescriptor','call','env','findByPk','verify-login-status','SELECT','2925856mOCepk','defineProperty','1375488hWwEGq','12188YeRQZt','bull','VerifyLoginStatus','UserConnection','__createBinding','__importDefault','get','1010241sJZxgM','data','104tyobxw','select\x20id\x20from\x20\x22Users\x22\x20where\x20\x22updatedAt\x22\x20<\x20now()\x20-\x20\x275\x20minutes\x27::interval\x20and\x20online\x20=\x20true','logger','REDIS_URI','configurable','317508AYZZOt','key','./database','userMonitor','15970990YTGXGg'];a625_0x49eb=function(){return _0x350abf;};return a625_0x49eb();}async function initUserMonitorQueues(){const _0x105f11=a625_0x520878,_0x660973=await exports[_0x105f11(0xec)]['getRepeatableJobs']();for(let _0x18373a of _0x660973){await exports['userMonitor'][_0x105f11(0xcd)](_0x18373a[_0x105f11(0xea)]);}exports['userMonitor'][_0x105f11(0xc6)]('VerifyLoginStatus',{},{'repeat':{'cron':'*\x20*\x20*\x20*\x20*','key':_0x105f11(0xd6)},'removeOnComplete':{'age':0x3c*0x3c,'count':0xa},'removeOnFail':{'age':0x3c*0x3c,'count':0xa}}),logger_1[_0x105f11(0xe6)]['info'](_0x105f11(0xc5));}exports[a625_0x520878(0xc8)]=initUserMonitorQueues;