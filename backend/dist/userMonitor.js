'use strict';const a524_0x48ccec=a524_0x3de6;(function(_0x41f007,_0x4f96a5){const _0x48a8b9=a524_0x3de6,_0x474cc3=_0x41f007();while(!![]){try{const _0x42d68f=-parseInt(_0x48a8b9(0x1a0))/0x1*(parseInt(_0x48a8b9(0x1a3))/0x2)+-parseInt(_0x48a8b9(0x19f))/0x3*(-parseInt(_0x48a8b9(0x1b1))/0x4)+parseInt(_0x48a8b9(0x1a8))/0x5*(-parseInt(_0x48a8b9(0x1ad))/0x6)+parseInt(_0x48a8b9(0x197))/0x7+parseInt(_0x48a8b9(0x1a5))/0x8*(-parseInt(_0x48a8b9(0x196))/0x9)+-parseInt(_0x48a8b9(0x18b))/0xa+parseInt(_0x48a8b9(0x1a1))/0xb;if(_0x42d68f===_0x4f96a5)break;else _0x474cc3['push'](_0x474cc3['shift']());}catch(_0x2512d6){_0x474cc3['push'](_0x474cc3['shift']());}}}(a524_0x352b,0xf05e3));var __createBinding=this&&this[a524_0x48ccec(0x18e)]||(Object[a524_0x48ccec(0x19d)]?function(_0x2f3136,_0x597ec3,_0x4f439b,_0x112fc1){const _0x56ef08=a524_0x48ccec;if(_0x112fc1===undefined)_0x112fc1=_0x4f439b;var _0x190f16=Object['getOwnPropertyDescriptor'](_0x597ec3,_0x4f439b);(!_0x190f16||(_0x56ef08(0x195)in _0x190f16?!_0x597ec3['__esModule']:_0x190f16['writable']||_0x190f16[_0x56ef08(0x194)]))&&(_0x190f16={'enumerable':!![],'get':function(){return _0x597ec3[_0x4f439b];}}),Object['defineProperty'](_0x2f3136,_0x112fc1,_0x190f16);}:function(_0x4bedfb,_0x530207,_0x35d275,_0x5eb039){if(_0x5eb039===undefined)_0x5eb039=_0x35d275;_0x4bedfb[_0x5eb039]=_0x530207[_0x35d275];}),__setModuleDefault=this&&this[a524_0x48ccec(0x1ae)]||(Object['create']?function(_0x478def,_0x48b4e1){const _0x26215b=a524_0x48ccec;Object[_0x26215b(0x1ac)](_0x478def,'default',{'enumerable':!![],'value':_0x48b4e1});}:function(_0x22d9e7,_0x14ca73){const _0x3dfc42=a524_0x48ccec;_0x22d9e7[_0x3dfc42(0x190)]=_0x14ca73;}),__importStar=this&&this[a524_0x48ccec(0x18d)]||function(_0x5f0c72){const _0x23bf59=a524_0x48ccec;if(_0x5f0c72&&_0x5f0c72['__esModule'])return _0x5f0c72;var _0x22fafe={};if(_0x5f0c72!=null){for(var _0x1c51b7 in _0x5f0c72)if(_0x1c51b7!=='default'&&Object[_0x23bf59(0x1ba)][_0x23bf59(0x1b2)][_0x23bf59(0x1b9)](_0x5f0c72,_0x1c51b7))__createBinding(_0x22fafe,_0x5f0c72,_0x1c51b7);}return __setModuleDefault(_0x22fafe,_0x5f0c72),_0x22fafe;},__importDefault=this&&this[a524_0x48ccec(0x1bb)]||function(_0x3242f9){const _0x13c1b4=a524_0x48ccec;return _0x3242f9&&_0x3242f9[_0x13c1b4(0x1b7)]?_0x3242f9:{'default':_0x3242f9};};Object[a524_0x48ccec(0x1ac)](exports,a524_0x48ccec(0x1b7),{'value':!![]}),exports['initUserMonitorQueues']=exports[a524_0x48ccec(0x1b4)]=void 0x0;const bull_1=__importDefault(require('bull')),Sentry=__importStar(require(a524_0x48ccec(0x1a2))),sequelize_1=require(a524_0x48ccec(0x18f)),lodash_1=require('lodash'),logger_1=require(a524_0x48ccec(0x1a6)),database_1=__importDefault(require('./database')),User_1=__importDefault(require('./models/User')),connection=process[a524_0x48ccec(0x1af)][a524_0x48ccec(0x1a4)]||'';exports[a524_0x48ccec(0x1b4)]=new bull_1[(a524_0x48ccec(0x190))](a524_0x48ccec(0x19a),connection);function a524_0x352b(){const _0x3d348d=['info','defineProperty','174BFSkKx','__setModuleDefault','env','verify-login-status','4100FmyRRV','hasOwnProperty','Usuário\x20passado\x20para\x20offline:\x20','userMonitor','update','QueryTypes','__esModule','save','call','prototype','__importDefault','captureException','key','initUserMonitorQueues','findByPk','8411030irjosR','null','__importStar','__createBinding','sequelize','default','VerifyLoginStatus','process','getRepeatableJobs','configurable','get','873LofnIJ','4096309eqXzLo','query','*\x20*\x20*\x20*\x20*','UserMonitor','select\x20id\x20from\x20\x22Users\x22\x20where\x20\x22updatedAt\x22\x20<\x20now()\x20-\x20\x275\x20minutes\x27::interval\x20and\x20online\x20=\x20true','logger','create','isNil','1167wsoEJj','8009CcQBuA','30644361SWAcXh','@sentry/node','386ITHjLJ','REDIS_URI','29768gXcjoC','./utils/logger','data','6455DRYaHH','add','removeRepeatableByKey'];a524_0x352b=function(){return _0x3d348d;};return a524_0x352b();}async function handleLoginStatus(_0x3b2753){const _0x16dd02=a524_0x48ccec,_0x4e9fbd=await database_1[_0x16dd02(0x190)][_0x16dd02(0x198)](_0x16dd02(0x19b),{'type':sequelize_1[_0x16dd02(0x1b6)]['SELECT']});for(let _0x443543 of _0x4e9fbd){try{const _0x3be96c=await User_1[_0x16dd02(0x190)]['findByPk'](_0x443543['id']);await _0x3be96c[_0x16dd02(0x1b5)]({'online':![]}),logger_1[_0x16dd02(0x19c)][_0x16dd02(0x1ab)](_0x16dd02(0x1b3)+_0x443543['id']);}catch(_0x23229e){Sentry[_0x16dd02(0x1bc)](_0x23229e);}}}async function handleUserConnection(_0x3d9a73){const _0x5150ec=a524_0x48ccec;try{const {id:_0xf9c49f}=_0x3d9a73[_0x5150ec(0x1a7)];if(!(0x0,lodash_1[_0x5150ec(0x19e)])(_0xf9c49f)&&_0xf9c49f!==_0x5150ec(0x18c)){const _0x3d96b6=await User_1[_0x5150ec(0x190)][_0x5150ec(0x18a)](_0xf9c49f);_0x3d96b6&&(_0x3d96b6['online']=!![],await _0x3d96b6[_0x5150ec(0x1b8)]());}}catch(_0x2e0c50){Sentry[_0x5150ec(0x1bc)](_0x2e0c50);}}function a524_0x3de6(_0x4fe768,_0x44a1d8){const _0x352b7b=a524_0x352b();return a524_0x3de6=function(_0x3de602,_0x58c6da){_0x3de602=_0x3de602-0x188;let _0x24681d=_0x352b7b[_0x3de602];return _0x24681d;},a524_0x3de6(_0x4fe768,_0x44a1d8);}exports[a524_0x48ccec(0x1b4)][a524_0x48ccec(0x192)]('UserConnection',handleUserConnection),exports[a524_0x48ccec(0x1b4)][a524_0x48ccec(0x192)](a524_0x48ccec(0x191),handleLoginStatus);async function initUserMonitorQueues(){const _0x120574=a524_0x48ccec,_0x5cb9d9=await exports[_0x120574(0x1b4)][_0x120574(0x193)]();for(let _0x5e665f of _0x5cb9d9){await exports[_0x120574(0x1b4)][_0x120574(0x1aa)](_0x5e665f[_0x120574(0x188)]);}exports[_0x120574(0x1b4)][_0x120574(0x1a9)](_0x120574(0x191),{},{'repeat':{'cron':_0x120574(0x199),'key':_0x120574(0x1b0)},'removeOnComplete':{'age':0x3c*0x3c,'count':0xa},'removeOnFail':{'age':0x3c*0x3c,'count':0xa}}),logger_1[_0x120574(0x19c)][_0x120574(0x1ab)]('Queue:\x20monitoramento\x20de\x20status\x20de\x20usuário\x20inicializado');}exports[a524_0x48ccec(0x189)]=initUserMonitorQueues;