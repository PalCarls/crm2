'use strict';const a648_0x59a578=a648_0x3fdb;(function(_0x2366b5,_0x486ddf){const _0x3bbc7e=a648_0x3fdb,_0x2504a3=_0x2366b5();while(!![]){try{const _0x5ded4f=parseInt(_0x3bbc7e(0x112))/0x1*(parseInt(_0x3bbc7e(0x126))/0x2)+parseInt(_0x3bbc7e(0x122))/0x3*(-parseInt(_0x3bbc7e(0x117))/0x4)+parseInt(_0x3bbc7e(0x145))/0x5*(parseInt(_0x3bbc7e(0x11a))/0x6)+-parseInt(_0x3bbc7e(0x137))/0x7+parseInt(_0x3bbc7e(0x132))/0x8*(-parseInt(_0x3bbc7e(0x11e))/0x9)+-parseInt(_0x3bbc7e(0x11c))/0xa*(parseInt(_0x3bbc7e(0x127))/0xb)+parseInt(_0x3bbc7e(0x130))/0xc;if(_0x5ded4f===_0x486ddf)break;else _0x2504a3['push'](_0x2504a3['shift']());}catch(_0x323b79){_0x2504a3['push'](_0x2504a3['shift']());}}}(a648_0x52c0,0x57c67));var __createBinding=this&&this['__createBinding']||(Object[a648_0x59a578(0x120)]?function(_0x203c08,_0x80f04,_0x55d9a4,_0x41a884){const _0x3063e6=a648_0x59a578;if(_0x41a884===undefined)_0x41a884=_0x55d9a4;var _0x1b6d93=Object[_0x3063e6(0x13e)](_0x80f04,_0x55d9a4);(!_0x1b6d93||('get'in _0x1b6d93?!_0x80f04[_0x3063e6(0x114)]:_0x1b6d93[_0x3063e6(0x139)]||_0x1b6d93[_0x3063e6(0x140)]))&&(_0x1b6d93={'enumerable':!![],'get':function(){return _0x80f04[_0x55d9a4];}}),Object['defineProperty'](_0x203c08,_0x41a884,_0x1b6d93);}:function(_0x254a05,_0x438c8c,_0x3f6fe5,_0x4967a1){if(_0x4967a1===undefined)_0x4967a1=_0x3f6fe5;_0x254a05[_0x4967a1]=_0x438c8c[_0x3f6fe5];}),__setModuleDefault=this&&this[a648_0x59a578(0x125)]||(Object[a648_0x59a578(0x120)]?function(_0x11c54f,_0x159b14){const _0x143150=a648_0x59a578;Object[_0x143150(0x12e)](_0x11c54f,_0x143150(0x12a),{'enumerable':!![],'value':_0x159b14});}:function(_0x144d25,_0x377c8){const _0x328b6c=a648_0x59a578;_0x144d25[_0x328b6c(0x12a)]=_0x377c8;}),__importStar=this&&this[a648_0x59a578(0x143)]||function(_0x46b185){const _0x96e83c=a648_0x59a578;if(_0x46b185&&_0x46b185['__esModule'])return _0x46b185;var _0x45f05c={};if(_0x46b185!=null){for(var _0x3a9e8d in _0x46b185)if(_0x3a9e8d!==_0x96e83c(0x12a)&&Object[_0x96e83c(0x128)][_0x96e83c(0x142)][_0x96e83c(0x13f)](_0x46b185,_0x3a9e8d))__createBinding(_0x45f05c,_0x46b185,_0x3a9e8d);}return __setModuleDefault(_0x45f05c,_0x46b185),_0x45f05c;},__importDefault=this&&this[a648_0x59a578(0x13b)]||function(_0x5d4acf){const _0x3a150b=a648_0x59a578;return _0x5d4acf&&_0x5d4acf[_0x3a150b(0x114)]?_0x5d4acf:{'default':_0x5d4acf};};function a648_0x52c0(){const _0x89c4e1=['writable','save','__importDefault','Usuário\x20passado\x20para\x20offline:\x20','verify-login-status','getOwnPropertyDescriptor','call','configurable','initUserMonitorQueues','hasOwnProperty','__importStar','data','120erWSIL','captureException','sequelize','8BZbmNi','./database','__esModule','online','bull','660904kAWOCG','*\x20*\x20*\x20*\x20*','add','55674uuTpCB','./models/User','10HcVrSW','SELECT','9WkRUIy','process','create','env','9CSDtDH','removeRepeatableByKey','findByPk','__setModuleDefault','80204TGXKsm','907434aEbNtC','prototype','VerifyLoginStatus','default','REDIS_URI','logger','UserConnection','defineProperty','update','9290712DCiRnF','info','25616cypbvX','Queue:\x20monitoramento\x20de\x20status\x20de\x20usuário\x20inicializado','query','key','QueryTypes','2637859JpPjxl','userMonitor'];a648_0x52c0=function(){return _0x89c4e1;};return a648_0x52c0();}function a648_0x3fdb(_0x40e36f,_0x4b2581){const _0x52c067=a648_0x52c0();return a648_0x3fdb=function(_0x3fdb7f,_0x26ce13){_0x3fdb7f=_0x3fdb7f-0x112;let _0x3ba511=_0x52c067[_0x3fdb7f];return _0x3ba511;},a648_0x3fdb(_0x40e36f,_0x4b2581);}Object[a648_0x59a578(0x12e)](exports,a648_0x59a578(0x114),{'value':!![]}),exports[a648_0x59a578(0x141)]=exports[a648_0x59a578(0x138)]=void 0x0;const bull_1=__importDefault(require(a648_0x59a578(0x116))),Sentry=__importStar(require('@sentry/node')),sequelize_1=require(a648_0x59a578(0x147)),lodash_1=require('lodash'),logger_1=require('./utils/logger'),database_1=__importDefault(require(a648_0x59a578(0x113))),User_1=__importDefault(require(a648_0x59a578(0x11b))),connection=process[a648_0x59a578(0x121)][a648_0x59a578(0x12b)]||'';exports[a648_0x59a578(0x138)]=new bull_1[(a648_0x59a578(0x12a))]('UserMonitor',connection);async function handleLoginStatus(_0x23609d){const _0x5591a7=a648_0x59a578,_0x1dd96f=await database_1['default'][_0x5591a7(0x134)]('select\x20id\x20from\x20\x22Users\x22\x20where\x20\x22updatedAt\x22\x20<\x20now()\x20-\x20\x275\x20minutes\x27::interval\x20and\x20online\x20=\x20true',{'type':sequelize_1[_0x5591a7(0x136)][_0x5591a7(0x11d)]});for(let _0x1a17fe of _0x1dd96f){try{const _0x5a7c5f=await User_1['default'][_0x5591a7(0x124)](_0x1a17fe['id']);await _0x5a7c5f[_0x5591a7(0x12f)]({'online':![]}),logger_1[_0x5591a7(0x12c)]['info'](_0x5591a7(0x13c)+_0x1a17fe['id']);}catch(_0x23f98b){Sentry[_0x5591a7(0x146)](_0x23f98b);}}}async function handleUserConnection(_0x1be3d3){const _0x34b07a=a648_0x59a578;try{const {id:_0x45c0cd}=_0x1be3d3[_0x34b07a(0x144)];if(!(0x0,lodash_1['isNil'])(_0x45c0cd)&&_0x45c0cd!=='null'){const _0x896e2f=await User_1[_0x34b07a(0x12a)][_0x34b07a(0x124)](_0x45c0cd);_0x896e2f&&(_0x896e2f[_0x34b07a(0x115)]=!![],await _0x896e2f[_0x34b07a(0x13a)]());}}catch(_0x3b8795){Sentry[_0x34b07a(0x146)](_0x3b8795);}}exports['userMonitor'][a648_0x59a578(0x11f)](a648_0x59a578(0x12d),handleUserConnection),exports[a648_0x59a578(0x138)][a648_0x59a578(0x11f)](a648_0x59a578(0x129),handleLoginStatus);async function initUserMonitorQueues(){const _0x860fe3=a648_0x59a578,_0x4d8e2a=await exports[_0x860fe3(0x138)]['getRepeatableJobs']();for(let _0x4886f9 of _0x4d8e2a){await exports[_0x860fe3(0x138)][_0x860fe3(0x123)](_0x4886f9[_0x860fe3(0x135)]);}exports[_0x860fe3(0x138)][_0x860fe3(0x119)](_0x860fe3(0x129),{},{'repeat':{'cron':_0x860fe3(0x118),'key':_0x860fe3(0x13d)},'removeOnComplete':{'age':0x3c*0x3c,'count':0xa},'removeOnFail':{'age':0x3c*0x3c,'count':0xa}}),logger_1[_0x860fe3(0x12c)][_0x860fe3(0x131)](_0x860fe3(0x133));}exports['initUserMonitorQueues']=initUserMonitorQueues;