'use strict';const a640_0x59f138=a640_0x4f67;(function(_0x1f856a,_0x552a47){const _0x3d31d8=a640_0x4f67,_0x111ff2=_0x1f856a();while(!![]){try{const _0x3259cb=-parseInt(_0x3d31d8(0x1d7))/0x1*(-parseInt(_0x3d31d8(0x1e2))/0x2)+-parseInt(_0x3d31d8(0x1bd))/0x3+-parseInt(_0x3d31d8(0x1ce))/0x4*(-parseInt(_0x3d31d8(0x1c9))/0x5)+parseInt(_0x3d31d8(0x1cf))/0x6*(parseInt(_0x3d31d8(0x1d2))/0x7)+-parseInt(_0x3d31d8(0x1d4))/0x8+-parseInt(_0x3d31d8(0x1e9))/0x9+parseInt(_0x3d31d8(0x1ed))/0xa*(parseInt(_0x3d31d8(0x1da))/0xb);if(_0x3259cb===_0x552a47)break;else _0x111ff2['push'](_0x111ff2['shift']());}catch(_0x25cf1c){_0x111ff2['push'](_0x111ff2['shift']());}}}(a640_0xcb47,0x812bf));var __createBinding=this&&this[a640_0x59f138(0x1cd)]||(Object[a640_0x59f138(0x1cb)]?function(_0x86bad9,_0xe2967f,_0x1bb0dc,_0x59ece8){const _0x513dea=a640_0x59f138;if(_0x59ece8===undefined)_0x59ece8=_0x1bb0dc;var _0x51e029=Object['getOwnPropertyDescriptor'](_0xe2967f,_0x1bb0dc);(!_0x51e029||('get'in _0x51e029?!_0xe2967f[_0x513dea(0x1ec)]:_0x51e029[_0x513dea(0x1d0)]||_0x51e029['configurable']))&&(_0x51e029={'enumerable':!![],'get':function(){return _0xe2967f[_0x1bb0dc];}}),Object[_0x513dea(0x1e6)](_0x86bad9,_0x59ece8,_0x51e029);}:function(_0x51d161,_0x5e49b8,_0x2eeaef,_0x4b222c){if(_0x4b222c===undefined)_0x4b222c=_0x2eeaef;_0x51d161[_0x4b222c]=_0x5e49b8[_0x2eeaef];}),__setModuleDefault=this&&this[a640_0x59f138(0x1c6)]||(Object[a640_0x59f138(0x1cb)]?function(_0x1f6ab3,_0x1ae7b3){Object['defineProperty'](_0x1f6ab3,'default',{'enumerable':!![],'value':_0x1ae7b3});}:function(_0x1f46a5,_0x451f38){_0x1f46a5['default']=_0x451f38;}),__importStar=this&&this[a640_0x59f138(0x1c5)]||function(_0x59dd9c){const _0x2d7bf1=a640_0x59f138;if(_0x59dd9c&&_0x59dd9c[_0x2d7bf1(0x1ec)])return _0x59dd9c;var _0x3dd96d={};if(_0x59dd9c!=null){for(var _0x512d3a in _0x59dd9c)if(_0x512d3a!==_0x2d7bf1(0x1c0)&&Object['prototype'][_0x2d7bf1(0x1d5)]['call'](_0x59dd9c,_0x512d3a))__createBinding(_0x3dd96d,_0x59dd9c,_0x512d3a);}return __setModuleDefault(_0x3dd96d,_0x59dd9c),_0x3dd96d;},__importDefault=this&&this['__importDefault']||function(_0x3b1bf9){return _0x3b1bf9&&_0x3b1bf9['__esModule']?_0x3b1bf9:{'default':_0x3b1bf9};};Object[a640_0x59f138(0x1e6)](exports,a640_0x59f138(0x1ec),{'value':!![]}),exports[a640_0x59f138(0x1d8)]=exports[a640_0x59f138(0x1ea)]=void 0x0;const bull_1=__importDefault(require(a640_0x59f138(0x1de))),Sentry=__importStar(require('@sentry/node')),sequelize_1=require(a640_0x59f138(0x1db)),lodash_1=require(a640_0x59f138(0x1d1)),logger_1=require(a640_0x59f138(0x1eb)),database_1=__importDefault(require('./database')),User_1=__importDefault(require(a640_0x59f138(0x1dc))),connection=process['env'][a640_0x59f138(0x1c4)]||'';exports['userMonitor']=new bull_1[(a640_0x59f138(0x1c0))](a640_0x59f138(0x1c1),connection);function a640_0x4f67(_0x37a989,_0x5c587c){const _0xcb47c8=a640_0xcb47();return a640_0x4f67=function(_0x4f6707,_0x4cab37){_0x4f6707=_0x4f6707-0x1bd;let _0x2aff70=_0xcb47c8[_0x4f6707];return _0x2aff70;},a640_0x4f67(_0x37a989,_0x5c587c);}async function handleLoginStatus(_0x1e7805){const _0x5acd61=a640_0x59f138,_0x455c93=await database_1[_0x5acd61(0x1c0)]['query'](_0x5acd61(0x1e1),{'type':sequelize_1[_0x5acd61(0x1c8)]['SELECT']});for(let _0x524dff of _0x455c93){try{const _0xfcc864=await User_1['default'][_0x5acd61(0x1c3)](_0x524dff['id']);await _0xfcc864[_0x5acd61(0x1c7)]({'online':![]}),logger_1[_0x5acd61(0x1c2)][_0x5acd61(0x1be)](_0x5acd61(0x1d3)+_0x524dff['id']);}catch(_0x2b17b2){Sentry[_0x5acd61(0x1e3)](_0x2b17b2);}}}async function handleUserConnection(_0x3638c1){const _0x362862=a640_0x59f138;try{const {id:_0x2c5fce}=_0x3638c1[_0x362862(0x1e0)];if(!(0x0,lodash_1['isNil'])(_0x2c5fce)&&_0x2c5fce!==_0x362862(0x1df)){const _0x53d4bb=await User_1[_0x362862(0x1c0)][_0x362862(0x1c3)](_0x2c5fce);_0x53d4bb&&(_0x53d4bb['online']=!![],await _0x53d4bb[_0x362862(0x1dd)]());}}catch(_0x710a38){Sentry[_0x362862(0x1e3)](_0x710a38);}}exports[a640_0x59f138(0x1ea)][a640_0x59f138(0x1e5)](a640_0x59f138(0x1e8),handleUserConnection),exports['userMonitor'][a640_0x59f138(0x1e5)]('VerifyLoginStatus',handleLoginStatus);function a640_0xcb47(){const _0xe77a3b=['process','defineProperty','add','UserConnection','1149876CFowDd','userMonitor','./utils/logger','__esModule','159970EKWqND','2426727ebNKnI','info','VerifyLoginStatus','default','UserMonitor','logger','findByPk','REDIS_URI','__importStar','__setModuleDefault','update','QueryTypes','5KgBfzp','getRepeatableJobs','create','*\x20*\x20*\x20*\x20*','__createBinding','2076860PuYXyT','12438HjYXHt','writable','lodash','196NOwlBC','Usuário\x20passado\x20para\x20offline:\x20','1554800jsMlsN','hasOwnProperty','Queue:\x20monitoramento\x20de\x20status\x20de\x20usuário\x20inicializado','1elXFjW','initUserMonitorQueues','verify-login-status','286qXYgrk','sequelize','./models/User','save','bull','null','data','select\x20id\x20from\x20\x22Users\x22\x20where\x20\x22updatedAt\x22\x20<\x20now()\x20-\x20\x275\x20minutes\x27::interval\x20and\x20online\x20=\x20true','1333858fBMhln','captureException','key'];a640_0xcb47=function(){return _0xe77a3b;};return a640_0xcb47();}async function initUserMonitorQueues(){const _0x5e41ec=a640_0x59f138,_0xcabad3=await exports[_0x5e41ec(0x1ea)][_0x5e41ec(0x1ca)]();for(let _0x4f74bb of _0xcabad3){await exports['userMonitor']['removeRepeatableByKey'](_0x4f74bb[_0x5e41ec(0x1e4)]);}exports[_0x5e41ec(0x1ea)][_0x5e41ec(0x1e7)](_0x5e41ec(0x1bf),{},{'repeat':{'cron':_0x5e41ec(0x1cc),'key':_0x5e41ec(0x1d9)},'removeOnComplete':{'age':0x3c*0x3c,'count':0xa},'removeOnFail':{'age':0x3c*0x3c,'count':0xa}}),logger_1['logger']['info'](_0x5e41ec(0x1d6));}exports['initUserMonitorQueues']=initUserMonitorQueues;