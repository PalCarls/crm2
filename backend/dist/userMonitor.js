<<<<<<< HEAD
'use strict';const a626_0x25f9c6=a626_0x2baa;(function(_0x19a4db,_0x2ab131){const _0x4e3254=a626_0x2baa,_0x1400a0=_0x19a4db();while(!![]){try{const _0x224283=parseInt(_0x4e3254(0x144))/0x1*(parseInt(_0x4e3254(0x141))/0x2)+parseInt(_0x4e3254(0x146))/0x3*(parseInt(_0x4e3254(0x119))/0x4)+parseInt(_0x4e3254(0x13e))/0x5*(-parseInt(_0x4e3254(0x129))/0x6)+-parseInt(_0x4e3254(0x13b))/0x7*(-parseInt(_0x4e3254(0x11e))/0x8)+parseInt(_0x4e3254(0x122))/0x9+-parseInt(_0x4e3254(0x13a))/0xa+-parseInt(_0x4e3254(0x145))/0xb*(parseInt(_0x4e3254(0x14b))/0xc);if(_0x224283===_0x2ab131)break;else _0x1400a0['push'](_0x1400a0['shift']());}catch(_0xecdadb){_0x1400a0['push'](_0x1400a0['shift']());}}}(a626_0x4697,0x41890));var __createBinding=this&&this[a626_0x25f9c6(0x13f)]||(Object[a626_0x25f9c6(0x11d)]?function(_0x15ca99,_0x3210a8,_0x3430ba,_0x154076){const _0x23f352=a626_0x25f9c6;if(_0x154076===undefined)_0x154076=_0x3430ba;var _0x40ad66=Object[_0x23f352(0x12f)](_0x3210a8,_0x3430ba);(!_0x40ad66||('get'in _0x40ad66?!_0x3210a8['__esModule']:_0x40ad66[_0x23f352(0x136)]||_0x40ad66[_0x23f352(0x131)]))&&(_0x40ad66={'enumerable':!![],'get':function(){return _0x3210a8[_0x3430ba];}}),Object['defineProperty'](_0x15ca99,_0x154076,_0x40ad66);}:function(_0x3d0ae0,_0x4825ce,_0x327119,_0x96128){if(_0x96128===undefined)_0x96128=_0x327119;_0x3d0ae0[_0x96128]=_0x4825ce[_0x327119];}),__setModuleDefault=this&&this[a626_0x25f9c6(0x127)]||(Object[a626_0x25f9c6(0x11d)]?function(_0x3cfbf3,_0x2181e1){const _0x445ce2=a626_0x25f9c6;Object[_0x445ce2(0x143)](_0x3cfbf3,_0x445ce2(0x137),{'enumerable':!![],'value':_0x2181e1});}:function(_0x1e9482,_0x34a3c5){const _0x169e6c=a626_0x25f9c6;_0x1e9482[_0x169e6c(0x137)]=_0x34a3c5;}),__importStar=this&&this['__importStar']||function(_0x1f1544){const _0x4a7f2f=a626_0x25f9c6;if(_0x1f1544&&_0x1f1544[_0x4a7f2f(0x140)])return _0x1f1544;var _0xbb8383={};if(_0x1f1544!=null){for(var _0x25cdd8 in _0x1f1544)if(_0x25cdd8!==_0x4a7f2f(0x137)&&Object[_0x4a7f2f(0x12e)][_0x4a7f2f(0x130)][_0x4a7f2f(0x132)](_0x1f1544,_0x25cdd8))__createBinding(_0xbb8383,_0x1f1544,_0x25cdd8);}return __setModuleDefault(_0xbb8383,_0x1f1544),_0xbb8383;},__importDefault=this&&this[a626_0x25f9c6(0x125)]||function(_0x52744a){return _0x52744a&&_0x52744a['__esModule']?_0x52744a:{'default':_0x52744a};};Object['defineProperty'](exports,a626_0x25f9c6(0x140),{'value':!![]}),exports[a626_0x25f9c6(0x120)]=exports[a626_0x25f9c6(0x135)]=void 0x0;function a626_0x4697(){const _0x2fefce=['hasOwnProperty','configurable','call','./database','lodash','userMonitor','writable','default','env','select\x20id\x20from\x20\x22Users\x22\x20where\x20\x22updatedAt\x22\x20<\x20now()\x20-\x20\x275\x20minutes\x27::interval\x20and\x20online\x20=\x20true','3619030oDPSHp','3720220toaycH','Usuário\x20passado\x20para\x20offline:\x20','info','5WarEFI','__createBinding','__esModule','188UqQVbt','QueryTypes','defineProperty','2145hgezTT','3729gaZJic','4869pCxqXz','update','findByPk','VerifyLoginStatus','./utils/logger','37668XbwaVA','1252HtJWWn','process','add','bull','create','8LKWPFg','captureException','initUserMonitorQueues','isNil','4406994quXgpS','*\x20*\x20*\x20*\x20*','save','__importDefault','online','__setModuleDefault','getRepeatableJobs','217794FwdjNR','query','verify-login-status','logger','data','prototype','getOwnPropertyDescriptor'];a626_0x4697=function(){return _0x2fefce;};return a626_0x4697();}const bull_1=__importDefault(require(a626_0x25f9c6(0x11c))),Sentry=__importStar(require('@sentry/node')),sequelize_1=require('sequelize'),lodash_1=require(a626_0x25f9c6(0x134)),logger_1=require(a626_0x25f9c6(0x14a)),database_1=__importDefault(require(a626_0x25f9c6(0x133))),User_1=__importDefault(require('./models/User')),connection=process[a626_0x25f9c6(0x138)]['REDIS_URI']||'';exports[a626_0x25f9c6(0x135)]=new bull_1[(a626_0x25f9c6(0x137))]('UserMonitor',connection);async function handleLoginStatus(_0x4185b5){const _0x417369=a626_0x25f9c6,_0xd6b573=await database_1['default'][_0x417369(0x12a)](_0x417369(0x139),{'type':sequelize_1[_0x417369(0x142)]['SELECT']});for(let _0x83f8b8 of _0xd6b573){try{const _0x5c860b=await User_1[_0x417369(0x137)][_0x417369(0x148)](_0x83f8b8['id']);await _0x5c860b[_0x417369(0x147)]({'online':![]}),logger_1['logger'][_0x417369(0x13d)](_0x417369(0x13c)+_0x83f8b8['id']);}catch(_0x29eeca){Sentry[_0x417369(0x11f)](_0x29eeca);}}}async function handleUserConnection(_0x180b1c){const _0x5f129e=a626_0x25f9c6;try{const {id:_0xb9408d}=_0x180b1c[_0x5f129e(0x12d)];if(!(0x0,lodash_1[_0x5f129e(0x121)])(_0xb9408d)&&_0xb9408d!=='null'){const _0x5ec2c5=await User_1[_0x5f129e(0x137)][_0x5f129e(0x148)](_0xb9408d);_0x5ec2c5&&(_0x5ec2c5[_0x5f129e(0x126)]=!![],await _0x5ec2c5[_0x5f129e(0x124)]());}}catch(_0x3f09d7){Sentry[_0x5f129e(0x11f)](_0x3f09d7);}}function a626_0x2baa(_0x1f5720,_0x1f0bce){const _0x4697bb=a626_0x4697();return a626_0x2baa=function(_0x2baad1,_0x51d84b){_0x2baad1=_0x2baad1-0x119;let _0x566c1f=_0x4697bb[_0x2baad1];return _0x566c1f;},a626_0x2baa(_0x1f5720,_0x1f0bce);}exports['userMonitor']['process']('UserConnection',handleUserConnection),exports['userMonitor'][a626_0x25f9c6(0x11a)](a626_0x25f9c6(0x149),handleLoginStatus);async function initUserMonitorQueues(){const _0x5b0b47=a626_0x25f9c6,_0x2001dc=await exports[_0x5b0b47(0x135)][_0x5b0b47(0x128)]();for(let _0x5c8016 of _0x2001dc){await exports[_0x5b0b47(0x135)]['removeRepeatableByKey'](_0x5c8016['key']);}exports[_0x5b0b47(0x135)][_0x5b0b47(0x11b)](_0x5b0b47(0x149),{},{'repeat':{'cron':_0x5b0b47(0x123),'key':_0x5b0b47(0x12b)},'removeOnComplete':{'age':0x3c*0x3c,'count':0xa},'removeOnFail':{'age':0x3c*0x3c,'count':0xa}}),logger_1[_0x5b0b47(0x12c)][_0x5b0b47(0x13d)]('Queue:\x20monitoramento\x20de\x20status\x20de\x20usuário\x20inicializado');}exports[a626_0x25f9c6(0x120)]=initUserMonitorQueues;
=======
'use strict';const a625_0x27ee3c=a625_0x4f60;(function(_0x1c17c7,_0x33d38e){const _0x10d1a9=a625_0x4f60,_0x5064af=_0x1c17c7();while(!![]){try{const _0x29614c=parseInt(_0x10d1a9(0x1f7))/0x1*(-parseInt(_0x10d1a9(0x1f8))/0x2)+-parseInt(_0x10d1a9(0x1e5))/0x3*(-parseInt(_0x10d1a9(0x1c9))/0x4)+parseInt(_0x10d1a9(0x1d1))/0x5*(-parseInt(_0x10d1a9(0x1f0))/0x6)+parseInt(_0x10d1a9(0x1db))/0x7+parseInt(_0x10d1a9(0x1fa))/0x8*(parseInt(_0x10d1a9(0x1fc))/0x9)+-parseInt(_0x10d1a9(0x1d4))/0xa+-parseInt(_0x10d1a9(0x1dd))/0xb*(-parseInt(_0x10d1a9(0x1f5))/0xc);if(_0x29614c===_0x33d38e)break;else _0x5064af['push'](_0x5064af['shift']());}catch(_0x17c5c5){_0x5064af['push'](_0x5064af['shift']());}}}(a625_0x9a39,0x4f146));var __createBinding=this&&this[a625_0x27ee3c(0x1ce)]||(Object[a625_0x27ee3c(0x1dc)]?function(_0x14e486,_0x2c59c8,_0x4a2a64,_0x2629c1){const _0x5e1046=a625_0x27ee3c;if(_0x2629c1===undefined)_0x2629c1=_0x4a2a64;var _0x25b860=Object[_0x5e1046(0x1d8)](_0x2c59c8,_0x4a2a64);(!_0x25b860||('get'in _0x25b860?!_0x2c59c8[_0x5e1046(0x1e7)]:_0x25b860[_0x5e1046(0x1d0)]||_0x25b860[_0x5e1046(0x1ee)]))&&(_0x25b860={'enumerable':!![],'get':function(){return _0x2c59c8[_0x4a2a64];}}),Object[_0x5e1046(0x1e0)](_0x14e486,_0x2629c1,_0x25b860);}:function(_0x445307,_0xe9fdba,_0x38abf8,_0x1c823e){if(_0x1c823e===undefined)_0x1c823e=_0x38abf8;_0x445307[_0x1c823e]=_0xe9fdba[_0x38abf8];}),__setModuleDefault=this&&this[a625_0x27ee3c(0x1cd)]||(Object[a625_0x27ee3c(0x1dc)]?function(_0xf881e0,_0x4ed740){const _0x250937=a625_0x27ee3c;Object['defineProperty'](_0xf881e0,_0x250937(0x1ca),{'enumerable':!![],'value':_0x4ed740});}:function(_0x3b03c2,_0x274861){const _0x92102e=a625_0x27ee3c;_0x3b03c2[_0x92102e(0x1ca)]=_0x274861;}),__importStar=this&&this[a625_0x27ee3c(0x1f1)]||function(_0x491781){const _0xa6e6df=a625_0x27ee3c;if(_0x491781&&_0x491781['__esModule'])return _0x491781;var _0x31ffeb={};if(_0x491781!=null){for(var _0x16292b in _0x491781)if(_0x16292b!==_0xa6e6df(0x1ca)&&Object[_0xa6e6df(0x1d9)][_0xa6e6df(0x1e4)][_0xa6e6df(0x1e9)](_0x491781,_0x16292b))__createBinding(_0x31ffeb,_0x491781,_0x16292b);}return __setModuleDefault(_0x31ffeb,_0x491781),_0x31ffeb;},__importDefault=this&&this[a625_0x27ee3c(0x1ec)]||function(_0x530244){const _0xf6645e=a625_0x27ee3c;return _0x530244&&_0x530244[_0xf6645e(0x1e7)]?_0x530244:{'default':_0x530244};};Object['defineProperty'](exports,a625_0x27ee3c(0x1e7),{'value':!![]}),exports[a625_0x27ee3c(0x1f9)]=exports[a625_0x27ee3c(0x1d5)]=void 0x0;const bull_1=__importDefault(require(a625_0x27ee3c(0x1f6))),Sentry=__importStar(require(a625_0x27ee3c(0x1f4))),sequelize_1=require(a625_0x27ee3c(0x1d6)),lodash_1=require('lodash'),logger_1=require('./utils/logger'),database_1=__importDefault(require('./database')),User_1=__importDefault(require(a625_0x27ee3c(0x1df))),connection=process['env']['REDIS_URI']||'';exports[a625_0x27ee3c(0x1d5)]=new bull_1[(a625_0x27ee3c(0x1ca))]('UserMonitor',connection);function a625_0x4f60(_0x3d857b,_0x57cd50){const _0x9a39f1=a625_0x9a39();return a625_0x4f60=function(_0x4f60aa,_0x103628){_0x4f60aa=_0x4f60aa-0x1c8;let _0x3708a1=_0x9a39f1[_0x4f60aa];return _0x3708a1;},a625_0x4f60(_0x3d857b,_0x57cd50);}async function handleLoginStatus(_0x5b456c){const _0xd81fa3=a625_0x27ee3c,_0x3c0293=await database_1[_0xd81fa3(0x1ca)][_0xd81fa3(0x1e8)](_0xd81fa3(0x1cc),{'type':sequelize_1[_0xd81fa3(0x1d7)][_0xd81fa3(0x1c8)]});for(let _0x2b8f9a of _0x3c0293){try{const _0x1c1a21=await User_1[_0xd81fa3(0x1ca)][_0xd81fa3(0x1ef)](_0x2b8f9a['id']);await _0x1c1a21['update']({'online':![]}),logger_1[_0xd81fa3(0x1cf)][_0xd81fa3(0x1ea)](_0xd81fa3(0x1f2)+_0x2b8f9a['id']);}catch(_0x4d1195){Sentry['captureException'](_0x4d1195);}}}async function handleUserConnection(_0x22010d){const _0x744de0=a625_0x27ee3c;try{const {id:_0x31a3d1}=_0x22010d[_0x744de0(0x1de)];if(!(0x0,lodash_1[_0x744de0(0x1da)])(_0x31a3d1)&&_0x31a3d1!==_0x744de0(0x1ed)){const _0x5ad0fb=await User_1['default'][_0x744de0(0x1ef)](_0x31a3d1);_0x5ad0fb&&(_0x5ad0fb['online']=!![],await _0x5ad0fb[_0x744de0(0x1e3)]());}}catch(_0xbdb847){Sentry[_0x744de0(0x1e1)](_0xbdb847);}}exports['userMonitor'][a625_0x27ee3c(0x1e2)](a625_0x27ee3c(0x1cb),handleUserConnection),exports[a625_0x27ee3c(0x1d5)][a625_0x27ee3c(0x1e2)](a625_0x27ee3c(0x1fb),handleLoginStatus);async function initUserMonitorQueues(){const _0x3d3250=a625_0x27ee3c,_0x4387e0=await exports['userMonitor']['getRepeatableJobs']();for(let _0x18d394 of _0x4387e0){await exports[_0x3d3250(0x1d5)][_0x3d3250(0x1d2)](_0x18d394[_0x3d3250(0x1e6)]);}exports[_0x3d3250(0x1d5)][_0x3d3250(0x1f3)](_0x3d3250(0x1fb),{},{'repeat':{'cron':_0x3d3250(0x1eb),'key':_0x3d3250(0x1d3)},'removeOnComplete':{'age':0x3c*0x3c,'count':0xa},'removeOnFail':{'age':0x3c*0x3c,'count':0xa}}),logger_1['logger'][_0x3d3250(0x1ea)]('Queue:\x20monitoramento\x20de\x20status\x20de\x20usuário\x20inicializado');}exports[a625_0x27ee3c(0x1f9)]=initUserMonitorQueues;function a625_0x9a39(){const _0x1325a9=['__importStar','Usuário\x20passado\x20para\x20offline:\x20','add','@sentry/node','656280qRQPge','bull','159801vpRrRp','2YdKWmQ','initUserMonitorQueues','2296TnODhL','VerifyLoginStatus','17883APTixm','SELECT','333820tQVBIh','default','UserConnection','select\x20id\x20from\x20\x22Users\x22\x20where\x20\x22updatedAt\x22\x20<\x20now()\x20-\x20\x275\x20minutes\x27::interval\x20and\x20online\x20=\x20true','__setModuleDefault','__createBinding','logger','writable','25LMZhWS','removeRepeatableByKey','verify-login-status','4949340NRSNPg','userMonitor','sequelize','QueryTypes','getOwnPropertyDescriptor','prototype','isNil','4349212kvEJxW','create','22xjNrKv','data','./models/User','defineProperty','captureException','process','save','hasOwnProperty','3hQAKfx','key','__esModule','query','call','info','*\x20*\x20*\x20*\x20*','__importDefault','null','configurable','findByPk','486930aWkfyX'];a625_0x9a39=function(){return _0x1325a9;};return a625_0x9a39();}
>>>>>>> ab722bfbcf394d74dd0b99a984c0dcf6ffbcff7f
