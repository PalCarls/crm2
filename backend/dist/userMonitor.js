'use strict';const a579_0x5caf1d=a579_0x1c9f;(function(_0x105f73,_0x20d20a){const _0x560b38=a579_0x1c9f,_0x2f8e0f=_0x105f73();while(!![]){try{const _0x4a76c8=-parseInt(_0x560b38(0x199))/0x1+-parseInt(_0x560b38(0x1b4))/0x2*(parseInt(_0x560b38(0x194))/0x3)+-parseInt(_0x560b38(0x1bb))/0x4*(-parseInt(_0x560b38(0x1b9))/0x5)+parseInt(_0x560b38(0x1ac))/0x6*(parseInt(_0x560b38(0x1a1))/0x7)+parseInt(_0x560b38(0x1b0))/0x8+-parseInt(_0x560b38(0x198))/0x9+parseInt(_0x560b38(0x1b8))/0xa*(-parseInt(_0x560b38(0x189))/0xb);if(_0x4a76c8===_0x20d20a)break;else _0x2f8e0f['push'](_0x2f8e0f['shift']());}catch(_0x4e2fa1){_0x2f8e0f['push'](_0x2f8e0f['shift']());}}}(a579_0x498d,0x3f6a6));var __createBinding=this&&this[a579_0x5caf1d(0x1a6)]||(Object[a579_0x5caf1d(0x1a3)]?function(_0x17c125,_0x2c36c0,_0x3ce340,_0x356204){const _0x35ecac=a579_0x5caf1d;if(_0x356204===undefined)_0x356204=_0x3ce340;var _0x3cfca9=Object[_0x35ecac(0x1b5)](_0x2c36c0,_0x3ce340);(!_0x3cfca9||(_0x35ecac(0x19c)in _0x3cfca9?!_0x2c36c0[_0x35ecac(0x191)]:_0x3cfca9['writable']||_0x3cfca9[_0x35ecac(0x1af)]))&&(_0x3cfca9={'enumerable':!![],'get':function(){return _0x2c36c0[_0x3ce340];}}),Object[_0x35ecac(0x18e)](_0x17c125,_0x356204,_0x3cfca9);}:function(_0x291740,_0x2a5bec,_0x23d007,_0x20415e){if(_0x20415e===undefined)_0x20415e=_0x23d007;_0x291740[_0x20415e]=_0x2a5bec[_0x23d007];}),__setModuleDefault=this&&this[a579_0x5caf1d(0x18a)]||(Object[a579_0x5caf1d(0x1a3)]?function(_0x382297,_0x3dbf98){const _0x175d7f=a579_0x5caf1d;Object['defineProperty'](_0x382297,_0x175d7f(0x1bc),{'enumerable':!![],'value':_0x3dbf98});}:function(_0x293471,_0x273699){const _0x4db274=a579_0x5caf1d;_0x293471[_0x4db274(0x1bc)]=_0x273699;}),__importStar=this&&this[a579_0x5caf1d(0x1be)]||function(_0x471f3b){const _0xe5cfa7=a579_0x5caf1d;if(_0x471f3b&&_0x471f3b[_0xe5cfa7(0x191)])return _0x471f3b;var _0x3cec19={};if(_0x471f3b!=null){for(var _0x26602b in _0x471f3b)if(_0x26602b!=='default'&&Object[_0xe5cfa7(0x19d)][_0xe5cfa7(0x19a)][_0xe5cfa7(0x1ad)](_0x471f3b,_0x26602b))__createBinding(_0x3cec19,_0x471f3b,_0x26602b);}return __setModuleDefault(_0x3cec19,_0x471f3b),_0x3cec19;},__importDefault=this&&this['__importDefault']||function(_0x3df845){const _0x5e1992=a579_0x5caf1d;return _0x3df845&&_0x3df845[_0x5e1992(0x191)]?_0x3df845:{'default':_0x3df845};};Object[a579_0x5caf1d(0x18e)](exports,a579_0x5caf1d(0x191),{'value':!![]}),exports['initUserMonitorQueues']=exports['userMonitor']=void 0x0;const bull_1=__importDefault(require(a579_0x5caf1d(0x1ae))),Sentry=__importStar(require(a579_0x5caf1d(0x19f))),sequelize_1=require(a579_0x5caf1d(0x19b)),lodash_1=require('lodash'),logger_1=require('./utils/logger'),database_1=__importDefault(require('./database')),User_1=__importDefault(require(a579_0x5caf1d(0x18f))),connection=process[a579_0x5caf1d(0x1b3)][a579_0x5caf1d(0x1b6)]||'';exports[a579_0x5caf1d(0x1ba)]=new bull_1[(a579_0x5caf1d(0x1bc))](a579_0x5caf1d(0x1b2),connection);async function handleLoginStatus(_0xeea79a){const _0x2a83b8=a579_0x5caf1d,_0x16df4f=await database_1[_0x2a83b8(0x1bc)][_0x2a83b8(0x1a0)](_0x2a83b8(0x195),{'type':sequelize_1[_0x2a83b8(0x1b7)][_0x2a83b8(0x18b)]});for(let _0x5f4411 of _0x16df4f){try{const _0x36cba6=await User_1[_0x2a83b8(0x1bc)][_0x2a83b8(0x1b1)](_0x5f4411['id']);await _0x36cba6[_0x2a83b8(0x1ab)]({'online':![]}),logger_1[_0x2a83b8(0x1aa)][_0x2a83b8(0x1a9)](_0x2a83b8(0x1bf)+_0x5f4411['id']);}catch(_0x45d086){Sentry['captureException'](_0x45d086);}}}async function handleUserConnection(_0x2293e3){const _0x4b2118=a579_0x5caf1d;try{const {id:_0x1158ef}=_0x2293e3[_0x4b2118(0x1a2)];if(!(0x0,lodash_1[_0x4b2118(0x18c)])(_0x1158ef)&&_0x1158ef!==_0x4b2118(0x1a7)){const _0x261219=await User_1[_0x4b2118(0x1bc)][_0x4b2118(0x1b1)](_0x1158ef);_0x261219&&(_0x261219[_0x4b2118(0x190)]=!![],await _0x261219['save']());}}catch(_0x29a39d){Sentry[_0x4b2118(0x1a5)](_0x29a39d);}}function a579_0x498d(){const _0x463b78=['prototype','VerifyLoginStatus','@sentry/node','query','64183QrtVlU','data','create','verify-login-status','captureException','__createBinding','null','Queue:\x20monitoramento\x20de\x20status\x20de\x20usuário\x20inicializado','info','logger','update','180yYUnGt','call','bull','configurable','2387664udgCbX','findByPk','UserMonitor','env','2YYscXy','getOwnPropertyDescriptor','REDIS_URI','QueryTypes','70PMhTGM','710250ctcbHC','userMonitor','12sVqbjV','default','add','__importStar','Usuário\x20passado\x20para\x20offline:\x20','24893aEBNMe','__setModuleDefault','SELECT','isNil','UserConnection','defineProperty','./models/User','online','__esModule','removeRepeatableByKey','process','804417xEVPHb','select\x20id\x20from\x20\x22Users\x22\x20where\x20\x22updatedAt\x22\x20<\x20now()\x20-\x20\x275\x20minutes\x27::interval\x20and\x20online\x20=\x20true','key','*\x20*\x20*\x20*\x20*','3400245rwYeiu','78143efgcUk','hasOwnProperty','sequelize','get'];a579_0x498d=function(){return _0x463b78;};return a579_0x498d();}function a579_0x1c9f(_0x2edab1,_0xbc96aa){const _0x498de0=a579_0x498d();return a579_0x1c9f=function(_0x1c9fe6,_0x93ac6a){_0x1c9fe6=_0x1c9fe6-0x189;let _0x3f6ade=_0x498de0[_0x1c9fe6];return _0x3f6ade;},a579_0x1c9f(_0x2edab1,_0xbc96aa);}exports['userMonitor']['process'](a579_0x5caf1d(0x18d),handleUserConnection),exports[a579_0x5caf1d(0x1ba)][a579_0x5caf1d(0x193)]('VerifyLoginStatus',handleLoginStatus);async function initUserMonitorQueues(){const _0x57d8a3=a579_0x5caf1d,_0x1f5c9d=await exports['userMonitor']['getRepeatableJobs']();for(let _0x31680d of _0x1f5c9d){await exports[_0x57d8a3(0x1ba)][_0x57d8a3(0x192)](_0x31680d[_0x57d8a3(0x196)]);}exports[_0x57d8a3(0x1ba)][_0x57d8a3(0x1bd)](_0x57d8a3(0x19e),{},{'repeat':{'cron':_0x57d8a3(0x197),'key':_0x57d8a3(0x1a4)},'removeOnComplete':{'age':0x3c*0x3c,'count':0xa},'removeOnFail':{'age':0x3c*0x3c,'count':0xa}}),logger_1['logger'][_0x57d8a3(0x1a9)](_0x57d8a3(0x1a8));}exports['initUserMonitorQueues']=initUserMonitorQueues;