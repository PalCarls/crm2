'use strict';const a640_0x16efc2=a640_0x25cd;(function(_0x2e2967,_0x5c6694){const _0x5170ae=a640_0x25cd,_0x2e6347=_0x2e2967();while(!![]){try{const _0x2d56f9=parseInt(_0x5170ae(0xae))/0x1+parseInt(_0x5170ae(0x8a))/0x2+-parseInt(_0x5170ae(0x89))/0x3*(-parseInt(_0x5170ae(0x9c))/0x4)+parseInt(_0x5170ae(0xa9))/0x5*(-parseInt(_0x5170ae(0x9a))/0x6)+-parseInt(_0x5170ae(0xa5))/0x7*(parseInt(_0x5170ae(0x8c))/0x8)+parseInt(_0x5170ae(0x97))/0x9+-parseInt(_0x5170ae(0x98))/0xa;if(_0x2d56f9===_0x5c6694)break;else _0x2e6347['push'](_0x2e6347['shift']());}catch(_0x23d6c2){_0x2e6347['push'](_0x2e6347['shift']());}}}(a640_0x33c5,0x4512e));var __createBinding=this&&this[a640_0x16efc2(0x94)]||(Object['create']?function(_0x33c61a,_0x40d282,_0x4655bd,_0x29bfce){const _0x54a40d=a640_0x16efc2;if(_0x29bfce===undefined)_0x29bfce=_0x4655bd;var _0x5b5ba2=Object[_0x54a40d(0xb7)](_0x40d282,_0x4655bd);(!_0x5b5ba2||(_0x54a40d(0x91)in _0x5b5ba2?!_0x40d282['__esModule']:_0x5b5ba2['writable']||_0x5b5ba2[_0x54a40d(0x93)]))&&(_0x5b5ba2={'enumerable':!![],'get':function(){return _0x40d282[_0x4655bd];}}),Object[_0x54a40d(0x99)](_0x33c61a,_0x29bfce,_0x5b5ba2);}:function(_0x5e4d4e,_0x370247,_0x221294,_0x16a70d){if(_0x16a70d===undefined)_0x16a70d=_0x221294;_0x5e4d4e[_0x16a70d]=_0x370247[_0x221294];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a640_0x16efc2(0x96)]?function(_0x75de1d,_0x306616){const _0x2fe043=a640_0x16efc2;Object[_0x2fe043(0x99)](_0x75de1d,'default',{'enumerable':!![],'value':_0x306616});}:function(_0x2a6245,_0x2d4fb2){_0x2a6245['default']=_0x2d4fb2;}),__importStar=this&&this['__importStar']||function(_0x13c074){const _0x39f7b3=a640_0x16efc2;if(_0x13c074&&_0x13c074[_0x39f7b3(0x92)])return _0x13c074;var _0x58ad82={};if(_0x13c074!=null){for(var _0x3ca5c0 in _0x13c074)if(_0x3ca5c0!==_0x39f7b3(0xa8)&&Object[_0x39f7b3(0x9e)][_0x39f7b3(0x86)][_0x39f7b3(0xaa)](_0x13c074,_0x3ca5c0))__createBinding(_0x58ad82,_0x13c074,_0x3ca5c0);}return __setModuleDefault(_0x58ad82,_0x13c074),_0x58ad82;},__importDefault=this&&this[a640_0x16efc2(0xa0)]||function(_0x47c7b4){const _0x3a99fd=a640_0x16efc2;return _0x47c7b4&&_0x47c7b4[_0x3a99fd(0x92)]?_0x47c7b4:{'default':_0x47c7b4};};Object[a640_0x16efc2(0x99)](exports,a640_0x16efc2(0x92),{'value':!![]}),exports[a640_0x16efc2(0xad)]=exports[a640_0x16efc2(0xb0)]=void 0x0;const bull_1=__importDefault(require(a640_0x16efc2(0xa6))),Sentry=__importStar(require(a640_0x16efc2(0x9b))),sequelize_1=require(a640_0x16efc2(0xa7)),lodash_1=require(a640_0x16efc2(0x9d)),logger_1=require(a640_0x16efc2(0xa2)),database_1=__importDefault(require('./database')),User_1=__importDefault(require('./models/User')),connection=process[a640_0x16efc2(0xb5)][a640_0x16efc2(0x8d)]||'';exports['userMonitor']=new bull_1['default'](a640_0x16efc2(0xb2),connection);async function handleLoginStatus(_0x5e7411){const _0x413a31=a640_0x16efc2,_0x59f9f4=await database_1[_0x413a31(0xa8)][_0x413a31(0x8f)](_0x413a31(0x8b),{'type':sequelize_1[_0x413a31(0xa4)][_0x413a31(0xb3)]});for(let _0xbe1ef4 of _0x59f9f4){try{const _0x2d108b=await User_1[_0x413a31(0xa8)][_0x413a31(0x90)](_0xbe1ef4['id']);await _0x2d108b['update']({'online':![]}),logger_1[_0x413a31(0xb6)][_0x413a31(0x87)](_0x413a31(0xa3)+_0xbe1ef4['id']);}catch(_0x195354){Sentry[_0x413a31(0xab)](_0x195354);}}}function a640_0x25cd(_0x416f95,_0x3c225f){const _0x33c514=a640_0x33c5();return a640_0x25cd=function(_0x25cd6c,_0x11898b){_0x25cd6c=_0x25cd6c-0x85;let _0xac7d6d=_0x33c514[_0x25cd6c];return _0xac7d6d;},a640_0x25cd(_0x416f95,_0x3c225f);}async function handleUserConnection(_0x1ece02){const _0x2e1793=a640_0x16efc2;try{const {id:_0x442826}=_0x1ece02[_0x2e1793(0xa1)];if(!(0x0,lodash_1['isNil'])(_0x442826)&&_0x442826!==_0x2e1793(0xb1)){const _0x1ca281=await User_1[_0x2e1793(0xa8)][_0x2e1793(0x90)](_0x442826);_0x1ca281&&(_0x1ca281[_0x2e1793(0x85)]=!![],await _0x1ca281[_0x2e1793(0x9f)]());}}catch(_0x3e8415){Sentry[_0x2e1793(0xab)](_0x3e8415);}}exports[a640_0x16efc2(0xb0)][a640_0x16efc2(0xac)]('UserConnection',handleUserConnection),exports[a640_0x16efc2(0xb0)][a640_0x16efc2(0xac)]('VerifyLoginStatus',handleLoginStatus);async function initUserMonitorQueues(){const _0x2e1be3=a640_0x16efc2,_0x2d3bc5=await exports[_0x2e1be3(0xb0)][_0x2e1be3(0xb4)]();for(let _0x2366e9 of _0x2d3bc5){await exports['userMonitor']['removeRepeatableByKey'](_0x2366e9[_0x2e1be3(0xaf)]);}exports[_0x2e1be3(0xb0)][_0x2e1be3(0x88)]('VerifyLoginStatus',{},{'repeat':{'cron':'*\x20*\x20*\x20*\x20*','key':_0x2e1be3(0x8e)},'removeOnComplete':{'age':0x3c*0x3c,'count':0xa},'removeOnFail':{'age':0x3c*0x3c,'count':0xa}}),logger_1[_0x2e1be3(0xb6)][_0x2e1be3(0x87)](_0x2e1be3(0x95));}exports['initUserMonitorQueues']=initUserMonitorQueues;function a640_0x33c5(){const _0x4cbb90=['1369312sufQQL','REDIS_URI','verify-login-status','query','findByPk','get','__esModule','configurable','__createBinding','Queue:\x20monitoramento\x20de\x20status\x20de\x20usuário\x20inicializado','create','2240316wUgkGd','3366530nZErkG','defineProperty','1831548yENZMh','@sentry/node','24YXeGVa','lodash','prototype','save','__importDefault','data','./utils/logger','Usuário\x20passado\x20para\x20offline:\x20','QueryTypes','7YcuQnB','bull','sequelize','default','5bpavyZ','call','captureException','process','initUserMonitorQueues','562338bDiMVT','key','userMonitor','null','UserMonitor','SELECT','getRepeatableJobs','env','logger','getOwnPropertyDescriptor','online','hasOwnProperty','info','add','71844RTEdyH','282102clGErZ','select\x20id\x20from\x20\x22Users\x22\x20where\x20\x22updatedAt\x22\x20<\x20now()\x20-\x20\x275\x20minutes\x27::interval\x20and\x20online\x20=\x20true'];a640_0x33c5=function(){return _0x4cbb90;};return a640_0x33c5();}