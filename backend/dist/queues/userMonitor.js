'use strict';const a345_0x52eea1=a345_0x5972;(function(_0x26d79b,_0x57cb38){const _0x241def=a345_0x5972,_0x16a293=_0x26d79b();while(!![]){try{const _0x407978=-parseInt(_0x241def(0xc1))/0x1+parseInt(_0x241def(0xd3))/0x2+-parseInt(_0x241def(0xdd))/0x3+parseInt(_0x241def(0xdc))/0x4+-parseInt(_0x241def(0xe4))/0x5*(parseInt(_0x241def(0xc8))/0x6)+-parseInt(_0x241def(0xd1))/0x7*(-parseInt(_0x241def(0xe7))/0x8)+parseInt(_0x241def(0xe6))/0x9*(parseInt(_0x241def(0xbd))/0xa);if(_0x407978===_0x57cb38)break;else _0x16a293['push'](_0x16a293['shift']());}catch(_0x252511){_0x16a293['push'](_0x16a293['shift']());}}}(a345_0xe1f0,0x8b884));function a345_0x5972(_0x53ac72,_0x342d0e){const _0xe1f0f0=a345_0xe1f0();return a345_0x5972=function(_0x59720a,_0x1bdf1f){_0x59720a=_0x59720a-0xba;let _0x14e937=_0xe1f0f0[_0x59720a];return _0x14e937;},a345_0x5972(_0x53ac72,_0x342d0e);}var __createBinding=this&&this[a345_0x52eea1(0xee)]||(Object['create']?function(_0x2d2ce8,_0x152da8,_0x20ccde,_0x881dba){const _0x33ef25=a345_0x52eea1;if(_0x881dba===undefined)_0x881dba=_0x20ccde;var _0x2e4896=Object[_0x33ef25(0xce)](_0x152da8,_0x20ccde);(!_0x2e4896||(_0x33ef25(0xbf)in _0x2e4896?!_0x152da8['__esModule']:_0x2e4896[_0x33ef25(0xcf)]||_0x2e4896[_0x33ef25(0xd7)]))&&(_0x2e4896={'enumerable':!![],'get':function(){return _0x152da8[_0x20ccde];}}),Object[_0x33ef25(0xd6)](_0x2d2ce8,_0x881dba,_0x2e4896);}:function(_0x590324,_0x172a3b,_0x481704,_0x476ece){if(_0x476ece===undefined)_0x476ece=_0x481704;_0x590324[_0x476ece]=_0x172a3b[_0x481704];}),__setModuleDefault=this&&this[a345_0x52eea1(0xd8)]||(Object[a345_0x52eea1(0xe5)]?function(_0x362c9e,_0x2fe832){const _0xd1dc7=a345_0x52eea1;Object[_0xd1dc7(0xd6)](_0x362c9e,_0xd1dc7(0xe8),{'enumerable':!![],'value':_0x2fe832});}:function(_0x2ee8a0,_0x3208e8){const _0x35e33a=a345_0x52eea1;_0x2ee8a0[_0x35e33a(0xe8)]=_0x3208e8;}),__importStar=this&&this[a345_0x52eea1(0xbe)]||function(_0x865a22){const _0x2fc37f=a345_0x52eea1;if(_0x865a22&&_0x865a22[_0x2fc37f(0xec)])return _0x865a22;var _0x2510ed={};if(_0x865a22!=null){for(var _0x365bc0 in _0x865a22)if(_0x365bc0!==_0x2fc37f(0xe8)&&Object['prototype'][_0x2fc37f(0xcc)][_0x2fc37f(0xdb)](_0x865a22,_0x365bc0))__createBinding(_0x2510ed,_0x865a22,_0x365bc0);}return __setModuleDefault(_0x2510ed,_0x865a22),_0x2510ed;},__importDefault=this&&this[a345_0x52eea1(0xd9)]||function(_0x40cdb0){return _0x40cdb0&&_0x40cdb0['__esModule']?_0x40cdb0:{'default':_0x40cdb0};};Object[a345_0x52eea1(0xd6)](exports,a345_0x52eea1(0xec),{'value':!![]}),exports[a345_0x52eea1(0xea)]=exports[a345_0x52eea1(0xc5)]=void 0x0;const bull_1=__importDefault(require(a345_0x52eea1(0xcd))),Sentry=__importStar(require('@sentry/node')),sequelize_1=require(a345_0x52eea1(0xf0)),lodash_1=require(a345_0x52eea1(0xca)),logger_1=require(a345_0x52eea1(0xdf)),database_1=__importDefault(require(a345_0x52eea1(0xeb))),User_1=__importDefault(require('../models/User')),connection=process[a345_0x52eea1(0xef)]['REDIS_URI']||'';exports[a345_0x52eea1(0xc5)]=new bull_1['default']('UserMonitor',connection);async function handleLoginStatus(_0x4974fa){const _0x298fd5=a345_0x52eea1,_0x16f0b2=await database_1[_0x298fd5(0xe8)]['query'](_0x298fd5(0xe3),{'type':sequelize_1[_0x298fd5(0xc0)][_0x298fd5(0xd2)]});for(let _0x2aa89b of _0x16f0b2){try{const _0x45c70f=await User_1[_0x298fd5(0xe8)][_0x298fd5(0xd5)](_0x2aa89b['id']);await _0x45c70f[_0x298fd5(0xc9)]({'online':![]}),logger_1['logger'][_0x298fd5(0xc7)](_0x298fd5(0xe2)+_0x2aa89b['id']);}catch(_0x5921af){Sentry['captureException'](_0x5921af);}}}function a345_0xe1f0(){const _0x5e2984=['sequelize','verify-loginstatus','getRepeatableJobs','key','127180cquJWb','__importStar','get','QueryTypes','709691XsxHAU','VerifyLoginStatus','Queue:\x20monitoramento\x20de\x20status\x20de\x20usu√°rio\x20inicializado','online','userMonitor','UserConnection','info','6Cemvsk','update','lodash','save','hasOwnProperty','bull','getOwnPropertyDescriptor','writable','logger','4217563mfjvNl','SELECT','1039642ULFFht','null','findByPk','defineProperty','configurable','__setModuleDefault','__importDefault','process','call','450724bHlVNh','1059084CgBrVi','data','../utils/logger','captureException','isNil','Usuario\x20passado\x20para\x20offline:\x20','select\x20id\x20from\x20\x22Users\x22\x20where\x20\x22updatedAt\x22\x20<\x20now()\x20-\x20\x275\x20minutes\x27::interval\x20and\x20online\x20=\x20true','1946420VMYXEn','create','558MsGjlL','8BCpyWT','default','add','initUserMonitorQueues','../database','__esModule','removeRepeatableByKey','__createBinding','env'];a345_0xe1f0=function(){return _0x5e2984;};return a345_0xe1f0();}async function handleUserConnection(_0x1233ea){const _0x3b8b92=a345_0x52eea1;try{const {id:_0x28f01d}=_0x1233ea[_0x3b8b92(0xde)];if(!(0x0,lodash_1[_0x3b8b92(0xe1)])(_0x28f01d)&&_0x28f01d!==_0x3b8b92(0xd4)){const _0x5a0e12=await User_1[_0x3b8b92(0xe8)][_0x3b8b92(0xd5)](_0x28f01d);_0x5a0e12&&(_0x5a0e12[_0x3b8b92(0xc4)]=!![],await _0x5a0e12[_0x3b8b92(0xcb)]());}}catch(_0x1fb325){Sentry[_0x3b8b92(0xe0)](_0x1fb325);}}exports[a345_0x52eea1(0xc5)][a345_0x52eea1(0xda)](a345_0x52eea1(0xc6),handleUserConnection),exports[a345_0x52eea1(0xc5)][a345_0x52eea1(0xda)](a345_0x52eea1(0xc2),handleLoginStatus);async function initUserMonitorQueues(){const _0x126d70=a345_0x52eea1,_0x10e708=await exports[_0x126d70(0xc5)][_0x126d70(0xbb)]();for(let _0x599008 of _0x10e708){await exports[_0x126d70(0xc5)][_0x126d70(0xed)](_0x599008[_0x126d70(0xbc)]);}exports[_0x126d70(0xc5)][_0x126d70(0xe9)](_0x126d70(0xc2),{},{'repeat':{'cron':'*\x20*\x20*\x20*\x20*','key':_0x126d70(0xba)},'removeOnComplete':{'age':0x3c*0x3c,'count':0xa},'removeOnFail':{'age':0x3c*0x3c,'count':0xa}}),logger_1[_0x126d70(0xd0)][_0x126d70(0xc7)](_0x126d70(0xc3));}exports[a345_0x52eea1(0xea)]=initUserMonitorQueues;