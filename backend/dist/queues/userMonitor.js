'use strict';function a345_0x1403(_0x2c3c14,_0x3fd135){const _0x8aeedd=a345_0x8aee();return a345_0x1403=function(_0x1403a2,_0x2ad49a){_0x1403a2=_0x1403a2-0x1c9;let _0x2a496a=_0x8aeedd[_0x1403a2];return _0x2a496a;},a345_0x1403(_0x2c3c14,_0x3fd135);}const a345_0x18b246=a345_0x1403;(function(_0x20798f,_0x42be12){const _0x38c611=a345_0x1403,_0x5cc56f=_0x20798f();while(!![]){try{const _0x18037c=-parseInt(_0x38c611(0x1cc))/0x1*(-parseInt(_0x38c611(0x1f8))/0x2)+-parseInt(_0x38c611(0x1f1))/0x3+parseInt(_0x38c611(0x1d1))/0x4*(-parseInt(_0x38c611(0x1e8))/0x5)+-parseInt(_0x38c611(0x1e5))/0x6*(-parseInt(_0x38c611(0x1d6))/0x7)+-parseInt(_0x38c611(0x1f7))/0x8*(-parseInt(_0x38c611(0x1d7))/0x9)+-parseInt(_0x38c611(0x1d5))/0xa+-parseInt(_0x38c611(0x1c9))/0xb*(-parseInt(_0x38c611(0x1ec))/0xc);if(_0x18037c===_0x42be12)break;else _0x5cc56f['push'](_0x5cc56f['shift']());}catch(_0x5e0696){_0x5cc56f['push'](_0x5cc56f['shift']());}}}(a345_0x8aee,0xc1b91));var __createBinding=this&&this['__createBinding']||(Object[a345_0x18b246(0x1f3)]?function(_0x5e250f,_0x1faf68,_0x151ac8,_0x24bcd2){const _0x51df5e=a345_0x18b246;if(_0x24bcd2===undefined)_0x24bcd2=_0x151ac8;var _0x256639=Object[_0x51df5e(0x1eb)](_0x1faf68,_0x151ac8);(!_0x256639||(_0x51df5e(0x1e6)in _0x256639?!_0x1faf68[_0x51df5e(0x1db)]:_0x256639[_0x51df5e(0x1e0)]||_0x256639['configurable']))&&(_0x256639={'enumerable':!![],'get':function(){return _0x1faf68[_0x151ac8];}}),Object[_0x51df5e(0x1e3)](_0x5e250f,_0x24bcd2,_0x256639);}:function(_0x388357,_0x3f962b,_0x2e3122,_0x49c1a1){if(_0x49c1a1===undefined)_0x49c1a1=_0x2e3122;_0x388357[_0x49c1a1]=_0x3f962b[_0x2e3122];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a345_0x18b246(0x1f3)]?function(_0x50a0a9,_0x31b9d6){Object['defineProperty'](_0x50a0a9,'default',{'enumerable':!![],'value':_0x31b9d6});}:function(_0x25efe3,_0x28ea7b){const _0x4a3076=a345_0x18b246;_0x25efe3[_0x4a3076(0x1e7)]=_0x28ea7b;}),__importStar=this&&this[a345_0x18b246(0x1ca)]||function(_0x1747dd){const _0x3ab7ce=a345_0x18b246;if(_0x1747dd&&_0x1747dd[_0x3ab7ce(0x1db)])return _0x1747dd;var _0xaeae3e={};if(_0x1747dd!=null){for(var _0x758856 in _0x1747dd)if(_0x758856!==_0x3ab7ce(0x1e7)&&Object['prototype'][_0x3ab7ce(0x1cd)][_0x3ab7ce(0x1f5)](_0x1747dd,_0x758856))__createBinding(_0xaeae3e,_0x1747dd,_0x758856);}return __setModuleDefault(_0xaeae3e,_0x1747dd),_0xaeae3e;},__importDefault=this&&this[a345_0x18b246(0x1cb)]||function(_0x212c18){const _0x10cdff=a345_0x18b246;return _0x212c18&&_0x212c18[_0x10cdff(0x1db)]?_0x212c18:{'default':_0x212c18};};Object[a345_0x18b246(0x1e3)](exports,a345_0x18b246(0x1db),{'value':!![]}),exports[a345_0x18b246(0x1d2)]=exports[a345_0x18b246(0x1e4)]=void 0x0;const bull_1=__importDefault(require('bull')),Sentry=__importStar(require(a345_0x18b246(0x1d8))),sequelize_1=require(a345_0x18b246(0x1ef)),lodash_1=require('lodash'),logger_1=require(a345_0x18b246(0x1e1)),database_1=__importDefault(require('../database')),User_1=__importDefault(require('../models/User')),connection=process['env']['REDIS_URI']||'';exports[a345_0x18b246(0x1e4)]=new bull_1[(a345_0x18b246(0x1e7))](a345_0x18b246(0x1d3),connection);function a345_0x8aee(){const _0x1403bb=['logger','VerifyLoginStatus','sequelize','online','2399337bxVjzu','process','create','update','call','null','4904TiRkis','847012IwvKtW','12672EhSOIl','__importStar','__importDefault','1TIuwXS','hasOwnProperty','data','query','findByPk','8YbYiJb','initUserMonitorQueues','UserMonitor','Usuario\x20passado\x20para\x20offline:\x20','702790IugpFY','3231515iHocxD','11142ONqFmS','@sentry/node','QueryTypes','info','__esModule','verify-loginstatus','UserConnection','save','add','writable','../utils/logger','removeRepeatableByKey','defineProperty','userMonitor','6fXWNWf','get','default','1045645DVEXNR','key','captureException','getOwnPropertyDescriptor','4560QwheTL'];a345_0x8aee=function(){return _0x1403bb;};return a345_0x8aee();}async function handleLoginStatus(_0x1177de){const _0x8be490=a345_0x18b246,_0x1540cc=await database_1[_0x8be490(0x1e7)][_0x8be490(0x1cf)]('select\x20id\x20from\x20\x22Users\x22\x20where\x20\x22updatedAt\x22\x20<\x20now()\x20-\x20\x275\x20minutes\x27::interval\x20and\x20online\x20=\x20true',{'type':sequelize_1[_0x8be490(0x1d9)]['SELECT']});for(let _0x48ff43 of _0x1540cc){try{const _0xcb319c=await User_1['default']['findByPk'](_0x48ff43['id']);await _0xcb319c[_0x8be490(0x1f4)]({'online':![]}),logger_1[_0x8be490(0x1ed)][_0x8be490(0x1da)](_0x8be490(0x1d4)+_0x48ff43['id']);}catch(_0x557106){Sentry[_0x8be490(0x1ea)](_0x557106);}}}async function handleUserConnection(_0x566984){const _0x10448f=a345_0x18b246;try{const {id:_0xb985a6}=_0x566984[_0x10448f(0x1ce)];if(!(0x0,lodash_1['isNil'])(_0xb985a6)&&_0xb985a6!==_0x10448f(0x1f6)){const _0x1bc95d=await User_1[_0x10448f(0x1e7)][_0x10448f(0x1d0)](_0xb985a6);_0x1bc95d&&(_0x1bc95d[_0x10448f(0x1f0)]=!![],await _0x1bc95d[_0x10448f(0x1de)]());}}catch(_0x5e790c){Sentry[_0x10448f(0x1ea)](_0x5e790c);}}exports[a345_0x18b246(0x1e4)][a345_0x18b246(0x1f2)](a345_0x18b246(0x1dd),handleUserConnection),exports[a345_0x18b246(0x1e4)]['process'](a345_0x18b246(0x1ee),handleLoginStatus);async function initUserMonitorQueues(){const _0x1beedf=a345_0x18b246,_0x45339c=await exports[_0x1beedf(0x1e4)]['getRepeatableJobs']();for(let _0x44a4ad of _0x45339c){await exports['userMonitor'][_0x1beedf(0x1e2)](_0x44a4ad[_0x1beedf(0x1e9)]);}exports['userMonitor'][_0x1beedf(0x1df)]('VerifyLoginStatus',{},{'repeat':{'cron':'*\x20*\x20*\x20*\x20*','key':_0x1beedf(0x1dc)},'removeOnComplete':{'age':0x3c*0x3c,'count':0xa},'removeOnFail':{'age':0x3c*0x3c,'count':0xa}}),logger_1['logger']['info']('Queue:\x20monitoramento\x20de\x20status\x20de\x20usuÃ¡rio\x20inicializado');}exports['initUserMonitorQueues']=initUserMonitorQueues;