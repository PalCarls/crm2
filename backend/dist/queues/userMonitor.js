'use strict';const a304_0x236ba7=a304_0x4f7b;(function(_0x15e71f,_0x2c565a){const _0x46e61e=a304_0x4f7b,_0x43ebd6=_0x15e71f();while(!![]){try{const _0x1f2e8b=-parseInt(_0x46e61e(0x10a))/0x1+parseInt(_0x46e61e(0xef))/0x2+parseInt(_0x46e61e(0x11b))/0x3*(-parseInt(_0x46e61e(0x114))/0x4)+-parseInt(_0x46e61e(0xf1))/0x5+parseInt(_0x46e61e(0x102))/0x6*(-parseInt(_0x46e61e(0xe9))/0x7)+-parseInt(_0x46e61e(0xe8))/0x8*(-parseInt(_0x46e61e(0x118))/0x9)+-parseInt(_0x46e61e(0x103))/0xa*(-parseInt(_0x46e61e(0xf2))/0xb);if(_0x1f2e8b===_0x2c565a)break;else _0x43ebd6['push'](_0x43ebd6['shift']());}catch(_0x48febe){_0x43ebd6['push'](_0x43ebd6['shift']());}}}(a304_0x4989,0xe9018));var __createBinding=this&&this[a304_0x236ba7(0xf6)]||(Object['create']?function(_0xd57f7b,_0x43f074,_0x123673,_0x4364d){const _0x8d10e=a304_0x236ba7;if(_0x4364d===undefined)_0x4364d=_0x123673;var _0x2b7a43=Object[_0x8d10e(0x10b)](_0x43f074,_0x123673);(!_0x2b7a43||(_0x8d10e(0x100)in _0x2b7a43?!_0x43f074[_0x8d10e(0xfb)]:_0x2b7a43[_0x8d10e(0x110)]||_0x2b7a43['configurable']))&&(_0x2b7a43={'enumerable':!![],'get':function(){return _0x43f074[_0x123673];}}),Object[_0x8d10e(0xed)](_0xd57f7b,_0x4364d,_0x2b7a43);}:function(_0x5d47d2,_0x32f1a6,_0x35ec90,_0x2b533b){if(_0x2b533b===undefined)_0x2b533b=_0x35ec90;_0x5d47d2[_0x2b533b]=_0x32f1a6[_0x35ec90];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a304_0x236ba7(0xfd)]?function(_0x445a23,_0x298bd9){const _0xe5dabd=a304_0x236ba7;Object[_0xe5dabd(0xed)](_0x445a23,_0xe5dabd(0xf0),{'enumerable':!![],'value':_0x298bd9});}:function(_0x1a78de,_0x1799ae){const _0x19e44e=a304_0x236ba7;_0x1a78de[_0x19e44e(0xf0)]=_0x1799ae;}),__importStar=this&&this['__importStar']||function(_0x16b180){const _0x5d63e7=a304_0x236ba7;if(_0x16b180&&_0x16b180['__esModule'])return _0x16b180;var _0x288a93={};if(_0x16b180!=null){for(var _0x1ff88d in _0x16b180)if(_0x1ff88d!==_0x5d63e7(0xf0)&&Object[_0x5d63e7(0xf4)]['hasOwnProperty'][_0x5d63e7(0xf5)](_0x16b180,_0x1ff88d))__createBinding(_0x288a93,_0x16b180,_0x1ff88d);}return __setModuleDefault(_0x288a93,_0x16b180),_0x288a93;},__importDefault=this&&this[a304_0x236ba7(0x113)]||function(_0x25cbc3){const _0x4f190e=a304_0x236ba7;return _0x25cbc3&&_0x25cbc3[_0x4f190e(0xfb)]?_0x25cbc3:{'default':_0x25cbc3};};Object[a304_0x236ba7(0xed)](exports,a304_0x236ba7(0xfb),{'value':!![]}),exports[a304_0x236ba7(0xf7)]=exports[a304_0x236ba7(0x109)]=void 0x0;const bull_1=__importDefault(require(a304_0x236ba7(0x10f))),Sentry=__importStar(require('@sentry/node')),sequelize_1=require(a304_0x236ba7(0x11d)),lodash_1=require(a304_0x236ba7(0x119)),logger_1=require(a304_0x236ba7(0x106)),database_1=__importDefault(require(a304_0x236ba7(0x112))),User_1=__importDefault(require(a304_0x236ba7(0x11c))),connection=process[a304_0x236ba7(0xee)][a304_0x236ba7(0xf8)]||'';exports[a304_0x236ba7(0x109)]=new bull_1['default'](a304_0x236ba7(0xea),connection);async function handleLoginStatus(_0x5eb681){const _0x23d237=a304_0x236ba7,_0x42e4f9=await database_1['default'][_0x23d237(0xff)]('select\x20id\x20from\x20\x22Users\x22\x20where\x20\x22updatedAt\x22\x20<\x20now()\x20-\x20\x275\x20minutes\x27::interval\x20and\x20online\x20=\x20true',{'type':sequelize_1[_0x23d237(0x101)][_0x23d237(0x11a)]});for(let _0x203d51 of _0x42e4f9){try{const _0x109854=await User_1[_0x23d237(0xf0)]['findByPk'](_0x203d51['id']);await _0x109854[_0x23d237(0x104)]({'online':![]}),logger_1[_0x23d237(0xf3)][_0x23d237(0xfe)](_0x23d237(0x116)+_0x203d51['id']);}catch(_0x418f26){Sentry['captureException'](_0x418f26);}}}function a304_0x4f7b(_0x5f0b6a,_0x4b8fe6){const _0x49891e=a304_0x4989();return a304_0x4f7b=function(_0x4f7b13,_0x559aa2){_0x4f7b13=_0x4f7b13-0xe8;let _0x5ab21a=_0x49891e[_0x4f7b13];return _0x5ab21a;},a304_0x4f7b(_0x5f0b6a,_0x4b8fe6);}function a304_0x4989(){const _0x44b0e7=['339530eQLHcO','getOwnPropertyDescriptor','online','removeRepeatableByKey','key','bull','writable','VerifyLoginStatus','../database','__importDefault','52oxfufJ','save','Usuario\x20passado\x20para\x20offline:\x20','null','72HjYDrN','lodash','SELECT','421431ukUOTS','../models/User','sequelize','process','UserConnection','1740272nGedCT','28ojwFVq','UserMonitor','isNil','*\x20*\x20*\x20*\x20*','defineProperty','env','1709368GupHbH','default','7966420NGltpz','1969siujrT','logger','prototype','call','__createBinding','initUserMonitorQueues','REDIS_URI','captureException','getRepeatableJobs','__esModule','findByPk','create','info','query','get','QueryTypes','412974JNfSSa','133730eMjsKE','update','data','../utils/logger','verify-loginstatus','add','userMonitor'];a304_0x4989=function(){return _0x44b0e7;};return a304_0x4989();}async function handleUserConnection(_0x31784a){const _0x51bd4a=a304_0x236ba7;try{const {id:_0x21aa75}=_0x31784a[_0x51bd4a(0x105)];if(!(0x0,lodash_1[_0x51bd4a(0xeb)])(_0x21aa75)&&_0x21aa75!==_0x51bd4a(0x117)){const _0x2c1e82=await User_1[_0x51bd4a(0xf0)][_0x51bd4a(0xfc)](_0x21aa75);_0x2c1e82&&(_0x2c1e82[_0x51bd4a(0x10c)]=!![],await _0x2c1e82[_0x51bd4a(0x115)]());}}catch(_0x488334){Sentry[_0x51bd4a(0xf9)](_0x488334);}}exports[a304_0x236ba7(0x109)][a304_0x236ba7(0x11e)](a304_0x236ba7(0x11f),handleUserConnection),exports[a304_0x236ba7(0x109)][a304_0x236ba7(0x11e)](a304_0x236ba7(0x111),handleLoginStatus);async function initUserMonitorQueues(){const _0x39517=a304_0x236ba7,_0x29f756=await exports[_0x39517(0x109)][_0x39517(0xfa)]();for(let _0x34bd86 of _0x29f756){await exports[_0x39517(0x109)][_0x39517(0x10d)](_0x34bd86[_0x39517(0x10e)]);}exports[_0x39517(0x109)][_0x39517(0x108)](_0x39517(0x111),{},{'repeat':{'cron':_0x39517(0xec),'key':_0x39517(0x107)},'removeOnComplete':{'age':0x3c*0x3c,'count':0xa},'removeOnFail':{'age':0x3c*0x3c,'count':0xa}}),logger_1[_0x39517(0xf3)][_0x39517(0xfe)]('Queue:\x20monitoramento\x20de\x20status\x20de\x20usuÃ¡rio\x20inicializado');}exports[a304_0x236ba7(0xf7)]=initUserMonitorQueues;