'use strict';const a304_0x364599=a304_0x18e0;(function(_0x498b16,_0x38d6ce){const _0x324b93=a304_0x18e0,_0x4dd29d=_0x498b16();while(!![]){try{const _0x29e243=parseInt(_0x324b93(0x139))/0x1+-parseInt(_0x324b93(0x138))/0x2*(-parseInt(_0x324b93(0x12c))/0x3)+parseInt(_0x324b93(0x123))/0x4+-parseInt(_0x324b93(0x143))/0x5*(parseInt(_0x324b93(0x11a))/0x6)+parseInt(_0x324b93(0x135))/0x7+parseInt(_0x324b93(0x12a))/0x8*(-parseInt(_0x324b93(0x13e))/0x9)+-parseInt(_0x324b93(0x134))/0xa;if(_0x29e243===_0x38d6ce)break;else _0x4dd29d['push'](_0x4dd29d['shift']());}catch(_0x263dc3){_0x4dd29d['push'](_0x4dd29d['shift']());}}}(a304_0x4bff,0xb8aed));var __createBinding=this&&this['__createBinding']||(Object[a304_0x364599(0x11f)]?function(_0x5a8614,_0x10316b,_0x1fdd2d,_0x3c7bbc){const _0x3696f0=a304_0x364599;if(_0x3c7bbc===undefined)_0x3c7bbc=_0x1fdd2d;var _0x1a28e2=Object[_0x3696f0(0x12d)](_0x10316b,_0x1fdd2d);(!_0x1a28e2||(_0x3696f0(0x129)in _0x1a28e2?!_0x10316b[_0x3696f0(0x113)]:_0x1a28e2['writable']||_0x1a28e2[_0x3696f0(0x121)]))&&(_0x1a28e2={'enumerable':!![],'get':function(){return _0x10316b[_0x1fdd2d];}}),Object[_0x3696f0(0x118)](_0x5a8614,_0x3c7bbc,_0x1a28e2);}:function(_0x57d953,_0x4d5987,_0x26358a,_0x11b674){if(_0x11b674===undefined)_0x11b674=_0x26358a;_0x57d953[_0x11b674]=_0x4d5987[_0x26358a];}),__setModuleDefault=this&&this[a304_0x364599(0x131)]||(Object['create']?function(_0x34c9fe,_0x25a651){const _0xe00007=a304_0x364599;Object['defineProperty'](_0x34c9fe,_0xe00007(0x13c),{'enumerable':!![],'value':_0x25a651});}:function(_0x172db5,_0x36da49){const _0x496a28=a304_0x364599;_0x172db5[_0x496a28(0x13c)]=_0x36da49;}),__importStar=this&&this['__importStar']||function(_0x3cd372){const _0x5086bb=a304_0x364599;if(_0x3cd372&&_0x3cd372[_0x5086bb(0x113)])return _0x3cd372;var _0x3b9bbd={};if(_0x3cd372!=null){for(var _0x27186a in _0x3cd372)if(_0x27186a!=='default'&&Object[_0x5086bb(0x137)][_0x5086bb(0x124)][_0x5086bb(0x125)](_0x3cd372,_0x27186a))__createBinding(_0x3b9bbd,_0x3cd372,_0x27186a);}return __setModuleDefault(_0x3b9bbd,_0x3cd372),_0x3b9bbd;},__importDefault=this&&this['__importDefault']||function(_0xf2837f){return _0xf2837f&&_0xf2837f['__esModule']?_0xf2837f:{'default':_0xf2837f};};function a304_0x4bff(){const _0x1d0bb5=['13647740gdGnip','7073696CTRCAk','save','prototype','8026mMctCr','133176MCZVOI','info','@sentry/node','default','*\x20*\x20*\x20*\x20*','225LqBWuc','REDIS_URI','logger','isNil','update','1619005GnrFil','lodash','Queue:\x20monitoramento\x20de\x20status\x20de\x20usu√°rio\x20inicializado','__esModule','UserMonitor','query','userMonitor','select\x20id\x20from\x20\x22Users\x22\x20where\x20\x22updatedAt\x22\x20<\x20now()\x20-\x20\x275\x20minutes\x27::interval\x20and\x20online\x20=\x20true','defineProperty','env','6gQivGC','process','../database','UserConnection','sequelize','create','../utils/logger','configurable','captureException','1965016ELcocW','hasOwnProperty','call','data','bull','../models/User','get','101624ImowiX','SELECT','843NIExkN','getOwnPropertyDescriptor','Usuario\x20passado\x20para\x20offline:\x20','initUserMonitorQueues','add','__setModuleDefault','null','VerifyLoginStatus'];a304_0x4bff=function(){return _0x1d0bb5;};return a304_0x4bff();}Object[a304_0x364599(0x118)](exports,a304_0x364599(0x113),{'value':!![]}),exports[a304_0x364599(0x12f)]=exports['userMonitor']=void 0x0;const bull_1=__importDefault(require(a304_0x364599(0x127))),Sentry=__importStar(require(a304_0x364599(0x13b))),sequelize_1=require(a304_0x364599(0x11e)),lodash_1=require(a304_0x364599(0x144)),logger_1=require(a304_0x364599(0x120)),database_1=__importDefault(require(a304_0x364599(0x11c))),User_1=__importDefault(require(a304_0x364599(0x128))),connection=process[a304_0x364599(0x119)][a304_0x364599(0x13f)]||'';exports[a304_0x364599(0x116)]=new bull_1[(a304_0x364599(0x13c))](a304_0x364599(0x114),connection);async function handleLoginStatus(_0x40e7f5){const _0x28ba67=a304_0x364599,_0x131703=await database_1[_0x28ba67(0x13c)][_0x28ba67(0x115)](_0x28ba67(0x117),{'type':sequelize_1['QueryTypes'][_0x28ba67(0x12b)]});for(let _0x5bd6a3 of _0x131703){try{const _0x519897=await User_1['default']['findByPk'](_0x5bd6a3['id']);await _0x519897[_0x28ba67(0x142)]({'online':![]}),logger_1[_0x28ba67(0x140)][_0x28ba67(0x13a)](_0x28ba67(0x12e)+_0x5bd6a3['id']);}catch(_0x5b11ed){Sentry[_0x28ba67(0x122)](_0x5b11ed);}}}async function handleUserConnection(_0x1eb510){const _0x11fdaf=a304_0x364599;try{const {id:_0x58d324}=_0x1eb510[_0x11fdaf(0x126)];if(!(0x0,lodash_1[_0x11fdaf(0x141)])(_0x58d324)&&_0x58d324!==_0x11fdaf(0x132)){const _0x488eec=await User_1[_0x11fdaf(0x13c)]['findByPk'](_0x58d324);_0x488eec&&(_0x488eec['online']=!![],await _0x488eec[_0x11fdaf(0x136)]());}}catch(_0x32b76b){Sentry[_0x11fdaf(0x122)](_0x32b76b);}}function a304_0x18e0(_0xf96a5,_0x4f6127){const _0x4bff80=a304_0x4bff();return a304_0x18e0=function(_0x18e034,_0x4c219b){_0x18e034=_0x18e034-0x112;let _0x2f0258=_0x4bff80[_0x18e034];return _0x2f0258;},a304_0x18e0(_0xf96a5,_0x4f6127);}exports[a304_0x364599(0x116)][a304_0x364599(0x11b)](a304_0x364599(0x11d),handleUserConnection),exports[a304_0x364599(0x116)][a304_0x364599(0x11b)](a304_0x364599(0x133),handleLoginStatus);async function initUserMonitorQueues(){const _0x4ebaea=a304_0x364599,_0x391a8d=await exports[_0x4ebaea(0x116)]['getRepeatableJobs']();for(let _0x3d01eb of _0x391a8d){await exports[_0x4ebaea(0x116)]['removeRepeatableByKey'](_0x3d01eb['key']);}exports[_0x4ebaea(0x116)][_0x4ebaea(0x130)]('VerifyLoginStatus',{},{'repeat':{'cron':_0x4ebaea(0x13d),'key':'verify-loginstatus'},'removeOnComplete':{'age':0x3c*0x3c,'count':0xa},'removeOnFail':{'age':0x3c*0x3c,'count':0xa}}),logger_1['logger'][_0x4ebaea(0x13a)](_0x4ebaea(0x112));}exports['initUserMonitorQueues']=initUserMonitorQueues;