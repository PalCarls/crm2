'use strict';const a35_0x4a666c=a35_0xcff1;(function(_0xf1e95c,_0x1f8f7f){const _0x172170=a35_0xcff1,_0x409fef=_0xf1e95c();while(!![]){try{const _0x133267=-parseInt(_0x172170(0x155))/0x1+-parseInt(_0x172170(0x14a))/0x2*(parseInt(_0x172170(0x131))/0x3)+-parseInt(_0x172170(0x13b))/0x4+-parseInt(_0x172170(0x122))/0x5+parseInt(_0x172170(0x145))/0x6+parseInt(_0x172170(0x14d))/0x7*(-parseInt(_0x172170(0x157))/0x8)+parseInt(_0x172170(0x129))/0x9*(parseInt(_0x172170(0x11f))/0xa);if(_0x133267===_0x1f8f7f)break;else _0x409fef['push'](_0x409fef['shift']());}catch(_0x328701){_0x409fef['push'](_0x409fef['shift']());}}}(a35_0xc559,0xeef1d));var __importDefault=this&&this[a35_0x4a666c(0x14c)]||function(_0x5eff78){const _0x414fec=a35_0x4a666c;return _0x5eff78&&_0x5eff78[_0x414fec(0x14b)]?_0x5eff78:{'default':_0x5eff78};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a35_0x4a666c(0x124)]=exports['remove']=exports['update']=exports[a35_0x4a666c(0x15f)]=exports[a35_0x4a666c(0x165)]=exports[a35_0x4a666c(0x128)]=void 0x0;function a35_0xc559(){const _0x394e15=['969696BuycRT','toISOString','../services/UserServices/UpdateUserService','url','getDate','8BbujGU','__esModule','__importDefault','763406bJJaEs','../helpers/CheckSettings','getWbot','emit','getIO','SendMail','../libs/wbot','../services/CompanyService/ShowCompanyService','1307555NTEwXg','../errors/AppError','112LUqHVu','query','Login\x20e\x20senha\x20da\x20Empresa\x20','-user','useDate','../services/UserServices/ListUsersService','Você\x20não\x20possui\x20permissão\x20para\x20acessar\x20este\x20recurso!','delete','show','../services/CompanyService/CreateCompanyService',',\x20este\x20é\x20um\x20email\x20sobre\x20o\x20cadastro\x20da\x20','log','findOne','@s.whatsapp.net','store','status','setDate','json','update','../services/UserServices/ShowUserService','17771210BFckgH',',\x20este\x20é\x20uma\x20mensagem\x20sobre\x20o\x20cadastro\x20da\x20','params','9038750xjRwkU','profile','list','ERR_NO_PERMISSION','companyId','isEmpty','index','36REHqxR','../services/UserServices/DeleteUserService','/signup','DEMO','ERR_USER_CREATION_DISABLED','sendMessage','remove','<br>Senha:\x20','452973OiTnVV','<br>Email:\x20','default','company-','../services/UserServices/SimpleListService','../services/CompanyService/FindCompaniesWhatsappService','../libs/socket','admin','closed','<br>Data\x20Vencimento\x20Trial:\x20','4181208hWFkit','user','CONNECTED','whatsapps','env','Olá\x20','\x0aData\x20Vencimento\x20Trial:\x20','\x0aSenha:\x20','body','userCreation'];a35_0xc559=function(){return _0x394e15;};return a35_0xc559();}const socket_1=require(a35_0x4a666c(0x137)),lodash_1=require('lodash'),CheckSettings_1=__importDefault(require(a35_0x4a666c(0x14e))),AppError_1=__importDefault(require(a35_0x4a666c(0x156))),CreateUserService_1=__importDefault(require('../services/UserServices/CreateUserService')),ListUsersService_1=__importDefault(require(a35_0x4a666c(0x15c))),UpdateUserService_1=__importDefault(require(a35_0x4a666c(0x147))),ShowUserService_1=__importDefault(require(a35_0x4a666c(0x11e))),DeleteUserService_1=__importDefault(require(a35_0x4a666c(0x12a))),SimpleListService_1=__importDefault(require(a35_0x4a666c(0x135))),CreateCompanyService_1=__importDefault(require(a35_0x4a666c(0x160))),SendMail_1=require('../helpers/SendMail'),useDate_1=require('../utils/useDate'),ShowCompanyService_1=__importDefault(require(a35_0x4a666c(0x154))),wbot_1=require(a35_0x4a666c(0x153)),FindCompaniesWhatsappService_1=__importDefault(require(a35_0x4a666c(0x136))),User_1=__importDefault(require('../models/User')),index=async(_0x28eead,_0x43c04b)=>{const _0x140177=a35_0x4a666c,{searchParam:_0x23c0d6,pageNumber:_0x17493d}=_0x28eead[_0x140177(0x158)],{companyId:_0x343613,profile:_0x10919b}=_0x28eead['user'],{users:_0x100573,count:_0x459769,hasMore:_0x425217}=await(0x0,ListUsersService_1[_0x140177(0x133)])({'searchParam':_0x23c0d6,'pageNumber':_0x17493d,'companyId':_0x343613,'profile':_0x10919b});return _0x43c04b[_0x140177(0x11c)]({'users':_0x100573,'count':_0x459769,'hasMore':_0x425217});};exports[a35_0x4a666c(0x128)]=index;const store=async(_0x19b4be,_0x565775)=>{const _0x2a4a6d=a35_0x4a666c,{email:_0x3f629e,password:_0x1cf1a0,name:_0x5b7f1c,phone:_0x505e5a,profile:_0x421705,companyId:_0x284f1f,queueIds:_0x74b9df,companyName:_0x1a0ccd,planId:_0x37d688,startWork:_0x5bc43f,endWork:_0x1e9bd6,whatsappId:_0x1eba3e,allTicket:_0x2c9291,defaultTheme:_0xc8b1ae,defaultMenu:_0x441d8a,allowGroup:_0x2bb3a2}=_0x19b4be[_0x2a4a6d(0x143)];let _0x279179=null;const {dateToClient:_0x1abe45}=(0x0,useDate_1[_0x2a4a6d(0x15b)])();if(_0x19b4be[_0x2a4a6d(0x13c)]!==undefined){const {companyId:_0x4a1c6b}=_0x19b4be[_0x2a4a6d(0x13c)];_0x279179=_0x4a1c6b;}if(_0x19b4be[_0x2a4a6d(0x148)]===_0x2a4a6d(0x12b)&&await(0x0,CheckSettings_1[_0x2a4a6d(0x133)])(_0x2a4a6d(0x144))==='disabled')throw new AppError_1[(_0x2a4a6d(0x133))](_0x2a4a6d(0x12d),0x193);else{if(_0x19b4be[_0x2a4a6d(0x148)]!==_0x2a4a6d(0x12b)&&_0x19b4be[_0x2a4a6d(0x13c)][_0x2a4a6d(0x123)]!==_0x2a4a6d(0x138))throw new AppError_1[(_0x2a4a6d(0x133))](_0x2a4a6d(0x125),0x193);}if(process[_0x2a4a6d(0x13f)][_0x2a4a6d(0x12c)]==='ON')throw new AppError_1['default'](_0x2a4a6d(0x125),0x193);const _0x148220=_0x284f1f||_0x279179;if(!_0x148220){const _0x3fabc9=new Date();_0x3fabc9[_0x2a4a6d(0x11b)](_0x3fabc9[_0x2a4a6d(0x149)]()+0x3);const _0x4d0bd9=_0x3fabc9[_0x2a4a6d(0x146)]()['split']('T')[0x0],_0x12978c={'name':_0x1a0ccd,'email':_0x3f629e,'phone':_0x505e5a,'planId':_0x37d688,'status':!![],'dueDate':_0x4d0bd9,'recurrence':'','document':'','paymentMethod':'','password':_0x1cf1a0,'companyUserName':_0x5b7f1c,'startWork':_0x5bc43f,'endWork':_0x1e9bd6,'defaultTheme':'light','defaultMenu':_0x2a4a6d(0x139),'allowGroup':![]},_0x368d2d=await(0x0,CreateCompanyService_1['default'])(_0x12978c);try{const _0x462b9c={'to':_0x3f629e,'subject':_0x2a4a6d(0x159)+_0x1a0ccd,'text':'Olá\x20'+_0x5b7f1c+_0x2a4a6d(0x161)+_0x1a0ccd+'!<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20Segue\x20os\x20dados\x20da\x20sua\x20empresa:<br><br>Nome:\x20'+_0x1a0ccd+_0x2a4a6d(0x132)+_0x3f629e+_0x2a4a6d(0x130)+_0x1cf1a0+_0x2a4a6d(0x13a)+_0x1abe45(_0x4d0bd9)};await(0x0,SendMail_1[_0x2a4a6d(0x152)])(_0x462b9c);}catch(_0x5cc02c){console['log']('Não\x20consegui\x20enviar\x20o\x20email');}try{const _0x85def6=await(0x0,ShowCompanyService_1[_0x2a4a6d(0x133)])(0x1),_0x29bec4=await(0x0,FindCompaniesWhatsappService_1[_0x2a4a6d(0x133)])(_0x85def6['id']);if(_0x29bec4[_0x2a4a6d(0x13e)][0x0]['status']===_0x2a4a6d(0x13d)&&(_0x505e5a!==undefined||!(0x0,lodash_1['isNil'])(_0x505e5a)||!(0x0,lodash_1[_0x2a4a6d(0x127)])(_0x505e5a))){const _0x4c9d1e=_0x29bec4[_0x2a4a6d(0x13e)][0x0]['id'],_0x12f2c1=(0x0,wbot_1[_0x2a4a6d(0x14f)])(_0x4c9d1e),_0x1a03ac=_0x2a4a6d(0x140)+_0x5b7f1c+_0x2a4a6d(0x120)+_0x1a0ccd+'!\x0a\x0aSegue\x20os\x20dados\x20da\x20sua\x20empresa:\x0a\x0aNome:\x20'+_0x1a0ccd+'\x0aEmail:\x20'+_0x3f629e+_0x2a4a6d(0x142)+_0x1cf1a0+_0x2a4a6d(0x141)+_0x1abe45(_0x4d0bd9);await _0x12f2c1[_0x2a4a6d(0x12e)]('55'+_0x505e5a+_0x2a4a6d(0x164),{'text':_0x1a03ac});}}catch(_0x38824e){console[_0x2a4a6d(0x162)]('Não\x20consegui\x20enviar\x20a\x20mensagem');}return _0x565775['status'](0xc8)['json'](_0x368d2d);}if(_0x148220){const _0x1d2bea=await(0x0,CreateUserService_1[_0x2a4a6d(0x133)])({'email':_0x3f629e,'password':_0x1cf1a0,'name':_0x5b7f1c,'profile':_0x421705,'companyId':_0x148220,'queueIds':_0x74b9df,'startWork':_0x5bc43f,'endWork':_0x1e9bd6,'whatsappId':_0x1eba3e,'allTicket':_0x2c9291,'defaultTheme':_0xc8b1ae,'defaultMenu':_0x441d8a,'allowGroup':_0x2bb3a2}),_0xbf987d=(0x0,socket_1[_0x2a4a6d(0x151)])();return _0xbf987d[_0x2a4a6d(0x150)](_0x2a4a6d(0x134)+_0x279179+_0x2a4a6d(0x15a),{'action':'create','user':_0x1d2bea}),_0x565775[_0x2a4a6d(0x11a)](0xc8)['json'](_0x1d2bea);}};exports[a35_0x4a666c(0x165)]=store;const show=async(_0x588815,_0x145317)=>{const _0x30a811=a35_0x4a666c,{userId:_0x2bcbc7}=_0x588815[_0x30a811(0x121)],_0x39b3be=await(0x0,ShowUserService_1['default'])(_0x2bcbc7);return _0x145317['status'](0xc8)[_0x30a811(0x11c)](_0x39b3be);};exports[a35_0x4a666c(0x15f)]=show;const update=async(_0x2a8ea4,_0x1ef845)=>{const _0xb39a5f=a35_0x4a666c;if(_0x2a8ea4[_0xb39a5f(0x13c)]['profile']!==_0xb39a5f(0x138))throw new AppError_1[(_0xb39a5f(0x133))](_0xb39a5f(0x125),0x193);if(process['env']['DEMO']==='ON')throw new AppError_1[(_0xb39a5f(0x133))](_0xb39a5f(0x125),0x193);const {id:_0x426e4d,companyId:_0x159dce}=_0x2a8ea4[_0xb39a5f(0x13c)],{userId:_0x316271}=_0x2a8ea4['params'],_0x20fcdc=_0x2a8ea4['body'],_0x953d52=await(0x0,UpdateUserService_1[_0xb39a5f(0x133)])({'userData':_0x20fcdc,'userId':_0x316271,'companyId':_0x159dce,'requestUserId':+_0x426e4d}),_0x2f7464=(0x0,socket_1[_0xb39a5f(0x151)])();return _0x2f7464[_0xb39a5f(0x150)]('company-'+_0x159dce+_0xb39a5f(0x15a),{'action':_0xb39a5f(0x11d),'user':_0x953d52}),_0x1ef845[_0xb39a5f(0x11a)](0xc8)['json'](_0x953d52);};function a35_0xcff1(_0x172660,_0x32e2fb){const _0xc559ad=a35_0xc559();return a35_0xcff1=function(_0xcff130,_0x81b779){_0xcff130=_0xcff130-0x11a;let _0x4dc943=_0xc559ad[_0xcff130];return _0x4dc943;},a35_0xcff1(_0x172660,_0x32e2fb);}exports[a35_0x4a666c(0x11d)]=update;const remove=async(_0x5b5f02,_0x2fad31)=>{const _0x54fce5=a35_0x4a666c,{userId:_0x47e6c8}=_0x5b5f02[_0x54fce5(0x121)],{companyId:_0x190147,id:_0x31a077,profile:_0x43d428}=_0x5b5f02[_0x54fce5(0x13c)];if(_0x43d428!==_0x54fce5(0x138))throw new AppError_1['default'](_0x54fce5(0x125),0x193);if(process[_0x54fce5(0x13f)][_0x54fce5(0x12c)]==='ON')throw new AppError_1[(_0x54fce5(0x133))](_0x54fce5(0x125),0x193);const _0x386b4a=await User_1[_0x54fce5(0x133)][_0x54fce5(0x163)]({'where':{'id':_0x47e6c8}});if(_0x190147!==_0x386b4a[_0x54fce5(0x126)])return _0x2fad31[_0x54fce5(0x11a)](0x190)[_0x54fce5(0x11c)]({'error':_0x54fce5(0x15d)});else{await(0x0,DeleteUserService_1[_0x54fce5(0x133)])(_0x47e6c8,_0x190147);const _0x3d07df=(0x0,socket_1[_0x54fce5(0x151)])();return _0x3d07df[_0x54fce5(0x150)]('company-'+_0x190147+_0x54fce5(0x15a),{'action':_0x54fce5(0x15e),'userId':_0x47e6c8}),_0x2fad31[_0x54fce5(0x11a)](0xc8)[_0x54fce5(0x11c)]({'message':'User\x20deleted'});}};exports[a35_0x4a666c(0x12f)]=remove;const list=async(_0x164f11,_0x1da473)=>{const _0x1da8a3=a35_0x4a666c,{companyId:_0x50544c}=_0x164f11[_0x1da8a3(0x158)],{companyId:_0x277008}=_0x164f11[_0x1da8a3(0x13c)],_0xbfdb88=await(0x0,SimpleListService_1[_0x1da8a3(0x133)])({'companyId':_0x50544c?+_0x50544c:_0x277008});return _0x1da473['status'](0xc8)[_0x1da8a3(0x11c)](_0xbfdb88);};exports[a35_0x4a666c(0x124)]=list;