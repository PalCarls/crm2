'use strict';const a36_0x184804=a36_0x3879;(function(_0x555588,_0x2ef2e3){const _0x4b8f0c=a36_0x3879,_0x48e15e=_0x555588();while(!![]){try{const _0x22c27a=-parseInt(_0x4b8f0c(0x103))/0x1+-parseInt(_0x4b8f0c(0x116))/0x2*(parseInt(_0x4b8f0c(0x102))/0x3)+parseInt(_0x4b8f0c(0x12b))/0x4+parseInt(_0x4b8f0c(0x125))/0x5*(-parseInt(_0x4b8f0c(0x11f))/0x6)+-parseInt(_0x4b8f0c(0x121))/0x7+parseInt(_0x4b8f0c(0xfd))/0x8*(parseInt(_0x4b8f0c(0x128))/0x9)+parseInt(_0x4b8f0c(0xe9))/0xa*(parseInt(_0x4b8f0c(0x117))/0xb);if(_0x22c27a===_0x2ef2e3)break;else _0x48e15e['push'](_0x48e15e['shift']());}catch(_0x45b113){_0x48e15e['push'](_0x48e15e['shift']());}}}(a36_0x47eb,0x6e58f));function a36_0x47eb(){const _0x43f70c=['__esModule','env','getIO','Imagem\x20atualizada','toISOString','\x0aSenha:\x20','../errors/AppError','../libs/socket','findOne','Olá\x20','message','getWbot','lodash','update','<br>Senha:\x20','908386GoQQDi','3755719JBSBmk','show','../models/User','../services/UserServices/SimpleListService','isNil','default',',\x20este\x20é\x20um\x20email\x20sobre\x20o\x20cadastro\x20da\x20','light','6qDpUsc','mediaUpload','4644423jfqZvg','profileImage',',\x20este\x20é\x20uma\x20mensagem\x20sobre\x20o\x20cadastro\x20da\x20','closed','1177815LpZgwj','log','emit','9cuKlCj','getDate','ERR_NO_PERMISSION','749748OCgDEh','../services/CompanyService/CreateCompanyService','url','remove','company-','json','index','../services/CompanyService/FindCompaniesWhatsappService','Login\x20e\x20senha\x20da\x20Empresa\x20','defineProperty','sendMessage','@s.whatsapp.net','split','disabled','DEMO','list','!\x0a\x0aSegue\x20os\x20dados\x20da\x20sua\x20empresa:\x0a\x0aNome:\x20','store','isEmpty','files','../helpers/SendMail','50vBClSb','__importDefault','status','whatsapps','/signup','replace','ERR_USER_CREATION_DISABLED','<br>Data\x20Vencimento\x20Trial:\x20','findByPk','-user','useDate','../libs/wbot','../utils/useDate','../helpers/CheckSettings','query','user','profile','\x0aEmail:\x20','Você\x20não\x20possui\x20permissão\x20para\x20acessar\x20este\x20recurso!','admin','3108192PhONMI','save','CONNECTED','!<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20Segue\x20os\x20dados\x20da\x20sua\x20empresa:<br><br>Nome:\x20','User\x20deleted','3PmsVHD','477878pEVuct','params','body','delete'];a36_0x47eb=function(){return _0x43f70c;};return a36_0x47eb();}var __importDefault=this&&this[a36_0x184804(0xea)]||function(_0x113c87){const _0x4087d8=a36_0x184804;return _0x113c87&&_0x113c87[_0x4087d8(0x107)]?_0x113c87:{'default':_0x113c87};};Object[a36_0x184804(0xdd)](exports,a36_0x184804(0x107),{'value':!![]}),exports['mediaUpload']=exports[a36_0x184804(0xe3)]=exports[a36_0x184804(0xd7)]=exports[a36_0x184804(0x114)]=exports[a36_0x184804(0x118)]=exports[a36_0x184804(0xe5)]=exports[a36_0x184804(0xda)]=void 0x0;const socket_1=require(a36_0x184804(0x10e)),lodash_1=require(a36_0x184804(0x113)),CheckSettings_1=__importDefault(require(a36_0x184804(0xf6))),AppError_1=__importDefault(require(a36_0x184804(0x10d))),CreateUserService_1=__importDefault(require('../services/UserServices/CreateUserService')),ListUsersService_1=__importDefault(require('../services/UserServices/ListUsersService')),UpdateUserService_1=__importDefault(require('../services/UserServices/UpdateUserService')),ShowUserService_1=__importDefault(require('../services/UserServices/ShowUserService')),DeleteUserService_1=__importDefault(require('../services/UserServices/DeleteUserService')),SimpleListService_1=__importDefault(require(a36_0x184804(0x11a))),CreateCompanyService_1=__importDefault(require(a36_0x184804(0x12c))),SendMail_1=require(a36_0x184804(0xe8)),useDate_1=require(a36_0x184804(0xf5)),ShowCompanyService_1=__importDefault(require('../services/CompanyService/ShowCompanyService')),wbot_1=require(a36_0x184804(0xf4)),FindCompaniesWhatsappService_1=__importDefault(require(a36_0x184804(0xdb))),User_1=__importDefault(require(a36_0x184804(0x119))),lodash_2=require(a36_0x184804(0x113)),index=async(_0x25504d,_0x3ab29f)=>{const _0x7af705=a36_0x184804,{searchParam:_0xfbbca2,pageNumber:_0x597307}=_0x25504d[_0x7af705(0xf7)],{companyId:_0x3dd26e,profile:_0x304879}=_0x25504d[_0x7af705(0xf8)],{users:_0xa0c7d5,count:_0x2a4e0e,hasMore:_0x5d9afe}=await(0x0,ListUsersService_1[_0x7af705(0x11c)])({'searchParam':_0xfbbca2,'pageNumber':_0x597307,'companyId':_0x3dd26e,'profile':_0x304879});return _0x3ab29f[_0x7af705(0xd9)]({'users':_0xa0c7d5,'count':_0x2a4e0e,'hasMore':_0x5d9afe});};exports['index']=index;const store=async(_0x28c9c4,_0x3e5c98)=>{const _0x160bca=a36_0x184804,{email:_0x8e43cf,password:_0x106cd2,name:_0x41602d,phone:_0x300e98,profile:_0x32ed5c,companyId:_0x58797d,queueIds:_0x446817,companyName:_0x46c8bb,planId:_0x7d7621,startWork:_0x4337ee,endWork:_0x4b9b02,whatsappId:_0x37161f,allTicket:_0x88fade,defaultTheme:_0x2134d8,defaultMenu:_0x1cba0c,allowGroup:_0x58aa16}=_0x28c9c4[_0x160bca(0x105)];let _0x45c204=null;const {dateToClient:_0x4b973b}=(0x0,useDate_1[_0x160bca(0xf3)])();if(_0x28c9c4[_0x160bca(0xf8)]!==undefined){const {companyId:_0x3c3b50}=_0x28c9c4[_0x160bca(0xf8)];_0x45c204=_0x3c3b50;}if(_0x28c9c4[_0x160bca(0x12d)]===_0x160bca(0xed)&&await(0x0,CheckSettings_1[_0x160bca(0x11c)])('userCreation')===_0x160bca(0xe1))throw new AppError_1[(_0x160bca(0x11c))](_0x160bca(0xef),0x193);else{if(_0x28c9c4['url']!==_0x160bca(0xed)&&_0x28c9c4[_0x160bca(0xf8)][_0x160bca(0xf9)]!=='admin')throw new AppError_1[(_0x160bca(0x11c))](_0x160bca(0x12a),0x193);}if(process[_0x160bca(0x108)][_0x160bca(0xe2)]==='ON')throw new AppError_1[(_0x160bca(0x11c))](_0x160bca(0x12a),0x193);const _0x468f5f=_0x58797d||_0x45c204;if(!_0x468f5f){const _0x503ec1=new Date();_0x503ec1['setDate'](_0x503ec1[_0x160bca(0x129)]()+0x3);const _0x56b8d4=_0x503ec1[_0x160bca(0x10b)]()[_0x160bca(0xe0)]('T')[0x0],_0x3209e8={'name':_0x46c8bb,'email':_0x8e43cf,'phone':_0x300e98,'planId':_0x7d7621,'status':!![],'dueDate':_0x56b8d4,'recurrence':'','document':'','paymentMethod':'','password':_0x106cd2,'companyUserName':_0x41602d,'startWork':_0x4337ee,'endWork':_0x4b9b02,'defaultTheme':_0x160bca(0x11e),'defaultMenu':_0x160bca(0x124),'allowGroup':![]},_0x485589=await(0x0,CreateCompanyService_1[_0x160bca(0x11c)])(_0x3209e8);try{const _0x2e4d64={'to':_0x8e43cf,'subject':_0x160bca(0xdc)+_0x46c8bb,'text':_0x160bca(0x110)+_0x41602d+_0x160bca(0x11d)+_0x46c8bb+_0x160bca(0x100)+_0x46c8bb+'<br>Email:\x20'+_0x8e43cf+_0x160bca(0x115)+_0x106cd2+_0x160bca(0xf0)+_0x4b973b(_0x56b8d4)};await(0x0,SendMail_1['SendMail'])(_0x2e4d64);}catch(_0x3f8105){console['log']('Não\x20consegui\x20enviar\x20o\x20email');}try{const _0x2e9d71=await(0x0,ShowCompanyService_1[_0x160bca(0x11c)])(0x1),_0x10c170=await(0x0,FindCompaniesWhatsappService_1[_0x160bca(0x11c)])(_0x2e9d71['id']);if(_0x10c170['whatsapps'][0x0]['status']===_0x160bca(0xff)&&(_0x300e98!==undefined||!(0x0,lodash_1[_0x160bca(0x11b)])(_0x300e98)||!(0x0,lodash_1[_0x160bca(0xe6)])(_0x300e98))){const _0x4f8952=_0x10c170[_0x160bca(0xec)][0x0]['id'],_0x54625c=(0x0,wbot_1[_0x160bca(0x112)])(_0x4f8952),_0x59c02e=_0x160bca(0x110)+_0x41602d+_0x160bca(0x123)+_0x46c8bb+_0x160bca(0xe4)+_0x46c8bb+_0x160bca(0xfa)+_0x8e43cf+_0x160bca(0x10c)+_0x106cd2+'\x0aData\x20Vencimento\x20Trial:\x20'+_0x4b973b(_0x56b8d4);await _0x54625c[_0x160bca(0xde)]('55'+_0x300e98+_0x160bca(0xdf),{'text':_0x59c02e});}}catch(_0x2db50e){console[_0x160bca(0x126)]('Não\x20consegui\x20enviar\x20a\x20mensagem');}return _0x3e5c98[_0x160bca(0xeb)](0xc8)[_0x160bca(0xd9)](_0x485589);}if(_0x468f5f){const _0x193890=await(0x0,CreateUserService_1[_0x160bca(0x11c)])({'email':_0x8e43cf,'password':_0x106cd2,'name':_0x41602d,'profile':_0x32ed5c,'companyId':_0x468f5f,'queueIds':_0x446817,'startWork':_0x4337ee,'endWork':_0x4b9b02,'whatsappId':_0x37161f,'allTicket':_0x88fade,'defaultTheme':_0x2134d8,'defaultMenu':_0x1cba0c,'allowGroup':_0x58aa16}),_0x19e42b=(0x0,socket_1[_0x160bca(0x109)])();return _0x19e42b['emit'](_0x160bca(0xd8)+_0x45c204+_0x160bca(0xf2),{'action':'create','user':_0x193890}),_0x3e5c98['status'](0xc8)[_0x160bca(0xd9)](_0x193890);}};exports[a36_0x184804(0xe5)]=store;const show=async(_0x38975e,_0xcb682)=>{const _0x969852=a36_0x184804,{userId:_0x532cd3}=_0x38975e[_0x969852(0x104)],_0x294700=await(0x0,ShowUserService_1[_0x969852(0x11c)])(_0x532cd3);return _0xcb682['status'](0xc8)[_0x969852(0xd9)](_0x294700);};exports[a36_0x184804(0x118)]=show;const update=async(_0x5925c2,_0x4f85de)=>{const _0x32377d=a36_0x184804;if(process[_0x32377d(0x108)][_0x32377d(0xe2)]==='ON')throw new AppError_1['default'](_0x32377d(0x12a),0x193);const {id:_0x4300d2,companyId:_0x27d318}=_0x5925c2[_0x32377d(0xf8)],{userId:_0x489133}=_0x5925c2[_0x32377d(0x104)],_0x494c53=_0x5925c2[_0x32377d(0x105)],_0x12a67b=await(0x0,UpdateUserService_1[_0x32377d(0x11c)])({'userData':_0x494c53,'userId':_0x489133,'companyId':_0x27d318,'requestUserId':+_0x4300d2}),_0x51b40a=(0x0,socket_1['getIO'])();return _0x51b40a[_0x32377d(0x127)]('company-'+_0x27d318+_0x32377d(0xf2),{'action':_0x32377d(0x114),'user':_0x12a67b}),_0x4f85de[_0x32377d(0xeb)](0xc8)[_0x32377d(0xd9)](_0x12a67b);};function a36_0x3879(_0x5134d5,_0x12b06c){const _0x47eb15=a36_0x47eb();return a36_0x3879=function(_0x3879e7,_0x3ab362){_0x3879e7=_0x3879e7-0xd7;let _0x5c142f=_0x47eb15[_0x3879e7];return _0x5c142f;},a36_0x3879(_0x5134d5,_0x12b06c);}exports[a36_0x184804(0x114)]=update;const remove=async(_0x345723,_0xc374a)=>{const _0x2f53e2=a36_0x184804,{userId:_0x500109}=_0x345723[_0x2f53e2(0x104)],{companyId:_0x1ce312,id:_0x18ce80,profile:_0x234925}=_0x345723[_0x2f53e2(0xf8)];if(_0x234925!==_0x2f53e2(0xfc))throw new AppError_1[(_0x2f53e2(0x11c))]('ERR_NO_PERMISSION',0x193);if(process[_0x2f53e2(0x108)]['DEMO']==='ON')throw new AppError_1[(_0x2f53e2(0x11c))](_0x2f53e2(0x12a),0x193);const _0x3779f2=await User_1[_0x2f53e2(0x11c)][_0x2f53e2(0x10f)]({'where':{'id':_0x500109}});if(_0x1ce312!==_0x3779f2['companyId'])return _0xc374a[_0x2f53e2(0xeb)](0x190)[_0x2f53e2(0xd9)]({'error':_0x2f53e2(0xfb)});else{await(0x0,DeleteUserService_1[_0x2f53e2(0x11c)])(_0x500109,_0x1ce312);const _0x5124dd=(0x0,socket_1[_0x2f53e2(0x109)])();return _0x5124dd['emit'](_0x2f53e2(0xd8)+_0x1ce312+_0x2f53e2(0xf2),{'action':_0x2f53e2(0x106),'userId':_0x500109}),_0xc374a['status'](0xc8)[_0x2f53e2(0xd9)]({'message':_0x2f53e2(0x101)});}};exports[a36_0x184804(0xd7)]=remove;const list=async(_0x3b6f56,_0x566750)=>{const _0x4a0234=a36_0x184804,{companyId:_0x2de6f4}=_0x3b6f56[_0x4a0234(0xf7)],{companyId:_0x1039bb}=_0x3b6f56[_0x4a0234(0xf8)],_0x59254c=await(0x0,SimpleListService_1['default'])({'companyId':_0x2de6f4?+_0x2de6f4:_0x1039bb});return _0x566750['status'](0xc8)[_0x4a0234(0xd9)](_0x59254c);};exports[a36_0x184804(0xe3)]=list;const mediaUpload=async(_0x243ad2,_0x2a8eb9)=>{const _0x5052cc=a36_0x184804,{userId:_0x5720a1}=_0x243ad2[_0x5052cc(0x104)],_0x9bdb88=_0x243ad2[_0x5052cc(0xe7)],_0xf44ac4=(0x0,lodash_2['head'])(_0x9bdb88);try{const _0x13e3b1=await User_1[_0x5052cc(0x11c)][_0x5052cc(0xf1)](_0x5720a1);return _0x13e3b1[_0x5052cc(0x122)]=_0xf44ac4['filename'][_0x5052cc(0xee)]('/','-'),await _0x13e3b1[_0x5052cc(0xfe)](),_0x2a8eb9[_0x5052cc(0xeb)](0xc8)[_0x5052cc(0xd9)]({'user':_0x13e3b1,'message':_0x5052cc(0x10a)});}catch(_0x159510){throw new AppError_1[(_0x5052cc(0x11c))](_0x159510[_0x5052cc(0x111)]);}};exports[a36_0x184804(0x120)]=mediaUpload;