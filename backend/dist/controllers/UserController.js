'use strict';const a39_0x403dbb=a39_0x36bd;(function(_0x5acfa4,_0x7513ca){const _0x4ce6af=a39_0x36bd,_0x431eda=_0x5acfa4();while(!![]){try{const _0x1f3e40=-parseInt(_0x4ce6af(0xcb))/0x1*(parseInt(_0x4ce6af(0xf9))/0x2)+-parseInt(_0x4ce6af(0xe6))/0x3*(-parseInt(_0x4ce6af(0xcf))/0x4)+parseInt(_0x4ce6af(0x101))/0x5*(parseInt(_0x4ce6af(0x105))/0x6)+-parseInt(_0x4ce6af(0x107))/0x7*(parseInt(_0x4ce6af(0xc8))/0x8)+parseInt(_0x4ce6af(0xc0))/0x9+-parseInt(_0x4ce6af(0xf5))/0xa+parseInt(_0x4ce6af(0xd3))/0xb;if(_0x1f3e40===_0x7513ca)break;else _0x431eda['push'](_0x431eda['shift']());}catch(_0x3a109a){_0x431eda['push'](_0x431eda['shift']());}}}(a39_0x58c1,0x52a9e));var __importDefault=this&&this['__importDefault']||function(_0x2c934e){const _0x3f2c58=a39_0x36bd;return _0x2c934e&&_0x2c934e[_0x3f2c58(0xbf)]?_0x2c934e:{'default':_0x2c934e};};Object[a39_0x403dbb(0xcc)](exports,a39_0x403dbb(0xbf),{'value':!![]}),exports[a39_0x403dbb(0xf4)]=exports[a39_0x403dbb(0xea)]=exports[a39_0x403dbb(0xc5)]=exports[a39_0x403dbb(0xb3)]=exports[a39_0x403dbb(0xdc)]=exports[a39_0x403dbb(0xb2)]=exports[a39_0x403dbb(0xc6)]=void 0x0;const socket_1=require(a39_0x403dbb(0xfc)),lodash_1=require('lodash'),CheckSettings_1=__importDefault(require(a39_0x403dbb(0xd9))),AppError_1=__importDefault(require(a39_0x403dbb(0xf7))),CreateUserService_1=__importDefault(require(a39_0x403dbb(0xb7))),ListUsersService_1=__importDefault(require('../services/UserServices/ListUsersService')),UpdateUserService_1=__importDefault(require(a39_0x403dbb(0x106))),ShowUserService_1=__importDefault(require('../services/UserServices/ShowUserService')),DeleteUserService_1=__importDefault(require(a39_0x403dbb(0x102))),SimpleListService_1=__importDefault(require(a39_0x403dbb(0xba))),CreateCompanyService_1=__importDefault(require('../services/CompanyService/CreateCompanyService')),SendMail_1=require(a39_0x403dbb(0xc9)),useDate_1=require(a39_0x403dbb(0xf3)),ShowCompanyService_1=__importDefault(require(a39_0x403dbb(0xef))),wbot_1=require(a39_0x403dbb(0xc4)),FindCompaniesWhatsappService_1=__importDefault(require(a39_0x403dbb(0xf2))),User_1=__importDefault(require('../models/User')),lodash_2=require('lodash'),index=async(_0x30cd9e,_0x4bdcb8)=>{const _0x48e970=a39_0x403dbb,{searchParam:_0x7165c1,pageNumber:_0x44a45f}=_0x30cd9e[_0x48e970(0xd6)],{companyId:_0x3ffe6e,profile:_0x284941}=_0x30cd9e[_0x48e970(0xb4)],{users:_0x2cb818,count:_0x2e03b1,hasMore:_0x1dfd25}=await(0x0,ListUsersService_1[_0x48e970(0xb1)])({'searchParam':_0x7165c1,'pageNumber':_0x44a45f,'companyId':_0x3ffe6e,'profile':_0x284941});return _0x4bdcb8[_0x48e970(0xfa)]({'users':_0x2cb818,'count':_0x2e03b1,'hasMore':_0x1dfd25});};function a39_0x36bd(_0x55ee8f,_0x2be782){const _0x58c1ca=a39_0x58c1();return a39_0x36bd=function(_0x36bdac,_0x4e3ef5){_0x36bdac=_0x36bdac-0xad;let _0x3ae5a9=_0x58c1ca[_0x36bdac];return _0x3ae5a9;},a39_0x36bd(_0x55ee8f,_0x2be782);}exports[a39_0x403dbb(0xc6)]=index;const store=async(_0x169e0e,_0x85b1)=>{const _0x3379a6=a39_0x403dbb,{email:_0x66283f,password:_0x1a3b54,name:_0x581512,phone:_0x100dc2,profile:_0x3b6c22,companyId:_0x5bbc9c,queueIds:_0x544eec,companyName:_0x3dae02,planId:_0x4b40d9,startWork:_0x4fcf2d,endWork:_0x166157,whatsappId:_0x51de5d,allTicket:_0x1cf894,defaultTheme:_0x277416,defaultMenu:_0x2727c9,allowGroup:_0x5cc98a,allHistoric:_0x263ccf,allUserChat:_0x1343d4}=_0x169e0e[_0x3379a6(0xcd)];let _0x450f38=null;const {dateToClient:_0x21833b}=(0x0,useDate_1[_0x3379a6(0xad)])();if(_0x169e0e['user']!==undefined){const {companyId:_0x24e452}=_0x169e0e[_0x3379a6(0xb4)];_0x450f38=_0x24e452;}if(_0x169e0e[_0x3379a6(0xd5)]===_0x3379a6(0xeb)&&await(0x0,CheckSettings_1['default'])(_0x3379a6(0x103))===_0x3379a6(0xbc))throw new AppError_1['default'](_0x3379a6(0xbb),0x193);else{if(_0x169e0e[_0x3379a6(0xd5)]!==_0x3379a6(0xeb)&&_0x169e0e[_0x3379a6(0xb4)][_0x3379a6(0xc2)]!==_0x3379a6(0x100))throw new AppError_1[(_0x3379a6(0xb1))](_0x3379a6(0xff),0x193);}if(process[_0x3379a6(0xdd)][_0x3379a6(0xda)]==='ON')throw new AppError_1[(_0x3379a6(0xb1))](_0x3379a6(0xff),0x193);const _0x2a36b5=_0x5bbc9c||_0x450f38;if(!_0x2a36b5){const _0x494082=new Date();_0x494082[_0x3379a6(0xe1)](_0x494082[_0x3379a6(0xe5)]()+0x3);const _0x484b0f=_0x494082[_0x3379a6(0xee)]()[_0x3379a6(0xd8)]('T')[0x0],_0x41d963={'name':_0x3dae02,'email':_0x66283f,'phone':_0x100dc2,'planId':_0x4b40d9,'status':!![],'dueDate':_0x484b0f,'recurrence':'','document':'','paymentMethod':'','password':_0x1a3b54,'companyUserName':_0x581512,'startWork':_0x4fcf2d,'endWork':_0x166157,'defaultTheme':_0x3379a6(0xb5),'defaultMenu':_0x3379a6(0xf1),'allowGroup':![],'allHistoric':![]},_0x47d0a3=await(0x0,CreateCompanyService_1[_0x3379a6(0xb1)])(_0x41d963);try{const _0xf7d016={'to':_0x66283f,'subject':_0x3379a6(0xfb)+_0x3dae02,'text':_0x3379a6(0xe4)+_0x581512+_0x3379a6(0xb0)+_0x3dae02+'!<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20Segue\x20os\x20dados\x20da\x20sua\x20empresa:<br><br>Nome:\x20'+_0x3dae02+_0x3379a6(0xe0)+_0x66283f+_0x3379a6(0xe2)+_0x1a3b54+_0x3379a6(0xb8)+_0x21833b(_0x484b0f)};await(0x0,SendMail_1[_0x3379a6(0xae)])(_0xf7d016);}catch(_0x13402c){console[_0x3379a6(0xc3)](_0x3379a6(0xfe));}try{const _0x345b8e=await(0x0,ShowCompanyService_1[_0x3379a6(0xb1)])(0x1),_0x4f6281=await(0x0,FindCompaniesWhatsappService_1['default'])(_0x345b8e['id']);if(_0x4f6281[_0x3379a6(0xdb)][0x0]['status']===_0x3379a6(0xd2)&&(_0x100dc2!==undefined||!(0x0,lodash_1[_0x3379a6(0xe7)])(_0x100dc2)||!(0x0,lodash_1[_0x3379a6(0xbd)])(_0x100dc2))){const _0x52aafc=_0x4f6281['whatsapps'][0x0]['id'],_0x5c4d2d=(0x0,wbot_1[_0x3379a6(0xde)])(_0x52aafc),_0x33e0ec=_0x3379a6(0xe4)+_0x581512+_0x3379a6(0xe9)+_0x3dae02+'!\x0a\x0aSegue\x20os\x20dados\x20da\x20sua\x20empresa:\x0a\x0aNome:\x20'+_0x3dae02+_0x3379a6(0xd0)+_0x66283f+_0x3379a6(0xb9)+_0x1a3b54+_0x3379a6(0xdf)+_0x21833b(_0x484b0f);await _0x5c4d2d[_0x3379a6(0xf0)]('55'+_0x100dc2+_0x3379a6(0xce),{'text':_0x33e0ec});}}catch(_0x185b97){console[_0x3379a6(0xc3)]('Não\x20consegui\x20enviar\x20a\x20mensagem');}return _0x85b1[_0x3379a6(0xd1)](0xc8)[_0x3379a6(0xfa)](_0x47d0a3);}if(_0x2a36b5){const _0x273bd4=await(0x0,CreateUserService_1[_0x3379a6(0xb1)])({'email':_0x66283f,'password':_0x1a3b54,'name':_0x581512,'profile':_0x3b6c22,'companyId':_0x2a36b5,'queueIds':_0x544eec,'startWork':_0x4fcf2d,'endWork':_0x166157,'whatsappId':_0x51de5d,'allTicket':_0x1cf894,'defaultTheme':_0x277416,'defaultMenu':_0x2727c9,'allowGroup':_0x5cc98a,'allHistoric':_0x263ccf,'allUserChat':_0x1343d4}),_0x2b6361=(0x0,socket_1[_0x3379a6(0xe3)])();return _0x2b6361[_0x3379a6(0xd7)]('company-'+_0x450f38+_0x3379a6(0xbe),{'action':_0x3379a6(0x104),'user':_0x273bd4}),_0x85b1['status'](0xc8)['json'](_0x273bd4);}};exports[a39_0x403dbb(0xb2)]=store;const show=async(_0x3679af,_0x19bbdc)=>{const _0x550b52=a39_0x403dbb,{userId:_0x4635bd}=_0x3679af[_0x550b52(0xc1)],{companyId:_0x56e1f6}=_0x3679af['user'],_0x59ded4=await(0x0,ShowUserService_1[_0x550b52(0xb1)])(_0x4635bd,_0x56e1f6);return _0x19bbdc[_0x550b52(0xd1)](0xc8)[_0x550b52(0xfa)](_0x59ded4);};exports[a39_0x403dbb(0xdc)]=show;function a39_0x58c1(){const _0xea2be3=['remove','index','delete','295208fXnPer','../helpers/SendMail','files','473oINYjw','defineProperty','body','@s.whatsapp.net','167376bQNLDO','\x0aEmail:\x20','status','CONNECTED','2782516tuqbVy','Você\x20não\x20possui\x20permissão\x20para\x20acessar\x20este\x20recurso!','url','query','emit','split','../helpers/CheckSettings','DEMO','whatsapps','show','env','getWbot','\x0aData\x20Vencimento\x20Trial:\x20','<br>Email:\x20','setDate','<br>Senha:\x20','getIO','Olá\x20','getDate','21uoMJGt','isNil','head',',\x20este\x20é\x20uma\x20mensagem\x20sobre\x20o\x20cadastro\x20da\x20','list','/signup','company-','findOne','toISOString','../services/CompanyService/ShowCompanyService','sendMessage','closed','../services/CompanyService/FindCompaniesWhatsappService','../utils/useDate','mediaUpload','6558500tAgiMY','profileImage','../errors/AppError','Imagem\x20atualizada','1098KuDIiT','json','Login\x20e\x20senha\x20da\x20Empresa\x20','../libs/socket','User\x20deleted','Não\x20consegui\x20enviar\x20o\x20email','ERR_NO_PERMISSION','admin','17715iZAHeK','../services/UserServices/DeleteUserService','userCreation','create','576iHFKLM','../services/UserServices/UpdateUserService','7zjKmsz','companyId','useDate','SendMail','filename',',\x20este\x20é\x20um\x20email\x20sobre\x20o\x20cadastro\x20da\x20','default','store','update','user','light','message','../services/UserServices/CreateUserService','<br>Data\x20Vencimento\x20Trial:\x20','\x0aSenha:\x20','../services/UserServices/SimpleListService','ERR_USER_CREATION_DISABLED','disabled','isEmpty','-user','__esModule','3645234oxNqOG','params','profile','log','../libs/wbot'];a39_0x58c1=function(){return _0xea2be3;};return a39_0x58c1();}const update=async(_0x241762,_0x523e49)=>{const _0xd8144=a39_0x403dbb;if(process[_0xd8144(0xdd)]['DEMO']==='ON')throw new AppError_1['default'](_0xd8144(0xff),0x193);const {id:_0x345f8b,companyId:_0x5e5e81}=_0x241762['user'],{userId:_0x249c30}=_0x241762[_0xd8144(0xc1)],_0x2fbab2=_0x241762['body'],_0x4943d7=await(0x0,UpdateUserService_1[_0xd8144(0xb1)])({'userData':_0x2fbab2,'userId':_0x249c30,'companyId':_0x5e5e81,'requestUserId':+_0x345f8b}),_0x447645=(0x0,socket_1['getIO'])();return _0x447645[_0xd8144(0xd7)](_0xd8144(0xec)+_0x5e5e81+_0xd8144(0xbe),{'action':_0xd8144(0xb3),'user':_0x4943d7}),_0x523e49[_0xd8144(0xd1)](0xc8)[_0xd8144(0xfa)](_0x4943d7);};exports[a39_0x403dbb(0xb3)]=update;const remove=async(_0x1643a5,_0x2de59f)=>{const _0x23576a=a39_0x403dbb,{userId:_0xe5b03}=_0x1643a5[_0x23576a(0xc1)],{companyId:_0x1b64d1,id:_0x448a8c,profile:_0x336769}=_0x1643a5[_0x23576a(0xb4)];if(_0x336769!==_0x23576a(0x100))throw new AppError_1[(_0x23576a(0xb1))]('ERR_NO_PERMISSION',0x193);if(process[_0x23576a(0xdd)]['DEMO']==='ON')throw new AppError_1[(_0x23576a(0xb1))](_0x23576a(0xff),0x193);const _0x56c763=await User_1[_0x23576a(0xb1)][_0x23576a(0xed)]({'where':{'id':_0xe5b03}});if(_0x1b64d1!==_0x56c763[_0x23576a(0x108)])return _0x2de59f[_0x23576a(0xd1)](0x190)[_0x23576a(0xfa)]({'error':_0x23576a(0xd4)});else{await(0x0,DeleteUserService_1[_0x23576a(0xb1)])(_0xe5b03,_0x1b64d1);const _0x5e6502=(0x0,socket_1[_0x23576a(0xe3)])();return _0x5e6502[_0x23576a(0xd7)]('company-'+_0x1b64d1+_0x23576a(0xbe),{'action':_0x23576a(0xc7),'userId':_0xe5b03}),_0x2de59f['status'](0xc8)['json']({'message':_0x23576a(0xfd)});}};exports['remove']=remove;const list=async(_0xbebf7d,_0x468e34)=>{const _0x19f2e6=a39_0x403dbb,{companyId:_0x8a73d4}=_0xbebf7d[_0x19f2e6(0xd6)],{companyId:_0x3102d4}=_0xbebf7d[_0x19f2e6(0xb4)],_0x34acc4=await(0x0,SimpleListService_1[_0x19f2e6(0xb1)])({'companyId':_0x8a73d4?+_0x8a73d4:_0x3102d4});return _0x468e34[_0x19f2e6(0xd1)](0xc8)[_0x19f2e6(0xfa)](_0x34acc4);};exports[a39_0x403dbb(0xea)]=list;const mediaUpload=async(_0x2d6115,_0x988db6)=>{const _0x15699a=a39_0x403dbb,{userId:_0x14b29a}=_0x2d6115[_0x15699a(0xc1)],_0x54d148=_0x2d6115[_0x15699a(0xca)],_0xc6b309=(0x0,lodash_2[_0x15699a(0xe8)])(_0x54d148);try{const _0x59bfe0=await User_1[_0x15699a(0xb1)]['findByPk'](_0x14b29a);return _0x59bfe0[_0x15699a(0xf6)]=_0xc6b309[_0x15699a(0xaf)]['replace']('/','-'),await _0x59bfe0['save'](),_0x988db6[_0x15699a(0xd1)](0xc8)[_0x15699a(0xfa)]({'user':_0x59bfe0,'message':_0x15699a(0xf8)});}catch(_0x9febfe){throw new AppError_1[(_0x15699a(0xb1))](_0x9febfe[_0x15699a(0xb6)]);}};exports[a39_0x403dbb(0xf4)]=mediaUpload;