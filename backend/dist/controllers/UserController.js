'use strict';const a36_0x3f1d18=a36_0x16ef;(function(_0x303b92,_0x4ac580){const _0x55fea4=a36_0x16ef,_0x1aa998=_0x303b92();while(!![]){try{const _0x16accb=parseInt(_0x55fea4(0xc0))/0x1+-parseInt(_0x55fea4(0x93))/0x2+-parseInt(_0x55fea4(0xbb))/0x3*(-parseInt(_0x55fea4(0x98))/0x4)+parseInt(_0x55fea4(0xa4))/0x5*(parseInt(_0x55fea4(0x8b))/0x6)+parseInt(_0x55fea4(0xd8))/0x7*(parseInt(_0x55fea4(0xcf))/0x8)+-parseInt(_0x55fea4(0xd7))/0x9*(-parseInt(_0x55fea4(0x86))/0xa)+-parseInt(_0x55fea4(0xbf))/0xb*(parseInt(_0x55fea4(0xc6))/0xc);if(_0x16accb===_0x4ac580)break;else _0x1aa998['push'](_0x1aa998['shift']());}catch(_0x4946c8){_0x1aa998['push'](_0x1aa998['shift']());}}}(a36_0x9509,0xad750));var __importDefault=this&&this[a36_0x3f1d18(0xaa)]||function(_0x590d41){const _0x4cee56=a36_0x3f1d18;return _0x590d41&&_0x590d41[_0x4cee56(0xba)]?_0x590d41:{'default':_0x590d41};};Object[a36_0x3f1d18(0x9a)](exports,a36_0x3f1d18(0xba),{'value':!![]}),exports[a36_0x3f1d18(0xb0)]=exports[a36_0x3f1d18(0xcd)]=exports[a36_0x3f1d18(0xaf)]=exports[a36_0x3f1d18(0xc5)]=exports['show']=exports[a36_0x3f1d18(0xae)]=exports['index']=void 0x0;const socket_1=require(a36_0x3f1d18(0xd5)),lodash_1=require(a36_0x3f1d18(0xd3)),CheckSettings_1=__importDefault(require(a36_0x3f1d18(0xce))),AppError_1=__importDefault(require(a36_0x3f1d18(0xb7))),CreateUserService_1=__importDefault(require(a36_0x3f1d18(0xc8))),ListUsersService_1=__importDefault(require(a36_0x3f1d18(0xd0))),UpdateUserService_1=__importDefault(require(a36_0x3f1d18(0x96))),ShowUserService_1=__importDefault(require(a36_0x3f1d18(0xa0))),DeleteUserService_1=__importDefault(require('../services/UserServices/DeleteUserService')),SimpleListService_1=__importDefault(require(a36_0x3f1d18(0xd1))),CreateCompanyService_1=__importDefault(require(a36_0x3f1d18(0xc9))),SendMail_1=require(a36_0x3f1d18(0x8a)),useDate_1=require(a36_0x3f1d18(0xb8)),ShowCompanyService_1=__importDefault(require('../services/CompanyService/ShowCompanyService')),wbot_1=require(a36_0x3f1d18(0x9b)),FindCompaniesWhatsappService_1=__importDefault(require(a36_0x3f1d18(0x7f))),User_1=__importDefault(require(a36_0x3f1d18(0xa7))),lodash_2=require(a36_0x3f1d18(0xd3)),index=async(_0x1b531e,_0x4c5aae)=>{const _0x39d902=a36_0x3f1d18,{searchParam:_0x2d1bb5,pageNumber:_0x12ce8e}=_0x1b531e[_0x39d902(0x97)],{companyId:_0x2cd356,profile:_0x15bd1d}=_0x1b531e[_0x39d902(0x85)],{users:_0x24af1d,count:_0x304b44,hasMore:_0x358b67}=await(0x0,ListUsersService_1[_0x39d902(0x83)])({'searchParam':_0x2d1bb5,'pageNumber':_0x12ce8e,'companyId':_0x2cd356,'profile':_0x15bd1d});return _0x4c5aae[_0x39d902(0x7e)]({'users':_0x24af1d,'count':_0x304b44,'hasMore':_0x358b67});};exports[a36_0x3f1d18(0xb1)]=index;function a36_0x16ef(_0x38e095,_0x3a71b4){const _0x9509ae=a36_0x9509();return a36_0x16ef=function(_0x16ef7e,_0x39b367){_0x16ef7e=_0x16ef7e-0x7d;let _0x4d7602=_0x9509ae[_0x16ef7e];return _0x4d7602;},a36_0x16ef(_0x38e095,_0x3a71b4);}function a36_0x9509(){const _0x50e729=['796942cIILoF','delete','sendMessage','../services/UserServices/UpdateUserService','query','12jxAYnM','show','defineProperty','../libs/wbot','company-','log','<br>Data\x20Vencimento\x20Trial:\x20','<br>Senha:\x20','../services/UserServices/ShowUserService','DEMO','admin','!<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20Segue\x20os\x20dados\x20da\x20sua\x20empresa:<br><br>Nome:\x20','340HKsURC','getIO','ERR_USER_CREATION_DISABLED','../models/User','getDate','Imagem\x20atualizada','__importDefault','findByPk','SendMail','profile','store','remove','mediaUpload','index','ERR_NO_PERMISSION','replace','getWbot','filename','isNil','../errors/AppError','../utils/useDate','Você\x20não\x20possui\x20permissão\x20para\x20acessar\x20este\x20recurso!','__esModule','1322493jiOChv','save','\x0aData\x20Vencimento\x20Trial:\x20',',\x20este\x20é\x20um\x20email\x20sobre\x20o\x20cadastro\x20da\x20','55TThqGr','200832wiFSJZ','whatsapps','Login\x20e\x20senha\x20da\x20Empresa\x20','head','Não\x20consegui\x20enviar\x20a\x20mensagem','update','6678852PUDUmL','\x0aEmail:\x20','../services/UserServices/CreateUserService','../services/CompanyService/CreateCompanyService','-user','CONNECTED','split','list','../helpers/CheckSettings','1693544jYCPMV','../services/UserServices/ListUsersService','../services/UserServices/SimpleListService','params','lodash','Não\x20consegui\x20enviar\x20o\x20email','../libs/socket','message','171NHiUGn','28IoRFTa','status','json','../services/CompanyService/FindCompaniesWhatsappService','emit','body','files','default','User\x20deleted','user','76950uVURkx','url','closed','Olá\x20','../helpers/SendMail','121368FduoOO','@s.whatsapp.net','env',',\x20este\x20é\x20uma\x20mensagem\x20sobre\x20o\x20cadastro\x20da\x20','useDate','profileImage','toISOString','light'];a36_0x9509=function(){return _0x50e729;};return a36_0x9509();}const store=async(_0x16aa15,_0x1c1c51)=>{const _0x521089=a36_0x3f1d18,{email:_0x22d738,password:_0x3477fc,name:_0x261fab,phone:_0x322af5,profile:_0x384633,companyId:_0x8284aa,queueIds:_0x39f84a,companyName:_0x13015e,planId:_0x1ac19f,startWork:_0x90d6f0,endWork:_0x1f6f3d,whatsappId:_0x292111,allTicket:_0x55df3b,defaultTheme:_0x47f40f,defaultMenu:_0x562cd5,allowGroup:_0xab3479}=_0x16aa15['body'];let _0x26211f=null;const {dateToClient:_0x532016}=(0x0,useDate_1[_0x521089(0x8f)])();if(_0x16aa15[_0x521089(0x85)]!==undefined){const {companyId:_0x26a460}=_0x16aa15['user'];_0x26211f=_0x26a460;}if(_0x16aa15[_0x521089(0x87)]==='/signup'&&await(0x0,CheckSettings_1[_0x521089(0x83)])('userCreation')==='disabled')throw new AppError_1[(_0x521089(0x83))](_0x521089(0xa6),0x193);else{if(_0x16aa15[_0x521089(0x87)]!=='/signup'&&_0x16aa15[_0x521089(0x85)][_0x521089(0xad)]!==_0x521089(0xa2))throw new AppError_1[(_0x521089(0x83))]('ERR_NO_PERMISSION',0x193);}if(process[_0x521089(0x8d)][_0x521089(0xa1)]==='ON')throw new AppError_1[(_0x521089(0x83))]('ERR_NO_PERMISSION',0x193);const _0xec39c=_0x8284aa||_0x26211f;if(!_0xec39c){const _0x3b0173=new Date();_0x3b0173['setDate'](_0x3b0173[_0x521089(0xa8)]()+0x3);const _0x3f6cf9=_0x3b0173[_0x521089(0x91)]()[_0x521089(0xcc)]('T')[0x0],_0x338906={'name':_0x13015e,'email':_0x22d738,'phone':_0x322af5,'planId':_0x1ac19f,'status':!![],'dueDate':_0x3f6cf9,'recurrence':'','document':'','paymentMethod':'','password':_0x3477fc,'companyUserName':_0x261fab,'startWork':_0x90d6f0,'endWork':_0x1f6f3d,'defaultTheme':_0x521089(0x92),'defaultMenu':_0x521089(0x88),'allowGroup':![]},_0xbb57c9=await(0x0,CreateCompanyService_1[_0x521089(0x83)])(_0x338906);try{const _0x37deba={'to':_0x22d738,'subject':_0x521089(0xc2)+_0x13015e,'text':_0x521089(0x89)+_0x261fab+_0x521089(0xbe)+_0x13015e+_0x521089(0xa3)+_0x13015e+'<br>Email:\x20'+_0x22d738+_0x521089(0x9f)+_0x3477fc+_0x521089(0x9e)+_0x532016(_0x3f6cf9)};await(0x0,SendMail_1[_0x521089(0xac)])(_0x37deba);}catch(_0x3d8381){console[_0x521089(0x9d)](_0x521089(0xd4));}try{const _0x36c181=await(0x0,ShowCompanyService_1[_0x521089(0x83)])(0x1),_0x440e6d=await(0x0,FindCompaniesWhatsappService_1['default'])(_0x36c181['id']);if(_0x440e6d[_0x521089(0xc1)][0x0][_0x521089(0x7d)]===_0x521089(0xcb)&&(_0x322af5!==undefined||!(0x0,lodash_1[_0x521089(0xb6)])(_0x322af5)||!(0x0,lodash_1['isEmpty'])(_0x322af5))){const _0x396308=_0x440e6d['whatsapps'][0x0]['id'],_0x3f20bb=(0x0,wbot_1[_0x521089(0xb4)])(_0x396308),_0x19a3c7=_0x521089(0x89)+_0x261fab+_0x521089(0x8e)+_0x13015e+'!\x0a\x0aSegue\x20os\x20dados\x20da\x20sua\x20empresa:\x0a\x0aNome:\x20'+_0x13015e+_0x521089(0xc7)+_0x22d738+'\x0aSenha:\x20'+_0x3477fc+_0x521089(0xbd)+_0x532016(_0x3f6cf9);await _0x3f20bb[_0x521089(0x95)]('55'+_0x322af5+_0x521089(0x8c),{'text':_0x19a3c7});}}catch(_0x4b7715){console['log'](_0x521089(0xc4));}return _0x1c1c51[_0x521089(0x7d)](0xc8)['json'](_0xbb57c9);}if(_0xec39c){const _0x2e1466=await(0x0,CreateUserService_1[_0x521089(0x83)])({'email':_0x22d738,'password':_0x3477fc,'name':_0x261fab,'profile':_0x384633,'companyId':_0xec39c,'queueIds':_0x39f84a,'startWork':_0x90d6f0,'endWork':_0x1f6f3d,'whatsappId':_0x292111,'allTicket':_0x55df3b,'defaultTheme':_0x47f40f,'defaultMenu':_0x562cd5,'allowGroup':_0xab3479}),_0x3b5032=(0x0,socket_1[_0x521089(0xa5)])();return _0x3b5032[_0x521089(0x80)]('company-'+_0x26211f+_0x521089(0xca),{'action':'create','user':_0x2e1466}),_0x1c1c51['status'](0xc8)[_0x521089(0x7e)](_0x2e1466);}};exports[a36_0x3f1d18(0xae)]=store;const show=async(_0x3958ec,_0x415226)=>{const _0xbb01a6=a36_0x3f1d18,{userId:_0x372316}=_0x3958ec['params'],_0x25b186=await(0x0,ShowUserService_1[_0xbb01a6(0x83)])(_0x372316);return _0x415226[_0xbb01a6(0x7d)](0xc8)[_0xbb01a6(0x7e)](_0x25b186);};exports[a36_0x3f1d18(0x99)]=show;const update=async(_0x46e544,_0x1483c6)=>{const _0x29ec38=a36_0x3f1d18;if(process[_0x29ec38(0x8d)][_0x29ec38(0xa1)]==='ON')throw new AppError_1[(_0x29ec38(0x83))](_0x29ec38(0xb2),0x193);const {id:_0x39a162,companyId:_0x41f7ed}=_0x46e544[_0x29ec38(0x85)],{userId:_0x2c7141}=_0x46e544['params'],_0x3c185d=_0x46e544[_0x29ec38(0x81)],_0x28eff2=await(0x0,UpdateUserService_1[_0x29ec38(0x83)])({'userData':_0x3c185d,'userId':_0x2c7141,'companyId':_0x41f7ed,'requestUserId':+_0x39a162}),_0x4bbf4b=(0x0,socket_1[_0x29ec38(0xa5)])();return _0x4bbf4b['emit'](_0x29ec38(0x9c)+_0x41f7ed+_0x29ec38(0xca),{'action':'update','user':_0x28eff2}),_0x1483c6[_0x29ec38(0x7d)](0xc8)[_0x29ec38(0x7e)](_0x28eff2);};exports[a36_0x3f1d18(0xc5)]=update;const remove=async(_0xf9f77d,_0x2b32bd)=>{const _0x5704fc=a36_0x3f1d18,{userId:_0x3ad926}=_0xf9f77d[_0x5704fc(0xd2)],{companyId:_0x3d0d28,id:_0x2349ed,profile:_0x2e71bc}=_0xf9f77d[_0x5704fc(0x85)];if(_0x2e71bc!=='admin')throw new AppError_1['default'](_0x5704fc(0xb2),0x193);if(process[_0x5704fc(0x8d)][_0x5704fc(0xa1)]==='ON')throw new AppError_1[(_0x5704fc(0x83))](_0x5704fc(0xb2),0x193);const _0xcad07e=await User_1['default']['findOne']({'where':{'id':_0x3ad926}});if(_0x3d0d28!==_0xcad07e['companyId'])return _0x2b32bd['status'](0x190)[_0x5704fc(0x7e)]({'error':_0x5704fc(0xb9)});else{await(0x0,DeleteUserService_1[_0x5704fc(0x83)])(_0x3ad926,_0x3d0d28);const _0x2ce719=(0x0,socket_1[_0x5704fc(0xa5)])();return _0x2ce719['emit'](_0x5704fc(0x9c)+_0x3d0d28+_0x5704fc(0xca),{'action':_0x5704fc(0x94),'userId':_0x3ad926}),_0x2b32bd[_0x5704fc(0x7d)](0xc8)['json']({'message':_0x5704fc(0x84)});}};exports[a36_0x3f1d18(0xaf)]=remove;const list=async(_0xa10705,_0x599e7c)=>{const _0x4d4ea2=a36_0x3f1d18,{companyId:_0xee2469}=_0xa10705[_0x4d4ea2(0x97)],{companyId:_0x3ba898}=_0xa10705[_0x4d4ea2(0x85)],_0x3dc506=await(0x0,SimpleListService_1[_0x4d4ea2(0x83)])({'companyId':_0xee2469?+_0xee2469:_0x3ba898});return _0x599e7c['status'](0xc8)['json'](_0x3dc506);};exports['list']=list;const mediaUpload=async(_0x1f1908,_0x38b040)=>{const _0x27b2f6=a36_0x3f1d18,{userId:_0x53d249}=_0x1f1908[_0x27b2f6(0xd2)],_0x122793=_0x1f1908[_0x27b2f6(0x82)],_0x54384f=(0x0,lodash_2[_0x27b2f6(0xc3)])(_0x122793);try{const _0x2f85fc=await User_1[_0x27b2f6(0x83)][_0x27b2f6(0xab)](_0x53d249);return _0x2f85fc[_0x27b2f6(0x90)]=_0x54384f[_0x27b2f6(0xb5)][_0x27b2f6(0xb3)]('/','-'),await _0x2f85fc[_0x27b2f6(0xbc)](),_0x38b040[_0x27b2f6(0x7d)](0xc8)[_0x27b2f6(0x7e)]({'user':_0x2f85fc,'message':_0x27b2f6(0xa9)});}catch(_0xed6d56){throw new AppError_1[(_0x27b2f6(0x83))](_0xed6d56[_0x27b2f6(0xd6)]);}};exports[a36_0x3f1d18(0xb0)]=mediaUpload;