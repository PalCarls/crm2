'use strict';const a37_0x55e15e=a37_0x5c3f;(function(_0x57d7db,_0xb543dd){const _0x317441=a37_0x5c3f,_0x234246=_0x57d7db();while(!![]){try{const _0x46f80a=-parseInt(_0x317441(0x181))/0x1*(parseInt(_0x317441(0x189))/0x2)+parseInt(_0x317441(0x17e))/0x3*(-parseInt(_0x317441(0x195))/0x4)+-parseInt(_0x317441(0x142))/0x5*(parseInt(_0x317441(0x163))/0x6)+parseInt(_0x317441(0x16d))/0x7*(-parseInt(_0x317441(0x15f))/0x8)+parseInt(_0x317441(0x15d))/0x9*(parseInt(_0x317441(0x16f))/0xa)+-parseInt(_0x317441(0x182))/0xb*(-parseInt(_0x317441(0x191))/0xc)+parseInt(_0x317441(0x140))/0xd*(parseInt(_0x317441(0x194))/0xe);if(_0x46f80a===_0xb543dd)break;else _0x234246['push'](_0x234246['shift']());}catch(_0x3f3ca4){_0x234246['push'](_0x234246['shift']());}}}(a37_0x57c5,0x5e936));var __importDefault=this&&this['__importDefault']||function(_0x1aa9cb){const _0x36f5d4=a37_0x5c3f;return _0x1aa9cb&&_0x1aa9cb[_0x36f5d4(0x197)]?_0x1aa9cb:{'default':_0x1aa9cb};};Object['defineProperty'](exports,a37_0x55e15e(0x197),{'value':!![]}),exports[a37_0x55e15e(0x150)]=exports['list']=exports[a37_0x55e15e(0x14b)]=exports[a37_0x55e15e(0x192)]=exports[a37_0x55e15e(0x16a)]=exports[a37_0x55e15e(0x167)]=exports[a37_0x55e15e(0x17d)]=void 0x0;const socket_1=require(a37_0x55e15e(0x196)),lodash_1=require(a37_0x55e15e(0x18a)),CheckSettings_1=__importDefault(require('../helpers/CheckSettings')),AppError_1=__importDefault(require('../errors/AppError')),CreateUserService_1=__importDefault(require('../services/UserServices/CreateUserService')),ListUsersService_1=__importDefault(require(a37_0x55e15e(0x19a))),UpdateUserService_1=__importDefault(require(a37_0x55e15e(0x17b))),ShowUserService_1=__importDefault(require(a37_0x55e15e(0x178))),DeleteUserService_1=__importDefault(require(a37_0x55e15e(0x14d))),SimpleListService_1=__importDefault(require('../services/UserServices/SimpleListService')),CreateCompanyService_1=__importDefault(require(a37_0x55e15e(0x156))),SendMail_1=require(a37_0x55e15e(0x183)),useDate_1=require(a37_0x55e15e(0x151)),ShowCompanyService_1=__importDefault(require(a37_0x55e15e(0x159))),wbot_1=require('../libs/wbot'),FindCompaniesWhatsappService_1=__importDefault(require(a37_0x55e15e(0x16b))),User_1=__importDefault(require(a37_0x55e15e(0x190))),lodash_2=require('lodash'),index=async(_0x21263b,_0x18ecf2)=>{const _0x20a9c6=a37_0x55e15e,{searchParam:_0x3404ca,pageNumber:_0x12db94}=_0x21263b[_0x20a9c6(0x184)],{companyId:_0x37ab08,profile:_0x2b6a7e}=_0x21263b[_0x20a9c6(0x17f)],{users:_0x2e90da,count:_0x1da931,hasMore:_0x1ce2a5}=await(0x0,ListUsersService_1[_0x20a9c6(0x160)])({'searchParam':_0x3404ca,'pageNumber':_0x12db94,'companyId':_0x37ab08,'profile':_0x2b6a7e});return _0x18ecf2[_0x20a9c6(0x18c)]({'users':_0x2e90da,'count':_0x1da931,'hasMore':_0x1ce2a5});};exports['index']=index;const store=async(_0x1af4aa,_0x1ca033)=>{const _0x14d003=a37_0x55e15e,{email:_0x4a0d40,password:_0x9dfe8d,name:_0x2addc0,phone:_0x4efc64,profile:_0x5459bf,companyId:_0x1926bd,queueIds:_0x5b597b,companyName:_0x204a16,planId:_0x126f2c,startWork:_0x5e8788,endWork:_0x112c2c,whatsappId:_0x808705,allTicket:_0x2abf92,defaultTheme:_0x42170f,defaultMenu:_0x2204fe,allowGroup:_0x53357a}=_0x1af4aa[_0x14d003(0x169)];let _0x33b96f=null;const {dateToClient:_0x3feef0}=(0x0,useDate_1[_0x14d003(0x144)])();if(_0x1af4aa['user']!==undefined){const {companyId:_0xd7cdb3}=_0x1af4aa['user'];_0x33b96f=_0xd7cdb3;}if(_0x1af4aa['url']===_0x14d003(0x143)&&await(0x0,CheckSettings_1[_0x14d003(0x160)])(_0x14d003(0x175))===_0x14d003(0x187))throw new AppError_1['default'](_0x14d003(0x152),0x193);else{if(_0x1af4aa[_0x14d003(0x188)]!==_0x14d003(0x143)&&_0x1af4aa[_0x14d003(0x17f)][_0x14d003(0x14a)]!==_0x14d003(0x157))throw new AppError_1[(_0x14d003(0x160))](_0x14d003(0x154),0x193);}if(process[_0x14d003(0x168)][_0x14d003(0x176)]==='ON')throw new AppError_1['default'](_0x14d003(0x154),0x193);const _0x413bcc=_0x1926bd||_0x33b96f;if(!_0x413bcc){const _0x1fa20b=new Date();_0x1fa20b[_0x14d003(0x145)](_0x1fa20b[_0x14d003(0x170)]()+0x3);const _0x47e0c8=_0x1fa20b['toISOString']()[_0x14d003(0x185)]('T')[0x0],_0x573e4d={'name':_0x204a16,'email':_0x4a0d40,'phone':_0x4efc64,'planId':_0x126f2c,'status':!![],'dueDate':_0x47e0c8,'recurrence':'','document':'','paymentMethod':'','password':_0x9dfe8d,'companyUserName':_0x2addc0,'startWork':_0x5e8788,'endWork':_0x112c2c,'defaultTheme':_0x14d003(0x199),'defaultMenu':_0x14d003(0x166),'allowGroup':![]},_0x558e46=await(0x0,CreateCompanyService_1[_0x14d003(0x160)])(_0x573e4d);try{const _0x28c3a4={'to':_0x4a0d40,'subject':'Login\x20e\x20senha\x20da\x20Empresa\x20'+_0x204a16,'text':_0x14d003(0x147)+_0x2addc0+_0x14d003(0x171)+_0x204a16+'!<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20Segue\x20os\x20dados\x20da\x20sua\x20empresa:<br><br>Nome:\x20'+_0x204a16+_0x14d003(0x172)+_0x4a0d40+_0x14d003(0x18d)+_0x9dfe8d+_0x14d003(0x153)+_0x3feef0(_0x47e0c8)};await(0x0,SendMail_1[_0x14d003(0x16c)])(_0x28c3a4);}catch(_0x1b608c){console[_0x14d003(0x149)]('Não\x20consegui\x20enviar\x20o\x20email');}try{const _0x44063b=await(0x0,ShowCompanyService_1[_0x14d003(0x160)])(0x1),_0x15e385=await(0x0,FindCompaniesWhatsappService_1[_0x14d003(0x160)])(_0x44063b['id']);if(_0x15e385[_0x14d003(0x14f)][0x0]['status']===_0x14d003(0x161)&&(_0x4efc64!==undefined||!(0x0,lodash_1[_0x14d003(0x141)])(_0x4efc64)||!(0x0,lodash_1[_0x14d003(0x15c)])(_0x4efc64))){const _0x3df48b=_0x15e385[_0x14d003(0x14f)][0x0]['id'],_0x5646eb=(0x0,wbot_1['getWbot'])(_0x3df48b),_0x21b4d='Olá\x20'+_0x2addc0+_0x14d003(0x164)+_0x204a16+_0x14d003(0x174)+_0x204a16+_0x14d003(0x14c)+_0x4a0d40+'\x0aSenha:\x20'+_0x9dfe8d+_0x14d003(0x177)+_0x3feef0(_0x47e0c8);await _0x5646eb[_0x14d003(0x198)]('55'+_0x4efc64+_0x14d003(0x15b),{'text':_0x21b4d});}}catch(_0x26c410){console[_0x14d003(0x149)](_0x14d003(0x148));}return _0x1ca033[_0x14d003(0x186)](0xc8)['json'](_0x558e46);}if(_0x413bcc){const _0x4fcef5=await(0x0,CreateUserService_1['default'])({'email':_0x4a0d40,'password':_0x9dfe8d,'name':_0x2addc0,'profile':_0x5459bf,'companyId':_0x413bcc,'queueIds':_0x5b597b,'startWork':_0x5e8788,'endWork':_0x112c2c,'whatsappId':_0x808705,'allTicket':_0x2abf92,'defaultTheme':_0x42170f,'defaultMenu':_0x2204fe,'allowGroup':_0x53357a}),_0x4d35c1=(0x0,socket_1['getIO'])();return _0x4d35c1[_0x14d003(0x155)](_0x14d003(0x173)+_0x33b96f+'-user',{'action':_0x14d003(0x180),'user':_0x4fcef5}),_0x1ca033[_0x14d003(0x186)](0xc8)[_0x14d003(0x18c)](_0x4fcef5);}};exports['store']=store;const show=async(_0x29d1b7,_0x3b6c78)=>{const _0x4be736=a37_0x55e15e,{userId:_0x417315}=_0x29d1b7[_0x4be736(0x17c)],_0x237d0e=await(0x0,ShowUserService_1[_0x4be736(0x160)])(_0x417315);return _0x3b6c78[_0x4be736(0x186)](0xc8)[_0x4be736(0x18c)](_0x237d0e);};function a37_0x5c3f(_0x560074,_0x6332a7){const _0x57c548=a37_0x57c5();return a37_0x5c3f=function(_0x5c3f5a,_0x4e06a3){_0x5c3f5a=_0x5c3f5a-0x140;let _0x46199b=_0x57c548[_0x5c3f5a];return _0x46199b;},a37_0x5c3f(_0x560074,_0x6332a7);}exports['show']=show;const update=async(_0x228010,_0xae69cc)=>{const _0x37af60=a37_0x55e15e;if(process['env']['DEMO']==='ON')throw new AppError_1[(_0x37af60(0x160))](_0x37af60(0x154),0x193);const {id:_0x4d65b0,companyId:_0x145e50}=_0x228010['user'],{userId:_0x2a446e}=_0x228010['params'],_0x4a9977=_0x228010[_0x37af60(0x169)],_0x185a4e=await(0x0,UpdateUserService_1[_0x37af60(0x160)])({'userData':_0x4a9977,'userId':_0x2a446e,'companyId':_0x145e50,'requestUserId':+_0x4d65b0}),_0x576364=(0x0,socket_1['getIO'])();return _0x576364[_0x37af60(0x155)](_0x37af60(0x173)+_0x145e50+_0x37af60(0x18f),{'action':_0x37af60(0x192),'user':_0x185a4e}),_0xae69cc['status'](0xc8)['json'](_0x185a4e);};exports[a37_0x55e15e(0x192)]=update;const remove=async(_0x138622,_0x368eb0)=>{const _0x13ebc1=a37_0x55e15e,{userId:_0x2f641b}=_0x138622[_0x13ebc1(0x17c)],{companyId:_0x776419,id:_0x24f540,profile:_0x144ce3}=_0x138622[_0x13ebc1(0x17f)];if(_0x144ce3!=='admin')throw new AppError_1[(_0x13ebc1(0x160))](_0x13ebc1(0x154),0x193);if(process[_0x13ebc1(0x168)][_0x13ebc1(0x176)]==='ON')throw new AppError_1[(_0x13ebc1(0x160))]('ERR_NO_PERMISSION',0x193);const _0x2725af=await User_1[_0x13ebc1(0x160)][_0x13ebc1(0x15a)]({'where':{'id':_0x2f641b}});if(_0x776419!==_0x2725af[_0x13ebc1(0x165)])return _0x368eb0[_0x13ebc1(0x186)](0x190)[_0x13ebc1(0x18c)]({'error':'Você\x20não\x20possui\x20permissão\x20para\x20acessar\x20este\x20recurso!'});else{await(0x0,DeleteUserService_1['default'])(_0x2f641b,_0x776419);const _0x2da5a1=(0x0,socket_1[_0x13ebc1(0x162)])();return _0x2da5a1[_0x13ebc1(0x155)](_0x13ebc1(0x173)+_0x776419+'-user',{'action':_0x13ebc1(0x17a),'userId':_0x2f641b}),_0x368eb0[_0x13ebc1(0x186)](0xc8)[_0x13ebc1(0x18c)]({'message':_0x13ebc1(0x146)});}};function a37_0x57c5(){const _0x16e5fd=['closed','store','env','body','show','../services/CompanyService/FindCompaniesWhatsappService','SendMail','828275jVrvJD','save','10dgnJms','getDate',',\x20este\x20é\x20um\x20email\x20sobre\x20o\x20cadastro\x20da\x20','<br>Email:\x20','company-','!\x0a\x0aSegue\x20os\x20dados\x20da\x20sua\x20empresa:\x0a\x0aNome:\x20','userCreation','DEMO','\x0aData\x20Vencimento\x20Trial:\x20','../services/UserServices/ShowUserService','message','delete','../services/UserServices/UpdateUserService','params','index','2229qsCTOx','user','create','448313GFAkqw','11lDSiyL','../helpers/SendMail','query','split','status','disabled','url','2esDveZ','lodash','filename','json','<br>Senha:\x20','replace','-user','../models/User','134508rrktUL','update','profileImage','56ZaqDNT','4KFFQWT','../libs/socket','__esModule','sendMessage','light','../services/UserServices/ListUsersService','5381116ZfIsMm','isNil','10TmgEUQ','/signup','useDate','setDate','User\x20deleted','Olá\x20','Não\x20consegui\x20enviar\x20a\x20mensagem','log','profile','remove','\x0aEmail:\x20','../services/UserServices/DeleteUserService','files','whatsapps','mediaUpload','../utils/useDate','ERR_USER_CREATION_DISABLED','<br>Data\x20Vencimento\x20Trial:\x20','ERR_NO_PERMISSION','emit','../services/CompanyService/CreateCompanyService','admin','list','../services/CompanyService/ShowCompanyService','findOne','@s.whatsapp.net','isEmpty','1025361fMRjud','Imagem\x20atualizada','48aoWcha','default','CONNECTED','getIO','703434QHdqGp',',\x20este\x20é\x20uma\x20mensagem\x20sobre\x20o\x20cadastro\x20da\x20','companyId'];a37_0x57c5=function(){return _0x16e5fd;};return a37_0x57c5();}exports[a37_0x55e15e(0x14b)]=remove;const list=async(_0x43d4e9,_0x563478)=>{const _0x23f9bf=a37_0x55e15e,{companyId:_0x50cb9b}=_0x43d4e9[_0x23f9bf(0x184)],{companyId:_0x1613a0}=_0x43d4e9[_0x23f9bf(0x17f)],_0x5a10f3=await(0x0,SimpleListService_1[_0x23f9bf(0x160)])({'companyId':_0x50cb9b?+_0x50cb9b:_0x1613a0});return _0x563478[_0x23f9bf(0x186)](0xc8)[_0x23f9bf(0x18c)](_0x5a10f3);};exports[a37_0x55e15e(0x158)]=list;const mediaUpload=async(_0x1f2c0b,_0x426ef8)=>{const _0x262cd8=a37_0x55e15e,{userId:_0x47ff38}=_0x1f2c0b[_0x262cd8(0x17c)],_0x4487bf=_0x1f2c0b[_0x262cd8(0x14e)],_0x216259=(0x0,lodash_2['head'])(_0x4487bf);try{const _0x499df4=await User_1[_0x262cd8(0x160)]['findByPk'](_0x47ff38);return _0x499df4[_0x262cd8(0x193)]=_0x216259[_0x262cd8(0x18b)][_0x262cd8(0x18e)]('/','-'),await _0x499df4[_0x262cd8(0x16e)](),_0x426ef8['status'](0xc8)[_0x262cd8(0x18c)]({'user':_0x499df4,'message':_0x262cd8(0x15e)});}catch(_0x56a991){throw new AppError_1['default'](_0x56a991[_0x262cd8(0x179)]);}};exports[a37_0x55e15e(0x150)]=mediaUpload;