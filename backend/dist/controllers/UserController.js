'use strict';const a36_0x33b361=a36_0x2a5a;(function(_0x571988,_0x464289){const _0x1072f9=a36_0x2a5a,_0x249282=_0x571988();while(!![]){try{const _0x57cc72=parseInt(_0x1072f9(0xbb))/0x1*(parseInt(_0x1072f9(0xc4))/0x2)+parseInt(_0x1072f9(0xb2))/0x3+parseInt(_0x1072f9(0xa2))/0x4+parseInt(_0x1072f9(0xa0))/0x5*(-parseInt(_0x1072f9(0x8a))/0x6)+-parseInt(_0x1072f9(0xbc))/0x7*(parseInt(_0x1072f9(0xce))/0x8)+parseInt(_0x1072f9(0x81))/0x9*(-parseInt(_0x1072f9(0x89))/0xa)+parseInt(_0x1072f9(0x8f))/0xb;if(_0x57cc72===_0x464289)break;else _0x249282['push'](_0x249282['shift']());}catch(_0x17a3aa){_0x249282['push'](_0x249282['shift']());}}}(a36_0x499b,0x7b1cd));var __importDefault=this&&this[a36_0x33b361(0x83)]||function(_0x58ea3c){return _0x58ea3c&&_0x58ea3c['__esModule']?_0x58ea3c:{'default':_0x58ea3c};};Object[a36_0x33b361(0xd0)](exports,'__esModule',{'value':!![]}),exports[a36_0x33b361(0x82)]=exports['list']=exports[a36_0x33b361(0x94)]=exports[a36_0x33b361(0x85)]=exports[a36_0x33b361(0x9c)]=exports['store']=exports[a36_0x33b361(0xa7)]=void 0x0;const socket_1=require(a36_0x33b361(0xa5)),lodash_1=require(a36_0x33b361(0xac)),CheckSettings_1=__importDefault(require('../helpers/CheckSettings')),AppError_1=__importDefault(require(a36_0x33b361(0x99))),CreateUserService_1=__importDefault(require(a36_0x33b361(0xad))),ListUsersService_1=__importDefault(require('../services/UserServices/ListUsersService')),UpdateUserService_1=__importDefault(require(a36_0x33b361(0xc2))),ShowUserService_1=__importDefault(require(a36_0x33b361(0xc1))),DeleteUserService_1=__importDefault(require(a36_0x33b361(0x8e))),SimpleListService_1=__importDefault(require(a36_0x33b361(0x7b))),CreateCompanyService_1=__importDefault(require('../services/CompanyService/CreateCompanyService')),SendMail_1=require('../helpers/SendMail'),useDate_1=require(a36_0x33b361(0xb6)),ShowCompanyService_1=__importDefault(require(a36_0x33b361(0xcc))),wbot_1=require(a36_0x33b361(0xc8)),FindCompaniesWhatsappService_1=__importDefault(require(a36_0x33b361(0x93))),User_1=__importDefault(require('../models/User')),lodash_2=require(a36_0x33b361(0xac)),index=async(_0x58dadd,_0x535b95)=>{const _0x165f63=a36_0x33b361,{searchParam:_0x4294a2,pageNumber:_0x248ffd}=_0x58dadd[_0x165f63(0xaa)],{companyId:_0xfa292d,profile:_0x557f8f}=_0x58dadd[_0x165f63(0xa9)],{users:_0x4aadfe,count:_0x3c0992,hasMore:_0x5c72b9}=await(0x0,ListUsersService_1['default'])({'searchParam':_0x4294a2,'pageNumber':_0x248ffd,'companyId':_0xfa292d,'profile':_0x557f8f});return _0x535b95[_0x165f63(0xa8)]({'users':_0x4aadfe,'count':_0x3c0992,'hasMore':_0x5c72b9});};exports[a36_0x33b361(0xa7)]=index;function a36_0x499b(){const _0x458660=['/signup','create','DEMO','filename','9cBPeSr','mediaUpload','__importDefault','sendMessage','update','Você\x20não\x20possui\x20permissão\x20para\x20acessar\x20este\x20recurso!','body','closed','2883380eJIJIZ','27816FJkavC','params','toISOString','log','../services/UserServices/DeleteUserService','3885981mKAass','whatsapps','useDate','default','../services/CompanyService/FindCompaniesWhatsappService','remove','ERR_NO_PERMISSION','\x0aSenha:\x20','company-','getIO','../errors/AppError','!\x0a\x0aSegue\x20os\x20dados\x20da\x20sua\x20empresa:\x0a\x0aNome:\x20','emit','show','store','SendMail','status','980tFBwjZ','companyId','904244dqoINo','disabled','message','../libs/socket','Não\x20consegui\x20enviar\x20a\x20mensagem','index','json','user','query','Não\x20consegui\x20enviar\x20o\x20email','lodash','../services/UserServices/CreateUserService',',\x20este\x20é\x20uma\x20mensagem\x20sobre\x20o\x20cadastro\x20da\x20','Login\x20e\x20senha\x20da\x20Empresa\x20','userCreation','profile','1710483JbeFLJ','split','replace','findByPk','../utils/useDate','admin','<br>Senha:\x20','\x0aEmail:\x20','profileImage','1mziYKH','21wZgHzl','url','Olá\x20','getWbot','isEmpty','../services/UserServices/ShowUserService','../services/UserServices/UpdateUserService','User\x20deleted','1252742osxFhc','delete','<br>Email:\x20','save','../libs/wbot','CONNECTED','<br>Data\x20Vencimento\x20Trial:\x20','Imagem\x20atualizada','../services/CompanyService/ShowCompanyService','list','198936QvWTtY','getDate','defineProperty','findOne','isNil','../services/UserServices/SimpleListService','-user'];a36_0x499b=function(){return _0x458660;};return a36_0x499b();}const store=async(_0x3a24d6,_0x1cec1c)=>{const _0x506cb8=a36_0x33b361,{email:_0x38e8ba,password:_0x4bf3a0,name:_0x31d024,phone:_0x11879d,profile:_0xb33570,companyId:_0xc41411,queueIds:_0x390210,companyName:_0x552068,planId:_0x372d5a,startWork:_0x4a8a8b,endWork:_0x3a9782,whatsappId:_0x41c82c,allTicket:_0x4ca131,defaultTheme:_0x4e95d3,defaultMenu:_0x3687bf,allowGroup:_0x45491a}=_0x3a24d6['body'];let _0x41bff3=null;const {dateToClient:_0x1bca8f}=(0x0,useDate_1[_0x506cb8(0x91)])();if(_0x3a24d6['user']!==undefined){const {companyId:_0x3b646b}=_0x3a24d6['user'];_0x41bff3=_0x3b646b;}if(_0x3a24d6[_0x506cb8(0xbd)]===_0x506cb8(0x7d)&&await(0x0,CheckSettings_1['default'])(_0x506cb8(0xb0))===_0x506cb8(0xa3))throw new AppError_1['default']('ERR_USER_CREATION_DISABLED',0x193);else{if(_0x3a24d6[_0x506cb8(0xbd)]!==_0x506cb8(0x7d)&&_0x3a24d6[_0x506cb8(0xa9)][_0x506cb8(0xb1)]!=='admin')throw new AppError_1['default'](_0x506cb8(0x95),0x193);}if(process['env'][_0x506cb8(0x7f)]==='ON')throw new AppError_1[(_0x506cb8(0x92))](_0x506cb8(0x95),0x193);const _0x2573ef=_0xc41411||_0x41bff3;if(!_0x2573ef){const _0x44eee4=new Date();_0x44eee4['setDate'](_0x44eee4[_0x506cb8(0xcf)]()+0x3);const _0x201c7d=_0x44eee4[_0x506cb8(0x8c)]()[_0x506cb8(0xb3)]('T')[0x0],_0x2cbd90={'name':_0x552068,'email':_0x38e8ba,'phone':_0x11879d,'planId':_0x372d5a,'status':!![],'dueDate':_0x201c7d,'recurrence':'','document':'','paymentMethod':'','password':_0x4bf3a0,'companyUserName':_0x31d024,'startWork':_0x4a8a8b,'endWork':_0x3a9782,'defaultTheme':'light','defaultMenu':_0x506cb8(0x88),'allowGroup':![]},_0x5a0dfe=await(0x0,CreateCompanyService_1[_0x506cb8(0x92)])(_0x2cbd90);try{const _0x4a22e1={'to':_0x38e8ba,'subject':_0x506cb8(0xaf)+_0x552068,'text':_0x506cb8(0xbe)+_0x31d024+',\x20este\x20é\x20um\x20email\x20sobre\x20o\x20cadastro\x20da\x20'+_0x552068+'!<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20Segue\x20os\x20dados\x20da\x20sua\x20empresa:<br><br>Nome:\x20'+_0x552068+_0x506cb8(0xc6)+_0x38e8ba+_0x506cb8(0xb8)+_0x4bf3a0+_0x506cb8(0xca)+_0x1bca8f(_0x201c7d)};await(0x0,SendMail_1[_0x506cb8(0x9e)])(_0x4a22e1);}catch(_0x153deb){console[_0x506cb8(0x8d)](_0x506cb8(0xab));}try{const _0x4ddd02=await(0x0,ShowCompanyService_1[_0x506cb8(0x92)])(0x1),_0x31c093=await(0x0,FindCompaniesWhatsappService_1[_0x506cb8(0x92)])(_0x4ddd02['id']);if(_0x31c093[_0x506cb8(0x90)][0x0][_0x506cb8(0x9f)]===_0x506cb8(0xc9)&&(_0x11879d!==undefined||!(0x0,lodash_1[_0x506cb8(0xd2)])(_0x11879d)||!(0x0,lodash_1[_0x506cb8(0xc0)])(_0x11879d))){const _0x2519af=_0x31c093['whatsapps'][0x0]['id'],_0x5a4478=(0x0,wbot_1[_0x506cb8(0xbf)])(_0x2519af),_0x3f0bea='Olá\x20'+_0x31d024+_0x506cb8(0xae)+_0x552068+_0x506cb8(0x9a)+_0x552068+_0x506cb8(0xb9)+_0x38e8ba+_0x506cb8(0x96)+_0x4bf3a0+'\x0aData\x20Vencimento\x20Trial:\x20'+_0x1bca8f(_0x201c7d);await _0x5a4478[_0x506cb8(0x84)]('55'+_0x11879d+'@s.whatsapp.net',{'text':_0x3f0bea});}}catch(_0x1dd4c7){console[_0x506cb8(0x8d)](_0x506cb8(0xa6));}return _0x1cec1c[_0x506cb8(0x9f)](0xc8)[_0x506cb8(0xa8)](_0x5a0dfe);}if(_0x2573ef){const _0x3134ea=await(0x0,CreateUserService_1[_0x506cb8(0x92)])({'email':_0x38e8ba,'password':_0x4bf3a0,'name':_0x31d024,'profile':_0xb33570,'companyId':_0x2573ef,'queueIds':_0x390210,'startWork':_0x4a8a8b,'endWork':_0x3a9782,'whatsappId':_0x41c82c,'allTicket':_0x4ca131,'defaultTheme':_0x4e95d3,'defaultMenu':_0x3687bf,'allowGroup':_0x45491a}),_0x252244=(0x0,socket_1[_0x506cb8(0x98)])();return _0x252244['emit'](_0x506cb8(0x97)+_0x41bff3+_0x506cb8(0x7c),{'action':_0x506cb8(0x7e),'user':_0x3134ea}),_0x1cec1c[_0x506cb8(0x9f)](0xc8)['json'](_0x3134ea);}};exports[a36_0x33b361(0x9d)]=store;const show=async(_0x4d9dac,_0x656c63)=>{const _0x41a71c=a36_0x33b361,{userId:_0x34e8bc}=_0x4d9dac['params'],_0x36e37e=await(0x0,ShowUserService_1[_0x41a71c(0x92)])(_0x34e8bc);return _0x656c63['status'](0xc8)[_0x41a71c(0xa8)](_0x36e37e);};exports[a36_0x33b361(0x9c)]=show;const update=async(_0xff0d43,_0x2c75e6)=>{const _0x5c6680=a36_0x33b361;if(process['env'][_0x5c6680(0x7f)]==='ON')throw new AppError_1[(_0x5c6680(0x92))]('ERR_NO_PERMISSION',0x193);const {id:_0x3645fc,companyId:_0x23a482}=_0xff0d43[_0x5c6680(0xa9)],{userId:_0x17d18b}=_0xff0d43[_0x5c6680(0x8b)],_0xb0e0c0=_0xff0d43[_0x5c6680(0x87)],_0xf8a9bb=await(0x0,UpdateUserService_1[_0x5c6680(0x92)])({'userData':_0xb0e0c0,'userId':_0x17d18b,'companyId':_0x23a482,'requestUserId':+_0x3645fc}),_0x8fcda9=(0x0,socket_1[_0x5c6680(0x98)])();return _0x8fcda9[_0x5c6680(0x9b)](_0x5c6680(0x97)+_0x23a482+_0x5c6680(0x7c),{'action':'update','user':_0xf8a9bb}),_0x2c75e6[_0x5c6680(0x9f)](0xc8)[_0x5c6680(0xa8)](_0xf8a9bb);};exports[a36_0x33b361(0x85)]=update;const remove=async(_0x481a54,_0x4d5f66)=>{const _0xf3cc58=a36_0x33b361,{userId:_0x16783e}=_0x481a54[_0xf3cc58(0x8b)],{companyId:_0x8d1c01,id:_0x2caf3a,profile:_0x2e10aa}=_0x481a54[_0xf3cc58(0xa9)];if(_0x2e10aa!==_0xf3cc58(0xb7))throw new AppError_1[(_0xf3cc58(0x92))](_0xf3cc58(0x95),0x193);if(process['env'][_0xf3cc58(0x7f)]==='ON')throw new AppError_1[(_0xf3cc58(0x92))](_0xf3cc58(0x95),0x193);const _0x448280=await User_1[_0xf3cc58(0x92)][_0xf3cc58(0xd1)]({'where':{'id':_0x16783e}});if(_0x8d1c01!==_0x448280[_0xf3cc58(0xa1)])return _0x4d5f66[_0xf3cc58(0x9f)](0x190)[_0xf3cc58(0xa8)]({'error':_0xf3cc58(0x86)});else{await(0x0,DeleteUserService_1[_0xf3cc58(0x92)])(_0x16783e,_0x8d1c01);const _0x502435=(0x0,socket_1[_0xf3cc58(0x98)])();return _0x502435[_0xf3cc58(0x9b)]('company-'+_0x8d1c01+_0xf3cc58(0x7c),{'action':_0xf3cc58(0xc5),'userId':_0x16783e}),_0x4d5f66[_0xf3cc58(0x9f)](0xc8)[_0xf3cc58(0xa8)]({'message':_0xf3cc58(0xc3)});}};exports[a36_0x33b361(0x94)]=remove;const list=async(_0x234ba8,_0x29003a)=>{const _0x26e668=a36_0x33b361,{companyId:_0x11f6c1}=_0x234ba8[_0x26e668(0xaa)],{companyId:_0x5f4d5b}=_0x234ba8['user'],_0x393b8d=await(0x0,SimpleListService_1[_0x26e668(0x92)])({'companyId':_0x11f6c1?+_0x11f6c1:_0x5f4d5b});return _0x29003a[_0x26e668(0x9f)](0xc8)[_0x26e668(0xa8)](_0x393b8d);};exports[a36_0x33b361(0xcd)]=list;function a36_0x2a5a(_0x41fd7c,_0x538dd0){const _0x499b70=a36_0x499b();return a36_0x2a5a=function(_0x2a5a82,_0x52e995){_0x2a5a82=_0x2a5a82-0x7b;let _0x3e957f=_0x499b70[_0x2a5a82];return _0x3e957f;},a36_0x2a5a(_0x41fd7c,_0x538dd0);}const mediaUpload=async(_0xd85f4f,_0x1f7cd)=>{const _0x27a6c7=a36_0x33b361,{userId:_0x3cf777}=_0xd85f4f[_0x27a6c7(0x8b)],_0x5703db=_0xd85f4f['files'],_0x2ff3ad=(0x0,lodash_2['head'])(_0x5703db);try{const _0x228b8b=await User_1['default'][_0x27a6c7(0xb5)](_0x3cf777);return _0x228b8b[_0x27a6c7(0xba)]=_0x2ff3ad[_0x27a6c7(0x80)][_0x27a6c7(0xb4)]('/','-'),await _0x228b8b[_0x27a6c7(0xc7)](),_0x1f7cd['status'](0xc8)[_0x27a6c7(0xa8)]({'user':_0x228b8b,'message':_0x27a6c7(0xcb)});}catch(_0x329cde){throw new AppError_1[(_0x27a6c7(0x92))](_0x329cde[_0x27a6c7(0xa4)]);}};exports[a36_0x33b361(0x82)]=mediaUpload;