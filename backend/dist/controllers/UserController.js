'use strict';const a37_0x212d9f=a37_0xb5ec;(function(_0x25c546,_0x7d052){const _0x59ade3=a37_0xb5ec,_0x5ab444=_0x25c546();while(!![]){try{const _0x4723bb=-parseInt(_0x59ade3(0x1f6))/0x1*(parseInt(_0x59ade3(0x214))/0x2)+-parseInt(_0x59ade3(0x211))/0x3*(-parseInt(_0x59ade3(0x1e3))/0x4)+-parseInt(_0x59ade3(0x1dd))/0x5+parseInt(_0x59ade3(0x1e4))/0x6*(parseInt(_0x59ade3(0x219))/0x7)+-parseInt(_0x59ade3(0x1e5))/0x8+parseInt(_0x59ade3(0x1f3))/0x9+parseInt(_0x59ade3(0x1de))/0xa;if(_0x4723bb===_0x7d052)break;else _0x5ab444['push'](_0x5ab444['shift']());}catch(_0x3ff3ff){_0x5ab444['push'](_0x5ab444['shift']());}}}(a37_0x32ec,0x84a82));var __importDefault=this&&this[a37_0x212d9f(0x206)]||function(_0x43f38d){return _0x43f38d&&_0x43f38d['__esModule']?_0x43f38d:{'default':_0x43f38d};};Object[a37_0x212d9f(0x20b)](exports,a37_0x212d9f(0x1ce),{'value':!![]}),exports['mediaUpload']=exports[a37_0x212d9f(0x216)]=exports['remove']=exports[a37_0x212d9f(0x1ee)]=exports['show']=exports[a37_0x212d9f(0x1fd)]=exports[a37_0x212d9f(0x21c)]=void 0x0;function a37_0xb5ec(_0x24111e,_0x253401){const _0x32ec14=a37_0x32ec();return a37_0xb5ec=function(_0xb5ecd2,_0x71db56){_0xb5ecd2=_0xb5ecd2-0x1cd;let _0x3b713f=_0x32ec14[_0xb5ecd2];return _0x3b713f;},a37_0xb5ec(_0x24111e,_0x253401);}const socket_1=require('../libs/socket'),lodash_1=require(a37_0x212d9f(0x1e1)),CheckSettings_1=__importDefault(require(a37_0x212d9f(0x1df))),AppError_1=__importDefault(require(a37_0x212d9f(0x1da))),CreateUserService_1=__importDefault(require(a37_0x212d9f(0x21f))),ListUsersService_1=__importDefault(require(a37_0x212d9f(0x1cf))),UpdateUserService_1=__importDefault(require(a37_0x212d9f(0x1d4))),ShowUserService_1=__importDefault(require(a37_0x212d9f(0x1e9))),DeleteUserService_1=__importDefault(require(a37_0x212d9f(0x1f0))),SimpleListService_1=__importDefault(require('../services/UserServices/SimpleListService')),CreateCompanyService_1=__importDefault(require(a37_0x212d9f(0x218))),SendMail_1=require(a37_0x212d9f(0x1fa)),useDate_1=require(a37_0x212d9f(0x209)),ShowCompanyService_1=__importDefault(require(a37_0x212d9f(0x1f2))),wbot_1=require('../libs/wbot'),FindCompaniesWhatsappService_1=__importDefault(require(a37_0x212d9f(0x1e8))),User_1=__importDefault(require('../models/User')),lodash_2=require('lodash'),index=async(_0x58d487,_0x32def6)=>{const _0x457043=a37_0x212d9f,{searchParam:_0x4d0902,pageNumber:_0x5d83fd}=_0x58d487[_0x457043(0x1f5)],{companyId:_0x42a971,profile:_0x39c45e}=_0x58d487[_0x457043(0x21e)],{users:_0x5f1476,count:_0x2b8ce9,hasMore:_0x3e6057}=await(0x0,ListUsersService_1[_0x457043(0x210)])({'searchParam':_0x4d0902,'pageNumber':_0x5d83fd,'companyId':_0x42a971,'profile':_0x39c45e});return _0x32def6[_0x457043(0x1fb)]({'users':_0x5f1476,'count':_0x2b8ce9,'hasMore':_0x3e6057});};exports[a37_0x212d9f(0x21c)]=index;const store=async(_0x36b1c9,_0x3cb5a4)=>{const _0x410cb9=a37_0x212d9f,{email:_0x4b6d51,password:_0x52ab94,name:_0x2616cd,phone:_0x148216,profile:_0x18e284,companyId:_0x223849,queueIds:_0x52dc8f,companyName:_0x292b59,planId:_0x4b0db5,startWork:_0x461d63,endWork:_0x23d697,whatsappId:_0x2e55f0,allTicket:_0x12c034,defaultTheme:_0x36c92e,defaultMenu:_0x4f32ce,allowGroup:_0x359351}=_0x36b1c9[_0x410cb9(0x213)];let _0x47cae8=null;const {dateToClient:_0x753050}=(0x0,useDate_1[_0x410cb9(0x1f7)])();if(_0x36b1c9[_0x410cb9(0x21e)]!==undefined){const {companyId:_0x440c2d}=_0x36b1c9[_0x410cb9(0x21e)];_0x47cae8=_0x440c2d;}if(_0x36b1c9[_0x410cb9(0x20d)]===_0x410cb9(0x208)&&await(0x0,CheckSettings_1[_0x410cb9(0x210)])(_0x410cb9(0x1e2))===_0x410cb9(0x203))throw new AppError_1[(_0x410cb9(0x210))]('ERR_USER_CREATION_DISABLED',0x193);else{if(_0x36b1c9['url']!==_0x410cb9(0x208)&&_0x36b1c9[_0x410cb9(0x21e)][_0x410cb9(0x1d9)]!==_0x410cb9(0x1e0))throw new AppError_1['default'](_0x410cb9(0x1d1),0x193);}if(process[_0x410cb9(0x1d3)][_0x410cb9(0x217)]==='ON')throw new AppError_1[(_0x410cb9(0x210))](_0x410cb9(0x1d1),0x193);const _0x972d64=_0x223849||_0x47cae8;if(!_0x972d64){const _0x530376=new Date();_0x530376['setDate'](_0x530376[_0x410cb9(0x1fe)]()+0x3);const _0x49cee0=_0x530376['toISOString']()[_0x410cb9(0x1d5)]('T')[0x0],_0x548b13={'name':_0x292b59,'email':_0x4b6d51,'phone':_0x148216,'planId':_0x4b0db5,'status':!![],'dueDate':_0x49cee0,'recurrence':'','document':'','paymentMethod':'','password':_0x52ab94,'companyUserName':_0x2616cd,'startWork':_0x461d63,'endWork':_0x23d697,'defaultTheme':_0x410cb9(0x1d8),'defaultMenu':_0x410cb9(0x1ec),'allowGroup':![]},_0x3e2b79=await(0x0,CreateCompanyService_1[_0x410cb9(0x210)])(_0x548b13);try{const _0x28c7e1={'to':_0x4b6d51,'subject':_0x410cb9(0x1f9)+_0x292b59,'text':_0x410cb9(0x1fc)+_0x2616cd+',\x20este\x20é\x20um\x20email\x20sobre\x20o\x20cadastro\x20da\x20'+_0x292b59+_0x410cb9(0x20e)+_0x292b59+_0x410cb9(0x1db)+_0x4b6d51+_0x410cb9(0x1eb)+_0x52ab94+_0x410cb9(0x21a)+_0x753050(_0x49cee0)};await(0x0,SendMail_1['SendMail'])(_0x28c7e1);}catch(_0x39b787){console[_0x410cb9(0x204)](_0x410cb9(0x200));}try{const _0x3ead4a=await(0x0,ShowCompanyService_1[_0x410cb9(0x210)])(0x1),_0x42ce74=await(0x0,FindCompaniesWhatsappService_1[_0x410cb9(0x210)])(_0x3ead4a['id']);if(_0x42ce74[_0x410cb9(0x1dc)][0x0][_0x410cb9(0x201)]==='CONNECTED'&&(_0x148216!==undefined||!(0x0,lodash_1[_0x410cb9(0x1ff)])(_0x148216)||!(0x0,lodash_1[_0x410cb9(0x1f4)])(_0x148216))){const _0x358136=_0x42ce74['whatsapps'][0x0]['id'],_0x4dc9c9=(0x0,wbot_1[_0x410cb9(0x220)])(_0x358136),_0x12c45f='Olá\x20'+_0x2616cd+',\x20este\x20é\x20uma\x20mensagem\x20sobre\x20o\x20cadastro\x20da\x20'+_0x292b59+_0x410cb9(0x221)+_0x292b59+'\x0aEmail:\x20'+_0x4b6d51+_0x410cb9(0x1ed)+_0x52ab94+_0x410cb9(0x207)+_0x753050(_0x49cee0);await _0x4dc9c9['sendMessage']('55'+_0x148216+_0x410cb9(0x1f8),{'text':_0x12c45f});}}catch(_0x16b162){console[_0x410cb9(0x204)](_0x410cb9(0x21b));}return _0x3cb5a4['status'](0xc8)['json'](_0x3e2b79);}if(_0x972d64){const _0x3fa683=await(0x0,CreateUserService_1[_0x410cb9(0x210)])({'email':_0x4b6d51,'password':_0x52ab94,'name':_0x2616cd,'profile':_0x18e284,'companyId':_0x972d64,'queueIds':_0x52dc8f,'startWork':_0x461d63,'endWork':_0x23d697,'whatsappId':_0x2e55f0,'allTicket':_0x12c034,'defaultTheme':_0x36c92e,'defaultMenu':_0x4f32ce,'allowGroup':_0x359351}),_0x2125de=(0x0,socket_1[_0x410cb9(0x1e6)])();return _0x2125de['emit'](_0x410cb9(0x1d6)+_0x47cae8+_0x410cb9(0x215),{'action':_0x410cb9(0x1d0),'user':_0x3fa683}),_0x3cb5a4[_0x410cb9(0x201)](0xc8)['json'](_0x3fa683);}};exports[a37_0x212d9f(0x1fd)]=store;const show=async(_0x3bcd20,_0x2be6e1)=>{const _0xbc0178=a37_0x212d9f,{userId:_0x445d75}=_0x3bcd20['params'],_0x2b4346=await(0x0,ShowUserService_1[_0xbc0178(0x210)])(_0x445d75);return _0x2be6e1[_0xbc0178(0x201)](0xc8)[_0xbc0178(0x1fb)](_0x2b4346);};exports[a37_0x212d9f(0x1d7)]=show;const update=async(_0x398742,_0x13330b)=>{const _0x6f70d8=a37_0x212d9f;if(process[_0x6f70d8(0x1d3)][_0x6f70d8(0x217)]==='ON')throw new AppError_1['default']('ERR_NO_PERMISSION',0x193);const {id:_0x103231,companyId:_0x26bc68}=_0x398742[_0x6f70d8(0x21e)],{userId:_0x33cd7e}=_0x398742[_0x6f70d8(0x1cd)],_0x2542c9=_0x398742[_0x6f70d8(0x213)],_0x55ee4b=await(0x0,UpdateUserService_1['default'])({'userData':_0x2542c9,'userId':_0x33cd7e,'companyId':_0x26bc68,'requestUserId':+_0x103231}),_0x359ace=(0x0,socket_1[_0x6f70d8(0x1e6)])();return _0x359ace[_0x6f70d8(0x202)](_0x6f70d8(0x1d6)+_0x26bc68+_0x6f70d8(0x215),{'action':'update','user':_0x55ee4b}),_0x13330b[_0x6f70d8(0x201)](0xc8)[_0x6f70d8(0x1fb)](_0x55ee4b);};exports[a37_0x212d9f(0x1ee)]=update;const remove=async(_0x1d60bf,_0x22bd1a)=>{const _0xe7dcfb=a37_0x212d9f,{userId:_0x3201b1}=_0x1d60bf['params'],{companyId:_0xcc3588,id:_0x20acf0,profile:_0x5edcd7}=_0x1d60bf[_0xe7dcfb(0x21e)];if(_0x5edcd7!==_0xe7dcfb(0x1e0))throw new AppError_1[(_0xe7dcfb(0x210))](_0xe7dcfb(0x1d1),0x193);if(process[_0xe7dcfb(0x1d3)]['DEMO']==='ON')throw new AppError_1[(_0xe7dcfb(0x210))](_0xe7dcfb(0x1d1),0x193);const _0x2dc7bd=await User_1['default']['findOne']({'where':{'id':_0x3201b1}});if(_0xcc3588!==_0x2dc7bd[_0xe7dcfb(0x20a)])return _0x22bd1a[_0xe7dcfb(0x201)](0x190)[_0xe7dcfb(0x1fb)]({'error':_0xe7dcfb(0x205)});else{await(0x0,DeleteUserService_1['default'])(_0x3201b1,_0xcc3588);const _0x4a44f6=(0x0,socket_1[_0xe7dcfb(0x1e6)])();return _0x4a44f6['emit'](_0xe7dcfb(0x1d6)+_0xcc3588+'-user',{'action':_0xe7dcfb(0x1d2),'userId':_0x3201b1}),_0x22bd1a[_0xe7dcfb(0x201)](0xc8)['json']({'message':'User\x20deleted'});}};exports[a37_0x212d9f(0x21d)]=remove;function a37_0x32ec(){const _0xaf8020=['201672owkOTY','getIO','save','../services/CompanyService/FindCompaniesWhatsappService','../services/UserServices/ShowUserService','files','<br>Senha:\x20','closed','\x0aSenha:\x20','update','message','../services/UserServices/DeleteUserService','mediaUpload','../services/CompanyService/ShowCompanyService','2419515iUASeL','isEmpty','query','680293Hvakkf','useDate','@s.whatsapp.net','Login\x20e\x20senha\x20da\x20Empresa\x20','../helpers/SendMail','json','Olá\x20','store','getDate','isNil','Não\x20consegui\x20enviar\x20o\x20email','status','emit','disabled','log','Você\x20não\x20possui\x20permissão\x20para\x20acessar\x20este\x20recurso!','__importDefault','\x0aData\x20Vencimento\x20Trial:\x20','/signup','../utils/useDate','companyId','defineProperty','replace','url','!<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20Segue\x20os\x20dados\x20da\x20sua\x20empresa:<br><br>Nome:\x20','findByPk','default','357NUiuaO','Imagem\x20atualizada','body','2tkQaVL','-user','list','DEMO','../services/CompanyService/CreateCompanyService','7YsuYIf','<br>Data\x20Vencimento\x20Trial:\x20','Não\x20consegui\x20enviar\x20a\x20mensagem','index','remove','user','../services/UserServices/CreateUserService','getWbot','!\x0a\x0aSegue\x20os\x20dados\x20da\x20sua\x20empresa:\x0a\x0aNome:\x20','params','__esModule','../services/UserServices/ListUsersService','create','ERR_NO_PERMISSION','delete','env','../services/UserServices/UpdateUserService','split','company-','show','light','profile','../errors/AppError','<br>Email:\x20','whatsapps','2893155bcIjRZ','5959920bePtXn','../helpers/CheckSettings','admin','lodash','userCreation','27964kwihrf','784434kjVjFn'];a37_0x32ec=function(){return _0xaf8020;};return a37_0x32ec();}const list=async(_0x1673e5,_0x42a2a6)=>{const _0x4b2ad9=a37_0x212d9f,{companyId:_0x19261d}=_0x1673e5[_0x4b2ad9(0x1f5)],{companyId:_0x6a7831}=_0x1673e5[_0x4b2ad9(0x21e)],_0x8d1aea=await(0x0,SimpleListService_1['default'])({'companyId':_0x19261d?+_0x19261d:_0x6a7831});return _0x42a2a6[_0x4b2ad9(0x201)](0xc8)[_0x4b2ad9(0x1fb)](_0x8d1aea);};exports[a37_0x212d9f(0x216)]=list;const mediaUpload=async(_0x4318e9,_0x57a1f2)=>{const _0x1e5281=a37_0x212d9f,{userId:_0x23ced4}=_0x4318e9[_0x1e5281(0x1cd)],_0x37eb0c=_0x4318e9[_0x1e5281(0x1ea)],_0x4e32fa=(0x0,lodash_2['head'])(_0x37eb0c);try{const _0xcf5f7=await User_1['default'][_0x1e5281(0x20f)](_0x23ced4);return _0xcf5f7['profileImage']=_0x4e32fa['filename'][_0x1e5281(0x20c)]('/','-'),await _0xcf5f7[_0x1e5281(0x1e7)](),_0x57a1f2[_0x1e5281(0x201)](0xc8)['json']({'user':_0xcf5f7,'message':_0x1e5281(0x212)});}catch(_0x2d691b){throw new AppError_1[(_0x1e5281(0x210))](_0x2d691b[_0x1e5281(0x1ef)]);}};exports[a37_0x212d9f(0x1f1)]=mediaUpload;