'use strict';const a37_0x33b257=a37_0x3a88;(function(_0x18804e,_0x127fb4){const _0x324d78=a37_0x3a88,_0x201802=_0x18804e();while(!![]){try{const _0x33c021=parseInt(_0x324d78(0x1f6))/0x1+parseInt(_0x324d78(0x1ec))/0x2+parseInt(_0x324d78(0x1d4))/0x3+parseInt(_0x324d78(0x1e3))/0x4*(-parseInt(_0x324d78(0x1bf))/0x5)+-parseInt(_0x324d78(0x1ae))/0x6+parseInt(_0x324d78(0x1ba))/0x7+-parseInt(_0x324d78(0x1b3))/0x8;if(_0x33c021===_0x127fb4)break;else _0x201802['push'](_0x201802['shift']());}catch(_0x48d2d9){_0x201802['push'](_0x201802['shift']());}}}(a37_0x5dda,0xe1921));function a37_0x5dda(){const _0x2ab5fb=['ERR_NO_PERMISSION','admin','isNil','isEmpty','findByPk','<br>Senha:\x20','update','user','/signup','getDate','log','Login\x20e\x20senha\x20da\x20Empresa\x20','@s.whatsapp.net','useDate','remove','show','3881670axjtcu','body','DEMO','../services/UserServices/SimpleListService','SendMail','../services/CompanyService/ShowCompanyService','company-','../services/CompanyService/FindCompaniesWhatsappService','profile','../services/UserServices/CreateUserService','save','replace','env','list','mediaUpload','463656jjCFxV','query','findOne','lodash','profileImage','getIO','Olá\x20','disabled','companyId','1073686OHOeAZ','../services/CompanyService/CreateCompanyService','json','params','../utils/useDate','url','emit','../services/UserServices/ListUsersService','../services/UserServices/DeleteUserService','index','1723390fJWMcG','getWbot','message',',\x20este\x20é\x20um\x20email\x20sobre\x20o\x20cadastro\x20da\x20','!\x0a\x0aSegue\x20os\x20dados\x20da\x20sua\x20empresa:\x0a\x0aNome:\x20','head','userCreation','\x0aData\x20Vencimento\x20Trial:\x20','status','light','files','4118832TKjYkx','\x0aEmail:\x20','-user','<br>Data\x20Vencimento\x20Trial:\x20','store','10475912SlqQIU','\x0aSenha:\x20','whatsapps','setDate','../services/UserServices/ShowUserService','Não\x20consegui\x20enviar\x20a\x20mensagem','filename','428813mFiSCl','default','Imagem\x20atualizada','closed','../helpers/SendMail','30EekOtG','split','!<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20Segue\x20os\x20dados\x20da\x20sua\x20empresa:<br><br>Nome:\x20','__esModule','<br>Email:\x20'];a37_0x5dda=function(){return _0x2ab5fb;};return a37_0x5dda();}var __importDefault=this&&this['__importDefault']||function(_0x27838f){const _0x19a04f=a37_0x3a88;return _0x27838f&&_0x27838f[_0x19a04f(0x1c2)]?_0x27838f:{'default':_0x27838f};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a37_0x33b257(0x1e2)]=exports[a37_0x33b257(0x1e1)]=exports[a37_0x33b257(0x1d2)]=exports[a37_0x33b257(0x1ca)]=exports['show']=exports[a37_0x33b257(0x1b2)]=exports[a37_0x33b257(0x1f5)]=void 0x0;const socket_1=require('../libs/socket'),lodash_1=require(a37_0x33b257(0x1e6)),CheckSettings_1=__importDefault(require('../helpers/CheckSettings')),AppError_1=__importDefault(require('../errors/AppError')),CreateUserService_1=__importDefault(require(a37_0x33b257(0x1dd))),ListUsersService_1=__importDefault(require(a37_0x33b257(0x1f3))),UpdateUserService_1=__importDefault(require('../services/UserServices/UpdateUserService')),ShowUserService_1=__importDefault(require(a37_0x33b257(0x1b7))),DeleteUserService_1=__importDefault(require(a37_0x33b257(0x1f4))),SimpleListService_1=__importDefault(require(a37_0x33b257(0x1d7))),CreateCompanyService_1=__importDefault(require(a37_0x33b257(0x1ed))),SendMail_1=require(a37_0x33b257(0x1be)),useDate_1=require(a37_0x33b257(0x1f0)),ShowCompanyService_1=__importDefault(require(a37_0x33b257(0x1d9))),wbot_1=require('../libs/wbot'),FindCompaniesWhatsappService_1=__importDefault(require(a37_0x33b257(0x1db))),User_1=__importDefault(require('../models/User')),lodash_2=require(a37_0x33b257(0x1e6)),index=async(_0x48a5e6,_0x1a3036)=>{const _0x58acf6=a37_0x33b257,{searchParam:_0x3f4fa8,pageNumber:_0x47e840}=_0x48a5e6[_0x58acf6(0x1e4)],{companyId:_0x1131df,profile:_0xe681f1}=_0x48a5e6[_0x58acf6(0x1cb)],{users:_0x55e831,count:_0x3ac822,hasMore:_0x4e6743}=await(0x0,ListUsersService_1[_0x58acf6(0x1bb)])({'searchParam':_0x3f4fa8,'pageNumber':_0x47e840,'companyId':_0x1131df,'profile':_0xe681f1});return _0x1a3036[_0x58acf6(0x1ee)]({'users':_0x55e831,'count':_0x3ac822,'hasMore':_0x4e6743});};exports['index']=index;const store=async(_0x33b0ae,_0x4f55ff)=>{const _0x43c7c7=a37_0x33b257,{email:_0x37169f,password:_0x253813,name:_0xb7ee31,phone:_0x471e87,profile:_0x504b25,companyId:_0x65074d,queueIds:_0xc72ad4,companyName:_0x328264,planId:_0x37686d,startWork:_0x1d334f,endWork:_0x47b155,whatsappId:_0x120f00,allTicket:_0x4ddc70,defaultTheme:_0x5d2d1f,defaultMenu:_0x4473ec,allowGroup:_0x1fef06}=_0x33b0ae[_0x43c7c7(0x1d5)];let _0x46be81=null;const {dateToClient:_0x1db1fd}=(0x0,useDate_1[_0x43c7c7(0x1d1)])();if(_0x33b0ae[_0x43c7c7(0x1cb)]!==undefined){const {companyId:_0x45d34a}=_0x33b0ae[_0x43c7c7(0x1cb)];_0x46be81=_0x45d34a;}if(_0x33b0ae['url']==='/signup'&&await(0x0,CheckSettings_1[_0x43c7c7(0x1bb)])(_0x43c7c7(0x1a9))===_0x43c7c7(0x1ea))throw new AppError_1[(_0x43c7c7(0x1bb))]('ERR_USER_CREATION_DISABLED',0x193);else{if(_0x33b0ae[_0x43c7c7(0x1f1)]!==_0x43c7c7(0x1cc)&&_0x33b0ae[_0x43c7c7(0x1cb)][_0x43c7c7(0x1dc)]!==_0x43c7c7(0x1c5))throw new AppError_1['default'](_0x43c7c7(0x1c4),0x193);}if(process['env'][_0x43c7c7(0x1d6)]==='ON')throw new AppError_1[(_0x43c7c7(0x1bb))](_0x43c7c7(0x1c4),0x193);const _0x296799=_0x65074d||_0x46be81;if(!_0x296799){const _0x5cc25c=new Date();_0x5cc25c[_0x43c7c7(0x1b6)](_0x5cc25c[_0x43c7c7(0x1cd)]()+0x3);const _0x10f2e2=_0x5cc25c['toISOString']()[_0x43c7c7(0x1c0)]('T')[0x0],_0x1d5423={'name':_0x328264,'email':_0x37169f,'phone':_0x471e87,'planId':_0x37686d,'status':!![],'dueDate':_0x10f2e2,'recurrence':'','document':'','paymentMethod':'','password':_0x253813,'companyUserName':_0xb7ee31,'startWork':_0x1d334f,'endWork':_0x47b155,'defaultTheme':_0x43c7c7(0x1ac),'defaultMenu':_0x43c7c7(0x1bd),'allowGroup':![]},_0x206587=await(0x0,CreateCompanyService_1[_0x43c7c7(0x1bb)])(_0x1d5423);try{const _0x1231a5={'to':_0x37169f,'subject':_0x43c7c7(0x1cf)+_0x328264,'text':_0x43c7c7(0x1e9)+_0xb7ee31+_0x43c7c7(0x1a6)+_0x328264+_0x43c7c7(0x1c1)+_0x328264+_0x43c7c7(0x1c3)+_0x37169f+_0x43c7c7(0x1c9)+_0x253813+_0x43c7c7(0x1b1)+_0x1db1fd(_0x10f2e2)};await(0x0,SendMail_1[_0x43c7c7(0x1d8)])(_0x1231a5);}catch(_0x53a72c){console[_0x43c7c7(0x1ce)]('Não\x20consegui\x20enviar\x20o\x20email');}try{const _0x337ed9=await(0x0,ShowCompanyService_1['default'])(0x1),_0x94091a=await(0x0,FindCompaniesWhatsappService_1[_0x43c7c7(0x1bb)])(_0x337ed9['id']);if(_0x94091a['whatsapps'][0x0][_0x43c7c7(0x1ab)]==='CONNECTED'&&(_0x471e87!==undefined||!(0x0,lodash_1[_0x43c7c7(0x1c6)])(_0x471e87)||!(0x0,lodash_1[_0x43c7c7(0x1c7)])(_0x471e87))){const _0x2b0e2a=_0x94091a[_0x43c7c7(0x1b5)][0x0]['id'],_0x2f00d6=(0x0,wbot_1[_0x43c7c7(0x1a4)])(_0x2b0e2a),_0x4f2736=_0x43c7c7(0x1e9)+_0xb7ee31+',\x20este\x20é\x20uma\x20mensagem\x20sobre\x20o\x20cadastro\x20da\x20'+_0x328264+_0x43c7c7(0x1a7)+_0x328264+_0x43c7c7(0x1af)+_0x37169f+_0x43c7c7(0x1b4)+_0x253813+_0x43c7c7(0x1aa)+_0x1db1fd(_0x10f2e2);await _0x2f00d6['sendMessage']('55'+_0x471e87+_0x43c7c7(0x1d0),{'text':_0x4f2736});}}catch(_0x3d676d){console['log'](_0x43c7c7(0x1b8));}return _0x4f55ff['status'](0xc8)['json'](_0x206587);}if(_0x296799){const _0x1cfda7=await(0x0,CreateUserService_1[_0x43c7c7(0x1bb)])({'email':_0x37169f,'password':_0x253813,'name':_0xb7ee31,'profile':_0x504b25,'companyId':_0x296799,'queueIds':_0xc72ad4,'startWork':_0x1d334f,'endWork':_0x47b155,'whatsappId':_0x120f00,'allTicket':_0x4ddc70,'defaultTheme':_0x5d2d1f,'defaultMenu':_0x4473ec,'allowGroup':_0x1fef06}),_0x31716b=(0x0,socket_1[_0x43c7c7(0x1e8)])();return _0x31716b[_0x43c7c7(0x1f2)](_0x43c7c7(0x1da)+_0x46be81+'-user',{'action':'create','user':_0x1cfda7}),_0x4f55ff[_0x43c7c7(0x1ab)](0xc8)[_0x43c7c7(0x1ee)](_0x1cfda7);}};exports[a37_0x33b257(0x1b2)]=store;function a37_0x3a88(_0x3da2e2,_0x267552){const _0x5dda83=a37_0x5dda();return a37_0x3a88=function(_0x3a8812,_0x36bf48){_0x3a8812=_0x3a8812-0x1a4;let _0x2885de=_0x5dda83[_0x3a8812];return _0x2885de;},a37_0x3a88(_0x3da2e2,_0x267552);}const show=async(_0x3fc09c,_0x5272e8)=>{const _0x224de1=a37_0x33b257,{userId:_0xfef4ab}=_0x3fc09c[_0x224de1(0x1ef)],_0x5148d5=await(0x0,ShowUserService_1[_0x224de1(0x1bb)])(_0xfef4ab);return _0x5272e8[_0x224de1(0x1ab)](0xc8)[_0x224de1(0x1ee)](_0x5148d5);};exports[a37_0x33b257(0x1d3)]=show;const update=async(_0x492ddb,_0x524303)=>{const _0x3aaff1=a37_0x33b257;if(process[_0x3aaff1(0x1e0)][_0x3aaff1(0x1d6)]==='ON')throw new AppError_1[(_0x3aaff1(0x1bb))](_0x3aaff1(0x1c4),0x193);const {id:_0x305832,companyId:_0x41ee2d}=_0x492ddb[_0x3aaff1(0x1cb)],{userId:_0x18cb75}=_0x492ddb['params'],_0x4658ea=_0x492ddb['body'],_0x46e81c=await(0x0,UpdateUserService_1[_0x3aaff1(0x1bb)])({'userData':_0x4658ea,'userId':_0x18cb75,'companyId':_0x41ee2d,'requestUserId':+_0x305832}),_0x2eaa03=(0x0,socket_1[_0x3aaff1(0x1e8)])();return _0x2eaa03['emit'](_0x3aaff1(0x1da)+_0x41ee2d+_0x3aaff1(0x1b0),{'action':'update','user':_0x46e81c}),_0x524303[_0x3aaff1(0x1ab)](0xc8)['json'](_0x46e81c);};exports[a37_0x33b257(0x1ca)]=update;const remove=async(_0x4f2cf4,_0x2620c3)=>{const _0x48f4b7=a37_0x33b257,{userId:_0x37b0f7}=_0x4f2cf4[_0x48f4b7(0x1ef)],{companyId:_0x53610e,id:_0x3d9a0d,profile:_0x5a246a}=_0x4f2cf4[_0x48f4b7(0x1cb)];if(_0x5a246a!==_0x48f4b7(0x1c5))throw new AppError_1[(_0x48f4b7(0x1bb))]('ERR_NO_PERMISSION',0x193);if(process[_0x48f4b7(0x1e0)][_0x48f4b7(0x1d6)]==='ON')throw new AppError_1[(_0x48f4b7(0x1bb))](_0x48f4b7(0x1c4),0x193);const _0x3b86ce=await User_1['default'][_0x48f4b7(0x1e5)]({'where':{'id':_0x37b0f7}});if(_0x53610e!==_0x3b86ce[_0x48f4b7(0x1eb)])return _0x2620c3[_0x48f4b7(0x1ab)](0x190)[_0x48f4b7(0x1ee)]({'error':'Você\x20não\x20possui\x20permissão\x20para\x20acessar\x20este\x20recurso!'});else{await(0x0,DeleteUserService_1[_0x48f4b7(0x1bb)])(_0x37b0f7,_0x53610e);const _0xc81695=(0x0,socket_1[_0x48f4b7(0x1e8)])();return _0xc81695[_0x48f4b7(0x1f2)](_0x48f4b7(0x1da)+_0x53610e+_0x48f4b7(0x1b0),{'action':'delete','userId':_0x37b0f7}),_0x2620c3['status'](0xc8)[_0x48f4b7(0x1ee)]({'message':'User\x20deleted'});}};exports[a37_0x33b257(0x1d2)]=remove;const list=async(_0x50f55a,_0x4da494)=>{const _0xf958ae=a37_0x33b257,{companyId:_0x390966}=_0x50f55a[_0xf958ae(0x1e4)],{companyId:_0xe98336}=_0x50f55a[_0xf958ae(0x1cb)],_0x3630e7=await(0x0,SimpleListService_1[_0xf958ae(0x1bb)])({'companyId':_0x390966?+_0x390966:_0xe98336});return _0x4da494[_0xf958ae(0x1ab)](0xc8)[_0xf958ae(0x1ee)](_0x3630e7);};exports[a37_0x33b257(0x1e1)]=list;const mediaUpload=async(_0x346874,_0x4d9a49)=>{const _0x8b5b02=a37_0x33b257,{userId:_0x23c5e7}=_0x346874[_0x8b5b02(0x1ef)],_0x1ab829=_0x346874[_0x8b5b02(0x1ad)],_0x3836e6=(0x0,lodash_2[_0x8b5b02(0x1a8)])(_0x1ab829);try{const _0x412712=await User_1[_0x8b5b02(0x1bb)][_0x8b5b02(0x1c8)](_0x23c5e7);return _0x412712[_0x8b5b02(0x1e7)]=_0x3836e6[_0x8b5b02(0x1b9)][_0x8b5b02(0x1df)]('/','-'),await _0x412712[_0x8b5b02(0x1de)](),_0x4d9a49[_0x8b5b02(0x1ab)](0xc8)[_0x8b5b02(0x1ee)]({'user':_0x412712,'message':_0x8b5b02(0x1bc)});}catch(_0x148939){throw new AppError_1['default'](_0x148939[_0x8b5b02(0x1a5)]);}};exports['mediaUpload']=mediaUpload;