'use strict';const a39_0x252a85=a39_0x3857;(function(_0x3bb55e,_0x4b8896){const _0x1e6f6c=a39_0x3857,_0x32415c=_0x3bb55e();while(!![]){try{const _0x53e805=parseInt(_0x1e6f6c(0x15f))/0x1*(parseInt(_0x1e6f6c(0x171))/0x2)+parseInt(_0x1e6f6c(0x161))/0x3+-parseInt(_0x1e6f6c(0x185))/0x4*(parseInt(_0x1e6f6c(0x180))/0x5)+-parseInt(_0x1e6f6c(0x168))/0x6+-parseInt(_0x1e6f6c(0x15a))/0x7+-parseInt(_0x1e6f6c(0x16d))/0x8+parseInt(_0x1e6f6c(0x199))/0x9*(parseInt(_0x1e6f6c(0x188))/0xa);if(_0x53e805===_0x4b8896)break;else _0x32415c['push'](_0x32415c['shift']());}catch(_0x3bbc38){_0x32415c['push'](_0x32415c['shift']());}}}(a39_0x564f,0xdba9c));var __importDefault=this&&this[a39_0x252a85(0x15b)]||function(_0x40b14d){const _0x5062ef=a39_0x252a85;return _0x40b14d&&_0x40b14d[_0x5062ef(0x178)]?_0x40b14d:{'default':_0x40b14d};};Object[a39_0x252a85(0x18f)](exports,'__esModule',{'value':!![]}),exports[a39_0x252a85(0x195)]=exports[a39_0x252a85(0x179)]=exports['remove']=exports[a39_0x252a85(0x18e)]=exports[a39_0x252a85(0x16a)]=exports[a39_0x252a85(0x1a0)]=exports[a39_0x252a85(0x18d)]=void 0x0;const socket_1=require(a39_0x252a85(0x16b)),lodash_1=require(a39_0x252a85(0x157)),CheckSettings_1=__importDefault(require(a39_0x252a85(0x154))),AppError_1=__importDefault(require(a39_0x252a85(0x181))),CreateUserService_1=__importDefault(require(a39_0x252a85(0x182))),ListUsersService_1=__importDefault(require(a39_0x252a85(0x189))),UpdateUserService_1=__importDefault(require(a39_0x252a85(0x17b))),ShowUserService_1=__importDefault(require('../services/UserServices/ShowUserService')),DeleteUserService_1=__importDefault(require(a39_0x252a85(0x153))),SimpleListService_1=__importDefault(require(a39_0x252a85(0x192))),CreateCompanyService_1=__importDefault(require(a39_0x252a85(0x16c))),SendMail_1=require(a39_0x252a85(0x162)),useDate_1=require(a39_0x252a85(0x17c)),ShowCompanyService_1=__importDefault(require(a39_0x252a85(0x18a))),wbot_1=require('../libs/wbot'),FindCompaniesWhatsappService_1=__importDefault(require(a39_0x252a85(0x14e))),User_1=__importDefault(require(a39_0x252a85(0x19f))),lodash_2=require(a39_0x252a85(0x157)),index=async(_0x48d776,_0x54b4b7)=>{const _0x4bfaf1=a39_0x252a85,{searchParam:_0x883d9,pageNumber:_0x2d75be}=_0x48d776[_0x4bfaf1(0x184)],{companyId:_0x9e6231,profile:_0x11daf3}=_0x48d776[_0x4bfaf1(0x176)],{users:_0xd37d7b,count:_0x1346b5,hasMore:_0x577339}=await(0x0,ListUsersService_1[_0x4bfaf1(0x186)])({'searchParam':_0x883d9,'pageNumber':_0x2d75be,'companyId':_0x9e6231,'profile':_0x11daf3});return _0x54b4b7['json']({'users':_0xd37d7b,'count':_0x1346b5,'hasMore':_0x577339});};exports[a39_0x252a85(0x18d)]=index;const store=async(_0x3d453b,_0x303d22)=>{const _0x3b1a52=a39_0x252a85,{email:_0x289e92,password:_0x5d5dbb,name:_0x2bb8d7,phone:_0x283e23,profile:_0x5d0999,companyId:_0x18c1ea,queueIds:_0x2d11c3,companyName:_0x2881f3,planId:_0x4b296c,startWork:_0x26bf59,endWork:_0x4242bc,whatsappId:_0x1a6746,allTicket:_0x105e26,defaultTheme:_0x106033,defaultMenu:_0xa9b795,allowGroup:_0x437b62,allHistoric:_0x5b3826,allUserChat:_0x26b37e}=_0x3d453b[_0x3b1a52(0x18b)];let _0x5d639a=null;const {dateToClient:_0x368ac2}=(0x0,useDate_1[_0x3b1a52(0x190)])();if(_0x3d453b['user']!==undefined){const {companyId:_0x3e4041}=_0x3d453b[_0x3b1a52(0x176)];_0x5d639a=_0x3e4041;}if(_0x3d453b[_0x3b1a52(0x166)]===_0x3b1a52(0x194)&&await(0x0,CheckSettings_1['default'])('userCreation')===_0x3b1a52(0x165))throw new AppError_1['default'](_0x3b1a52(0x198),0x193);else{if(_0x3d453b['url']!=='/signup'&&_0x3d453b['user'][_0x3b1a52(0x159)]!==_0x3b1a52(0x18c))throw new AppError_1['default'](_0x3b1a52(0x17a),0x193);}if(process[_0x3b1a52(0x17f)][_0x3b1a52(0x170)]==='ON')throw new AppError_1['default'](_0x3b1a52(0x17a),0x193);const _0x39fd8c=_0x18c1ea||_0x5d639a;if(!_0x39fd8c){const _0x5575de=new Date();_0x5575de['setDate'](_0x5575de[_0x3b1a52(0x17e)]()+0x3);const _0x1e5cb8=_0x5575de[_0x3b1a52(0x172)]()['split']('T')[0x0],_0x582ff8={'name':_0x2881f3,'email':_0x289e92,'phone':_0x283e23,'planId':_0x4b296c,'status':!![],'dueDate':_0x1e5cb8,'recurrence':'','document':'','paymentMethod':'','password':_0x5d5dbb,'companyUserName':_0x2bb8d7,'startWork':_0x26bf59,'endWork':_0x4242bc,'defaultTheme':'light','defaultMenu':'closed','allowGroup':![],'allHistoric':![]},_0x96e9f8=await(0x0,CreateCompanyService_1[_0x3b1a52(0x186)])(_0x582ff8);try{const _0x4ade96={'to':_0x289e92,'subject':_0x3b1a52(0x183)+_0x2881f3,'text':_0x3b1a52(0x151)+_0x2bb8d7+',\x20este\x20é\x20um\x20email\x20sobre\x20o\x20cadastro\x20da\x20'+_0x2881f3+_0x3b1a52(0x167)+_0x2881f3+_0x3b1a52(0x158)+_0x289e92+_0x3b1a52(0x19e)+_0x5d5dbb+_0x3b1a52(0x169)+_0x368ac2(_0x1e5cb8)};await(0x0,SendMail_1[_0x3b1a52(0x152)])(_0x4ade96);}catch(_0x444675){console[_0x3b1a52(0x19a)](_0x3b1a52(0x187));}try{const _0xc32d97=await(0x0,ShowCompanyService_1[_0x3b1a52(0x186)])(0x1),_0x57e57b=await(0x0,FindCompaniesWhatsappService_1[_0x3b1a52(0x186)])(_0xc32d97['id']);if(_0x57e57b['whatsapps'][0x0][_0x3b1a52(0x197)]===_0x3b1a52(0x175)&&(_0x283e23!==undefined||!(0x0,lodash_1[_0x3b1a52(0x19d)])(_0x283e23)||!(0x0,lodash_1['isEmpty'])(_0x283e23))){const _0x3d02fd=_0x57e57b['whatsapps'][0x0]['id'],_0x213a46=(0x0,wbot_1[_0x3b1a52(0x17d)])(_0x3d02fd),_0x54f9f6=_0x3b1a52(0x151)+_0x2bb8d7+',\x20este\x20é\x20uma\x20mensagem\x20sobre\x20o\x20cadastro\x20da\x20'+_0x2881f3+'!\x0a\x0aSegue\x20os\x20dados\x20da\x20sua\x20empresa:\x0a\x0aNome:\x20'+_0x2881f3+'\x0aEmail:\x20'+_0x289e92+_0x3b1a52(0x177)+_0x5d5dbb+_0x3b1a52(0x15e)+_0x368ac2(_0x1e5cb8);await _0x213a46['sendMessage']('55'+_0x283e23+'@s.whatsapp.net',{'text':_0x54f9f6});}}catch(_0x50ad26){console[_0x3b1a52(0x19a)](_0x3b1a52(0x155));}return _0x303d22['status'](0xc8)[_0x3b1a52(0x15d)](_0x96e9f8);}if(_0x39fd8c){const _0x257b6c=await(0x0,CreateUserService_1[_0x3b1a52(0x186)])({'email':_0x289e92,'password':_0x5d5dbb,'name':_0x2bb8d7,'profile':_0x5d0999,'companyId':_0x39fd8c,'queueIds':_0x2d11c3,'startWork':_0x26bf59,'endWork':_0x4242bc,'whatsappId':_0x1a6746,'allTicket':_0x105e26,'defaultTheme':_0x106033,'defaultMenu':_0xa9b795,'allowGroup':_0x437b62,'allHistoric':_0x5b3826,'allUserChat':_0x26b37e}),_0x3a6cba=(0x0,socket_1[_0x3b1a52(0x156)])();return _0x3a6cba[_0x3b1a52(0x19b)](_0x3b1a52(0x15c)+_0x5d639a+_0x3b1a52(0x193),{'action':'create','user':_0x257b6c}),_0x303d22[_0x3b1a52(0x197)](0xc8)[_0x3b1a52(0x15d)](_0x257b6c);}};exports['store']=store;const show=async(_0x11a70b,_0x2cad36)=>{const _0x11c8e1=a39_0x252a85,{userId:_0x1edeef}=_0x11a70b[_0x11c8e1(0x163)],{companyId:_0x392562}=_0x11a70b[_0x11c8e1(0x176)],_0x1ba80c=await(0x0,ShowUserService_1[_0x11c8e1(0x186)])(_0x1edeef,_0x392562);return _0x2cad36[_0x11c8e1(0x197)](0xc8)[_0x11c8e1(0x15d)](_0x1ba80c);};exports['show']=show;const update=async(_0x2e0648,_0x34e320)=>{const _0x3feed3=a39_0x252a85;if(process[_0x3feed3(0x17f)][_0x3feed3(0x170)]==='ON')throw new AppError_1[(_0x3feed3(0x186))](_0x3feed3(0x17a),0x193);const {id:_0x3a120c,companyId:_0xdf18e0}=_0x2e0648[_0x3feed3(0x176)],{userId:_0xfdebbb}=_0x2e0648[_0x3feed3(0x163)],_0x4cf8e6=_0x2e0648[_0x3feed3(0x18b)],_0x14c805=await(0x0,UpdateUserService_1[_0x3feed3(0x186)])({'userData':_0x4cf8e6,'userId':_0xfdebbb,'companyId':_0xdf18e0,'requestUserId':+_0x3a120c}),_0xdc8a2b=(0x0,socket_1[_0x3feed3(0x156)])();return _0xdc8a2b['emit']('company-'+_0xdf18e0+_0x3feed3(0x193),{'action':_0x3feed3(0x18e),'user':_0x14c805}),_0x34e320[_0x3feed3(0x197)](0xc8)[_0x3feed3(0x15d)](_0x14c805);};exports[a39_0x252a85(0x18e)]=update;const remove=async(_0x17b438,_0x3f870d)=>{const _0x2d4450=a39_0x252a85,{userId:_0x1ab705}=_0x17b438[_0x2d4450(0x163)],{companyId:_0x244a1e,id:_0x3547fb,profile:_0x1667b2}=_0x17b438[_0x2d4450(0x176)];if(_0x1667b2!==_0x2d4450(0x18c))throw new AppError_1[(_0x2d4450(0x186))](_0x2d4450(0x17a),0x193);if(process['env'][_0x2d4450(0x170)]==='ON')throw new AppError_1[(_0x2d4450(0x186))]('ERR_NO_PERMISSION',0x193);const _0x116fb7=await User_1[_0x2d4450(0x186)][_0x2d4450(0x173)]({'where':{'id':_0x1ab705}});if(_0x244a1e!==_0x116fb7[_0x2d4450(0x150)])return _0x3f870d[_0x2d4450(0x197)](0x190)[_0x2d4450(0x15d)]({'error':_0x2d4450(0x16f)});else{await(0x0,DeleteUserService_1[_0x2d4450(0x186)])(_0x1ab705,_0x244a1e);const _0x4035e9=(0x0,socket_1[_0x2d4450(0x156)])();return _0x4035e9['emit'](_0x2d4450(0x15c)+_0x244a1e+_0x2d4450(0x193),{'action':_0x2d4450(0x19c),'userId':_0x1ab705}),_0x3f870d[_0x2d4450(0x197)](0xc8)[_0x2d4450(0x15d)]({'message':_0x2d4450(0x196)});}};exports[a39_0x252a85(0x14f)]=remove;const list=async(_0x4279aa,_0x59d9f5)=>{const _0x3c57c2=a39_0x252a85,{companyId:_0x29faee}=_0x4279aa[_0x3c57c2(0x184)],{companyId:_0x461324}=_0x4279aa[_0x3c57c2(0x176)],_0x2685d0=await(0x0,SimpleListService_1[_0x3c57c2(0x186)])({'companyId':_0x29faee?+_0x29faee:_0x461324});return _0x59d9f5[_0x3c57c2(0x197)](0xc8)['json'](_0x2685d0);};function a39_0x564f(){const _0x1b9a4b=['body','admin','index','update','defineProperty','useDate','message','../services/UserServices/SimpleListService','-user','/signup','mediaUpload','User\x20deleted','status','ERR_USER_CREATION_DISABLED','3313782NMmvvA','log','emit','delete','isNil','<br>Senha:\x20','../models/User','store','../services/CompanyService/FindCompaniesWhatsappService','remove','companyId','Olá\x20','SendMail','../services/UserServices/DeleteUserService','../helpers/CheckSettings','Não\x20consegui\x20enviar\x20a\x20mensagem','getIO','lodash','<br>Email:\x20','profile','4089666kkjKkB','__importDefault','company-','json','\x0aData\x20Vencimento\x20Trial:\x20','37745dSQvqy','save','2330769gXOXTJ','../helpers/SendMail','params','head','disabled','url','!<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20Segue\x20os\x20dados\x20da\x20sua\x20empresa:<br><br>Nome:\x20','2397102BqVRez','<br>Data\x20Vencimento\x20Trial:\x20','show','../libs/socket','../services/CompanyService/CreateCompanyService','12147152qaSQyW','files','Você\x20não\x20possui\x20permissão\x20para\x20acessar\x20este\x20recurso!','DEMO','34FCNqds','toISOString','findOne','filename','CONNECTED','user','\x0aSenha:\x20','__esModule','list','ERR_NO_PERMISSION','../services/UserServices/UpdateUserService','../utils/useDate','getWbot','getDate','env','594085KGNrWl','../errors/AppError','../services/UserServices/CreateUserService','Login\x20e\x20senha\x20da\x20Empresa\x20','query','20ZWrGqJ','default','Não\x20consegui\x20enviar\x20o\x20email','70hXVNrl','../services/UserServices/ListUsersService','../services/CompanyService/ShowCompanyService'];a39_0x564f=function(){return _0x1b9a4b;};return a39_0x564f();}exports[a39_0x252a85(0x179)]=list;const mediaUpload=async(_0x5b2d2c,_0x2b65ed)=>{const _0x50cb63=a39_0x252a85,{userId:_0x267930}=_0x5b2d2c['params'],_0x4fb5f1=_0x5b2d2c[_0x50cb63(0x16e)],_0xb25dbe=(0x0,lodash_2[_0x50cb63(0x164)])(_0x4fb5f1);try{const _0x1646db=await User_1[_0x50cb63(0x186)]['findByPk'](_0x267930);return _0x1646db['profileImage']=_0xb25dbe[_0x50cb63(0x174)]['replace']('/','-'),await _0x1646db[_0x50cb63(0x160)](),_0x2b65ed[_0x50cb63(0x197)](0xc8)[_0x50cb63(0x15d)]({'user':_0x1646db,'message':'Imagem\x20atualizada'});}catch(_0x197c6b){throw new AppError_1[(_0x50cb63(0x186))](_0x197c6b[_0x50cb63(0x191)]);}};function a39_0x3857(_0x513889,_0x227ea6){const _0x564f1f=a39_0x564f();return a39_0x3857=function(_0x385793,_0x12348a){_0x385793=_0x385793-0x14e;let _0x36c59e=_0x564f1f[_0x385793];return _0x36c59e;},a39_0x3857(_0x513889,_0x227ea6);}exports['mediaUpload']=mediaUpload;