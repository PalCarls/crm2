'use strict';const a39_0x164067=a39_0x386e;(function(_0x4c8692,_0x19d6ba){const _0x5d2ecd=a39_0x386e,_0x282a8d=_0x4c8692();while(!![]){try{const _0x4657ee=-parseInt(_0x5d2ecd(0x140))/0x1+parseInt(_0x5d2ecd(0x179))/0x2*(-parseInt(_0x5d2ecd(0x12b))/0x3)+parseInt(_0x5d2ecd(0x129))/0x4*(-parseInt(_0x5d2ecd(0x141))/0x5)+-parseInt(_0x5d2ecd(0x130))/0x6*(parseInt(_0x5d2ecd(0x156))/0x7)+-parseInt(_0x5d2ecd(0x174))/0x8*(-parseInt(_0x5d2ecd(0x178))/0x9)+-parseInt(_0x5d2ecd(0x16e))/0xa+parseInt(_0x5d2ecd(0x15f))/0xb;if(_0x4657ee===_0x19d6ba)break;else _0x282a8d['push'](_0x282a8d['shift']());}catch(_0xaafcea){_0x282a8d['push'](_0x282a8d['shift']());}}}(a39_0x1465,0xa71cd));var __importDefault=this&&this[a39_0x164067(0x142)]||function(_0x3eaa26){const _0x169d92=a39_0x164067;return _0x3eaa26&&_0x3eaa26[_0x169d92(0x159)]?_0x3eaa26:{'default':_0x3eaa26};};Object['defineProperty'](exports,a39_0x164067(0x159),{'value':!![]}),exports[a39_0x164067(0x15b)]=exports[a39_0x164067(0x14f)]=exports[a39_0x164067(0x14e)]=exports[a39_0x164067(0x15a)]=exports['show']=exports['store']=exports['index']=void 0x0;const socket_1=require(a39_0x164067(0x14a)),lodash_1=require(a39_0x164067(0x169)),CheckSettings_1=__importDefault(require('../helpers/CheckSettings')),AppError_1=__importDefault(require('../errors/AppError')),CreateUserService_1=__importDefault(require(a39_0x164067(0x16c))),ListUsersService_1=__importDefault(require(a39_0x164067(0x15c))),UpdateUserService_1=__importDefault(require('../services/UserServices/UpdateUserService')),ShowUserService_1=__importDefault(require('../services/UserServices/ShowUserService')),DeleteUserService_1=__importDefault(require(a39_0x164067(0x170))),SimpleListService_1=__importDefault(require(a39_0x164067(0x128))),CreateCompanyService_1=__importDefault(require(a39_0x164067(0x13c))),SendMail_1=require(a39_0x164067(0x136)),useDate_1=require(a39_0x164067(0x148)),ShowCompanyService_1=__importDefault(require('../services/CompanyService/ShowCompanyService')),wbot_1=require(a39_0x164067(0x164)),FindCompaniesWhatsappService_1=__importDefault(require(a39_0x164067(0x166))),User_1=__importDefault(require(a39_0x164067(0x139))),lodash_2=require(a39_0x164067(0x169)),index=async(_0xd3a5f9,_0x301d6c)=>{const _0x57c7ce=a39_0x164067,{searchParam:_0x38108c,pageNumber:_0x11211c}=_0xd3a5f9[_0x57c7ce(0x155)],{companyId:_0x329740,profile:_0x280dda}=_0xd3a5f9[_0x57c7ce(0x145)],{users:_0x279961,count:_0x4fd109,hasMore:_0x4af791}=await(0x0,ListUsersService_1[_0x57c7ce(0x12c)])({'searchParam':_0x38108c,'pageNumber':_0x11211c,'companyId':_0x329740,'profile':_0x280dda});return _0x301d6c['json']({'users':_0x279961,'count':_0x4fd109,'hasMore':_0x4af791});};exports[a39_0x164067(0x143)]=index;const store=async(_0x494df7,_0x565c25)=>{const _0x2a2dd3=a39_0x164067,{email:_0x5f5a26,password:_0x532686,name:_0x4494b0,phone:_0x3e32c6,profile:_0x3516b5,companyId:_0x170056,queueIds:_0x197951,companyName:_0x4ac1b1,planId:_0x70c72f,startWork:_0x3ff99c,endWork:_0x1dac3c,whatsappId:_0x92770c,allTicket:_0xd6592f,defaultTheme:_0x202504,defaultMenu:_0x198e5b,allowGroup:_0x113c5e,allHistoric:_0x4bc6b8,allUserChat:_0x16e12b}=_0x494df7[_0x2a2dd3(0x13e)];let _0x4c4f4a=null;const {dateToClient:_0xd88922}=(0x0,useDate_1[_0x2a2dd3(0x172)])();if(_0x494df7[_0x2a2dd3(0x145)]!==undefined){const {companyId:_0x4bca1e}=_0x494df7[_0x2a2dd3(0x145)];_0x4c4f4a=_0x4bca1e;}if(_0x494df7[_0x2a2dd3(0x13a)]==='/signup'&&await(0x0,CheckSettings_1[_0x2a2dd3(0x12c)])(_0x2a2dd3(0x14b))===_0x2a2dd3(0x13f))throw new AppError_1[(_0x2a2dd3(0x12c))]('ERR_USER_CREATION_DISABLED',0x193);else{if(_0x494df7[_0x2a2dd3(0x13a)]!=='/signup'&&_0x494df7[_0x2a2dd3(0x145)][_0x2a2dd3(0x163)]!==_0x2a2dd3(0x13d))throw new AppError_1[(_0x2a2dd3(0x12c))](_0x2a2dd3(0x132),0x193);}if(process[_0x2a2dd3(0x134)][_0x2a2dd3(0x16b)]==='ON')throw new AppError_1['default'](_0x2a2dd3(0x132),0x193);const _0x54df24=_0x170056||_0x4c4f4a;if(!_0x54df24){const _0x1c9632=new Date();_0x1c9632[_0x2a2dd3(0x153)](_0x1c9632[_0x2a2dd3(0x12d)]()+0x3);const _0xd8b8bd=_0x1c9632[_0x2a2dd3(0x173)]()[_0x2a2dd3(0x160)]('T')[0x0],_0xaed0b9={'name':_0x4ac1b1,'email':_0x5f5a26,'phone':_0x3e32c6,'planId':_0x70c72f,'status':!![],'dueDate':_0xd8b8bd,'recurrence':'','document':'','paymentMethod':'','password':_0x532686,'companyUserName':_0x4494b0,'startWork':_0x3ff99c,'endWork':_0x1dac3c,'defaultTheme':'light','defaultMenu':_0x2a2dd3(0x175),'allowGroup':![],'allHistoric':![]},_0x56426b=await(0x0,CreateCompanyService_1[_0x2a2dd3(0x12c)])(_0xaed0b9);try{const _0x3c83a1={'to':_0x5f5a26,'subject':_0x2a2dd3(0x15e)+_0x4ac1b1,'text':'Olá\x20'+_0x4494b0+',\x20este\x20é\x20um\x20email\x20sobre\x20o\x20cadastro\x20da\x20'+_0x4ac1b1+'!<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20Segue\x20os\x20dados\x20da\x20sua\x20empresa:<br><br>Nome:\x20'+_0x4ac1b1+_0x2a2dd3(0x154)+_0x5f5a26+_0x2a2dd3(0x171)+_0x532686+_0x2a2dd3(0x162)+_0xd88922(_0xd8b8bd)};await(0x0,SendMail_1[_0x2a2dd3(0x16f)])(_0x3c83a1);}catch(_0x453d99){console[_0x2a2dd3(0x138)](_0x2a2dd3(0x152));}try{const _0x1aeb42=await(0x0,ShowCompanyService_1[_0x2a2dd3(0x12c)])(0x1),_0x2fb3c1=await(0x0,FindCompaniesWhatsappService_1[_0x2a2dd3(0x12c)])(_0x1aeb42['id']);if(_0x2fb3c1[_0x2a2dd3(0x161)][0x0]['status']===_0x2a2dd3(0x14c)&&(_0x3e32c6!==undefined||!(0x0,lodash_1[_0x2a2dd3(0x13b)])(_0x3e32c6)||!(0x0,lodash_1[_0x2a2dd3(0x150)])(_0x3e32c6))){const _0x249d53=_0x2fb3c1[_0x2a2dd3(0x161)][0x0]['id'],_0x4a5945=(0x0,wbot_1[_0x2a2dd3(0x135)])(_0x249d53),_0x4336aa=_0x2a2dd3(0x151)+_0x4494b0+_0x2a2dd3(0x177)+_0x4ac1b1+'!\x0a\x0aSegue\x20os\x20dados\x20da\x20sua\x20empresa:\x0a\x0aNome:\x20'+_0x4ac1b1+_0x2a2dd3(0x131)+_0x5f5a26+'\x0aSenha:\x20'+_0x532686+_0x2a2dd3(0x16a)+_0xd88922(_0xd8b8bd);await _0x4a5945['sendMessage']('55'+_0x3e32c6+_0x2a2dd3(0x12a),{'text':_0x4336aa});}}catch(_0xd14497){console[_0x2a2dd3(0x138)]('Não\x20consegui\x20enviar\x20a\x20mensagem');}return _0x565c25[_0x2a2dd3(0x133)](0xc8)[_0x2a2dd3(0x165)](_0x56426b);}if(_0x54df24){const _0x45782c=await(0x0,CreateUserService_1['default'])({'email':_0x5f5a26,'password':_0x532686,'name':_0x4494b0,'profile':_0x3516b5,'companyId':_0x54df24,'queueIds':_0x197951,'startWork':_0x3ff99c,'endWork':_0x1dac3c,'whatsappId':_0x92770c,'allTicket':_0xd6592f,'defaultTheme':_0x202504,'defaultMenu':_0x198e5b,'allowGroup':_0x113c5e,'allHistoric':_0x4bc6b8,'allUserChat':_0x16e12b}),_0x57b6c5=(0x0,socket_1[_0x2a2dd3(0x158)])();return _0x57b6c5[_0x2a2dd3(0x144)](_0x2a2dd3(0x137)+_0x4c4f4a+'-user',{'action':_0x2a2dd3(0x146),'user':_0x45782c}),_0x565c25[_0x2a2dd3(0x133)](0xc8)['json'](_0x45782c);}};exports[a39_0x164067(0x168)]=store;const show=async(_0x37cecd,_0x248ad6)=>{const _0x4eb910=a39_0x164067,{userId:_0x3440c9}=_0x37cecd[_0x4eb910(0x157)],{companyId:_0x2faa53}=_0x37cecd[_0x4eb910(0x145)],_0x2d73f1=await(0x0,ShowUserService_1['default'])(_0x3440c9,_0x2faa53);return _0x248ad6[_0x4eb910(0x133)](0xc8)[_0x4eb910(0x165)](_0x2d73f1);};function a39_0x386e(_0x1577e2,_0x1dc5db){const _0x14651c=a39_0x1465();return a39_0x386e=function(_0x386efd,_0x35865b){_0x386efd=_0x386efd-0x127;let _0x5ba18b=_0x14651c[_0x386efd];return _0x5ba18b;},a39_0x386e(_0x1577e2,_0x1dc5db);}exports['show']=show;const update=async(_0x53fe53,_0x2bbaca)=>{const _0xab99b5=a39_0x164067;if(process[_0xab99b5(0x134)]['DEMO']==='ON')throw new AppError_1['default'](_0xab99b5(0x132),0x193);const {id:_0x2c3fb3,companyId:_0x1d1ca3}=_0x53fe53[_0xab99b5(0x145)],{userId:_0x43c0a3}=_0x53fe53[_0xab99b5(0x157)],_0x25198e=_0x53fe53[_0xab99b5(0x13e)],_0x1f1866=await(0x0,UpdateUserService_1[_0xab99b5(0x12c)])({'userData':_0x25198e,'userId':_0x43c0a3,'companyId':_0x1d1ca3,'requestUserId':+_0x2c3fb3}),_0xeb8e4f=(0x0,socket_1['getIO'])();return _0xeb8e4f[_0xab99b5(0x144)](_0xab99b5(0x137)+_0x1d1ca3+_0xab99b5(0x16d),{'action':_0xab99b5(0x15a),'user':_0x1f1866}),_0x2bbaca[_0xab99b5(0x133)](0xc8)['json'](_0x1f1866);};exports['update']=update;const remove=async(_0x4d398e,_0x42dec2)=>{const _0x3783c2=a39_0x164067,{userId:_0x3b0a3a}=_0x4d398e['params'],{companyId:_0x83c4a2,id:_0x323ae0,profile:_0x1028c2}=_0x4d398e[_0x3783c2(0x145)];if(_0x1028c2!==_0x3783c2(0x13d))throw new AppError_1['default']('ERR_NO_PERMISSION',0x193);if(process[_0x3783c2(0x134)]['DEMO']==='ON')throw new AppError_1[(_0x3783c2(0x12c))]('ERR_NO_PERMISSION',0x193);const _0x45be5b=await User_1['default']['findOne']({'where':{'id':_0x3b0a3a}});if(_0x83c4a2!==_0x45be5b[_0x3783c2(0x127)])return _0x42dec2['status'](0x190)[_0x3783c2(0x165)]({'error':_0x3783c2(0x14d)});else{await(0x0,DeleteUserService_1['default'])(_0x3b0a3a,_0x83c4a2);const _0xb4da11=(0x0,socket_1['getIO'])();return _0xb4da11['emit'](_0x3783c2(0x137)+_0x83c4a2+_0x3783c2(0x16d),{'action':_0x3783c2(0x12f),'userId':_0x3b0a3a}),_0x42dec2['status'](0xc8)[_0x3783c2(0x165)]({'message':_0x3783c2(0x12e)});}};exports['remove']=remove;const list=async(_0x435af5,_0x2214a9)=>{const _0x47a852=a39_0x164067,{companyId:_0x43769f}=_0x435af5[_0x47a852(0x155)],{companyId:_0x366870}=_0x435af5[_0x47a852(0x145)],_0x5004c2=await(0x0,SimpleListService_1[_0x47a852(0x12c)])({'companyId':_0x43769f?+_0x43769f:_0x366870});return _0x2214a9[_0x47a852(0x133)](0xc8)['json'](_0x5004c2);};exports[a39_0x164067(0x14f)]=list;const mediaUpload=async(_0x532045,_0x1387c9)=>{const _0xbe18ea=a39_0x164067,{userId:_0x2520c6}=_0x532045[_0xbe18ea(0x157)],_0x5823fe=_0x532045[_0xbe18ea(0x149)],_0x480593=(0x0,lodash_2[_0xbe18ea(0x147)])(_0x5823fe);try{const _0x481309=await User_1[_0xbe18ea(0x12c)]['findByPk'](_0x2520c6);return _0x481309['profileImage']=_0x480593[_0xbe18ea(0x15d)]['replace']('/','-'),await _0x481309['save'](),_0x1387c9['status'](0xc8)['json']({'user':_0x481309,'message':_0xbe18ea(0x167)});}catch(_0x1dc709){throw new AppError_1['default'](_0x1dc709[_0xbe18ea(0x176)]);}};exports[a39_0x164067(0x15b)]=mediaUpload;function a39_0x1465(){const _0x4a1718=['\x0aData\x20Vencimento\x20Trial:\x20','DEMO','../services/UserServices/CreateUserService','-user','7263620WNTRzW','SendMail','../services/UserServices/DeleteUserService','<br>Senha:\x20','useDate','toISOString','16EnIInI','closed','message',',\x20este\x20é\x20uma\x20mensagem\x20sobre\x20o\x20cadastro\x20da\x20','3042990ntcmeG','112FzoIBM','companyId','../services/UserServices/SimpleListService','4BDBNaq','@s.whatsapp.net','58515WhfMUa','default','getDate','User\x20deleted','delete','9186iboYnz','\x0aEmail:\x20','ERR_NO_PERMISSION','status','env','getWbot','../helpers/SendMail','company-','log','../models/User','url','isNil','../services/CompanyService/CreateCompanyService','admin','body','disabled','844079rGhqhW','71245ULEpjp','__importDefault','index','emit','user','create','head','../utils/useDate','files','../libs/socket','userCreation','CONNECTED','Você\x20não\x20possui\x20permissão\x20para\x20acessar\x20este\x20recurso!','remove','list','isEmpty','Olá\x20','Não\x20consegui\x20enviar\x20o\x20email','setDate','<br>Email:\x20','query','3395VRoHkB','params','getIO','__esModule','update','mediaUpload','../services/UserServices/ListUsersService','filename','Login\x20e\x20senha\x20da\x20Empresa\x20','37705558QxbBqC','split','whatsapps','<br>Data\x20Vencimento\x20Trial:\x20','profile','../libs/wbot','json','../services/CompanyService/FindCompaniesWhatsappService','Imagem\x20atualizada','store','lodash'];a39_0x1465=function(){return _0x4a1718;};return a39_0x1465();}