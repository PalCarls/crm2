'use strict';const a39_0x2dfa8e=a39_0x5c08;(function(_0x2f6f55,_0x53f5f6){const _0x9d787c=a39_0x5c08,_0x42a050=_0x2f6f55();while(!![]){try{const _0x68caaa=parseInt(_0x9d787c(0x236))/0x1*(parseInt(_0x9d787c(0x1ec))/0x2)+parseInt(_0x9d787c(0x218))/0x3+parseInt(_0x9d787c(0x208))/0x4*(-parseInt(_0x9d787c(0x217))/0x5)+-parseInt(_0x9d787c(0x230))/0x6+parseInt(_0x9d787c(0x235))/0x7+-parseInt(_0x9d787c(0x21a))/0x8*(parseInt(_0x9d787c(0x201))/0x9)+-parseInt(_0x9d787c(0x22d))/0xa;if(_0x68caaa===_0x53f5f6)break;else _0x42a050['push'](_0x42a050['shift']());}catch(_0x303876){_0x42a050['push'](_0x42a050['shift']());}}}(a39_0x12d6,0x7aa87));function a39_0x5c08(_0x20abec,_0x4ba246){const _0x12d651=a39_0x12d6();return a39_0x5c08=function(_0x5c08fd,_0x3cc2de){_0x5c08fd=_0x5c08fd-0x1e2;let _0x310f91=_0x12d651[_0x5c08fd];return _0x310f91;},a39_0x5c08(_0x20abec,_0x4ba246);}var __importDefault=this&&this[a39_0x2dfa8e(0x232)]||function(_0xcb85e0){const _0x285879=a39_0x2dfa8e;return _0xcb85e0&&_0xcb85e0[_0x285879(0x20b)]?_0xcb85e0:{'default':_0xcb85e0};};Object['defineProperty'](exports,a39_0x2dfa8e(0x20b),{'value':!![]}),exports[a39_0x2dfa8e(0x224)]=exports[a39_0x2dfa8e(0x21b)]=exports[a39_0x2dfa8e(0x1ff)]=exports[a39_0x2dfa8e(0x1ed)]=exports[a39_0x2dfa8e(0x238)]=exports[a39_0x2dfa8e(0x22a)]=exports['index']=void 0x0;function a39_0x12d6(){const _0x2a03c6=['11366fNtXUg','update','Login\x20e\x20senha\x20da\x20Empresa\x20','whatsapps','<br>Email:\x20','delete','Não\x20consegui\x20enviar\x20a\x20mensagem','profile','User\x20deleted','DEMO','Você\x20não\x20possui\x20permissão\x20para\x20acessar\x20este\x20recurso!','profileImage','admin','body','log','../errors/AppError','findOne','default','disabled','remove','findByPk','118620dgXhgT','../services/UserServices/SimpleListService','../services/UserServices/ShowUserService','../services/CompanyService/FindCompaniesWhatsappService','json','../services/CompanyService/CreateCompanyService','message','33064CKZIlF','\x0aSenha:\x20','\x0aEmail:\x20','__esModule','filename','../models/User','../services/CompanyService/ShowCompanyService','../helpers/SendMail','../services/UserServices/DeleteUserService','ERR_USER_CREATION_DISABLED','!\x0a\x0aSegue\x20os\x20dados\x20da\x20sua\x20empresa:\x0a\x0aNome:\x20','getIO','files','Não\x20consegui\x20enviar\x20o\x20email','<br>Senha:\x20','205PxKjBN','1814262BvDrrl','company-','272jJVaaj','list','user','\x0aData\x20Vencimento\x20Trial:\x20','status','getDate','query','isNil','../helpers/CheckSettings','../services/UserServices/CreateUserService','mediaUpload','Olá\x20','-user','Imagem\x20atualizada','emit','toISOString','store','setDate',',\x20este\x20é\x20uma\x20mensagem\x20sobre\x20o\x20cadastro\x20da\x20','2367780bwkGPP','companyId','lodash','765996xHRBZs',',\x20este\x20é\x20um\x20email\x20sobre\x20o\x20cadastro\x20da\x20','__importDefault','ERR_NO_PERMISSION','getWbot','3644228CsoaGd','93LqyXbG','replace','show','<br>Data\x20Vencimento\x20Trial:\x20','../utils/useDate','/signup','sendMessage','split','../services/UserServices/ListUsersService','env','!<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20Segue\x20os\x20dados\x20da\x20sua\x20empresa:<br><br>Nome:\x20','params','closed','../libs/wbot'];a39_0x12d6=function(){return _0x2a03c6;};return a39_0x12d6();}const socket_1=require('../libs/socket'),lodash_1=require(a39_0x2dfa8e(0x22f)),CheckSettings_1=__importDefault(require(a39_0x2dfa8e(0x222))),AppError_1=__importDefault(require(a39_0x2dfa8e(0x1fb))),CreateUserService_1=__importDefault(require(a39_0x2dfa8e(0x223))),ListUsersService_1=__importDefault(require(a39_0x2dfa8e(0x1e6))),UpdateUserService_1=__importDefault(require('../services/UserServices/UpdateUserService')),ShowUserService_1=__importDefault(require(a39_0x2dfa8e(0x203))),DeleteUserService_1=__importDefault(require(a39_0x2dfa8e(0x210))),SimpleListService_1=__importDefault(require(a39_0x2dfa8e(0x202))),CreateCompanyService_1=__importDefault(require(a39_0x2dfa8e(0x206))),SendMail_1=require(a39_0x2dfa8e(0x20f)),useDate_1=require(a39_0x2dfa8e(0x1e2)),ShowCompanyService_1=__importDefault(require(a39_0x2dfa8e(0x20e))),wbot_1=require(a39_0x2dfa8e(0x1eb)),FindCompaniesWhatsappService_1=__importDefault(require(a39_0x2dfa8e(0x204))),User_1=__importDefault(require(a39_0x2dfa8e(0x20d))),lodash_2=require('lodash'),index=async(_0x227252,_0x1dfa81)=>{const _0x2ee927=a39_0x2dfa8e,{searchParam:_0x1502b3,pageNumber:_0x47c79b}=_0x227252['query'],{companyId:_0x304e0c,profile:_0x1166cf}=_0x227252[_0x2ee927(0x21c)],{users:_0x5f15dc,count:_0x1b448e,hasMore:_0x2c3967}=await(0x0,ListUsersService_1[_0x2ee927(0x1fd)])({'searchParam':_0x1502b3,'pageNumber':_0x47c79b,'companyId':_0x304e0c,'profile':_0x1166cf});return _0x1dfa81[_0x2ee927(0x205)]({'users':_0x5f15dc,'count':_0x1b448e,'hasMore':_0x2c3967});};exports['index']=index;const store=async(_0xb4cae0,_0x2f3246)=>{const _0x153299=a39_0x2dfa8e,{email:_0xc32bef,password:_0x297470,name:_0x3d76f9,phone:_0x17e9f8,profile:_0x5a8cc4,companyId:_0x19b1e2,queueIds:_0xfe9328,companyName:_0x41e557,planId:_0x4c83b1,startWork:_0xdae5f6,endWork:_0x250b9d,whatsappId:_0x2141ad,allTicket:_0xebb701,defaultTheme:_0x141f9d,defaultMenu:_0xc4be92,allowGroup:_0x26f6f0,allHistoric:_0x2d5519,allUserChat:_0x4364b7}=_0xb4cae0[_0x153299(0x1f9)];let _0x46db47=null;const {dateToClient:_0x53975a}=(0x0,useDate_1['useDate'])();if(_0xb4cae0[_0x153299(0x21c)]!==undefined){const {companyId:_0x58a28f}=_0xb4cae0[_0x153299(0x21c)];_0x46db47=_0x58a28f;}if(_0xb4cae0['url']===_0x153299(0x1e3)&&await(0x0,CheckSettings_1['default'])('userCreation')===_0x153299(0x1fe))throw new AppError_1[(_0x153299(0x1fd))](_0x153299(0x211),0x193);else{if(_0xb4cae0['url']!==_0x153299(0x1e3)&&_0xb4cae0[_0x153299(0x21c)][_0x153299(0x1f3)]!==_0x153299(0x1f8))throw new AppError_1[(_0x153299(0x1fd))](_0x153299(0x233),0x193);}if(process[_0x153299(0x1e7)][_0x153299(0x1f5)]==='ON')throw new AppError_1[(_0x153299(0x1fd))]('ERR_NO_PERMISSION',0x193);const _0x3e77c5=_0x19b1e2||_0x46db47;if(!_0x3e77c5){const _0x3fbbfb=new Date();_0x3fbbfb[_0x153299(0x22b)](_0x3fbbfb[_0x153299(0x21f)]()+0x3);const _0x2ff081=_0x3fbbfb[_0x153299(0x229)]()[_0x153299(0x1e5)]('T')[0x0],_0x50541a={'name':_0x41e557,'email':_0xc32bef,'phone':_0x17e9f8,'planId':_0x4c83b1,'status':!![],'dueDate':_0x2ff081,'recurrence':'','document':'','paymentMethod':'','password':_0x297470,'companyUserName':_0x3d76f9,'startWork':_0xdae5f6,'endWork':_0x250b9d,'defaultTheme':'light','defaultMenu':_0x153299(0x1ea),'allowGroup':![],'allHistoric':![]},_0x3b0015=await(0x0,CreateCompanyService_1[_0x153299(0x1fd)])(_0x50541a);try{const _0x575bd2={'to':_0xc32bef,'subject':_0x153299(0x1ee)+_0x41e557,'text':'Olá\x20'+_0x3d76f9+_0x153299(0x231)+_0x41e557+_0x153299(0x1e8)+_0x41e557+_0x153299(0x1f0)+_0xc32bef+_0x153299(0x216)+_0x297470+_0x153299(0x239)+_0x53975a(_0x2ff081)};await(0x0,SendMail_1['SendMail'])(_0x575bd2);}catch(_0x3abdab){console[_0x153299(0x1fa)](_0x153299(0x215));}try{const _0x36a3af=await(0x0,ShowCompanyService_1[_0x153299(0x1fd)])(0x1),_0x3b1e74=await(0x0,FindCompaniesWhatsappService_1[_0x153299(0x1fd)])(_0x36a3af['id']);if(_0x3b1e74['whatsapps'][0x0]['status']==='CONNECTED'&&(_0x17e9f8!==undefined||!(0x0,lodash_1[_0x153299(0x221)])(_0x17e9f8)||!(0x0,lodash_1['isEmpty'])(_0x17e9f8))){const _0xb92229=_0x3b1e74[_0x153299(0x1ef)][0x0]['id'],_0x353ee8=(0x0,wbot_1[_0x153299(0x234)])(_0xb92229),_0x126ab4=_0x153299(0x225)+_0x3d76f9+_0x153299(0x22c)+_0x41e557+_0x153299(0x212)+_0x41e557+_0x153299(0x20a)+_0xc32bef+_0x153299(0x209)+_0x297470+_0x153299(0x21d)+_0x53975a(_0x2ff081);await _0x353ee8[_0x153299(0x1e4)]('55'+_0x17e9f8+'@s.whatsapp.net',{'text':_0x126ab4});}}catch(_0x5afc79){console[_0x153299(0x1fa)](_0x153299(0x1f2));}return _0x2f3246['status'](0xc8)[_0x153299(0x205)](_0x3b0015);}if(_0x3e77c5){const _0x37806b=await(0x0,CreateUserService_1[_0x153299(0x1fd)])({'email':_0xc32bef,'password':_0x297470,'name':_0x3d76f9,'profile':_0x5a8cc4,'companyId':_0x3e77c5,'queueIds':_0xfe9328,'startWork':_0xdae5f6,'endWork':_0x250b9d,'whatsappId':_0x2141ad,'allTicket':_0xebb701,'defaultTheme':_0x141f9d,'defaultMenu':_0xc4be92,'allowGroup':_0x26f6f0,'allHistoric':_0x2d5519,'allUserChat':_0x4364b7}),_0x2f0409=(0x0,socket_1[_0x153299(0x213)])();return _0x2f0409[_0x153299(0x228)](_0x153299(0x219)+_0x46db47+_0x153299(0x226),{'action':'create','user':_0x37806b}),_0x2f3246[_0x153299(0x21e)](0xc8)['json'](_0x37806b);}};exports[a39_0x2dfa8e(0x22a)]=store;const show=async(_0xcb2151,_0x980978)=>{const _0x442cc1=a39_0x2dfa8e,{userId:_0x40493b}=_0xcb2151[_0x442cc1(0x1e9)],{companyId:_0x1396ce}=_0xcb2151['user'],_0x529ce1=await(0x0,ShowUserService_1[_0x442cc1(0x1fd)])(_0x40493b,_0x1396ce);return _0x980978[_0x442cc1(0x21e)](0xc8)[_0x442cc1(0x205)](_0x529ce1);};exports['show']=show;const update=async(_0x342e63,_0x4ed2f8)=>{const _0x902d67=a39_0x2dfa8e;if(process['env'][_0x902d67(0x1f5)]==='ON')throw new AppError_1[(_0x902d67(0x1fd))](_0x902d67(0x233),0x193);const {id:_0x3276c3,companyId:_0x4ec3d1}=_0x342e63[_0x902d67(0x21c)],{userId:_0x39316a}=_0x342e63['params'],_0x16e29f=_0x342e63[_0x902d67(0x1f9)],_0x417172=await(0x0,UpdateUserService_1[_0x902d67(0x1fd)])({'userData':_0x16e29f,'userId':_0x39316a,'companyId':_0x4ec3d1,'requestUserId':+_0x3276c3}),_0x4ea4be=(0x0,socket_1[_0x902d67(0x213)])();return _0x4ea4be['emit'](_0x902d67(0x219)+_0x4ec3d1+_0x902d67(0x226),{'action':'update','user':_0x417172}),_0x4ed2f8[_0x902d67(0x21e)](0xc8)['json'](_0x417172);};exports[a39_0x2dfa8e(0x1ed)]=update;const remove=async(_0x3c7b0c,_0xc46111)=>{const _0x1bac58=a39_0x2dfa8e,{userId:_0x118af3}=_0x3c7b0c['params'],{companyId:_0x4c9929,id:_0x3daf7b,profile:_0x43fe57}=_0x3c7b0c['user'];if(_0x43fe57!=='admin')throw new AppError_1[(_0x1bac58(0x1fd))]('ERR_NO_PERMISSION',0x193);if(process['env'][_0x1bac58(0x1f5)]==='ON')throw new AppError_1[(_0x1bac58(0x1fd))](_0x1bac58(0x233),0x193);const _0x3a5570=await User_1[_0x1bac58(0x1fd)][_0x1bac58(0x1fc)]({'where':{'id':_0x118af3}});if(_0x4c9929!==_0x3a5570[_0x1bac58(0x22e)])return _0xc46111[_0x1bac58(0x21e)](0x190)['json']({'error':_0x1bac58(0x1f6)});else{await(0x0,DeleteUserService_1[_0x1bac58(0x1fd)])(_0x118af3,_0x4c9929);const _0x52e283=(0x0,socket_1[_0x1bac58(0x213)])();return _0x52e283['emit'](_0x1bac58(0x219)+_0x4c9929+_0x1bac58(0x226),{'action':_0x1bac58(0x1f1),'userId':_0x118af3}),_0xc46111[_0x1bac58(0x21e)](0xc8)[_0x1bac58(0x205)]({'message':_0x1bac58(0x1f4)});}};exports[a39_0x2dfa8e(0x1ff)]=remove;const list=async(_0x5d82fa,_0x43ec0c)=>{const _0x4a609a=a39_0x2dfa8e,{companyId:_0xb11c16}=_0x5d82fa[_0x4a609a(0x220)],{companyId:_0xee99cd}=_0x5d82fa['user'],_0xc13387=await(0x0,SimpleListService_1[_0x4a609a(0x1fd)])({'companyId':_0xb11c16?+_0xb11c16:_0xee99cd});return _0x43ec0c[_0x4a609a(0x21e)](0xc8)[_0x4a609a(0x205)](_0xc13387);};exports[a39_0x2dfa8e(0x21b)]=list;const mediaUpload=async(_0x23d2bf,_0x4b3d1c)=>{const _0x1edc19=a39_0x2dfa8e,{userId:_0xa8f4e0}=_0x23d2bf[_0x1edc19(0x1e9)],_0x313aa6=_0x23d2bf[_0x1edc19(0x214)],_0x33ba0f=(0x0,lodash_2['head'])(_0x313aa6);try{const _0x591428=await User_1['default'][_0x1edc19(0x200)](_0xa8f4e0);return _0x591428[_0x1edc19(0x1f7)]=_0x33ba0f[_0x1edc19(0x20c)][_0x1edc19(0x237)]('/','-'),await _0x591428['save'](),_0x4b3d1c[_0x1edc19(0x21e)](0xc8)[_0x1edc19(0x205)]({'user':_0x591428,'message':_0x1edc19(0x227)});}catch(_0x37559d){throw new AppError_1[(_0x1edc19(0x1fd))](_0x37559d[_0x1edc19(0x207)]);}};exports[a39_0x2dfa8e(0x224)]=mediaUpload;