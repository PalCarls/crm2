'use strict';const a33_0x3a0210=a33_0x48d0;(function(_0x543a34,_0x8c4d66){const _0x33fa79=a33_0x48d0,_0x58687f=_0x543a34();while(!![]){try{const _0x545161=-parseInt(_0x33fa79(0x107))/0x1*(-parseInt(_0x33fa79(0x102))/0x2)+parseInt(_0x33fa79(0x115))/0x3+-parseInt(_0x33fa79(0x108))/0x4+parseInt(_0x33fa79(0xf4))/0x5+-parseInt(_0x33fa79(0xf9))/0x6+parseInt(_0x33fa79(0xf2))/0x7+-parseInt(_0x33fa79(0xf1))/0x8*(parseInt(_0x33fa79(0x104))/0x9);if(_0x545161===_0x8c4d66)break;else _0x58687f['push'](_0x58687f['shift']());}catch(_0x2dd102){_0x58687f['push'](_0x58687f['shift']());}}}(a33_0x1cbd,0x65ed6));var __importDefault=this&&this[a33_0x3a0210(0x119)]||function(_0x407cb3){return _0x407cb3&&_0x407cb3['__esModule']?_0x407cb3:{'default':_0x407cb3};};Object[a33_0x3a0210(0xf5)](exports,'__esModule',{'value':!![]}),exports['closeAll']=exports[a33_0x3a0210(0x105)]=exports[a33_0x3a0210(0x101)]=exports[a33_0x3a0210(0x103)]=exports['show']=exports[a33_0x3a0210(0x10a)]=exports[a33_0x3a0210(0x10f)]=void 0x0;const socket_1=require(a33_0x3a0210(0x110)),Ticket_1=__importDefault(require(a33_0x3a0210(0xf6))),CreateTicketService_1=__importDefault(require(a33_0x3a0210(0xeb))),DeleteTicketService_1=__importDefault(require(a33_0x3a0210(0xfa))),ListTicketsService_1=__importDefault(require(a33_0x3a0210(0xf0))),ShowTicketFromUUIDService_1=__importDefault(require('../services/TicketServices/ShowTicketFromUUIDService')),ShowTicketService_1=__importDefault(require(a33_0x3a0210(0xed))),UpdateTicketService_1=__importDefault(require(a33_0x3a0210(0xfd))),index=async(_0x1c5f31,_0x36912e)=>{const _0x11e0de=a33_0x3a0210,{pageNumber:_0x12a3e7,status:_0x3c593e,date:_0x1cd515,dateStart:_0x40985e,dateEnd:_0xff91cf,updatedAt:_0x4329d9,searchParam:_0x316f0c,showAll:_0x578ed1,queueIds:_0x264310,tags:_0x2049a7,users:_0x18e240,withUnreadMessages:_0x37b59c,whatsapps:_0x5300af,statusFilter:_0x33abe8}=_0x1c5f31[_0x11e0de(0x10d)],_0x1d8362=_0x1c5f31[_0x11e0de(0xec)]['id'],{companyId:_0x432e07}=_0x1c5f31['user'];let _0x3b4f07=[],_0x773e1f=[],_0x370441=[],_0x52cdbd=[],_0x1c6a75=[];_0x264310&&(_0x3b4f07=JSON[_0x11e0de(0xee)](_0x264310));_0x2049a7&&(_0x773e1f=JSON[_0x11e0de(0xee)](_0x2049a7));_0x18e240&&(_0x370441=JSON['parse'](_0x18e240));_0x5300af&&(_0x52cdbd=JSON[_0x11e0de(0xee)](_0x5300af));_0x33abe8&&(_0x1c6a75=JSON[_0x11e0de(0xee)](_0x33abe8));const {tickets:_0x563114,count:_0x51c9ea,hasMore:_0x2d5ec1}=await(0x0,ListTicketsService_1[_0x11e0de(0x113)])({'searchParam':_0x316f0c,'tags':_0x773e1f,'users':_0x370441,'pageNumber':_0x12a3e7,'status':_0x3c593e,'date':_0x1cd515,'dateStart':_0x40985e,'dateEnd':_0xff91cf,'updatedAt':_0x4329d9,'showAll':_0x578ed1,'userId':_0x1d8362,'queueIds':_0x3b4f07,'withUnreadMessages':_0x37b59c,'whatsappIds':_0x52cdbd,'statusFilters':_0x1c6a75,'companyId':_0x432e07});return _0x36912e['status'](0xc8)[_0x11e0de(0x112)]({'tickets':_0x563114,'count':_0x51c9ea,'hasMore':_0x2d5ec1});};exports[a33_0x3a0210(0x10f)]=index;const store=async(_0xeb4c91,_0x506e46)=>{const _0x3361c6=a33_0x3a0210,{contactId:_0x20ea2d,status:_0x3d2c12,userId:_0x5b256a,queueId:_0x4e3aba,whatsappId:_0x5ed2f9}=_0xeb4c91['body'],{companyId:_0x15d488}=_0xeb4c91['user'],_0xe3bd7b=await(0x0,CreateTicketService_1[_0x3361c6(0x113)])({'contactId':_0x20ea2d,'status':_0x3d2c12,'userId':_0x5b256a,'companyId':_0x15d488,'queueId':_0x4e3aba,'whatsappId':_0x5ed2f9}),_0x3c8060=(0x0,socket_1[_0x3361c6(0xfe)])();return _0x3c8060['to'](_0xe3bd7b[_0x3361c6(0xef)])[_0x3361c6(0xf8)]('company-'+_0x15d488+_0x3361c6(0x10c),{'action':_0x3361c6(0x101),'ticket':_0xe3bd7b}),_0x506e46[_0x3361c6(0xef)](0xc8)[_0x3361c6(0x112)](_0xe3bd7b);};exports[a33_0x3a0210(0x10a)]=store;const show=async(_0x367f51,_0x46ed77)=>{const _0x45dfb1=a33_0x3a0210,{ticketId:_0x4ba62d}=_0x367f51[_0x45dfb1(0x10b)],{companyId:_0x398621}=_0x367f51[_0x45dfb1(0xec)],_0x4b13d0=await(0x0,ShowTicketService_1[_0x45dfb1(0x113)])(_0x4ba62d,_0x398621);return _0x46ed77['status'](0xc8)[_0x45dfb1(0x112)](_0x4b13d0);};function a33_0x48d0(_0x4dad83,_0x46eef2){const _0x1cbda4=a33_0x1cbd();return a33_0x48d0=function(_0x48d075,_0x5959d4){_0x48d075=_0x48d075-0xea;let _0x4950eb=_0x1cbda4[_0x48d075];return _0x4950eb;},a33_0x48d0(_0x4dad83,_0x46eef2);}exports[a33_0x3a0210(0x118)]=show;const showFromUUID=async(_0x4a497a,_0x40c802)=>{const _0x1e5708=a33_0x3a0210,{uuid:_0x291107}=_0x4a497a[_0x1e5708(0x10b)],_0x5569f4=await(0x0,ShowTicketFromUUIDService_1[_0x1e5708(0x113)])(_0x291107);return _0x40c802[_0x1e5708(0xef)](0xc8)[_0x1e5708(0x112)](_0x5569f4);};exports[a33_0x3a0210(0x103)]=showFromUUID;const update=async(_0x5f3bec,_0x53b084)=>{const _0x4a6435=a33_0x3a0210,{ticketId:_0x262b51}=_0x5f3bec['params'],_0x1bdab0=_0x5f3bec[_0x4a6435(0xfb)],{companyId:_0x8bda4a}=_0x5f3bec[_0x4a6435(0xec)],{ticket:_0x335f67}=await(0x0,UpdateTicketService_1['default'])({'ticketData':_0x1bdab0,'ticketId':_0x262b51,'companyId':_0x8bda4a});return _0x53b084[_0x4a6435(0xef)](0xc8)[_0x4a6435(0x112)](_0x335f67);};exports['update']=update;function a33_0x1cbd(){const _0x3518e0=['remove','userId','986nHUaMO','1959548MMQhMj','queueId','store','params','-ticket','query','notification','index','../libs/socket','toString','json','default','closed','2052810hDLKJF','open','closeAll','show','__importDefault','findAndCountAll','../services/TicketServices/CreateTicketService','user','../services/TicketServices/ShowTicketService','parse','status','../services/TicketServices/ListTicketsService','675992mxsMgk','5385296WOSnQr','delete','260745FIQHpO','defineProperty','../models/Ticket','forEach','emit','4445094ehgcDm','../services/TicketServices/DeleteTicketService','body','updatedAt','../services/TicketServices/UpdateTicketService','getIO','company-','ticket\x20deleted','update','1146aiaVTP','showFromUUID','45XXYzzy'];a33_0x1cbd=function(){return _0x3518e0;};return a33_0x1cbd();}const remove=async(_0x56855e,_0x440a16)=>{const _0x2d1817=a33_0x3a0210,{ticketId:_0x4bb412}=_0x56855e[_0x2d1817(0x10b)],{companyId:_0x3a90d2}=_0x56855e[_0x2d1817(0xec)];await(0x0,ShowTicketService_1[_0x2d1817(0x113)])(_0x4bb412,_0x3a90d2);const _0x39bc63=await(0x0,DeleteTicketService_1[_0x2d1817(0x113)])(_0x4bb412),_0x18afb8=(0x0,socket_1['getIO'])();return _0x18afb8['to'](_0x39bc63[_0x2d1817(0xef)])['to'](_0x4bb412)['to'](_0x2d1817(0x10e))[_0x2d1817(0xf8)](_0x2d1817(0xff)+_0x3a90d2+_0x2d1817(0x10c),{'action':_0x2d1817(0xf3),'ticketId':+_0x4bb412}),_0x440a16[_0x2d1817(0xef)](0xc8)[_0x2d1817(0x112)]({'message':_0x2d1817(0x100)});};exports['remove']=remove;const closeAll=async(_0x42711c,_0x107e7a)=>{const _0x5abb58=a33_0x3a0210,{companyId:_0x1aee20}=_0x42711c[_0x5abb58(0xec)],{status:_0x5dcec6}=_0x42711c[_0x5abb58(0xfb)],_0x22a057=(0x0,socket_1['getIO'])(),{rows:_0x2161ea}=await Ticket_1[_0x5abb58(0x113)][_0x5abb58(0xea)]({'where':{'companyId':_0x1aee20,'status':_0x5dcec6,'isGroup':![]},'order':[[_0x5abb58(0xfc),'DESC']]});return _0x2161ea[_0x5abb58(0xf7)](async _0xb48c78=>{const _0x5e3f67=_0x5abb58;await _0xb48c78[_0x5e3f67(0x101)]({'status':_0x5e3f67(0x114),'userId':_0xb48c78[_0x5e3f67(0x106)]||0x1,'queueId':_0xb48c78[_0x5e3f67(0x109)]||null,'unreadMessages':0x0,'amountUsedBotQueues':0x0}),_0x22a057['to'](_0x5e3f67(0x116))['to'](_0xb48c78['id'][_0x5e3f67(0x111)]())['emit'](_0x5e3f67(0xff)+_0xb48c78['companyId']+_0x5e3f67(0x10c),{'action':'delete','ticketId':_0xb48c78['id']});}),_0x107e7a[_0x5abb58(0xef)](0xc8)[_0x5abb58(0x112)]();};exports[a33_0x3a0210(0x117)]=closeAll;