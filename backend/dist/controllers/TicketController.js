<<<<<<< HEAD
'use strict';const a36_0x435f4b=a36_0x100f;(function(_0xaf4c41,_0x388c7e){const _0x1e5fd2=a36_0x100f,_0x411058=_0xaf4c41();while(!![]){try{const _0x3f408c=parseInt(_0x1e5fd2(0x177))/0x1+-parseInt(_0x1e5fd2(0x176))/0x2+-parseInt(_0x1e5fd2(0x18c))/0x3+parseInt(_0x1e5fd2(0x18e))/0x4+-parseInt(_0x1e5fd2(0x19e))/0x5+parseInt(_0x1e5fd2(0x187))/0x6+-parseInt(_0x1e5fd2(0x19f))/0x7*(-parseInt(_0x1e5fd2(0x181))/0x8);if(_0x3f408c===_0x388c7e)break;else _0x411058['push'](_0x411058['shift']());}catch(_0x259bb6){_0x411058['push'](_0x411058['shift']());}}}(a36_0x566d,0x215d3));var __importDefault=this&&this['__importDefault']||function(_0x19a96a){const _0x24bbda=a36_0x100f;return _0x19a96a&&_0x19a96a[_0x24bbda(0x18a)]?_0x19a96a:{'default':_0x19a96a};};Object[a36_0x435f4b(0x194)](exports,a36_0x435f4b(0x18a),{'value':!![]}),exports[a36_0x435f4b(0x173)]=exports['remove']=exports[a36_0x435f4b(0x1a0)]=exports[a36_0x435f4b(0x171)]=exports[a36_0x435f4b(0x170)]=exports[a36_0x435f4b(0x183)]=exports[a36_0x435f4b(0x17a)]=exports[a36_0x435f4b(0x198)]=exports[a36_0x435f4b(0x172)]=void 0x0;const socket_1=require(a36_0x435f4b(0x17e)),Ticket_1=__importDefault(require(a36_0x435f4b(0x195))),CreateTicketService_1=__importDefault(require('../services/TicketServices/CreateTicketService')),DeleteTicketService_1=__importDefault(require(a36_0x435f4b(0x199))),ListTicketsService_1=__importDefault(require(a36_0x435f4b(0x175))),ShowTicketFromUUIDService_1=__importDefault(require(a36_0x435f4b(0x185))),ShowTicketService_1=__importDefault(require('../services/TicketServices/ShowTicketService')),UpdateTicketService_1=__importDefault(require(a36_0x435f4b(0x196))),ListTicketsServiceKanban_1=__importDefault(require(a36_0x435f4b(0x193))),CreateLogTicketService_1=__importDefault(require(a36_0x435f4b(0x19d))),ShowLogTicketService_1=__importDefault(require(a36_0x435f4b(0x180))),index=async(_0x953c0d,_0x3c89a8)=>{const _0xf5db7b=a36_0x435f4b,{pageNumber:_0x21af5b,status:_0x3cd099,date:_0x526dc2,dateStart:_0x2f3e50,dateEnd:_0x4a736d,updatedAt:_0xd5da6c,searchParam:_0x867855,showAll:_0x3b47a2,queueIds:_0x37d4bc,tags:_0x40c054,users:_0x574f1f,withUnreadMessages:_0x1d4d0b,whatsapps:_0x5afa16,statusFilter:_0x3105ec}=_0x953c0d[_0xf5db7b(0x182)],_0x1d9a06=Number(_0x953c0d[_0xf5db7b(0x186)]['id']),{companyId:_0x3696f2}=_0x953c0d[_0xf5db7b(0x186)];let _0x5fa85f=[],_0x974f63=[],_0x2bcd0a=[],_0x30ff3a=[],_0x377f65=[];_0x37d4bc&&(_0x5fa85f=JSON[_0xf5db7b(0x19a)](_0x37d4bc));_0x40c054&&(_0x974f63=JSON[_0xf5db7b(0x19a)](_0x40c054));_0x574f1f&&(_0x2bcd0a=JSON[_0xf5db7b(0x19a)](_0x574f1f));_0x5afa16&&(_0x30ff3a=JSON[_0xf5db7b(0x19a)](_0x5afa16));_0x3105ec&&(_0x377f65=JSON['parse'](_0x3105ec));const {tickets:_0x2da609,count:_0x56c5f3,hasMore:_0x5813c7}=await(0x0,ListTicketsService_1[_0xf5db7b(0x19b)])({'searchParam':_0x867855,'tags':_0x974f63,'users':_0x2bcd0a,'pageNumber':_0x21af5b,'status':_0x3cd099,'date':_0x526dc2,'dateStart':_0x2f3e50,'dateEnd':_0x4a736d,'updatedAt':_0xd5da6c,'showAll':_0x3b47a2,'userId':_0x1d9a06,'queueIds':_0x5fa85f,'withUnreadMessages':_0x1d4d0b,'whatsappIds':_0x30ff3a,'statusFilters':_0x377f65,'companyId':_0x3696f2});return _0x3c89a8['status'](0xc8)['json']({'tickets':_0x2da609,'count':_0x56c5f3,'hasMore':_0x5813c7});};exports['index']=index;const kanban=async(_0x3cb1c8,_0x2f946f)=>{const _0x36eef9=a36_0x435f4b,{pageNumber:_0x36da69,status:_0xe67a4d,date:_0x4d4230,updatedAt:_0x3341be,searchParam:_0x4395fe,showAll:_0x350950,queueIds:_0x2c50bb,tags:_0x5478a8,users:_0x460c9c,withUnreadMessages:_0x1f7d10}=_0x3cb1c8[_0x36eef9(0x182)],_0x4b0b8a=_0x3cb1c8[_0x36eef9(0x186)]['id'],{companyId:_0x3f750d}=_0x3cb1c8[_0x36eef9(0x186)];let _0x180089=[],_0x2b2aaf=[],_0x58bd3a=[];_0x2c50bb&&(_0x180089=JSON['parse'](_0x2c50bb));_0x5478a8&&(_0x2b2aaf=JSON[_0x36eef9(0x19a)](_0x5478a8));_0x460c9c&&(_0x58bd3a=JSON['parse'](_0x460c9c));const {tickets:_0x35f165,count:_0x5c0e2a,hasMore:_0x16bce9}=await(0x0,ListTicketsServiceKanban_1[_0x36eef9(0x19b)])({'searchParam':_0x4395fe,'tags':_0x2b2aaf,'users':_0x58bd3a,'pageNumber':_0x36da69,'status':_0xe67a4d,'date':_0x4d4230,'updatedAt':_0x3341be,'showAll':_0x350950,'userId':_0x4b0b8a,'queueIds':_0x180089,'withUnreadMessages':_0x1f7d10,'companyId':_0x3f750d});return _0x2f946f['status'](0xc8)[_0x36eef9(0x17b)]({'tickets':_0x35f165,'count':_0x5c0e2a,'hasMore':_0x16bce9});};exports[a36_0x435f4b(0x198)]=kanban;const store=async(_0x5edf5d,_0x17358c)=>{const _0x4deab8=a36_0x435f4b,{contactId:_0x55d023,status:_0x1ab51c,userId:_0x362f1e,queueId:_0x2f0992,whatsappId:_0x4fe0d8}=_0x5edf5d[_0x4deab8(0x179)],{companyId:_0x11a23a}=_0x5edf5d['user'],_0x5ad525=await(0x0,CreateTicketService_1[_0x4deab8(0x19b)])({'contactId':_0x55d023,'status':_0x1ab51c,'userId':_0x362f1e,'companyId':_0x11a23a,'queueId':_0x2f0992,'whatsappId':_0x4fe0d8}),_0x5f0daa=(0x0,socket_1[_0x4deab8(0x189)])();return _0x5f0daa['to'](_0x5ad525['status'])['emit'](_0x4deab8(0x184)+_0x11a23a+'-ticket',{'action':'update','ticket':_0x5ad525}),_0x17358c[_0x4deab8(0x191)](0xc8)[_0x4deab8(0x17b)](_0x5ad525);};exports['store']=store;const show=async(_0x17f27b,_0x2d8f2a)=>{const _0x3d6875=a36_0x435f4b,{ticketId:_0x1f661a}=_0x17f27b[_0x3d6875(0x178)],{id:_0x4276e4,companyId:_0x5b5f79}=_0x17f27b[_0x3d6875(0x186)],_0x123f89=await(0x0,ShowTicketService_1['default'])(_0x1f661a,_0x5b5f79);return await(0x0,CreateLogTicketService_1[_0x3d6875(0x19b)])({'userId':_0x4276e4,'ticketId':_0x1f661a,'type':_0x3d6875(0x18f)}),_0x2d8f2a[_0x3d6875(0x191)](0xc8)[_0x3d6875(0x17b)](_0x123f89);};exports['show']=show;const showLog=async(_0x1128db,_0xe587b1)=>{const _0x5d35b8=a36_0x435f4b,{ticketId:_0x56a193}=_0x1128db[_0x5d35b8(0x178)],{id:_0x49c46e,companyId:_0x4cac64}=_0x1128db[_0x5d35b8(0x186)],_0x2e0270=await(0x0,ShowLogTicketService_1['default'])({'ticketId':_0x56a193,'companyId':_0x4cac64});return _0xe587b1[_0x5d35b8(0x191)](0xc8)['json'](_0x2e0270);};exports['showLog']=showLog;function a36_0x566d(){const _0x5ae85a=['defineProperty','../models/Ticket','../services/TicketServices/UpdateTicketService','closed','kanban','../services/TicketServices/DeleteTicketService','parse','default','findAndCountAll','../services/TicketServices/CreateLogTicketService','631890RWsdgV','35GqYthK','update','showLog','showFromUUID','index','closeAll','DESC','../services/TicketServices/ListTicketsService','359088NnytAt','160311wuLezf','params','body','store','json','userId','updatedAt','../libs/socket','queueId','../services/TicketServices/ShowLogTicketService','588024OkKEND','query','show','company-','../services/TicketServices/ShowTicketFromUUIDService','user','144948WnuwhF','ticket\x20deleted','getIO','__esModule','remove','349143jgMWuy','forEach','27912tWtZcZ','access','-ticket','status','notification','../services/TicketServices/ListTicketsServiceKanban'];a36_0x566d=function(){return _0x5ae85a;};return a36_0x566d();}const showFromUUID=async(_0x1e896f,_0x2abef4)=>{const _0x365bda=a36_0x435f4b,{uuid:_0x45b16b}=_0x1e896f['params'],{id:_0x22f4e9,companyId:_0xaacb37}=_0x1e896f['user'],_0x5cadd9=await(0x0,ShowTicketFromUUIDService_1[_0x365bda(0x19b)])(_0x45b16b,_0xaacb37);return await(0x0,CreateLogTicketService_1[_0x365bda(0x19b)])({'userId':_0x22f4e9,'ticketId':_0x5cadd9['id'],'type':_0x365bda(0x18f)}),_0x2abef4[_0x365bda(0x191)](0xc8)['json'](_0x5cadd9);};function a36_0x100f(_0x3a5bda,_0x24e46d){const _0x566d14=a36_0x566d();return a36_0x100f=function(_0x100f91,_0x585e4a){_0x100f91=_0x100f91-0x170;let _0x44625d=_0x566d14[_0x100f91];return _0x44625d;},a36_0x100f(_0x3a5bda,_0x24e46d);}exports[a36_0x435f4b(0x171)]=showFromUUID;const update=async(_0x59e602,_0x21da38)=>{const _0x325b17=a36_0x435f4b,{ticketId:_0x39f7c8}=_0x59e602[_0x325b17(0x178)],_0xbc29f8=_0x59e602[_0x325b17(0x179)],{companyId:_0x2fd92b}=_0x59e602['user'],{ticket:_0x145d2e}=await(0x0,UpdateTicketService_1[_0x325b17(0x19b)])({'ticketData':_0xbc29f8,'ticketId':_0x39f7c8,'companyId':_0x2fd92b});return _0x21da38[_0x325b17(0x191)](0xc8)['json'](_0x145d2e);};exports[a36_0x435f4b(0x1a0)]=update;const remove=async(_0x177a98,_0x582528)=>{const _0x1e6924=a36_0x435f4b,{ticketId:_0x596f8d}=_0x177a98['params'],{id:_0x3d0524,companyId:_0x26bb08}=_0x177a98['user'];await(0x0,ShowTicketService_1[_0x1e6924(0x19b)])(_0x596f8d,_0x26bb08);const _0x309996=await(0x0,DeleteTicketService_1[_0x1e6924(0x19b)])(_0x596f8d,_0x3d0524,_0x26bb08),_0x1b4f85=(0x0,socket_1[_0x1e6924(0x189)])();return _0x1b4f85['to'](_0x309996[_0x1e6924(0x191)])['to'](_0x596f8d)['to'](_0x1e6924(0x192))['emit'](_0x1e6924(0x184)+_0x26bb08+_0x1e6924(0x190),{'action':'delete','ticketId':+_0x596f8d}),_0x582528[_0x1e6924(0x191)](0xc8)[_0x1e6924(0x17b)]({'message':_0x1e6924(0x188)});};exports[a36_0x435f4b(0x18b)]=remove;const closeAll=async(_0xfabaab,_0x1baf64)=>{const _0x3ef9a7=a36_0x435f4b,{companyId:_0x3d78d3}=_0xfabaab[_0x3ef9a7(0x186)],{status:_0x2bbe44}=_0xfabaab[_0x3ef9a7(0x179)],_0x47c8e5=(0x0,socket_1[_0x3ef9a7(0x189)])(),{rows:_0x1b1faf}=await Ticket_1['default'][_0x3ef9a7(0x19c)]({'where':{'companyId':_0x3d78d3,'status':_0x2bbe44},'order':[[_0x3ef9a7(0x17d),_0x3ef9a7(0x174)]]});return _0x1b1faf[_0x3ef9a7(0x18d)](async _0x2bf0f4=>{const _0x47b649=_0x3ef9a7,_0xf94b01={'status':_0x47b649(0x197),'userId':_0x2bf0f4[_0x47b649(0x17c)]||null,'queueId':_0x2bf0f4[_0x47b649(0x17f)]||null,'unreadMessages':0x0,'amountUsedBotQueues':0x0,'sendFarewellMessage':![]};await(0x0,UpdateTicketService_1[_0x47b649(0x19b)])({'ticketData':_0xf94b01,'ticketId':_0x2bf0f4['id'],'companyId':_0x3d78d3});}),_0x1baf64[_0x3ef9a7(0x191)](0xc8)[_0x3ef9a7(0x17b)]();};exports[a36_0x435f4b(0x173)]=closeAll;
=======
'use strict';const a36_0x2d392b=a36_0x3865;(function(_0x408ba9,_0x1c0050){const _0x507c08=a36_0x3865,_0x1db478=_0x408ba9();while(!![]){try{const _0x16783b=parseInt(_0x507c08(0x146))/0x1*(parseInt(_0x507c08(0x130))/0x2)+-parseInt(_0x507c08(0x129))/0x3+parseInt(_0x507c08(0x13e))/0x4+parseInt(_0x507c08(0x147))/0x5*(parseInt(_0x507c08(0x12c))/0x6)+-parseInt(_0x507c08(0x139))/0x7*(-parseInt(_0x507c08(0x14e))/0x8)+-parseInt(_0x507c08(0x138))/0x9*(-parseInt(_0x507c08(0x155))/0xa)+-parseInt(_0x507c08(0x143))/0xb*(parseInt(_0x507c08(0x13c))/0xc);if(_0x16783b===_0x1c0050)break;else _0x1db478['push'](_0x1db478['shift']());}catch(_0x1062d5){_0x1db478['push'](_0x1db478['shift']());}}}(a36_0x3c58,0x4844e));var __importDefault=this&&this[a36_0x2d392b(0x12d)]||function(_0x4cd1ab){const _0x5709a1=a36_0x2d392b;return _0x4cd1ab&&_0x4cd1ab[_0x5709a1(0x132)]?_0x4cd1ab:{'default':_0x4cd1ab};};Object[a36_0x2d392b(0x126)](exports,a36_0x2d392b(0x132),{'value':!![]}),exports[a36_0x2d392b(0x13f)]=exports['remove']=exports[a36_0x2d392b(0x144)]=exports[a36_0x2d392b(0x12a)]=exports[a36_0x2d392b(0x157)]=exports['show']=exports[a36_0x2d392b(0x14d)]=exports['kanban']=exports[a36_0x2d392b(0x148)]=void 0x0;const socket_1=require(a36_0x2d392b(0x13a)),Ticket_1=__importDefault(require(a36_0x2d392b(0x140))),CreateTicketService_1=__importDefault(require(a36_0x2d392b(0x134))),DeleteTicketService_1=__importDefault(require(a36_0x2d392b(0x13b))),ListTicketsService_1=__importDefault(require(a36_0x2d392b(0x142))),ShowTicketFromUUIDService_1=__importDefault(require(a36_0x2d392b(0x12e))),ShowTicketService_1=__importDefault(require(a36_0x2d392b(0x151))),UpdateTicketService_1=__importDefault(require(a36_0x2d392b(0x156))),ListTicketsServiceKanban_1=__importDefault(require(a36_0x2d392b(0x152))),CreateLogTicketService_1=__importDefault(require(a36_0x2d392b(0x153))),ShowLogTicketService_1=__importDefault(require('../services/TicketServices/ShowLogTicketService')),index=async(_0x2b5c88,_0x3fe0ae)=>{const _0x44d550=a36_0x2d392b,{pageNumber:_0x75c0b0,status:_0x5b98a6,date:_0x2c6531,dateStart:_0x229f16,dateEnd:_0xfe0b98,updatedAt:_0x4a9d3b,searchParam:_0x220bd0,showAll:_0x2af3fa,queueIds:_0x477fab,tags:_0x50240c,users:_0x5d75da,withUnreadMessages:_0x32bb2d,whatsapps:_0x5ec3a2,statusFilter:_0x19801f}=_0x2b5c88[_0x44d550(0x145)],_0x5632ab=Number(_0x2b5c88[_0x44d550(0x12b)]['id']),{companyId:_0xc2268c}=_0x2b5c88[_0x44d550(0x12b)];let _0x522a1a=[],_0x368aa1=[],_0x315f60=[],_0xc94314=[],_0x432c77=[];_0x477fab&&(_0x522a1a=JSON['parse'](_0x477fab));_0x50240c&&(_0x368aa1=JSON[_0x44d550(0x14c)](_0x50240c));_0x5d75da&&(_0x315f60=JSON[_0x44d550(0x14c)](_0x5d75da));_0x5ec3a2&&(_0xc94314=JSON[_0x44d550(0x14c)](_0x5ec3a2));_0x19801f&&(_0x432c77=JSON['parse'](_0x19801f));const {tickets:_0x136a3f,count:_0x5182ed,hasMore:_0x887e88}=await(0x0,ListTicketsService_1[_0x44d550(0x127)])({'searchParam':_0x220bd0,'tags':_0x368aa1,'users':_0x315f60,'pageNumber':_0x75c0b0,'status':_0x5b98a6,'date':_0x2c6531,'dateStart':_0x229f16,'dateEnd':_0xfe0b98,'updatedAt':_0x4a9d3b,'showAll':_0x2af3fa,'userId':_0x5632ab,'queueIds':_0x522a1a,'withUnreadMessages':_0x32bb2d,'whatsappIds':_0xc94314,'statusFilters':_0x432c77,'companyId':_0xc2268c});return _0x3fe0ae[_0x44d550(0x133)](0xc8)[_0x44d550(0x131)]({'tickets':_0x136a3f,'count':_0x5182ed,'hasMore':_0x887e88});};exports[a36_0x2d392b(0x148)]=index;const kanban=async(_0x558cee,_0x203f24)=>{const _0x16fc45=a36_0x2d392b,{pageNumber:_0x686ccf,status:_0x2ad639,date:_0x2385c3,updatedAt:_0x29c4a2,searchParam:_0x27aa7f,showAll:_0x157dfa,queueIds:_0x2e816b,tags:_0x26b41a,users:_0x11f158,withUnreadMessages:_0x4551db}=_0x558cee[_0x16fc45(0x145)],_0x5ff7b2=_0x558cee[_0x16fc45(0x12b)]['id'],{companyId:_0x3d47b9}=_0x558cee[_0x16fc45(0x12b)];let _0x34d7ea=[],_0x5dd731=[],_0x369bc0=[];_0x2e816b&&(_0x34d7ea=JSON[_0x16fc45(0x14c)](_0x2e816b));_0x26b41a&&(_0x5dd731=JSON[_0x16fc45(0x14c)](_0x26b41a));_0x11f158&&(_0x369bc0=JSON[_0x16fc45(0x14c)](_0x11f158));const {tickets:_0x5663b1,count:_0x1d8f90,hasMore:_0x459638}=await(0x0,ListTicketsServiceKanban_1[_0x16fc45(0x127)])({'searchParam':_0x27aa7f,'tags':_0x5dd731,'users':_0x369bc0,'pageNumber':_0x686ccf,'status':_0x2ad639,'date':_0x2385c3,'updatedAt':_0x29c4a2,'showAll':_0x157dfa,'userId':_0x5ff7b2,'queueIds':_0x34d7ea,'withUnreadMessages':_0x4551db,'companyId':_0x3d47b9});return _0x203f24['status'](0xc8)[_0x16fc45(0x131)]({'tickets':_0x5663b1,'count':_0x1d8f90,'hasMore':_0x459638});};exports[a36_0x2d392b(0x13d)]=kanban;const store=async(_0x442222,_0x176cb2)=>{const _0x1646cb=a36_0x2d392b,{contactId:_0x34af72,status:_0x27c43e,userId:_0x47fd9d,queueId:_0x16ddd7,whatsappId:_0x3eb978}=_0x442222[_0x1646cb(0x12f)],{companyId:_0xaff412}=_0x442222['user'],_0x575532=await(0x0,CreateTicketService_1[_0x1646cb(0x127)])({'contactId':_0x34af72,'status':_0x27c43e,'userId':_0x47fd9d,'companyId':_0xaff412,'queueId':_0x16ddd7,'whatsappId':_0x3eb978}),_0x4d751d=(0x0,socket_1[_0x1646cb(0x128)])();return _0x4d751d['to'](_0x575532[_0x1646cb(0x133)])[_0x1646cb(0x137)](_0x1646cb(0x14f)+_0xaff412+_0x1646cb(0x14b),{'action':_0x1646cb(0x144),'ticket':_0x575532}),_0x176cb2[_0x1646cb(0x133)](0xc8)['json'](_0x575532);};exports[a36_0x2d392b(0x14d)]=store;const show=async(_0x56f66a,_0x21c0de)=>{const _0x566cc8=a36_0x2d392b,{ticketId:_0x17500d}=_0x56f66a[_0x566cc8(0x135)],{id:_0x45524d,companyId:_0x5b057a}=_0x56f66a[_0x566cc8(0x12b)],_0x3205ef=await(0x0,ShowTicketService_1[_0x566cc8(0x127)])(_0x17500d,_0x5b057a);return await(0x0,CreateLogTicketService_1['default'])({'userId':_0x45524d,'ticketId':_0x17500d,'type':_0x566cc8(0x150)}),_0x21c0de[_0x566cc8(0x133)](0xc8)[_0x566cc8(0x131)](_0x3205ef);};exports[a36_0x2d392b(0x141)]=show;const showLog=async(_0x34c147,_0x5ec203)=>{const _0x4ff9c1=a36_0x2d392b,{ticketId:_0x3bba99}=_0x34c147['params'],{id:_0x3059a4,companyId:_0x142634}=_0x34c147[_0x4ff9c1(0x12b)],_0x225b00=await(0x0,ShowLogTicketService_1[_0x4ff9c1(0x127)])({'ticketId':_0x3bba99,'companyId':_0x142634});return _0x5ec203[_0x4ff9c1(0x133)](0xc8)[_0x4ff9c1(0x131)](_0x225b00);};exports[a36_0x2d392b(0x157)]=showLog;const showFromUUID=async(_0x2fc9fd,_0x2197d6)=>{const _0x322181=a36_0x2d392b,{uuid:_0x54562b}=_0x2fc9fd[_0x322181(0x135)],{id:_0x3e0c22,companyId:_0x387415}=_0x2fc9fd[_0x322181(0x12b)],_0x38cba4=await(0x0,ShowTicketFromUUIDService_1[_0x322181(0x127)])(_0x54562b,_0x387415);return await(0x0,CreateLogTicketService_1['default'])({'userId':_0x3e0c22,'ticketId':_0x38cba4['id'],'type':_0x322181(0x150)}),_0x2197d6['status'](0xc8)[_0x322181(0x131)](_0x38cba4);};exports['showFromUUID']=showFromUUID;const update=async(_0x2ef8bf,_0xc33b5a)=>{const _0x16f77d=a36_0x2d392b,{ticketId:_0x3b4139}=_0x2ef8bf[_0x16f77d(0x135)],_0x4f5373=_0x2ef8bf[_0x16f77d(0x12f)],{companyId:_0x2b0cb0}=_0x2ef8bf['user'],{ticket:_0x4a87c7}=await(0x0,UpdateTicketService_1[_0x16f77d(0x127)])({'ticketData':_0x4f5373,'ticketId':_0x3b4139,'companyId':_0x2b0cb0});return _0xc33b5a[_0x16f77d(0x133)](0xc8)[_0x16f77d(0x131)](_0x4a87c7);};exports[a36_0x2d392b(0x144)]=update;const remove=async(_0x5a400a,_0x8d828b)=>{const _0x27e75f=a36_0x2d392b,{ticketId:_0x32b2fd}=_0x5a400a[_0x27e75f(0x135)],{id:_0x8341,companyId:_0x38b791}=_0x5a400a[_0x27e75f(0x12b)];await(0x0,ShowTicketService_1[_0x27e75f(0x127)])(_0x32b2fd,_0x38b791);const _0x52c4c8=await(0x0,DeleteTicketService_1[_0x27e75f(0x127)])(_0x32b2fd,_0x8341,_0x38b791),_0x493fdd=(0x0,socket_1[_0x27e75f(0x128)])();return _0x493fdd['to'](_0x52c4c8[_0x27e75f(0x133)])['to'](_0x32b2fd)['to'](_0x27e75f(0x149))[_0x27e75f(0x137)](_0x27e75f(0x14f)+_0x38b791+_0x27e75f(0x14b),{'action':'delete','ticketId':+_0x32b2fd}),_0x8d828b[_0x27e75f(0x133)](0xc8)['json']({'message':'ticket\x20deleted'});};function a36_0x3865(_0x109605,_0x50228a){const _0x3c5820=a36_0x3c58();return a36_0x3865=function(_0x386508,_0x1be1b9){_0x386508=_0x386508-0x126;let _0x32b072=_0x3c5820[_0x386508];return _0x32b072;},a36_0x3865(_0x109605,_0x50228a);}exports[a36_0x2d392b(0x154)]=remove;const closeAll=async(_0x598829,_0x172900)=>{const _0xd2e159=a36_0x2d392b,{companyId:_0x59e810}=_0x598829[_0xd2e159(0x12b)],{status:_0x5b77c9}=_0x598829[_0xd2e159(0x12f)],_0x35b51f=(0x0,socket_1[_0xd2e159(0x128)])(),{rows:_0x43ee3c}=await Ticket_1[_0xd2e159(0x127)]['findAndCountAll']({'where':{'companyId':_0x59e810,'status':_0x5b77c9},'order':[[_0xd2e159(0x14a),'DESC']]});return _0x43ee3c[_0xd2e159(0x136)](async _0x286359=>{const _0x33f433=_0xd2e159,_0x301378={'status':'closed','userId':_0x286359['userId']||null,'queueId':_0x286359['queueId']||null,'unreadMessages':0x0,'amountUsedBotQueues':0x0,'sendFarewellMessage':![]};await(0x0,UpdateTicketService_1[_0x33f433(0x127)])({'ticketData':_0x301378,'ticketId':_0x286359['id'],'companyId':_0x59e810});}),_0x172900[_0xd2e159(0x133)](0xc8)[_0xd2e159(0x131)]();};exports['closeAll']=closeAll;function a36_0x3c58(){const _0x420662=['898512EYaYWp','closeAll','../models/Ticket','show','../services/TicketServices/ListTicketsService','2172819vjbDWZ','update','query','444601SSiLxf','6875RUHLIH','index','notification','updatedAt','-ticket','parse','store','16fBDGhS','company-','access','../services/TicketServices/ShowTicketService','../services/TicketServices/ListTicketsServiceKanban','../services/TicketServices/CreateLogTicketService','remove','35260XeTreM','../services/TicketServices/UpdateTicketService','showLog','defineProperty','default','getIO','1309617IjZppO','showFromUUID','user','240ditgcB','__importDefault','../services/TicketServices/ShowTicketFromUUIDService','body','2MSDhuu','json','__esModule','status','../services/TicketServices/CreateTicketService','params','forEach','emit','981PJJNZm','66668VOPOHI','../libs/socket','../services/TicketServices/DeleteTicketService','24AItZtz','kanban'];a36_0x3c58=function(){return _0x420662;};return a36_0x3c58();}
>>>>>>> ab722bfbcf394d74dd0b99a984c0dcf6ffbcff7f
