'use strict';const a33_0x54a0b5=a33_0x5113;(function(_0x24b13d,_0x327e66){const _0x11fbb7=a33_0x5113,_0x5c63a4=_0x24b13d();while(!![]){try{const _0x5f19c0=-parseInt(_0x11fbb7(0x120))/0x1*(-parseInt(_0x11fbb7(0x103))/0x2)+-parseInt(_0x11fbb7(0x121))/0x3+-parseInt(_0x11fbb7(0x109))/0x4*(parseInt(_0x11fbb7(0x124))/0x5)+parseInt(_0x11fbb7(0x118))/0x6+parseInt(_0x11fbb7(0x102))/0x7+parseInt(_0x11fbb7(0x113))/0x8+parseInt(_0x11fbb7(0x10f))/0x9;if(_0x5f19c0===_0x327e66)break;else _0x5c63a4['push'](_0x5c63a4['shift']());}catch(_0x45a371){_0x5c63a4['push'](_0x5c63a4['shift']());}}}(a33_0x5b77,0xa64de));var __importDefault=this&&this[a33_0x54a0b5(0x11b)]||function(_0x318230){const _0x24bf96=a33_0x54a0b5;return _0x318230&&_0x318230[_0x24bf96(0x10d)]?_0x318230:{'default':_0x318230};};Object[a33_0x54a0b5(0xfe)](exports,a33_0x54a0b5(0x10d),{'value':!![]}),exports[a33_0x54a0b5(0x127)]=exports['remove']=exports[a33_0x54a0b5(0x114)]=exports['showFromUUID']=exports[a33_0x54a0b5(0x10b)]=exports[a33_0x54a0b5(0x107)]=exports[a33_0x54a0b5(0x11f)]=exports[a33_0x54a0b5(0xf6)]=void 0x0;const socket_1=require(a33_0x54a0b5(0x117)),Ticket_1=__importDefault(require(a33_0x54a0b5(0x119))),CreateTicketService_1=__importDefault(require(a33_0x54a0b5(0xfb))),DeleteTicketService_1=__importDefault(require(a33_0x54a0b5(0x112))),ListTicketsService_1=__importDefault(require(a33_0x54a0b5(0x100))),ShowTicketFromUUIDService_1=__importDefault(require(a33_0x54a0b5(0x10a))),ShowTicketService_1=__importDefault(require('../services/TicketServices/ShowTicketService')),UpdateTicketService_1=__importDefault(require(a33_0x54a0b5(0x122))),ListTicketsServiceKanban_1=__importDefault(require(a33_0x54a0b5(0x115))),index=async(_0x168a17,_0x145063)=>{const _0xfca5fd=a33_0x54a0b5,{pageNumber:_0x365739,status:_0x23fc0b,date:_0x555293,dateStart:_0x82c196,dateEnd:_0x531bfb,updatedAt:_0x335817,searchParam:_0xd8d2c4,showAll:_0x4acf91,queueIds:_0x31b68e,tags:_0xcd7bc3,users:_0x773756,withUnreadMessages:_0xc2203d,whatsapps:_0x2a275f,statusFilter:_0x502785}=_0x168a17[_0xfca5fd(0x11e)],_0x3f1e26=_0x168a17[_0xfca5fd(0xff)]['id'],{companyId:_0x444b52}=_0x168a17[_0xfca5fd(0xff)];let _0x1d36fb=[],_0x4f9f02=[],_0x4870f6=[],_0x2d58e3=[],_0x294ab2=[];_0x31b68e&&(_0x1d36fb=JSON[_0xfca5fd(0x101)](_0x31b68e));_0xcd7bc3&&(_0x4f9f02=JSON[_0xfca5fd(0x101)](_0xcd7bc3));_0x773756&&(_0x4870f6=JSON[_0xfca5fd(0x101)](_0x773756));_0x2a275f&&(_0x2d58e3=JSON[_0xfca5fd(0x101)](_0x2a275f));_0x502785&&(_0x294ab2=JSON[_0xfca5fd(0x101)](_0x502785));const {tickets:_0x239a71,count:_0x15f114,hasMore:_0x34fc50}=await(0x0,ListTicketsService_1[_0xfca5fd(0x123)])({'searchParam':_0xd8d2c4,'tags':_0x4f9f02,'users':_0x4870f6,'pageNumber':_0x365739,'status':_0x23fc0b,'date':_0x555293,'dateStart':_0x82c196,'dateEnd':_0x531bfb,'updatedAt':_0x335817,'showAll':_0x4acf91,'userId':_0x3f1e26,'queueIds':_0x1d36fb,'withUnreadMessages':_0xc2203d,'whatsappIds':_0x2d58e3,'statusFilters':_0x294ab2,'companyId':_0x444b52});return _0x145063[_0xfca5fd(0xfa)](0xc8)['json']({'tickets':_0x239a71,'count':_0x15f114,'hasMore':_0x34fc50});};exports[a33_0x54a0b5(0xf6)]=index;const kanban=async(_0x35fcf0,_0x46fe13)=>{const _0x4017b6=a33_0x54a0b5,{pageNumber:_0x1c8cda,status:_0x569a85,date:_0x62fea6,updatedAt:_0x3421e5,searchParam:_0x5349c0,showAll:_0x14d434,queueIds:_0x2fd99d,tags:_0x59eb0a,users:_0x397834,withUnreadMessages:_0x5aac74}=_0x35fcf0[_0x4017b6(0x11e)],_0x1830b1=_0x35fcf0[_0x4017b6(0xff)]['id'],{companyId:_0x4265bc}=_0x35fcf0[_0x4017b6(0xff)];let _0x4286c2=[],_0x32f6da=[],_0x58e46f=[];_0x2fd99d&&(_0x4286c2=JSON[_0x4017b6(0x101)](_0x2fd99d));_0x59eb0a&&(_0x32f6da=JSON[_0x4017b6(0x101)](_0x59eb0a));_0x397834&&(_0x58e46f=JSON[_0x4017b6(0x101)](_0x397834));const {tickets:_0x3c77f1,count:_0x254849,hasMore:_0x54bdc9}=await(0x0,ListTicketsServiceKanban_1['default'])({'searchParam':_0x5349c0,'tags':_0x32f6da,'users':_0x58e46f,'pageNumber':_0x1c8cda,'status':_0x569a85,'date':_0x62fea6,'updatedAt':_0x3421e5,'showAll':_0x14d434,'userId':_0x1830b1,'queueIds':_0x4286c2,'withUnreadMessages':_0x5aac74,'companyId':_0x4265bc});return _0x46fe13[_0x4017b6(0xfa)](0xc8)[_0x4017b6(0x10c)]({'tickets':_0x3c77f1,'count':_0x254849,'hasMore':_0x54bdc9});};exports['kanban']=kanban;const store=async(_0x28c985,_0x428a36)=>{const _0x385002=a33_0x54a0b5,{contactId:_0x24b4c9,status:_0x57d9f7,userId:_0x2144db,queueId:_0x29eb98,whatsappId:_0x433d07}=_0x28c985[_0x385002(0x11c)],{companyId:_0x352f6b}=_0x28c985[_0x385002(0xff)],_0x1d5ee5=await(0x0,CreateTicketService_1[_0x385002(0x123)])({'contactId':_0x24b4c9,'status':_0x57d9f7,'userId':_0x2144db,'companyId':_0x352f6b,'queueId':_0x29eb98,'whatsappId':_0x433d07}),_0x40d1b5=(0x0,socket_1[_0x385002(0x11a)])();return _0x40d1b5['to'](_0x1d5ee5[_0x385002(0xfa)])[_0x385002(0xfc)](_0x385002(0x10e)+_0x352f6b+_0x385002(0x11d),{'action':'update','ticket':_0x1d5ee5}),_0x428a36[_0x385002(0xfa)](0xc8)[_0x385002(0x10c)](_0x1d5ee5);};exports[a33_0x54a0b5(0x107)]=store;const show=async(_0x4eb6aa,_0x37a4c8)=>{const _0x165ced=a33_0x54a0b5,{ticketId:_0x55d86b}=_0x4eb6aa[_0x165ced(0xfd)],{companyId:_0x1dfe20}=_0x4eb6aa['user'],_0x385e97=await(0x0,ShowTicketService_1[_0x165ced(0x123)])(_0x55d86b,_0x1dfe20);return _0x37a4c8['status'](0xc8)[_0x165ced(0x10c)](_0x385e97);};exports[a33_0x54a0b5(0x10b)]=show;const showFromUUID=async(_0x342e09,_0x4dec02)=>{const _0x2b34b6=a33_0x54a0b5,{uuid:_0x388230}=_0x342e09['params'],_0x524944=await(0x0,ShowTicketFromUUIDService_1[_0x2b34b6(0x123)])(_0x388230);return _0x4dec02[_0x2b34b6(0xfa)](0xc8)[_0x2b34b6(0x10c)](_0x524944);};exports[a33_0x54a0b5(0xf8)]=showFromUUID;const update=async(_0xed6331,_0x4569a6)=>{const _0x4c1fc3=a33_0x54a0b5,{ticketId:_0xc40ed4}=_0xed6331[_0x4c1fc3(0xfd)],_0xc42e5=_0xed6331[_0x4c1fc3(0x11c)],{companyId:_0x4e5da8}=_0xed6331['user'],{ticket:_0x218f50}=await(0x0,UpdateTicketService_1['default'])({'ticketData':_0xc42e5,'ticketId':_0xc40ed4,'companyId':_0x4e5da8});return _0x4569a6[_0x4c1fc3(0xfa)](0xc8)['json'](_0x218f50);};exports['update']=update;function a33_0x5113(_0x24123b,_0x3121ca){const _0x5b7745=a33_0x5b77();return a33_0x5113=function(_0x51139d,_0x1ff17a){_0x51139d=_0x51139d-0xf6;let _0x3a6b75=_0x5b7745[_0x51139d];return _0x3a6b75;},a33_0x5113(_0x24123b,_0x3121ca);}const remove=async(_0x1aa481,_0x13e1f4)=>{const _0x32db7e=a33_0x54a0b5,{ticketId:_0x4a98be}=_0x1aa481[_0x32db7e(0xfd)],{companyId:_0x1ab2bb}=_0x1aa481['user'];await(0x0,ShowTicketService_1['default'])(_0x4a98be,_0x1ab2bb);const _0x3109c5=await(0x0,DeleteTicketService_1[_0x32db7e(0x123)])(_0x4a98be),_0x3d5b58=(0x0,socket_1[_0x32db7e(0x11a)])();return _0x3d5b58['to'](_0x3109c5['status'])['to'](_0x4a98be)['to'](_0x32db7e(0x125))['emit'](_0x32db7e(0x10e)+_0x1ab2bb+_0x32db7e(0x11d),{'action':'delete','ticketId':+_0x4a98be}),_0x13e1f4['status'](0xc8)[_0x32db7e(0x10c)]({'message':_0x32db7e(0xf9)});};exports['remove']=remove;const closeAll=async(_0x13421e,_0x4415df)=>{const _0x24699f=a33_0x54a0b5,{companyId:_0x42caad}=_0x13421e['user'],{status:_0x45a5cf}=_0x13421e[_0x24699f(0x11c)],_0x29ba08=(0x0,socket_1[_0x24699f(0x11a)])(),{rows:_0x5c5f43}=await Ticket_1['default'][_0x24699f(0x104)]({'where':{'companyId':_0x42caad,'status':_0x45a5cf,'isGroup':![]},'order':[[_0x24699f(0x110),_0x24699f(0x116)]]});return _0x5c5f43['forEach'](async _0xb17ebb=>{const _0x4f02f8=_0x24699f;await _0xb17ebb[_0x4f02f8(0x114)]({'status':_0x4f02f8(0x111),'userId':_0xb17ebb[_0x4f02f8(0x126)]||0x1,'queueId':_0xb17ebb[_0x4f02f8(0x108)]||null,'unreadMessages':0x0,'amountUsedBotQueues':0x0}),_0x29ba08['to'](_0x45a5cf)['to'](_0xb17ebb['id'][_0x4f02f8(0xf7)]())[_0x4f02f8(0xfc)](_0x4f02f8(0x10e)+_0xb17ebb[_0x4f02f8(0x106)]+_0x4f02f8(0x11d),{'action':_0x4f02f8(0x105),'ticketId':_0xb17ebb['id']});}),_0x4415df['status'](0xc8)[_0x24699f(0x10c)]();};function a33_0x5b77(){const _0x2a46f8=['notification','userId','closeAll','index','toString','showFromUUID','ticket\x20deleted','status','../services/TicketServices/CreateTicketService','emit','params','defineProperty','user','../services/TicketServices/ListTicketsService','parse','1566376ehdOkX','237764ixTeFW','findAndCountAll','delete','companyId','store','queueId','20toXyfh','../services/TicketServices/ShowTicketFromUUIDService','show','json','__esModule','company-','5688846dtGUIp','updatedAt','closed','../services/TicketServices/DeleteTicketService','5724648iUUxhx','update','../services/TicketServices/ListTicketsServiceKanban','DESC','../libs/socket','2042592XzqeiP','../models/Ticket','getIO','__importDefault','body','-ticket','query','kanban','9ZSYUok','3419178dWyLPU','../services/TicketServices/UpdateTicketService','default','1160905oPHHkh'];a33_0x5b77=function(){return _0x2a46f8;};return a33_0x5b77();}exports[a33_0x54a0b5(0x127)]=closeAll;