'use strict';const a8_0xf0c017=a8_0x4175;(function(_0x4ba985,_0x51a786){const _0x190566=a8_0x4175,_0x1e8cf6=_0x4ba985();while(!![]){try{const _0x1a4546=-parseInt(_0x190566(0xc5))/0x1*(-parseInt(_0x190566(0xca))/0x2)+-parseInt(_0x190566(0x94))/0x3+-parseInt(_0x190566(0xb3))/0x4*(parseInt(_0x190566(0xdd))/0x5)+-parseInt(_0x190566(0xcf))/0x6*(-parseInt(_0x190566(0xa4))/0x7)+parseInt(_0x190566(0x89))/0x8*(-parseInt(_0x190566(0xb9))/0x9)+parseInt(_0x190566(0x98))/0xa*(parseInt(_0x190566(0xc8))/0xb)+parseInt(_0x190566(0xe3))/0xc*(parseInt(_0x190566(0xc2))/0xd);if(_0x1a4546===_0x51a786)break;else _0x1e8cf6['push'](_0x1e8cf6['shift']());}catch(_0x23fd68){_0x1e8cf6['push'](_0x1e8cf6['shift']());}}}(a8_0x1921,0x55bc6));var __createBinding=this&&this[a8_0xf0c017(0x85)]||(Object['create']?function(_0x3f258e,_0x45ade1,_0x14df71,_0x1e1c45){const _0x42323d=a8_0xf0c017;if(_0x1e1c45===undefined)_0x1e1c45=_0x14df71;var _0xef2dc4=Object[_0x42323d(0xae)](_0x45ade1,_0x14df71);(!_0xef2dc4||('get'in _0xef2dc4?!_0x45ade1[_0x42323d(0xd9)]:_0xef2dc4[_0x42323d(0x99)]||_0xef2dc4[_0x42323d(0x96)]))&&(_0xef2dc4={'enumerable':!![],'get':function(){return _0x45ade1[_0x14df71];}}),Object[_0x42323d(0xa0)](_0x3f258e,_0x1e1c45,_0xef2dc4);}:function(_0x523e64,_0x343b3a,_0x298ad5,_0x2050f1){if(_0x2050f1===undefined)_0x2050f1=_0x298ad5;_0x523e64[_0x2050f1]=_0x343b3a[_0x298ad5];}),__setModuleDefault=this&&this[a8_0xf0c017(0xa1)]||(Object[a8_0xf0c017(0xbe)]?function(_0x2041b5,_0x44f023){Object['defineProperty'](_0x2041b5,'default',{'enumerable':!![],'value':_0x44f023});}:function(_0x2a1735,_0x536ed7){const _0x1f9c3c=a8_0xf0c017;_0x2a1735[_0x1f9c3c(0xce)]=_0x536ed7;}),__importStar=this&&this[a8_0xf0c017(0xa7)]||function(_0x427ede){const _0x292c2e=a8_0xf0c017;if(_0x427ede&&_0x427ede[_0x292c2e(0xd9)])return _0x427ede;var _0x1fc24f={};if(_0x427ede!=null){for(var _0x1e7913 in _0x427ede)if(_0x1e7913!==_0x292c2e(0xce)&&Object[_0x292c2e(0x86)][_0x292c2e(0xe9)][_0x292c2e(0xdb)](_0x427ede,_0x1e7913))__createBinding(_0x1fc24f,_0x427ede,_0x1e7913);}return __setModuleDefault(_0x1fc24f,_0x427ede),_0x1fc24f;},__importDefault=this&&this[a8_0xf0c017(0xd3)]||function(_0x594868){const _0x510f2f=a8_0xf0c017;return _0x594868&&_0x594868[_0x510f2f(0xd9)]?_0x594868:{'default':_0x594868};};Object[a8_0xf0c017(0xa0)](exports,a8_0xf0c017(0xd9),{'value':!![]}),exports[a8_0xf0c017(0x9b)]=exports[a8_0xf0c017(0xc0)]=exports['indexImage']=exports[a8_0xf0c017(0xab)]=exports['indexLink']=exports[a8_0xf0c017(0x95)]=void 0x0;const Yup=__importStar(require(a8_0xf0c017(0xcc))),AppError_1=__importDefault(require(a8_0xf0c017(0xda))),GetDefaultWhatsApp_1=__importDefault(require(a8_0xf0c017(0xba))),SetTicketMessagesAsRead_1=__importDefault(require(a8_0xf0c017(0xb8))),Whatsapp_1=__importDefault(require('../models/Whatsapp')),CreateOrUpdateContactService_1=__importDefault(require(a8_0xf0c017(0x97))),FindOrCreateTicketService_1=__importDefault(require(a8_0xf0c017(0xcd))),ShowTicketService_1=__importDefault(require('../services/TicketServices/ShowTicketService')),CheckIsValidContact_1=__importDefault(require(a8_0xf0c017(0xa9))),CheckNumber_1=__importDefault(require(a8_0xf0c017(0xd1))),GetProfilePicUrl_1=__importDefault(require(a8_0xf0c017(0xdc))),SendWhatsAppMedia_1=__importDefault(require('../services/WbotServices/SendWhatsAppMedia')),UpdateTicketService_1=__importDefault(require(a8_0xf0c017(0x91))),wbot_1=require(a8_0xf0c017(0xd5)),SendWhatsAppMessageLink_1=__importDefault(require('../services/WbotServices/SendWhatsAppMessageLink')),SendWhatsAppMessageAPI_1=__importDefault(require(a8_0xf0c017(0xe1))),SendWhatsappMediaImage_1=__importDefault(require(a8_0xf0c017(0xe2))),ApiUsages_1=__importDefault(require(a8_0xf0c017(0xc9))),useDate_1=require(a8_0xf0c017(0x8f)),moment_1=__importDefault(require(a8_0xf0c017(0xe7)));class OnWhatsAppDto{constructor(_0x5dfcfb,_0x2a585e){const _0x2c4db7=a8_0xf0c017;this[_0x2c4db7(0xe8)]=_0x5dfcfb,this[_0x2c4db7(0xb5)]=_0x2a585e;}}exports[a8_0xf0c017(0x95)]=OnWhatsAppDto;const createContact=async(_0x2e3d72,_0x2193d6,_0x4b6b08,_0x434b4c,_0x4f16ac)=>{const _0x3a0a43=a8_0xf0c017;await(0x0,CheckIsValidContact_1['default'])(_0x4b6b08,_0x2193d6);const _0x2eb957=await(0x0,CheckNumber_1[_0x3a0a43(0xce)])(_0x4b6b08,_0x2193d6),_0x408dba=await(0x0,GetProfilePicUrl_1[_0x3a0a43(0xce)])(_0x2eb957,_0x2193d6),_0x28dc10=_0x2eb957,_0x24e190={'name':''+_0x28dc10,'number':_0x28dc10,'profilePicUrl':_0x408dba,'isGroup':![],'companyId':_0x2193d6},_0x10af73=await(0x0,CreateOrUpdateContactService_1['default'])(_0x24e190);let _0x142fcd;if(_0x2e3d72===undefined)_0x142fcd=await(0x0,GetDefaultWhatsApp_1[_0x3a0a43(0xce)])(_0x2193d6);else{_0x142fcd=await Whatsapp_1[_0x3a0a43(0xce)][_0x3a0a43(0xbb)](_0x2e3d72);if(_0x142fcd===null)throw new AppError_1['default'](_0x3a0a43(0xaf)+_0x2e3d72+_0x3a0a43(0x9e));}const {ticket:_0x1d7a38,isCreated:_0x10ad33}=await(0x0,FindOrCreateTicketService_1[_0x3a0a43(0xce)])(_0x10af73,_0x142fcd['id'],0x0,_0x2193d6,_0x4f16ac,_0x434b4c),_0x4fb319=await(0x0,ShowTicketService_1[_0x3a0a43(0xce)])(_0x1d7a38['id'],_0x2193d6);return(0x0,SetTicketMessagesAsRead_1[_0x3a0a43(0xce)])(_0x4fb319),_0x4fb319;};function formatBRNumber(_0xcc8c48){const _0x32a9d6=a8_0xf0c017,_0x3202ea=new RegExp(/^(\d{2})(\d{2})\d{1}(\d{8})$/);if(_0x3202ea[_0x32a9d6(0xd7)](_0xcc8c48)){const _0x10e51d=_0x3202ea[_0x32a9d6(0xbd)](_0xcc8c48);if(_0x10e51d&&_0x10e51d[0x1]==='55'&&Number['isInteger'](Number['parseInt'](_0x10e51d[0x2]))){const _0x562fee=Number['parseInt'](_0x10e51d[0x2]);if(_0x562fee<0x1f)return _0x10e51d[0x0];else{if(_0x562fee>=0x1f)return _0x10e51d[0x1]+_0x10e51d[0x2]+_0x10e51d[0x3];}}}else return _0xcc8c48;}function createJid(_0x4dbf5c){const _0x3e5b61=a8_0xf0c017;if(_0x4dbf5c[_0x3e5b61(0xad)](_0x3e5b61(0x9c))||_0x4dbf5c[_0x3e5b61(0xad)]('@s.whatsapp.net'))return formatBRNumber(_0x4dbf5c);return _0x4dbf5c[_0x3e5b61(0xad)]('-')?_0x4dbf5c+_0x3e5b61(0x9c):formatBRNumber(_0x4dbf5c)+_0x3e5b61(0xd8);}const indexLink=async(_0x4e665b,_0x59ed36)=>{const _0x5cd8b2=a8_0xf0c017,_0x1d49b3=_0x4e665b[_0x5cd8b2(0xcb)],{whatsappId:_0x56eb8f}=_0x4e665b[_0x5cd8b2(0xcb)],{msdelay:_0x1154a4}=_0x4e665b[_0x5cd8b2(0xcb)],_0x2c2bfd=_0x4e665b[_0x5cd8b2(0xcb)][_0x5cd8b2(0xd0)],_0x358116=_0x4e665b[_0x5cd8b2(0xcb)][_0x5cd8b2(0xd4)],_0x46e27a=_0x4e665b[_0x5cd8b2(0xa8)]['authorization'],[,_0x18bf99]=_0x46e27a[_0x5cd8b2(0x8e)]('\x20'),_0x35e0f2=await Whatsapp_1[_0x5cd8b2(0xce)][_0x5cd8b2(0xbf)]({'where':{'token':_0x18bf99}}),_0x8a7599=_0x35e0f2[_0x5cd8b2(0xb4)];_0x1d49b3[_0x5cd8b2(0xdf)]=_0x1d49b3[_0x5cd8b2(0xdf)][_0x5cd8b2(0xb0)]('-','')['replace']('\x20','');const _0x3c10a0=Yup[_0x5cd8b2(0xc1)]()[_0x5cd8b2(0x8b)]({'number':Yup['string']()['required']()[_0x5cd8b2(0xa5)](/^\d+$/,'Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.')});try{await _0x3c10a0[_0x5cd8b2(0xe4)](_0x1d49b3);}catch(_0x161a16){throw new AppError_1[(_0x5cd8b2(0xce))](_0x161a16[_0x5cd8b2(0xc3)]);}const _0x516402=await createContact(_0x56eb8f,_0x8a7599,_0x1d49b3[_0x5cd8b2(0xdf)]);return await(0x0,SendWhatsAppMessageLink_1[_0x5cd8b2(0xce)])({'whatsappId':_0x56eb8f,'contact':_0x516402[_0x5cd8b2(0x8c)],'url':_0x2c2bfd,'caption':_0x358116,'msdelay':_0x1154a4}),setTimeout(async()=>{const _0x168e2c=_0x5cd8b2,{dateToClient:_0x10ffbc}=(0x0,useDate_1[_0x168e2c(0x8a)])(),_0x3dbbf5=_0x10ffbc(new Date()),_0x5d4377=(0x0,moment_1[_0x168e2c(0xce)])()[_0x168e2c(0xe6)](),_0x5e8c3b=await ApiUsages_1[_0x168e2c(0xce)][_0x168e2c(0xbf)]({'where':{'dateUsed':_0x3dbbf5,'companyId':_0x8a7599}});if(_0x5e8c3b)await _0x5e8c3b[_0x168e2c(0xb7)]({'usedPDF':_0x5e8c3b[_0x168e2c(0xa3)]['usedPDF']+0x1,'UsedOnDay':_0x5e8c3b['dataValues'][_0x168e2c(0x9a)]+0x1,'updatedAt':_0x5d4377});else{const _0xafb219=await ApiUsages_1['default'][_0x168e2c(0xbe)]({'companyId':_0x8a7599,'dateUsed':_0x3dbbf5});await _0xafb219[_0x168e2c(0xb7)]({'usedPDF':_0xafb219['dataValues'][_0x168e2c(0xbc)]+0x1,'UsedOnDay':_0xafb219[_0x168e2c(0xa3)][_0x168e2c(0x9a)]+0x1,'updatedAt':_0x5d4377});}},0x64),_0x59ed36[_0x5cd8b2(0xb1)]({'status':'SUCCESS'});};exports['indexLink']=indexLink;const index=async(_0x36f2a0,_0x27f622)=>{const _0x10c9e7=a8_0xf0c017,_0x2190c7=_0x36f2a0[_0x10c9e7(0xcb)],{whatsappId:_0x219499}=_0x36f2a0['body'],{msdelay:_0x141d21}=_0x36f2a0[_0x10c9e7(0xcb)],{body:_0x4bc0cc,quotedMsg:_0x45230d,userId:_0x266c64,queueId:_0xe35f86}=_0x36f2a0['body'],_0x1b7479=_0x36f2a0['files'],_0xcf6777=_0x36f2a0[_0x10c9e7(0xa8)][_0x10c9e7(0xc6)],[,_0x2fd6a6]=_0xcf6777['split']('\x20'),_0xab85b6=await Whatsapp_1['default'][_0x10c9e7(0xbf)]({'where':{'token':_0x2fd6a6}}),_0x21843d=_0xab85b6[_0x10c9e7(0xb4)];_0x2190c7[_0x10c9e7(0xdf)]=_0x2190c7[_0x10c9e7(0xdf)][_0x10c9e7(0xb0)]('-','')[_0x10c9e7(0xb0)]('\x20','');const _0x54933c=Yup[_0x10c9e7(0xc1)]()[_0x10c9e7(0x8b)]({'number':Yup[_0x10c9e7(0xe5)]()['required']()[_0x10c9e7(0xa5)](/^\d+$/,_0x10c9e7(0xb6))});try{await _0x54933c[_0x10c9e7(0xe4)](_0x2190c7);}catch(_0x47bd4a){throw new AppError_1[(_0x10c9e7(0xce))](_0x47bd4a['message']);}const _0x58ab79=await createContact(_0xab85b6['id'],_0x21843d,_0x2190c7[_0x10c9e7(0xdf)],_0x266c64,_0xe35f86);return console[_0x10c9e7(0x88)](_0x58ab79),_0x1b7479?await Promise['all'](_0x1b7479[_0x10c9e7(0x8d)](async _0x33dab0=>{const _0x18e3e6=_0x10c9e7;await(0x0,SendWhatsAppMedia_1[_0x18e3e6(0xce)])({'body':_0x4bc0cc,'media':_0x33dab0,'ticket':_0x58ab79});})):await(0x0,SendWhatsAppMessageAPI_1[_0x10c9e7(0xce)])({'body':_0x4bc0cc,'whatsappId':_0xab85b6['id'],'contact':_0x58ab79[_0x10c9e7(0x8c)],'quotedMsg':_0x45230d,'msdelay':_0x141d21}),setTimeout(async()=>{const _0x5032be=_0x10c9e7,{dateToClient:_0x10ab85}=(0x0,useDate_1[_0x5032be(0x8a)])(),_0x575edc=_0x10ab85(new Date()),_0x57ed66=(0x0,moment_1[_0x5032be(0xce)])()[_0x5032be(0xe6)]();let _0x4896a9=await ApiUsages_1[_0x5032be(0xce)][_0x5032be(0xbf)]({'where':{'dateUsed':_0x575edc,'companyId':_0x21843d}});_0x4896a9?_0x1b7479?await Promise[_0x5032be(0x9f)](_0x1b7479[_0x5032be(0x8d)](async _0x1bf991=>{const _0x2c5508=_0x5032be;if(_0x1bf991[_0x2c5508(0xe0)]['includes']('pdf'))await _0x4896a9[_0x2c5508(0xb7)]({'usedPDF':_0x4896a9[_0x2c5508(0xa3)][_0x2c5508(0xbc)]+0x1,'UsedOnDay':_0x4896a9[_0x2c5508(0xa3)]['UsedOnDay']+0x1,'updatedAt':_0x57ed66});else{if(_0x1bf991[_0x2c5508(0xe0)][_0x2c5508(0xad)]('image'))await _0x4896a9['update']({'usedImage':_0x4896a9[_0x2c5508(0xa3)][_0x2c5508(0xd6)]+0x1,'UsedOnDay':_0x4896a9['dataValues'][_0x2c5508(0x9a)]+0x1,'updatedAt':_0x57ed66});else _0x1bf991[_0x2c5508(0xe0)][_0x2c5508(0xad)](_0x2c5508(0xa2))?await _0x4896a9[_0x2c5508(0xb7)]({'usedVideo':_0x4896a9[_0x2c5508(0xa3)]['usedVideo']+0x1,'UsedOnDay':_0x4896a9['dataValues'][_0x2c5508(0x9a)]+0x1,'updatedAt':_0x57ed66}):await _0x4896a9[_0x2c5508(0xb7)]({'usedOther':_0x4896a9[_0x2c5508(0xa3)][_0x2c5508(0x87)]+0x1,'UsedOnDay':_0x4896a9[_0x2c5508(0xa3)][_0x2c5508(0x9a)]+0x1,'updatedAt':_0x57ed66});}})):await _0x4896a9[_0x5032be(0xb7)]({'usedText':_0x4896a9[_0x5032be(0xa3)][_0x5032be(0x93)]+0x1,'UsedOnDay':_0x4896a9['dataValues'][_0x5032be(0x9a)]+0x1,'updatedAt':_0x57ed66}):(_0x4896a9=await ApiUsages_1[_0x5032be(0xce)][_0x5032be(0xbe)]({'companyId':_0x21843d,'dateUsed':_0x575edc}),_0x1b7479?await Promise[_0x5032be(0x9f)](_0x1b7479['map'](async _0x3c565b=>{const _0xbff63b=_0x5032be;if(_0x3c565b['mimetype'][_0xbff63b(0xad)]('pdf'))await _0x4896a9[_0xbff63b(0xb7)]({'usedPDF':_0x4896a9['dataValues'][_0xbff63b(0xbc)]+0x1,'UsedOnDay':_0x4896a9[_0xbff63b(0xa3)][_0xbff63b(0x9a)]+0x1,'updatedAt':_0x57ed66});else{if(_0x3c565b[_0xbff63b(0xe0)]['includes'](_0xbff63b(0xd2)))await _0x4896a9[_0xbff63b(0xb7)]({'usedImage':_0x4896a9[_0xbff63b(0xa3)][_0xbff63b(0xd6)]+0x1,'UsedOnDay':_0x4896a9[_0xbff63b(0xa3)][_0xbff63b(0x9a)]+0x1,'updatedAt':_0x57ed66});else _0x3c565b['mimetype'][_0xbff63b(0xad)]('video')?await _0x4896a9[_0xbff63b(0xb7)]({'usedVideo':_0x4896a9[_0xbff63b(0xa3)]['usedVideo']+0x1,'UsedOnDay':_0x4896a9[_0xbff63b(0xa3)]['UsedOnDay']+0x1,'updatedAt':_0x57ed66}):await _0x4896a9[_0xbff63b(0xb7)]({'usedOther':_0x4896a9[_0xbff63b(0xa3)][_0xbff63b(0x87)]+0x1,'UsedOnDay':_0x4896a9[_0xbff63b(0xa3)][_0xbff63b(0x9a)]+0x1,'updatedAt':_0x57ed66});}})):await _0x4896a9['update']({'usedText':_0x4896a9['dataValues'][_0x5032be(0x93)]+0x1,'UsedOnDay':_0x4896a9[_0x5032be(0xa3)][_0x5032be(0x9a)]+0x1,'updatedAt':_0x57ed66}));},0x64),_0x27f622[_0x10c9e7(0xb1)]({'status':_0x10c9e7(0xde)});};exports[a8_0xf0c017(0xab)]=index;const indexImage=async(_0x567034,_0xb11e8a)=>{const _0x117881=a8_0xf0c017,_0x2c960a=_0x567034[_0x117881(0xcb)],{whatsappId:_0x15ba07}=_0x567034['body'],{msdelay:_0x46a6fa}=_0x567034[_0x117881(0xcb)],_0x1684c5=_0x567034[_0x117881(0xcb)][_0x117881(0xd0)],_0xf6d13b=_0x567034[_0x117881(0xcb)][_0x117881(0xd4)],_0xe7431c=_0x567034[_0x117881(0xa8)][_0x117881(0xc6)],[,_0x1d4e97]=_0xe7431c[_0x117881(0x8e)]('\x20'),_0x1908cf=await Whatsapp_1['default'][_0x117881(0xbf)]({'where':{'token':_0x1d4e97}}),_0x74966b=_0x1908cf[_0x117881(0xb4)];_0x2c960a[_0x117881(0xdf)]=_0x2c960a[_0x117881(0xdf)]['replace']('-','')[_0x117881(0xb0)]('\x20','');const _0x404be1=Yup[_0x117881(0xc1)]()['shape']({'number':Yup['string']()[_0x117881(0x90)]()[_0x117881(0xa5)](/^\d+$/,_0x117881(0xb6))});try{await _0x404be1[_0x117881(0xe4)](_0x2c960a);}catch(_0x231277){throw new AppError_1['default'](_0x231277[_0x117881(0xc3)]);}const _0x2f518b=await createContact(_0x15ba07,_0x74966b,_0x2c960a[_0x117881(0xdf)]);return _0x1684c5&&await(0x0,SendWhatsappMediaImage_1['default'])({'ticket':_0x2f518b,'url':_0x1684c5,'caption':_0xf6d13b,'msdelay':_0x46a6fa}),setTimeout(async()=>{const _0x26f06c=_0x117881;await(0x0,UpdateTicketService_1[_0x26f06c(0xce)])({'ticketId':_0x2f518b['id'],'ticketData':{'status':_0x26f06c(0xa6),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x74966b});},0x64),setTimeout(async()=>{const _0x15c8e4=_0x117881,{dateToClient:_0x4180ba}=(0x0,useDate_1[_0x15c8e4(0x8a)])(),_0x194ba6=_0x4180ba(new Date()),_0x290857=(0x0,moment_1['default'])()[_0x15c8e4(0xe6)](),_0xc43ad=await ApiUsages_1[_0x15c8e4(0xce)]['findOne']({'where':{'dateUsed':_0x194ba6,'companyId':_0x74966b}});if(_0xc43ad)await _0xc43ad['update']({'usedImage':_0xc43ad[_0x15c8e4(0xa3)][_0x15c8e4(0xd6)]+0x1,'UsedOnDay':_0xc43ad['dataValues'][_0x15c8e4(0x9a)]+0x1,'updatedAt':_0x290857});else{const _0xf76f3d=await ApiUsages_1['default'][_0x15c8e4(0xbe)]({'companyId':_0x74966b,'dateUsed':_0x194ba6});await _0xf76f3d[_0x15c8e4(0xb7)]({'usedImage':_0xf76f3d[_0x15c8e4(0xa3)][_0x15c8e4(0xd6)]+0x1,'UsedOnDay':_0xf76f3d[_0x15c8e4(0xa3)][_0x15c8e4(0x9a)]+0x1,'updatedAt':_0x290857});}},0x64),_0xb11e8a[_0x117881(0xb1)]({'status':'SUCCESS'});};exports[a8_0xf0c017(0xc4)]=indexImage;const checkNumber=async(_0x574679,_0x13bf7a)=>{const _0x55de3e=a8_0xf0c017,_0x259fe4=_0x574679[_0x55de3e(0xcb)],_0x56c4bc=_0x574679[_0x55de3e(0xa8)][_0x55de3e(0xc6)],[,_0x2710dc]=_0x56c4bc[_0x55de3e(0x8e)]('\x20'),_0x5ce3d3=await Whatsapp_1[_0x55de3e(0xce)][_0x55de3e(0xbf)]({'where':{'token':_0x2710dc}}),_0x3c96b1=_0x5ce3d3[_0x55de3e(0xb4)],_0x4de5aa=_0x259fe4[_0x55de3e(0xdf)][_0x55de3e(0xb0)]('-','')[_0x55de3e(0xb0)]('\x20',''),_0x2439f1=await(0x0,GetDefaultWhatsApp_1['default'])(_0x3c96b1),_0x3dc258=(0x0,wbot_1[_0x55de3e(0x92)])(_0x2439f1['id']),_0x55dfc3=createJid(_0x4de5aa);try{const [_0x5ecc94]=await _0x3dc258[_0x55de3e(0xaa)](_0x55dfc3);if(_0x5ecc94['exists'])return setTimeout(async()=>{const _0x53df68=_0x55de3e,{dateToClient:_0x257491}=(0x0,useDate_1[_0x53df68(0x8a)])(),_0x5b0ee5=_0x257491(new Date()),_0x3b6ccc=(0x0,moment_1[_0x53df68(0xce)])()[_0x53df68(0xe6)](),_0x57977f=await ApiUsages_1['default'][_0x53df68(0xbf)]({'where':{'dateUsed':_0x5b0ee5,'companyId':_0x3c96b1}});if(_0x57977f)await _0x57977f[_0x53df68(0xb7)]({'usedCheckNumber':_0x57977f[_0x53df68(0xa3)][_0x53df68(0xac)]+0x1,'UsedOnDay':_0x57977f['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x3b6ccc});else{const _0x127747=await ApiUsages_1[_0x53df68(0xce)][_0x53df68(0xbe)]({'companyId':_0x3c96b1,'dateUsed':_0x5b0ee5});await _0x127747[_0x53df68(0xb7)]({'usedCheckNumber':_0x127747[_0x53df68(0xa3)]['usedCheckNumber']+0x1,'UsedOnDay':_0x127747['dataValues'][_0x53df68(0x9a)]+0x1,'updatedAt':_0x3b6ccc});}},0x64),_0x13bf7a['status'](0xc8)[_0x55de3e(0xb2)]({'existsInWhatsapp':!![],'number':_0x4de5aa,'numberFormatted':_0x5ecc94[_0x55de3e(0xe8)]});}catch(_0xb14701){return _0x13bf7a['status'](0x190)[_0x55de3e(0xb2)]({'existsInWhatsapp':![],'number':_0x55dfc3,'error':_0x55de3e(0x9d)});}};exports[a8_0xf0c017(0xc0)]=checkNumber;function a8_0x4175(_0x27811d,_0x1fb98e){const _0x1921e1=a8_0x1921();return a8_0x4175=function(_0x4175b0,_0x2b7ee0){_0x4175b0=_0x4175b0-0x85;let _0x406b38=_0x1921e1[_0x4175b0];return _0x406b38;},a8_0x4175(_0x27811d,_0x1fb98e);}const indexWhatsappsId=async(_0x1a192d,_0x1be06d)=>{const _0x103216=a8_0xf0c017;return console['log']('req',_0x1a192d),console[_0x103216(0x88)](_0x103216(0xc7),_0x1a192d['user']),_0x1be06d['status'](0xc8)['json']('oi');};exports[a8_0xf0c017(0x9b)]=indexWhatsappsId;function a8_0x1921(){const _0x5948f6=['indexWhatsappsId','@g.us','Not\x20exists\x20on\x20Whatsapp','\x20not\x20found','all','defineProperty','__setModuleDefault','video','dataValues','92827uwlPIT','matches','closed','__importStar','headers','../services/WbotServices/CheckIsValidContact','onWhatsApp','index','usedCheckNumber','includes','getOwnPropertyDescriptor','whatsapp\x20#','replace','send','json','39436WVoJiZ','companyId','exists','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','update','../helpers/SetTicketMessagesAsRead','2086011beiHOg','../helpers/GetDefaultWhatsApp','findByPk','usedPDF','exec','create','findOne','checkNumber','object','13lSSIyS','message','indexImage','27haODfE','authorization','req','11YEsTxM','../models/ApiUsages','818JRPUUG','body','yup','../services/TicketServices/FindOrCreateTicketService','default','138VnUaWs','url','../services/WbotServices/CheckNumber','image','__importDefault','caption','../libs/wbot','usedImage','test','@s.whatsapp.net','__esModule','../errors/AppError','call','../services/WbotServices/GetProfilePicUrl','75amdlYi','SUCCESS','number','mimetype','../services/WbotServices/SendWhatsAppMessageAPI','../services/WbotServices/SendWhatsappMediaImage','2732604SwKnhX','validate','string','format','moment','jid','hasOwnProperty','__createBinding','prototype','usedOther','log','8vFwYuN','useDate','shape','contact','map','split','../utils/useDate','required','../services/TicketServices/UpdateTicketService','getWbot','usedText','954738sbzhHC','OnWhatsAppDto','configurable','../services/ContactServices/CreateOrUpdateContactService','5053210WTefbq','writable','UsedOnDay'];a8_0x1921=function(){return _0x5948f6;};return a8_0x1921();}