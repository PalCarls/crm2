'use strict';const a8_0x1ec30b=a8_0x5f9c;(function(_0x4a610a,_0x475485){const _0x1678b9=a8_0x5f9c,_0x253e9a=_0x4a610a();while(!![]){try{const _0x166dc2=-parseInt(_0x1678b9(0xba))/0x1*(parseInt(_0x1678b9(0x9c))/0x2)+parseInt(_0x1678b9(0xc1))/0x3+parseInt(_0x1678b9(0xaa))/0x4*(parseInt(_0x1678b9(0xa6))/0x5)+parseInt(_0x1678b9(0x92))/0x6+parseInt(_0x1678b9(0x96))/0x7+parseInt(_0x1678b9(0xb7))/0x8+-parseInt(_0x1678b9(0x70))/0x9*(parseInt(_0x1678b9(0xbf))/0xa);if(_0x166dc2===_0x475485)break;else _0x253e9a['push'](_0x253e9a['shift']());}catch(_0xd4f0fb){_0x253e9a['push'](_0x253e9a['shift']());}}}(a8_0x28e3,0x61f82));var __createBinding=this&&this['__createBinding']||(Object[a8_0x1ec30b(0x8f)]?function(_0xd07b7c,_0x124e10,_0x3bf8ae,_0x38358c){const _0x2cf269=a8_0x1ec30b;if(_0x38358c===undefined)_0x38358c=_0x3bf8ae;var _0x364b1c=Object['getOwnPropertyDescriptor'](_0x124e10,_0x3bf8ae);(!_0x364b1c||(_0x2cf269(0x77)in _0x364b1c?!_0x124e10[_0x2cf269(0x9e)]:_0x364b1c[_0x2cf269(0xa0)]||_0x364b1c[_0x2cf269(0x95)]))&&(_0x364b1c={'enumerable':!![],'get':function(){return _0x124e10[_0x3bf8ae];}}),Object[_0x2cf269(0x88)](_0xd07b7c,_0x38358c,_0x364b1c);}:function(_0x533a65,_0x2fddad,_0x1740d0,_0x533a79){if(_0x533a79===undefined)_0x533a79=_0x1740d0;_0x533a65[_0x533a79]=_0x2fddad[_0x1740d0];}),__setModuleDefault=this&&this[a8_0x1ec30b(0x81)]||(Object[a8_0x1ec30b(0x8f)]?function(_0x3c98d8,_0x182fb6){const _0x166fce=a8_0x1ec30b;Object[_0x166fce(0x88)](_0x3c98d8,_0x166fce(0xb5),{'enumerable':!![],'value':_0x182fb6});}:function(_0x48c240,_0x432e15){const _0x50c5b6=a8_0x1ec30b;_0x48c240[_0x50c5b6(0xb5)]=_0x432e15;}),__importStar=this&&this[a8_0x1ec30b(0xbb)]||function(_0x3213bb){const _0x4ef7d4=a8_0x1ec30b;if(_0x3213bb&&_0x3213bb[_0x4ef7d4(0x9e)])return _0x3213bb;var _0x345459={};if(_0x3213bb!=null){for(var _0x4a4354 in _0x3213bb)if(_0x4a4354!==_0x4ef7d4(0xb5)&&Object[_0x4ef7d4(0xb6)][_0x4ef7d4(0x97)][_0x4ef7d4(0xa3)](_0x3213bb,_0x4a4354))__createBinding(_0x345459,_0x3213bb,_0x4a4354);}return __setModuleDefault(_0x345459,_0x3213bb),_0x345459;},__importDefault=this&&this[a8_0x1ec30b(0x78)]||function(_0x4a1b37){return _0x4a1b37&&_0x4a1b37['__esModule']?_0x4a1b37:{'default':_0x4a1b37};};Object['defineProperty'](exports,a8_0x1ec30b(0x9e),{'value':!![]}),exports[a8_0x1ec30b(0xce)]=exports[a8_0x1ec30b(0x6b)]=exports[a8_0x1ec30b(0xca)]=exports[a8_0x1ec30b(0x7c)]=exports[a8_0x1ec30b(0x9d)]=exports[a8_0x1ec30b(0x7a)]=void 0x0;const Yup=__importStar(require(a8_0x1ec30b(0xbc))),AppError_1=__importDefault(require(a8_0x1ec30b(0xa1))),GetDefaultWhatsApp_1=__importDefault(require(a8_0x1ec30b(0x90))),SetTicketMessagesAsRead_1=__importDefault(require('../helpers/SetTicketMessagesAsRead')),Whatsapp_1=__importDefault(require('../models/Whatsapp')),CreateOrUpdateContactService_1=__importDefault(require(a8_0x1ec30b(0x6c))),FindOrCreateTicketService_1=__importDefault(require('../services/TicketServices/FindOrCreateTicketService')),ShowTicketService_1=__importDefault(require(a8_0x1ec30b(0xc2))),CheckIsValidContact_1=__importDefault(require(a8_0x1ec30b(0x6f))),CheckNumber_1=__importDefault(require(a8_0x1ec30b(0x93))),GetProfilePicUrl_1=__importDefault(require('../services/WbotServices/GetProfilePicUrl')),SendWhatsAppMedia_1=__importDefault(require(a8_0x1ec30b(0xa7))),UpdateTicketService_1=__importDefault(require(a8_0x1ec30b(0xa4))),wbot_1=require(a8_0x1ec30b(0xae)),SendWhatsAppMessageLink_1=__importDefault(require(a8_0x1ec30b(0xb1))),SendWhatsAppMessageAPI_1=__importDefault(require(a8_0x1ec30b(0xac))),SendWhatsappMediaImage_1=__importDefault(require(a8_0x1ec30b(0x6e))),ApiUsages_1=__importDefault(require(a8_0x1ec30b(0x99))),useDate_1=require(a8_0x1ec30b(0xb4)),moment_1=__importDefault(require(a8_0x1ec30b(0x7d))),ListSettingsService_1=__importDefault(require(a8_0x1ec30b(0xc6)));class OnWhatsAppDto{constructor(_0x4838d9,_0x9528b2){const _0x4ceacc=a8_0x1ec30b;this[_0x4ceacc(0x91)]=_0x4838d9,this[_0x4ceacc(0x84)]=_0x9528b2;}}exports['OnWhatsAppDto']=OnWhatsAppDto;const createContact=async(_0x1f39fa,_0x2459b3,_0x244bd1,_0x3dc719,_0x539358)=>{const _0x5c8bfd=a8_0x1ec30b;await(0x0,CheckIsValidContact_1[_0x5c8bfd(0xb5)])(_0x244bd1,_0x2459b3);const _0x41d10c=await(0x0,CheckNumber_1[_0x5c8bfd(0xb5)])(_0x244bd1,_0x2459b3),_0x4c4040=await(0x0,GetProfilePicUrl_1[_0x5c8bfd(0xb5)])(_0x41d10c,_0x2459b3),_0x2e7ea7=await(0x0,ListSettingsService_1[_0x5c8bfd(0xb5)])({'companyId':_0x2459b3}),_0x1c2c46=_0x41d10c,_0x53a356={'name':''+_0x1c2c46,'number':_0x1c2c46,'profilePicUrl':_0x4c4040,'isGroup':![],'companyId':_0x2459b3},_0x41c883=await(0x0,CreateOrUpdateContactService_1['default'])(_0x53a356);let _0x43a04d;if(_0x1f39fa===undefined)_0x43a04d=await(0x0,GetDefaultWhatsApp_1['default'])(_0x2459b3);else{_0x43a04d=await Whatsapp_1[_0x5c8bfd(0xb5)][_0x5c8bfd(0x82)](_0x1f39fa);if(_0x43a04d===null)throw new AppError_1[(_0x5c8bfd(0xb5))](_0x5c8bfd(0x85)+_0x1f39fa+_0x5c8bfd(0x75));}const {ticket:_0x2fac31,isCreated:_0x4d76a2}=await(0x0,FindOrCreateTicketService_1[_0x5c8bfd(0xb5)])(_0x41c883,_0x43a04d,0x0,_0x2459b3,_0x539358,_0x3dc719,null,_0x5c8bfd(0x74),null,![],_0x2e7ea7),_0x1b848c=await(0x0,ShowTicketService_1[_0x5c8bfd(0xb5)])(_0x2fac31['id'],_0x2459b3);return(0x0,SetTicketMessagesAsRead_1[_0x5c8bfd(0xb5)])(_0x1b848c),_0x1b848c;};function formatBRNumber(_0x5bb8fc){const _0x10a002=a8_0x1ec30b,_0x262590=new RegExp(/^(\d{2})(\d{2})\d{1}(\d{8})$/);if(_0x262590[_0x10a002(0xb0)](_0x5bb8fc)){const _0x1fce9b=_0x262590[_0x10a002(0xad)](_0x5bb8fc);if(_0x1fce9b&&_0x1fce9b[0x1]==='55'&&Number[_0x10a002(0x89)](Number[_0x10a002(0xbe)](_0x1fce9b[0x2]))){const _0x56c1c1=Number['parseInt'](_0x1fce9b[0x2]);if(_0x56c1c1<0x1f)return _0x1fce9b[0x0];else{if(_0x56c1c1>=0x1f)return _0x1fce9b[0x1]+_0x1fce9b[0x2]+_0x1fce9b[0x3];}}}else return _0x5bb8fc;}function createJid(_0x13fce8){const _0xdeacb3=a8_0x1ec30b;if(_0x13fce8[_0xdeacb3(0x8a)](_0xdeacb3(0xcb))||_0x13fce8[_0xdeacb3(0x8a)]('@s.whatsapp.net'))return formatBRNumber(_0x13fce8);return _0x13fce8[_0xdeacb3(0x8a)]('-')?_0x13fce8+'@g.us':formatBRNumber(_0x13fce8)+'@s.whatsapp.net';}function a8_0x28e3(){const _0x177465=['3145704hqioFG','../services/WbotServices/CheckNumber','body','configurable','1379714hHuCvm','hasOwnProperty','send','../models/ApiUsages','contact','files','2nrqYYV','indexLink','__esModule','usedImage','writable','../errors/AppError','object','call','../services/TicketServices/UpdateTicketService','caption','10XOfDYM','../services/WbotServices/SendWhatsAppMedia','usedText','message','447816GKfwDG','req','../services/WbotServices/SendWhatsAppMessageAPI','exec','../libs/wbot','pdf','test','../services/WbotServices/SendWhatsAppMessageLink','format','string','../utils/useDate','default','prototype','5454944fcpSXx','required','matches','268154WPIRzw','__importStar','yup','log','parseInt','90XUXlIi','shape','1940760fFdSUi','../services/TicketServices/ShowTicketService','video','json','UsedOnDay','../services/SettingServices/ListSettingsService','useDate','findOne','headers','indexImage','@g.us','image','replace','indexWhatsappsId','number','mimetype','update','onWhatsApp','usedOther','checkNumber','../services/ContactServices/CreateOrUpdateContactService','all','../services/WbotServices/SendWhatsappMediaImage','../services/WbotServices/CheckIsValidContact','1604646aLAdgP','status','authorization','usedVideo','whatsapp','\x20not\x20found','usedCheckNumber','get','__importDefault','validate','OnWhatsAppDto','map','index','moment','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','SUCCESS','getWbot','__setModuleDefault','findByPk','usedPDF','exists','whatsapp\x20#','split','user','defineProperty','isInteger','includes','companyId','Not\x20exists\x20on\x20Whatsapp','url','dataValues','create','../helpers/GetDefaultWhatsApp','jid'];a8_0x28e3=function(){return _0x177465;};return a8_0x28e3();}const indexLink=async(_0x48c20f,_0x230110)=>{const _0x2a8772=a8_0x1ec30b,_0x525dd6=_0x48c20f[_0x2a8772(0x94)],{whatsappId:_0xe1b1b0}=_0x48c20f[_0x2a8772(0x94)],{msdelay:_0x1a545c}=_0x48c20f[_0x2a8772(0x94)],_0x253ae2=_0x48c20f[_0x2a8772(0x94)][_0x2a8772(0x8d)],_0x28a8a4=_0x48c20f[_0x2a8772(0x94)]['caption'],_0x1cd577=_0x48c20f[_0x2a8772(0xc9)]['authorization'],[,_0x5c2872]=_0x1cd577['split']('\x20'),_0xf707db=await Whatsapp_1['default'][_0x2a8772(0xc8)]({'where':{'token':_0x5c2872}}),_0x689fe1=_0xf707db['companyId'];_0x525dd6[_0x2a8772(0xcf)]=_0x525dd6[_0x2a8772(0xcf)][_0x2a8772(0xcd)]('-','')[_0x2a8772(0xcd)]('\x20','');const _0x42cc44=Yup[_0x2a8772(0xa2)]()['shape']({'number':Yup[_0x2a8772(0xb3)]()[_0x2a8772(0xb8)]()['matches'](/^\d+$/,_0x2a8772(0x7e))});try{await _0x42cc44[_0x2a8772(0x79)](_0x525dd6);}catch(_0x53e478){throw new AppError_1['default'](_0x53e478[_0x2a8772(0xa9)]);}const _0x5097f4=await createContact(_0xe1b1b0,_0x689fe1,_0x525dd6[_0x2a8772(0xcf)]);return await(0x0,SendWhatsAppMessageLink_1[_0x2a8772(0xb5)])({'whatsappId':_0xe1b1b0,'contact':_0x5097f4[_0x2a8772(0x9a)],'url':_0x253ae2,'caption':_0x28a8a4,'msdelay':_0x1a545c}),setTimeout(async()=>{const _0x593097=_0x2a8772,{dateToClient:_0x459a36}=(0x0,useDate_1[_0x593097(0xc7)])(),_0xc4eb4=_0x459a36(new Date()),_0x3374ff=(0x0,moment_1['default'])()[_0x593097(0xb2)](),_0x5a1168=await ApiUsages_1[_0x593097(0xb5)][_0x593097(0xc8)]({'where':{'dateUsed':_0xc4eb4,'companyId':_0x689fe1}});if(_0x5a1168)await _0x5a1168[_0x593097(0x68)]({'usedPDF':_0x5a1168[_0x593097(0x8e)]['usedPDF']+0x1,'UsedOnDay':_0x5a1168['dataValues'][_0x593097(0xc5)]+0x1,'updatedAt':_0x3374ff});else{const _0xefb590=await ApiUsages_1['default'][_0x593097(0x8f)]({'companyId':_0x689fe1,'dateUsed':_0xc4eb4});await _0xefb590['update']({'usedPDF':_0xefb590[_0x593097(0x8e)][_0x593097(0x83)]+0x1,'UsedOnDay':_0xefb590[_0x593097(0x8e)][_0x593097(0xc5)]+0x1,'updatedAt':_0x3374ff});}},0x64),_0x230110['send']({'status':_0x2a8772(0x7f)});};exports[a8_0x1ec30b(0x9d)]=indexLink;const index=async(_0x4b7089,_0x10ccc2)=>{const _0x22ab6a=a8_0x1ec30b,_0x1f9b86=_0x4b7089[_0x22ab6a(0x94)],{whatsappId:_0x215cab}=_0x4b7089['body'],{msdelay:_0x24552e}=_0x4b7089['body'],{body:_0x178336,quotedMsg:_0x41595a,userId:_0x18a88c,queueId:_0x3801bc}=_0x4b7089[_0x22ab6a(0x94)],_0x31ed0b=_0x4b7089[_0x22ab6a(0x9b)],_0x3849df=_0x4b7089['headers'][_0x22ab6a(0x72)],[,_0x1d3253]=_0x3849df[_0x22ab6a(0x86)]('\x20'),_0x283c1d=await Whatsapp_1[_0x22ab6a(0xb5)][_0x22ab6a(0xc8)]({'where':{'token':_0x1d3253}}),_0x126f0f=_0x283c1d[_0x22ab6a(0x8b)];_0x1f9b86[_0x22ab6a(0xcf)]=_0x1f9b86[_0x22ab6a(0xcf)][_0x22ab6a(0xcd)]('-','')[_0x22ab6a(0xcd)]('\x20','');const _0x420b86=Yup[_0x22ab6a(0xa2)]()[_0x22ab6a(0xc0)]({'number':Yup[_0x22ab6a(0xb3)]()[_0x22ab6a(0xb8)]()[_0x22ab6a(0xb9)](/^\d+$/,_0x22ab6a(0x7e))});try{await _0x420b86[_0x22ab6a(0x79)](_0x1f9b86);}catch(_0x117655){throw new AppError_1[(_0x22ab6a(0xb5))](_0x117655[_0x22ab6a(0xa9)]);}const _0x35f482=await createContact(_0x283c1d['id'],_0x126f0f,_0x1f9b86['number'],_0x18a88c,_0x3801bc);return _0x31ed0b?await Promise[_0x22ab6a(0x6d)](_0x31ed0b[_0x22ab6a(0x7b)](async _0x1f55cd=>{await(0x0,SendWhatsAppMedia_1['default'])({'body':_0x178336,'media':_0x1f55cd,'ticket':_0x35f482});})):await(0x0,SendWhatsAppMessageAPI_1[_0x22ab6a(0xb5)])({'body':_0x178336,'whatsappId':_0x283c1d['id'],'contact':_0x35f482[_0x22ab6a(0x9a)],'quotedMsg':_0x41595a,'msdelay':_0x24552e}),setTimeout(async()=>{const _0x450880=_0x22ab6a,{dateToClient:_0x22fdb5}=(0x0,useDate_1[_0x450880(0xc7)])(),_0x47a4aa=_0x22fdb5(new Date()),_0xbe65cf=(0x0,moment_1['default'])()[_0x450880(0xb2)]();let _0x5bdc5d=await ApiUsages_1[_0x450880(0xb5)][_0x450880(0xc8)]({'where':{'dateUsed':_0x47a4aa,'companyId':_0x126f0f}});_0x5bdc5d?_0x31ed0b?await Promise['all'](_0x31ed0b['map'](async _0x58d03d=>{const _0x5301f7=_0x450880;if(_0x58d03d[_0x5301f7(0x67)][_0x5301f7(0x8a)](_0x5301f7(0xaf)))await _0x5bdc5d[_0x5301f7(0x68)]({'usedPDF':_0x5bdc5d[_0x5301f7(0x8e)][_0x5301f7(0x83)]+0x1,'UsedOnDay':_0x5bdc5d[_0x5301f7(0x8e)]['UsedOnDay']+0x1,'updatedAt':_0xbe65cf});else{if(_0x58d03d[_0x5301f7(0x67)][_0x5301f7(0x8a)](_0x5301f7(0xcc)))await _0x5bdc5d[_0x5301f7(0x68)]({'usedImage':_0x5bdc5d['dataValues'][_0x5301f7(0x9f)]+0x1,'UsedOnDay':_0x5bdc5d[_0x5301f7(0x8e)][_0x5301f7(0xc5)]+0x1,'updatedAt':_0xbe65cf});else _0x58d03d[_0x5301f7(0x67)][_0x5301f7(0x8a)](_0x5301f7(0xc3))?await _0x5bdc5d[_0x5301f7(0x68)]({'usedVideo':_0x5bdc5d[_0x5301f7(0x8e)][_0x5301f7(0x73)]+0x1,'UsedOnDay':_0x5bdc5d[_0x5301f7(0x8e)][_0x5301f7(0xc5)]+0x1,'updatedAt':_0xbe65cf}):await _0x5bdc5d[_0x5301f7(0x68)]({'usedOther':_0x5bdc5d['dataValues'][_0x5301f7(0x6a)]+0x1,'UsedOnDay':_0x5bdc5d[_0x5301f7(0x8e)][_0x5301f7(0xc5)]+0x1,'updatedAt':_0xbe65cf});}})):await _0x5bdc5d['update']({'usedText':_0x5bdc5d[_0x450880(0x8e)][_0x450880(0xa8)]+0x1,'UsedOnDay':_0x5bdc5d[_0x450880(0x8e)][_0x450880(0xc5)]+0x1,'updatedAt':_0xbe65cf}):(_0x5bdc5d=await ApiUsages_1[_0x450880(0xb5)][_0x450880(0x8f)]({'companyId':_0x126f0f,'dateUsed':_0x47a4aa}),_0x31ed0b?await Promise[_0x450880(0x6d)](_0x31ed0b[_0x450880(0x7b)](async _0x5ec532=>{const _0x142885=_0x450880;if(_0x5ec532[_0x142885(0x67)][_0x142885(0x8a)](_0x142885(0xaf)))await _0x5bdc5d['update']({'usedPDF':_0x5bdc5d[_0x142885(0x8e)][_0x142885(0x83)]+0x1,'UsedOnDay':_0x5bdc5d[_0x142885(0x8e)]['UsedOnDay']+0x1,'updatedAt':_0xbe65cf});else{if(_0x5ec532[_0x142885(0x67)][_0x142885(0x8a)](_0x142885(0xcc)))await _0x5bdc5d[_0x142885(0x68)]({'usedImage':_0x5bdc5d[_0x142885(0x8e)][_0x142885(0x9f)]+0x1,'UsedOnDay':_0x5bdc5d['dataValues'][_0x142885(0xc5)]+0x1,'updatedAt':_0xbe65cf});else _0x5ec532[_0x142885(0x67)][_0x142885(0x8a)]('video')?await _0x5bdc5d[_0x142885(0x68)]({'usedVideo':_0x5bdc5d[_0x142885(0x8e)]['usedVideo']+0x1,'UsedOnDay':_0x5bdc5d[_0x142885(0x8e)][_0x142885(0xc5)]+0x1,'updatedAt':_0xbe65cf}):await _0x5bdc5d[_0x142885(0x68)]({'usedOther':_0x5bdc5d[_0x142885(0x8e)]['usedOther']+0x1,'UsedOnDay':_0x5bdc5d[_0x142885(0x8e)][_0x142885(0xc5)]+0x1,'updatedAt':_0xbe65cf});}})):await _0x5bdc5d[_0x450880(0x68)]({'usedText':_0x5bdc5d[_0x450880(0x8e)]['usedText']+0x1,'UsedOnDay':_0x5bdc5d['dataValues'][_0x450880(0xc5)]+0x1,'updatedAt':_0xbe65cf}));},0x64),_0x10ccc2[_0x22ab6a(0x98)]({'status':_0x22ab6a(0x7f)});};exports[a8_0x1ec30b(0x7c)]=index;const indexImage=async(_0x396c74,_0x3f4942)=>{const _0x40c995=a8_0x1ec30b,_0x177da8=_0x396c74['body'],{whatsappId:_0x47c7d7}=_0x396c74['body'],{msdelay:_0x52e85f}=_0x396c74[_0x40c995(0x94)],_0x5dfe72=_0x396c74[_0x40c995(0x94)][_0x40c995(0x8d)],_0x542877=_0x396c74[_0x40c995(0x94)][_0x40c995(0xa5)],_0x161f61=_0x396c74[_0x40c995(0xc9)][_0x40c995(0x72)],[,_0x29f389]=_0x161f61[_0x40c995(0x86)]('\x20'),_0x21cc3d=await Whatsapp_1[_0x40c995(0xb5)][_0x40c995(0xc8)]({'where':{'token':_0x29f389}}),_0x4ef5df=_0x21cc3d[_0x40c995(0x8b)];_0x177da8[_0x40c995(0xcf)]=_0x177da8[_0x40c995(0xcf)]['replace']('-','')[_0x40c995(0xcd)]('\x20','');const _0x410d9f=Yup[_0x40c995(0xa2)]()[_0x40c995(0xc0)]({'number':Yup[_0x40c995(0xb3)]()[_0x40c995(0xb8)]()[_0x40c995(0xb9)](/^\d+$/,_0x40c995(0x7e))});try{await _0x410d9f[_0x40c995(0x79)](_0x177da8);}catch(_0x119bf2){throw new AppError_1['default'](_0x119bf2[_0x40c995(0xa9)]);}const _0x4388a5=await createContact(_0x47c7d7,_0x4ef5df,_0x177da8['number']);return _0x5dfe72&&await(0x0,SendWhatsappMediaImage_1[_0x40c995(0xb5)])({'ticket':_0x4388a5,'url':_0x5dfe72,'caption':_0x542877,'msdelay':_0x52e85f}),setTimeout(async()=>{await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x4388a5['id'],'ticketData':{'status':'closed','sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x4ef5df});},0x64),setTimeout(async()=>{const _0x40343a=_0x40c995,{dateToClient:_0x326d9b}=(0x0,useDate_1[_0x40343a(0xc7)])(),_0xbb21e=_0x326d9b(new Date()),_0x445f73=(0x0,moment_1[_0x40343a(0xb5)])()['format'](),_0x2deeda=await ApiUsages_1[_0x40343a(0xb5)][_0x40343a(0xc8)]({'where':{'dateUsed':_0xbb21e,'companyId':_0x4ef5df}});if(_0x2deeda)await _0x2deeda[_0x40343a(0x68)]({'usedImage':_0x2deeda[_0x40343a(0x8e)][_0x40343a(0x9f)]+0x1,'UsedOnDay':_0x2deeda[_0x40343a(0x8e)][_0x40343a(0xc5)]+0x1,'updatedAt':_0x445f73});else{const _0x43bad2=await ApiUsages_1[_0x40343a(0xb5)][_0x40343a(0x8f)]({'companyId':_0x4ef5df,'dateUsed':_0xbb21e});await _0x43bad2[_0x40343a(0x68)]({'usedImage':_0x43bad2['dataValues'][_0x40343a(0x9f)]+0x1,'UsedOnDay':_0x43bad2[_0x40343a(0x8e)][_0x40343a(0xc5)]+0x1,'updatedAt':_0x445f73});}},0x64),_0x3f4942['send']({'status':'SUCCESS'});};exports['indexImage']=indexImage;const checkNumber=async(_0x9c8fd3,_0x5d36c4)=>{const _0x46a600=a8_0x1ec30b,_0x17dfca=_0x9c8fd3['body'],_0x19be6f=_0x9c8fd3[_0x46a600(0xc9)][_0x46a600(0x72)],[,_0x144659]=_0x19be6f['split']('\x20'),_0x27e296=await Whatsapp_1[_0x46a600(0xb5)][_0x46a600(0xc8)]({'where':{'token':_0x144659}}),_0x143acf=_0x27e296[_0x46a600(0x8b)],_0x13c8e1=_0x17dfca['number'][_0x46a600(0xcd)]('-','')[_0x46a600(0xcd)]('\x20',''),_0x46ccf0=await(0x0,GetDefaultWhatsApp_1['default'])(_0x143acf),_0x3a6bfb=(0x0,wbot_1[_0x46a600(0x80)])(_0x46ccf0['id']),_0x30c0a4=createJid(_0x13c8e1);try{const [_0x40abbd]=await _0x3a6bfb[_0x46a600(0x69)](_0x30c0a4);if(_0x40abbd[_0x46a600(0x84)])return setTimeout(async()=>{const _0x34a82a=_0x46a600,{dateToClient:_0x348002}=(0x0,useDate_1[_0x34a82a(0xc7)])(),_0x2a136d=_0x348002(new Date()),_0x231cc8=(0x0,moment_1[_0x34a82a(0xb5)])()['format'](),_0x585643=await ApiUsages_1[_0x34a82a(0xb5)][_0x34a82a(0xc8)]({'where':{'dateUsed':_0x2a136d,'companyId':_0x143acf}});if(_0x585643)await _0x585643[_0x34a82a(0x68)]({'usedCheckNumber':_0x585643[_0x34a82a(0x8e)][_0x34a82a(0x76)]+0x1,'UsedOnDay':_0x585643[_0x34a82a(0x8e)][_0x34a82a(0xc5)]+0x1,'updatedAt':_0x231cc8});else{const _0x20adde=await ApiUsages_1[_0x34a82a(0xb5)]['create']({'companyId':_0x143acf,'dateUsed':_0x2a136d});await _0x20adde[_0x34a82a(0x68)]({'usedCheckNumber':_0x20adde[_0x34a82a(0x8e)][_0x34a82a(0x76)]+0x1,'UsedOnDay':_0x20adde[_0x34a82a(0x8e)][_0x34a82a(0xc5)]+0x1,'updatedAt':_0x231cc8});}},0x64),_0x5d36c4[_0x46a600(0x71)](0xc8)['json']({'existsInWhatsapp':!![],'number':_0x13c8e1,'numberFormatted':_0x40abbd[_0x46a600(0x91)]});}catch(_0x253159){return _0x5d36c4['status'](0x190)['json']({'existsInWhatsapp':![],'number':_0x30c0a4,'error':_0x46a600(0x8c)});}};exports[a8_0x1ec30b(0x6b)]=checkNumber;const indexWhatsappsId=async(_0x2cc673,_0x3b4ce5)=>{const _0x5cd8b5=a8_0x1ec30b;return console[_0x5cd8b5(0xbd)](_0x5cd8b5(0xab),_0x2cc673),console[_0x5cd8b5(0xbd)](_0x5cd8b5(0xab),_0x2cc673[_0x5cd8b5(0x87)]),_0x3b4ce5[_0x5cd8b5(0x71)](0xc8)[_0x5cd8b5(0xc4)]('oi');};function a8_0x5f9c(_0x2270b1,_0x308c1a){const _0x28e3c7=a8_0x28e3();return a8_0x5f9c=function(_0x5f9c67,_0x2a6c31){_0x5f9c67=_0x5f9c67-0x67;let _0x58c3c6=_0x28e3c7[_0x5f9c67];return _0x58c3c6;},a8_0x5f9c(_0x2270b1,_0x308c1a);}exports[a8_0x1ec30b(0xce)]=indexWhatsappsId;