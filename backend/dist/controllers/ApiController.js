'use strict';const a8_0x5d7d91=a8_0x7b82;(function(_0x59fa65,_0x4c4115){const _0x1a2724=a8_0x7b82,_0x13ab71=_0x59fa65();while(!![]){try{const _0x3ae6f7=-parseInt(_0x1a2724(0x20f))/0x1*(-parseInt(_0x1a2724(0x1e0))/0x2)+parseInt(_0x1a2724(0x21e))/0x3*(-parseInt(_0x1a2724(0x1d9))/0x4)+parseInt(_0x1a2724(0x211))/0x5+parseInt(_0x1a2724(0x1ee))/0x6*(-parseInt(_0x1a2724(0x1e9))/0x7)+parseInt(_0x1a2724(0x209))/0x8+parseInt(_0x1a2724(0x224))/0x9*(parseInt(_0x1a2724(0x200))/0xa)+parseInt(_0x1a2724(0x1e6))/0xb*(-parseInt(_0x1a2724(0x216))/0xc);if(_0x3ae6f7===_0x4c4115)break;else _0x13ab71['push'](_0x13ab71['shift']());}catch(_0x4634d1){_0x13ab71['push'](_0x13ab71['shift']());}}}(a8_0x1371,0x98526));var __createBinding=this&&this[a8_0x5d7d91(0x201)]||(Object['create']?function(_0x333d50,_0x43c516,_0x59213f,_0x2f6342){const _0x49338b=a8_0x5d7d91;if(_0x2f6342===undefined)_0x2f6342=_0x59213f;var _0xff643a=Object[_0x49338b(0x20b)](_0x43c516,_0x59213f);(!_0xff643a||('get'in _0xff643a?!_0x43c516[_0x49338b(0x22c)]:_0xff643a['writable']||_0xff643a[_0x49338b(0x20e)]))&&(_0xff643a={'enumerable':!![],'get':function(){return _0x43c516[_0x59213f];}}),Object[_0x49338b(0x1e8)](_0x333d50,_0x2f6342,_0xff643a);}:function(_0x12219e,_0x3899e3,_0xf6cd10,_0x4b7bf3){if(_0x4b7bf3===undefined)_0x4b7bf3=_0xf6cd10;_0x12219e[_0x4b7bf3]=_0x3899e3[_0xf6cd10];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x3afa9a,_0x2c4cbd){const _0x564dfd=a8_0x5d7d91;Object[_0x564dfd(0x1e8)](_0x3afa9a,_0x564dfd(0x1fd),{'enumerable':!![],'value':_0x2c4cbd});}:function(_0xd515e3,_0x3501ea){const _0x533dd8=a8_0x5d7d91;_0xd515e3[_0x533dd8(0x1fd)]=_0x3501ea;}),__importStar=this&&this[a8_0x5d7d91(0x20d)]||function(_0x3db561){const _0x2fa91c=a8_0x5d7d91;if(_0x3db561&&_0x3db561[_0x2fa91c(0x22c)])return _0x3db561;var _0x23ff40={};if(_0x3db561!=null){for(var _0x547f19 in _0x3db561)if(_0x547f19!==_0x2fa91c(0x1fd)&&Object[_0x2fa91c(0x1e1)][_0x2fa91c(0x225)][_0x2fa91c(0x232)](_0x3db561,_0x547f19))__createBinding(_0x23ff40,_0x3db561,_0x547f19);}return __setModuleDefault(_0x23ff40,_0x3db561),_0x23ff40;},__importDefault=this&&this[a8_0x5d7d91(0x21f)]||function(_0x5b040){const _0x29acac=a8_0x5d7d91;return _0x5b040&&_0x5b040[_0x29acac(0x22c)]?_0x5b040:{'default':_0x5b040};};Object['defineProperty'](exports,a8_0x5d7d91(0x22c),{'value':!![]}),exports[a8_0x5d7d91(0x1cc)]=exports[a8_0x5d7d91(0x1fc)]=exports[a8_0x5d7d91(0x1f3)]=exports[a8_0x5d7d91(0x1fe)]=exports['indexLink']=exports[a8_0x5d7d91(0x21b)]=void 0x0;const Yup=__importStar(require(a8_0x5d7d91(0x1e5))),AppError_1=__importDefault(require(a8_0x5d7d91(0x1dc))),GetDefaultWhatsApp_1=__importDefault(require(a8_0x5d7d91(0x1ea))),SetTicketMessagesAsRead_1=__importDefault(require(a8_0x5d7d91(0x22f))),Whatsapp_1=__importDefault(require(a8_0x5d7d91(0x1f5))),CreateOrUpdateContactService_1=__importDefault(require('../services/ContactServices/CreateOrUpdateContactService')),FindOrCreateTicketService_1=__importDefault(require(a8_0x5d7d91(0x1f4))),ShowTicketService_1=__importDefault(require('../services/TicketServices/ShowTicketService')),CheckIsValidContact_1=__importDefault(require(a8_0x5d7d91(0x217))),CheckNumber_1=__importDefault(require(a8_0x5d7d91(0x21d))),GetProfilePicUrl_1=__importDefault(require(a8_0x5d7d91(0x22b))),SendWhatsAppMedia_1=__importDefault(require(a8_0x5d7d91(0x1ed))),UpdateTicketService_1=__importDefault(require(a8_0x5d7d91(0x1d2))),wbot_1=require(a8_0x5d7d91(0x21a)),SendWhatsAppMessageLink_1=__importDefault(require(a8_0x5d7d91(0x22d))),SendWhatsAppMessageAPI_1=__importDefault(require(a8_0x5d7d91(0x1cf))),SendWhatsappMediaImage_1=__importDefault(require(a8_0x5d7d91(0x230))),ApiUsages_1=__importDefault(require(a8_0x5d7d91(0x1d3))),useDate_1=require(a8_0x5d7d91(0x205)),moment_1=__importDefault(require(a8_0x5d7d91(0x1f1))),CompaniesSettings_1=__importDefault(require('../models/CompaniesSettings'));class OnWhatsAppDto{constructor(_0x2bce98,_0xb9875a){const _0x2bc8b6=a8_0x5d7d91;this[_0x2bc8b6(0x234)]=_0x2bce98,this[_0x2bc8b6(0x202)]=_0xb9875a;}}exports[a8_0x5d7d91(0x21b)]=OnWhatsAppDto;const createContact=async(_0x260c47,_0x42087e,_0x1a522a,_0x18172d,_0x377130)=>{const _0x3ea567=a8_0x5d7d91;await(0x0,CheckIsValidContact_1[_0x3ea567(0x1fd)])(_0x1a522a,_0x42087e);const _0xb36222=await(0x0,CheckNumber_1[_0x3ea567(0x1fd)])(_0x1a522a,_0x42087e),_0x57de28=await(0x0,GetProfilePicUrl_1[_0x3ea567(0x1fd)])(_0xb36222,_0x42087e),_0xfca86=_0xb36222,_0x5993be={'name':''+_0xfca86,'number':_0xfca86,'profilePicUrl':_0x57de28,'isGroup':![],'companyId':_0x42087e},_0x3d2153=await(0x0,CreateOrUpdateContactService_1[_0x3ea567(0x1fd)])(_0x5993be),_0x32d635=await CompaniesSettings_1[_0x3ea567(0x1fd)]['findOne']({'where':{'companyId':_0x42087e}});let _0x31465b;if(_0x260c47===undefined)_0x31465b=await(0x0,GetDefaultWhatsApp_1[_0x3ea567(0x1fd)])(_0x42087e);else{_0x31465b=await Whatsapp_1[_0x3ea567(0x1fd)][_0x3ea567(0x229)](_0x260c47);if(_0x31465b===null)throw new AppError_1[(_0x3ea567(0x1fd))](_0x3ea567(0x1d5)+_0x260c47+_0x3ea567(0x233));}const {ticket:_0x4a3868,isCreated:_0x1d9827}=await(0x0,FindOrCreateTicketService_1[_0x3ea567(0x1fd)])(_0x3d2153,_0x31465b,0x0,_0x42087e,_0x377130,_0x18172d,null,_0x3ea567(0x206),null,![],_0x32d635),_0x51aa33=await(0x0,ShowTicketService_1[_0x3ea567(0x1fd)])(_0x4a3868['id'],_0x42087e);return(0x0,SetTicketMessagesAsRead_1['default'])(_0x51aa33),_0x51aa33;};function formatBRNumber(_0xe76403){const _0x6056b9=a8_0x5d7d91,_0x5c4781=new RegExp(/^(\d{2})(\d{2})\d{1}(\d{8})$/);if(_0x5c4781[_0x6056b9(0x1df)](_0xe76403)){const _0xb45df3=_0x5c4781[_0x6056b9(0x223)](_0xe76403);if(_0xb45df3&&_0xb45df3[0x1]==='55'&&Number[_0x6056b9(0x212)](Number[_0x6056b9(0x231)](_0xb45df3[0x2]))){const _0x4c02ff=Number['parseInt'](_0xb45df3[0x2]);if(_0x4c02ff<0x1f)return _0xb45df3[0x0];else{if(_0x4c02ff>=0x1f)return _0xb45df3[0x1]+_0xb45df3[0x2]+_0xb45df3[0x3];}}}else return _0xe76403;}function a8_0x7b82(_0x5b16d4,_0x16154f){const _0x137164=a8_0x1371();return a8_0x7b82=function(_0x7b8245,_0x21359d){_0x7b8245=_0x7b8245-0x1cc;let _0x45ff46=_0x137164[_0x7b8245];return _0x45ff46;},a8_0x7b82(_0x5b16d4,_0x16154f);}function createJid(_0x1f7809){const _0x3cb0cb=a8_0x5d7d91;if(_0x1f7809[_0x3cb0cb(0x218)]('@g.us')||_0x1f7809[_0x3cb0cb(0x218)]('@s.whatsapp.net'))return formatBRNumber(_0x1f7809);return _0x1f7809[_0x3cb0cb(0x218)]('-')?_0x1f7809+_0x3cb0cb(0x1dd):formatBRNumber(_0x1f7809)+_0x3cb0cb(0x1ec);}const indexLink=async(_0x3fab34,_0x1e3a9d)=>{const _0x2b4848=a8_0x5d7d91,_0x2c1f6d=_0x3fab34[_0x2b4848(0x1e3)],{whatsappId:_0x54416b}=_0x3fab34['body'],{msdelay:_0x3eb09a}=_0x3fab34[_0x2b4848(0x1e3)],_0x2abfb2=_0x3fab34[_0x2b4848(0x1e3)]['url'],_0x599c2e=_0x3fab34[_0x2b4848(0x1e3)][_0x2b4848(0x1eb)],_0x1175c3=_0x3fab34[_0x2b4848(0x1f6)][_0x2b4848(0x1ce)],[,_0x2d0e40]=_0x1175c3['split']('\x20'),_0x41e56a=await Whatsapp_1[_0x2b4848(0x1fd)][_0x2b4848(0x215)]({'where':{'token':_0x2d0e40}}),_0x236b3e=_0x41e56a['companyId'];_0x2c1f6d[_0x2b4848(0x20a)]=_0x2c1f6d[_0x2b4848(0x20a)]['replace']('-','')[_0x2b4848(0x1d8)]('\x20','');const _0x2f8458=Yup[_0x2b4848(0x210)]()[_0x2b4848(0x1f2)]({'number':Yup[_0x2b4848(0x222)]()['required']()[_0x2b4848(0x1da)](/^\d+$/,_0x2b4848(0x213))});try{await _0x2f8458[_0x2b4848(0x204)](_0x2c1f6d);}catch(_0x48bee6){throw new AppError_1[(_0x2b4848(0x1fd))](_0x48bee6[_0x2b4848(0x203)]);}const _0x4c1951=await createContact(_0x54416b,_0x236b3e,_0x2c1f6d[_0x2b4848(0x20a)]);return await(0x0,SendWhatsAppMessageLink_1['default'])({'whatsappId':_0x54416b,'contact':_0x4c1951[_0x2b4848(0x1f8)],'url':_0x2abfb2,'caption':_0x599c2e,'msdelay':_0x3eb09a}),setTimeout(async()=>{const _0xb034f9=_0x2b4848,{dateToClient:_0x4a677c}=(0x0,useDate_1[_0xb034f9(0x1fb)])(),_0x454b4b=_0x4a677c(new Date()),_0x5a7342=(0x0,moment_1[_0xb034f9(0x1fd)])()[_0xb034f9(0x1f9)](),_0x1fc149=await ApiUsages_1[_0xb034f9(0x1fd)][_0xb034f9(0x215)]({'where':{'dateUsed':_0x454b4b,'companyId':_0x236b3e}});if(_0x1fc149)await _0x1fc149[_0xb034f9(0x1ff)]({'usedPDF':_0x1fc149[_0xb034f9(0x22e)][_0xb034f9(0x208)]+0x1,'UsedOnDay':_0x1fc149[_0xb034f9(0x22e)][_0xb034f9(0x226)]+0x1,'updatedAt':_0x5a7342});else{const _0x49d91c=await ApiUsages_1[_0xb034f9(0x1fd)][_0xb034f9(0x1e2)]({'companyId':_0x236b3e,'dateUsed':_0x454b4b});await _0x49d91c['update']({'usedPDF':_0x49d91c[_0xb034f9(0x22e)][_0xb034f9(0x208)]+0x1,'UsedOnDay':_0x49d91c[_0xb034f9(0x22e)]['UsedOnDay']+0x1,'updatedAt':_0x5a7342});}},0x64),_0x1e3a9d[_0x2b4848(0x220)]({'status':_0x2b4848(0x1d6)});};exports[a8_0x5d7d91(0x1d1)]=indexLink;const index=async(_0xccced9,_0x168cde)=>{const _0x4f1eb8=a8_0x5d7d91,_0x154337=_0xccced9[_0x4f1eb8(0x1e3)],{whatsappId:_0x496d0c}=_0xccced9['body'],{msdelay:_0xda1ba7}=_0xccced9[_0x4f1eb8(0x1e3)],{body:_0x3d2fa7,quotedMsg:_0x3ca45b,userId:_0x1c68c1,queueId:_0xd40f2b}=_0xccced9['body'],_0x3056e5=_0xccced9['files'],_0x31ed6f=_0xccced9['headers'][_0x4f1eb8(0x1ce)],[,_0x292fca]=_0x31ed6f[_0x4f1eb8(0x227)]('\x20'),_0x278b15=await Whatsapp_1[_0x4f1eb8(0x1fd)][_0x4f1eb8(0x215)]({'where':{'token':_0x292fca}}),_0xd370a9=_0x278b15[_0x4f1eb8(0x1f7)];_0x154337['number']=_0x154337['number'][_0x4f1eb8(0x1d8)]('-','')[_0x4f1eb8(0x1d8)]('\x20','');const _0x3f80f2=Yup['object']()['shape']({'number':Yup[_0x4f1eb8(0x222)]()[_0x4f1eb8(0x1fa)]()[_0x4f1eb8(0x1da)](/^\d+$/,_0x4f1eb8(0x213))});try{await _0x3f80f2[_0x4f1eb8(0x204)](_0x154337);}catch(_0x2b4682){throw new AppError_1['default'](_0x2b4682[_0x4f1eb8(0x203)]);}const _0x63fac5=await createContact(_0x278b15['id'],_0xd370a9,_0x154337[_0x4f1eb8(0x20a)],_0x1c68c1,_0xd40f2b);return _0x3056e5?await Promise[_0x4f1eb8(0x1f0)](_0x3056e5[_0x4f1eb8(0x1db)](async _0x52ceeb=>{const _0x469b2d=_0x4f1eb8;await(0x0,SendWhatsAppMedia_1[_0x469b2d(0x1fd)])({'body':_0x3d2fa7,'media':_0x52ceeb,'ticket':_0x63fac5,'isForwarded':![]});})):await(0x0,SendWhatsAppMessageAPI_1['default'])({'body':_0x3d2fa7,'whatsappId':_0x278b15['id'],'contact':_0x63fac5[_0x4f1eb8(0x1f8)],'quotedMsg':_0x3ca45b,'msdelay':_0xda1ba7}),setTimeout(async()=>{const _0x5f101a=_0x4f1eb8,{dateToClient:_0x5c0799}=(0x0,useDate_1[_0x5f101a(0x1fb)])(),_0x31bcd4=_0x5c0799(new Date()),_0x18a8ea=(0x0,moment_1['default'])()[_0x5f101a(0x1f9)]();let _0xe356ce=await ApiUsages_1['default'][_0x5f101a(0x215)]({'where':{'dateUsed':_0x31bcd4,'companyId':_0xd370a9}});_0xe356ce?_0x3056e5?await Promise['all'](_0x3056e5[_0x5f101a(0x1db)](async _0x5b3767=>{const _0x5af96f=_0x5f101a;if(_0x5b3767[_0x5af96f(0x228)][_0x5af96f(0x218)]('pdf'))await _0xe356ce['update']({'usedPDF':_0xe356ce['dataValues'][_0x5af96f(0x208)]+0x1,'UsedOnDay':_0xe356ce['dataValues'][_0x5af96f(0x226)]+0x1,'updatedAt':_0x18a8ea});else{if(_0x5b3767[_0x5af96f(0x228)][_0x5af96f(0x218)]('image'))await _0xe356ce['update']({'usedImage':_0xe356ce['dataValues'][_0x5af96f(0x22a)]+0x1,'UsedOnDay':_0xe356ce[_0x5af96f(0x22e)][_0x5af96f(0x226)]+0x1,'updatedAt':_0x18a8ea});else _0x5b3767[_0x5af96f(0x228)][_0x5af96f(0x218)](_0x5af96f(0x207))?await _0xe356ce[_0x5af96f(0x1ff)]({'usedVideo':_0xe356ce[_0x5af96f(0x22e)][_0x5af96f(0x1cd)]+0x1,'UsedOnDay':_0xe356ce['dataValues'][_0x5af96f(0x226)]+0x1,'updatedAt':_0x18a8ea}):await _0xe356ce[_0x5af96f(0x1ff)]({'usedOther':_0xe356ce['dataValues'][_0x5af96f(0x1e7)]+0x1,'UsedOnDay':_0xe356ce[_0x5af96f(0x22e)][_0x5af96f(0x226)]+0x1,'updatedAt':_0x18a8ea});}})):await _0xe356ce[_0x5f101a(0x1ff)]({'usedText':_0xe356ce[_0x5f101a(0x22e)][_0x5f101a(0x1e4)]+0x1,'UsedOnDay':_0xe356ce[_0x5f101a(0x22e)][_0x5f101a(0x226)]+0x1,'updatedAt':_0x18a8ea}):(_0xe356ce=await ApiUsages_1[_0x5f101a(0x1fd)][_0x5f101a(0x1e2)]({'companyId':_0xd370a9,'dateUsed':_0x31bcd4}),_0x3056e5?await Promise['all'](_0x3056e5['map'](async _0xf0f111=>{const _0x4afd32=_0x5f101a;if(_0xf0f111['mimetype'][_0x4afd32(0x218)]('pdf'))await _0xe356ce[_0x4afd32(0x1ff)]({'usedPDF':_0xe356ce[_0x4afd32(0x22e)][_0x4afd32(0x208)]+0x1,'UsedOnDay':_0xe356ce[_0x4afd32(0x22e)][_0x4afd32(0x226)]+0x1,'updatedAt':_0x18a8ea});else{if(_0xf0f111[_0x4afd32(0x228)][_0x4afd32(0x218)](_0x4afd32(0x1ef)))await _0xe356ce[_0x4afd32(0x1ff)]({'usedImage':_0xe356ce[_0x4afd32(0x22e)][_0x4afd32(0x22a)]+0x1,'UsedOnDay':_0xe356ce[_0x4afd32(0x22e)][_0x4afd32(0x226)]+0x1,'updatedAt':_0x18a8ea});else _0xf0f111[_0x4afd32(0x228)]['includes'](_0x4afd32(0x207))?await _0xe356ce[_0x4afd32(0x1ff)]({'usedVideo':_0xe356ce[_0x4afd32(0x22e)][_0x4afd32(0x1cd)]+0x1,'UsedOnDay':_0xe356ce[_0x4afd32(0x22e)][_0x4afd32(0x226)]+0x1,'updatedAt':_0x18a8ea}):await _0xe356ce[_0x4afd32(0x1ff)]({'usedOther':_0xe356ce['dataValues'][_0x4afd32(0x1e7)]+0x1,'UsedOnDay':_0xe356ce[_0x4afd32(0x22e)][_0x4afd32(0x226)]+0x1,'updatedAt':_0x18a8ea});}})):await _0xe356ce[_0x5f101a(0x1ff)]({'usedText':_0xe356ce['dataValues'][_0x5f101a(0x1e4)]+0x1,'UsedOnDay':_0xe356ce[_0x5f101a(0x22e)]['UsedOnDay']+0x1,'updatedAt':_0x18a8ea}));},0x64),_0x168cde[_0x4f1eb8(0x220)]({'status':_0x4f1eb8(0x1d6)});};exports[a8_0x5d7d91(0x1fe)]=index;const indexImage=async(_0x57f091,_0x404a82)=>{const _0x5011b0=a8_0x5d7d91,_0x369f88=_0x57f091['body'],{whatsappId:_0x1dea79}=_0x57f091[_0x5011b0(0x1e3)],{msdelay:_0x29a494}=_0x57f091[_0x5011b0(0x1e3)],_0x218aa8=_0x57f091[_0x5011b0(0x1e3)][_0x5011b0(0x1d0)],_0x30532b=_0x57f091[_0x5011b0(0x1e3)]['caption'],_0x4e0438=_0x57f091[_0x5011b0(0x1f6)]['authorization'],[,_0x305122]=_0x4e0438['split']('\x20'),_0x20013a=await Whatsapp_1[_0x5011b0(0x1fd)][_0x5011b0(0x215)]({'where':{'token':_0x305122}}),_0x1de1af=_0x20013a[_0x5011b0(0x1f7)];_0x369f88[_0x5011b0(0x20a)]=_0x369f88[_0x5011b0(0x20a)][_0x5011b0(0x1d8)]('-','')[_0x5011b0(0x1d8)]('\x20','');const _0x2fc3af=Yup[_0x5011b0(0x210)]()['shape']({'number':Yup[_0x5011b0(0x222)]()[_0x5011b0(0x1fa)]()['matches'](/^\d+$/,_0x5011b0(0x213))});try{await _0x2fc3af[_0x5011b0(0x204)](_0x369f88);}catch(_0x22c1ec){throw new AppError_1[(_0x5011b0(0x1fd))](_0x22c1ec[_0x5011b0(0x203)]);}const _0x2cb915=await createContact(_0x1dea79,_0x1de1af,_0x369f88[_0x5011b0(0x20a)]);return _0x218aa8&&await(0x0,SendWhatsappMediaImage_1[_0x5011b0(0x1fd)])({'ticket':_0x2cb915,'url':_0x218aa8,'caption':_0x30532b,'msdelay':_0x29a494}),setTimeout(async()=>{const _0x413c27=_0x5011b0;await(0x0,UpdateTicketService_1[_0x413c27(0x1fd)])({'ticketId':_0x2cb915['id'],'ticketData':{'status':_0x413c27(0x214),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x1de1af});},0x64),setTimeout(async()=>{const _0x1cba3d=_0x5011b0,{dateToClient:_0x5589c6}=(0x0,useDate_1[_0x1cba3d(0x1fb)])(),_0x679242=_0x5589c6(new Date()),_0x695091=(0x0,moment_1[_0x1cba3d(0x1fd)])()[_0x1cba3d(0x1f9)](),_0x41671a=await ApiUsages_1['default'][_0x1cba3d(0x215)]({'where':{'dateUsed':_0x679242,'companyId':_0x1de1af}});if(_0x41671a)await _0x41671a[_0x1cba3d(0x1ff)]({'usedImage':_0x41671a[_0x1cba3d(0x22e)][_0x1cba3d(0x22a)]+0x1,'UsedOnDay':_0x41671a[_0x1cba3d(0x22e)]['UsedOnDay']+0x1,'updatedAt':_0x695091});else{const _0x126b2b=await ApiUsages_1[_0x1cba3d(0x1fd)][_0x1cba3d(0x1e2)]({'companyId':_0x1de1af,'dateUsed':_0x679242});await _0x126b2b[_0x1cba3d(0x1ff)]({'usedImage':_0x126b2b[_0x1cba3d(0x22e)][_0x1cba3d(0x22a)]+0x1,'UsedOnDay':_0x126b2b[_0x1cba3d(0x22e)]['UsedOnDay']+0x1,'updatedAt':_0x695091});}},0x64),_0x404a82[_0x5011b0(0x220)]({'status':_0x5011b0(0x1d6)});};exports[a8_0x5d7d91(0x1f3)]=indexImage;const checkNumber=async(_0x5db004,_0x2f36f0)=>{const _0x12da02=a8_0x5d7d91,_0x397507=_0x5db004[_0x12da02(0x1e3)],_0x121158=_0x5db004[_0x12da02(0x1f6)]['authorization'],[,_0x20d65d]=_0x121158[_0x12da02(0x227)]('\x20'),_0x51058c=await Whatsapp_1[_0x12da02(0x1fd)][_0x12da02(0x215)]({'where':{'token':_0x20d65d}}),_0x5b9219=_0x51058c[_0x12da02(0x1f7)],_0x32b889=_0x397507[_0x12da02(0x20a)][_0x12da02(0x1d8)]('-','')[_0x12da02(0x1d8)]('\x20',''),_0x440220=await(0x0,GetDefaultWhatsApp_1['default'])(_0x5b9219),_0x29881a=(0x0,wbot_1[_0x12da02(0x21c)])(_0x440220['id']),_0x2c9ab1=createJid(_0x32b889);try{const [_0x3e5db8]=await _0x29881a[_0x12da02(0x1d7)](_0x2c9ab1);if(_0x3e5db8['exists'])return setTimeout(async()=>{const _0xc6437a=_0x12da02,{dateToClient:_0x1a8b84}=(0x0,useDate_1[_0xc6437a(0x1fb)])(),_0xfd4a3=_0x1a8b84(new Date()),_0x450c8f=(0x0,moment_1[_0xc6437a(0x1fd)])()['format'](),_0x467185=await ApiUsages_1['default']['findOne']({'where':{'dateUsed':_0xfd4a3,'companyId':_0x5b9219}});if(_0x467185)await _0x467185[_0xc6437a(0x1ff)]({'usedCheckNumber':_0x467185[_0xc6437a(0x22e)]['usedCheckNumber']+0x1,'UsedOnDay':_0x467185[_0xc6437a(0x22e)][_0xc6437a(0x226)]+0x1,'updatedAt':_0x450c8f});else{const _0x5cfa9e=await ApiUsages_1['default'][_0xc6437a(0x1e2)]({'companyId':_0x5b9219,'dateUsed':_0xfd4a3});await _0x5cfa9e[_0xc6437a(0x1ff)]({'usedCheckNumber':_0x5cfa9e[_0xc6437a(0x22e)]['usedCheckNumber']+0x1,'UsedOnDay':_0x5cfa9e[_0xc6437a(0x22e)][_0xc6437a(0x226)]+0x1,'updatedAt':_0x450c8f});}},0x64),_0x2f36f0['status'](0xc8)[_0x12da02(0x221)]({'existsInWhatsapp':!![],'number':_0x32b889,'numberFormatted':_0x3e5db8['jid']});}catch(_0x5aaf35){return _0x2f36f0[_0x12da02(0x1d4)](0x190)[_0x12da02(0x221)]({'existsInWhatsapp':![],'number':_0x2c9ab1,'error':_0x12da02(0x1de)});}};exports[a8_0x5d7d91(0x1fc)]=checkNumber;const indexWhatsappsId=async(_0x85ca67,_0x8a759)=>{const _0x2b811b=a8_0x5d7d91;return console[_0x2b811b(0x235)](_0x2b811b(0x20c),_0x85ca67),console[_0x2b811b(0x235)](_0x2b811b(0x20c),_0x85ca67[_0x2b811b(0x219)]),_0x8a759[_0x2b811b(0x1d4)](0xc8)[_0x2b811b(0x221)]('oi');};exports['indexWhatsappsId']=indexWhatsappsId;function a8_0x1371(){const _0x1149dd=['json','string','exec','27IqdkOa','hasOwnProperty','UsedOnDay','split','mimetype','findByPk','usedImage','../services/WbotServices/GetProfilePicUrl','__esModule','../services/WbotServices/SendWhatsAppMessageLink','dataValues','../helpers/SetTicketMessagesAsRead','../services/WbotServices/SendWhatsappMediaImage','parseInt','call','\x20not\x20found','jid','log','indexWhatsappsId','usedVideo','authorization','../services/WbotServices/SendWhatsAppMessageAPI','url','indexLink','../services/TicketServices/UpdateTicketService','../models/ApiUsages','status','whatsapp\x20#','SUCCESS','onWhatsApp','replace','4iDVXWg','matches','map','../errors/AppError','@g.us','Not\x20exists\x20on\x20Whatsapp','test','14RzVrZm','prototype','create','body','usedText','yup','241505OzTZVc','usedOther','defineProperty','909209YowBYy','../helpers/GetDefaultWhatsApp','caption','@s.whatsapp.net','../services/WbotServices/SendWhatsAppMedia','12EneSpd','image','all','moment','shape','indexImage','../services/TicketServices/FindOrCreateTicketService','../models/Whatsapp','headers','companyId','contact','format','required','useDate','checkNumber','default','index','update','3714290plHjia','__createBinding','exists','message','validate','../utils/useDate','whatsapp','video','usedPDF','5446704EQJzbu','number','getOwnPropertyDescriptor','req','__importStar','configurable','115920VpSLbt','object','1984265xrfVVi','isInteger','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','closed','findOne','516DMvJiG','../services/WbotServices/CheckIsValidContact','includes','user','../libs/wbot','OnWhatsAppDto','getWbot','../services/WbotServices/CheckNumber','3527007wniwaj','__importDefault','send'];a8_0x1371=function(){return _0x1149dd;};return a8_0x1371();}