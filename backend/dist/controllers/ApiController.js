'use strict';const a8_0x457a7d=a8_0xb8ff;(function(_0x16b562,_0x441072){const _0x1db139=a8_0xb8ff,_0x363871=_0x16b562();while(!![]){try{const _0x2139ac=-parseInt(_0x1db139(0x86))/0x1+-parseInt(_0x1db139(0xbc))/0x2+parseInt(_0x1db139(0x88))/0x3*(-parseInt(_0x1db139(0x82))/0x4)+-parseInt(_0x1db139(0xa3))/0x5+parseInt(_0x1db139(0x95))/0x6*(parseInt(_0x1db139(0xd1))/0x7)+parseInt(_0x1db139(0xe3))/0x8+parseInt(_0x1db139(0xdc))/0x9*(parseInt(_0x1db139(0xad))/0xa);if(_0x2139ac===_0x441072)break;else _0x363871['push'](_0x363871['shift']());}catch(_0x189e19){_0x363871['push'](_0x363871['shift']());}}}(a8_0x2e28,0x553b7));var __createBinding=this&&this[a8_0x457a7d(0x85)]||(Object['create']?function(_0x2b1093,_0x2b698f,_0x2d9269,_0xeacce5){const _0x42b880=a8_0x457a7d;if(_0xeacce5===undefined)_0xeacce5=_0x2d9269;var _0x22aa4c=Object['getOwnPropertyDescriptor'](_0x2b698f,_0x2d9269);(!_0x22aa4c||(_0x42b880(0xc6)in _0x22aa4c?!_0x2b698f[_0x42b880(0xe0)]:_0x22aa4c['writable']||_0x22aa4c['configurable']))&&(_0x22aa4c={'enumerable':!![],'get':function(){return _0x2b698f[_0x2d9269];}}),Object['defineProperty'](_0x2b1093,_0xeacce5,_0x22aa4c);}:function(_0x442c9f,_0x1d3aaa,_0x148c5e,_0x44beaf){if(_0x44beaf===undefined)_0x44beaf=_0x148c5e;_0x442c9f[_0x44beaf]=_0x1d3aaa[_0x148c5e];}),__setModuleDefault=this&&this[a8_0x457a7d(0x83)]||(Object['create']?function(_0x2ec85c,_0x422d1d){const _0x59e718=a8_0x457a7d;Object[_0x59e718(0xc7)](_0x2ec85c,_0x59e718(0xa7),{'enumerable':!![],'value':_0x422d1d});}:function(_0x150c5a,_0x32c846){_0x150c5a['default']=_0x32c846;}),__importStar=this&&this[a8_0x457a7d(0xb4)]||function(_0x32cd9e){const _0x28caa8=a8_0x457a7d;if(_0x32cd9e&&_0x32cd9e[_0x28caa8(0xe0)])return _0x32cd9e;var _0x5c150c={};if(_0x32cd9e!=null){for(var _0x562f5d in _0x32cd9e)if(_0x562f5d!=='default'&&Object['prototype']['hasOwnProperty'][_0x28caa8(0xca)](_0x32cd9e,_0x562f5d))__createBinding(_0x5c150c,_0x32cd9e,_0x562f5d);}return __setModuleDefault(_0x5c150c,_0x32cd9e),_0x5c150c;},__importDefault=this&&this[a8_0x457a7d(0xdd)]||function(_0x4638f2){const _0x40ebfc=a8_0x457a7d;return _0x4638f2&&_0x4638f2[_0x40ebfc(0xe0)]?_0x4638f2:{'default':_0x4638f2};};Object[a8_0x457a7d(0xc7)](exports,a8_0x457a7d(0xe0),{'value':!![]}),exports['indexWhatsappsId']=exports[a8_0x457a7d(0x8d)]=exports['indexImage']=exports[a8_0x457a7d(0xa2)]=exports[a8_0x457a7d(0xdb)]=exports[a8_0x457a7d(0xb5)]=void 0x0;const Yup=__importStar(require(a8_0x457a7d(0xb0))),AppError_1=__importDefault(require(a8_0x457a7d(0xc5))),GetDefaultWhatsApp_1=__importDefault(require('../helpers/GetDefaultWhatsApp')),SetTicketMessagesAsRead_1=__importDefault(require(a8_0x457a7d(0xa9))),Whatsapp_1=__importDefault(require(a8_0x457a7d(0x8a))),CreateOrUpdateContactService_1=__importDefault(require(a8_0x457a7d(0xbf))),FindOrCreateTicketService_1=__importDefault(require(a8_0x457a7d(0x90))),ShowTicketService_1=__importDefault(require(a8_0x457a7d(0xce))),CheckIsValidContact_1=__importDefault(require(a8_0x457a7d(0x81))),CheckNumber_1=__importDefault(require(a8_0x457a7d(0xb8))),GetProfilePicUrl_1=__importDefault(require(a8_0x457a7d(0x84))),SendWhatsAppMedia_1=__importDefault(require('../services/WbotServices/SendWhatsAppMedia')),UpdateTicketService_1=__importDefault(require('../services/TicketServices/UpdateTicketService')),wbot_1=require(a8_0x457a7d(0xcb)),SendWhatsAppMessageLink_1=__importDefault(require(a8_0x457a7d(0xe2))),SendWhatsAppMessageAPI_1=__importDefault(require(a8_0x457a7d(0x9f))),SendWhatsappMediaImage_1=__importDefault(require('../services/WbotServices/SendWhatsappMediaImage')),ApiUsages_1=__importDefault(require(a8_0x457a7d(0xb9))),useDate_1=require(a8_0x457a7d(0xdf)),moment_1=__importDefault(require('moment')),ListSettingsService_1=__importDefault(require(a8_0x457a7d(0xb6)));class OnWhatsAppDto{constructor(_0xc69fa5,_0x2b6b59){const _0x2540ff=a8_0x457a7d;this['jid']=_0xc69fa5,this[_0x2540ff(0xaa)]=_0x2b6b59;}}exports[a8_0x457a7d(0xb5)]=OnWhatsAppDto;function a8_0xb8ff(_0xa419ba,_0x5a2a02){const _0x2e28a3=a8_0x2e28();return a8_0xb8ff=function(_0xb8ff98,_0xb1ac49){_0xb8ff98=_0xb8ff98-0x80;let _0x378dc8=_0x2e28a3[_0xb8ff98];return _0x378dc8;},a8_0xb8ff(_0xa419ba,_0x5a2a02);}const createContact=async(_0x3a8565,_0x5533b4,_0x5bfb94,_0x1b448a,_0x5e5761)=>{const _0x2a40e9=a8_0x457a7d;await(0x0,CheckIsValidContact_1[_0x2a40e9(0xa7)])(_0x5bfb94,_0x5533b4);const _0x46b741=await(0x0,CheckNumber_1[_0x2a40e9(0xa7)])(_0x5bfb94,_0x5533b4),_0x9703b1=await(0x0,GetProfilePicUrl_1['default'])(_0x46b741,_0x5533b4),_0x312f62=await(0x0,ListSettingsService_1[_0x2a40e9(0xa7)])({'companyId':_0x5533b4}),_0x43b8f7=_0x46b741,_0x54cf24={'name':''+_0x43b8f7,'number':_0x43b8f7,'profilePicUrl':_0x9703b1,'isGroup':![],'companyId':_0x5533b4},_0x480647=await(0x0,CreateOrUpdateContactService_1[_0x2a40e9(0xa7)])(_0x54cf24);let _0x34a3ff;if(_0x3a8565===undefined)_0x34a3ff=await(0x0,GetDefaultWhatsApp_1[_0x2a40e9(0xa7)])(_0x5533b4);else{_0x34a3ff=await Whatsapp_1[_0x2a40e9(0xa7)][_0x2a40e9(0x9d)](_0x3a8565);if(_0x34a3ff===null)throw new AppError_1[(_0x2a40e9(0xa7))](_0x2a40e9(0x92)+_0x3a8565+_0x2a40e9(0x9a));}const {ticket:_0x43855d,isCreated:_0x16a1e1}=await(0x0,FindOrCreateTicketService_1['default'])(_0x480647,_0x34a3ff,0x0,_0x5533b4,_0x5e5761,_0x1b448a,null,_0x2a40e9(0xcc),null,![],_0x312f62),_0x1cee08=await(0x0,ShowTicketService_1['default'])(_0x43855d['id'],_0x5533b4);return(0x0,SetTicketMessagesAsRead_1[_0x2a40e9(0xa7)])(_0x1cee08),_0x1cee08;};function formatBRNumber(_0x3d944b){const _0x30e89c=a8_0x457a7d,_0x225d51=new RegExp(/^(\d{2})(\d{2})\d{1}(\d{8})$/);if(_0x225d51[_0x30e89c(0x8b)](_0x3d944b)){const _0x4a3743=_0x225d51[_0x30e89c(0x97)](_0x3d944b);if(_0x4a3743&&_0x4a3743[0x1]==='55'&&Number[_0x30e89c(0x87)](Number[_0x30e89c(0x94)](_0x4a3743[0x2]))){const _0x45e461=Number[_0x30e89c(0x94)](_0x4a3743[0x2]);if(_0x45e461<0x1f)return _0x4a3743[0x0];else{if(_0x45e461>=0x1f)return _0x4a3743[0x1]+_0x4a3743[0x2]+_0x4a3743[0x3];}}}else return _0x3d944b;}function createJid(_0x8ea13b){const _0xd575ee=a8_0x457a7d;if(_0x8ea13b[_0xd575ee(0x8e)](_0xd575ee(0xd2))||_0x8ea13b['includes'](_0xd575ee(0xa0)))return formatBRNumber(_0x8ea13b);return _0x8ea13b['includes']('-')?_0x8ea13b+_0xd575ee(0xd2):formatBRNumber(_0x8ea13b)+_0xd575ee(0xa0);}const indexLink=async(_0xcc27d3,_0x2c8483)=>{const _0x14525d=a8_0x457a7d,_0xfbee30=_0xcc27d3[_0x14525d(0xaf)],{whatsappId:_0xb855b5}=_0xcc27d3[_0x14525d(0xaf)],{msdelay:_0x302304}=_0xcc27d3[_0x14525d(0xaf)],_0x12cbbf=_0xcc27d3[_0x14525d(0xaf)][_0x14525d(0xd0)],_0x4de116=_0xcc27d3[_0x14525d(0xaf)][_0x14525d(0xac)],_0x3269fa=_0xcc27d3[_0x14525d(0xd5)][_0x14525d(0xb7)],[,_0x5d34f2]=_0x3269fa['split']('\x20'),_0x40a765=await Whatsapp_1[_0x14525d(0xa7)][_0x14525d(0x98)]({'where':{'token':_0x5d34f2}}),_0x5ada7a=_0x40a765[_0x14525d(0x8f)];_0xfbee30[_0x14525d(0xbd)]=_0xfbee30[_0x14525d(0xbd)]['replace']('-','')[_0x14525d(0x89)]('\x20','');const _0x124130=Yup[_0x14525d(0xbe)]()['shape']({'number':Yup['string']()[_0x14525d(0xcf)]()[_0x14525d(0xc0)](/^\d+$/,_0x14525d(0xd9))});try{await _0x124130[_0x14525d(0x93)](_0xfbee30);}catch(_0x39f1){throw new AppError_1['default'](_0x39f1[_0x14525d(0xb2)]);}const _0x43f246=await createContact(_0xb855b5,_0x5ada7a,_0xfbee30[_0x14525d(0xbd)]);return await(0x0,SendWhatsAppMessageLink_1['default'])({'whatsappId':_0xb855b5,'contact':_0x43f246[_0x14525d(0xcd)],'url':_0x12cbbf,'caption':_0x4de116,'msdelay':_0x302304}),setTimeout(async()=>{const _0x2d1ebf=_0x14525d,{dateToClient:_0x5c156f}=(0x0,useDate_1[_0x2d1ebf(0xde)])(),_0x3b29c2=_0x5c156f(new Date()),_0x469c41=(0x0,moment_1['default'])()[_0x2d1ebf(0xab)](),_0x13a5e3=await ApiUsages_1['default']['findOne']({'where':{'dateUsed':_0x3b29c2,'companyId':_0x5ada7a}});if(_0x13a5e3)await _0x13a5e3[_0x2d1ebf(0xae)]({'usedPDF':_0x13a5e3['dataValues'][_0x2d1ebf(0xd8)]+0x1,'UsedOnDay':_0x13a5e3[_0x2d1ebf(0xbb)][_0x2d1ebf(0xa6)]+0x1,'updatedAt':_0x469c41});else{const _0x46b719=await ApiUsages_1[_0x2d1ebf(0xa7)]['create']({'companyId':_0x5ada7a,'dateUsed':_0x3b29c2});await _0x46b719[_0x2d1ebf(0xae)]({'usedPDF':_0x46b719['dataValues']['usedPDF']+0x1,'UsedOnDay':_0x46b719[_0x2d1ebf(0xbb)][_0x2d1ebf(0xa6)]+0x1,'updatedAt':_0x469c41});}},0x64),_0x2c8483['send']({'status':_0x14525d(0xa1)});};exports[a8_0x457a7d(0xdb)]=indexLink;const index=async(_0x2fcd64,_0x126da7)=>{const _0x54134a=a8_0x457a7d,_0x3f42c5=_0x2fcd64[_0x54134a(0xaf)],{whatsappId:_0x15f80d}=_0x2fcd64['body'],{msdelay:_0x94046}=_0x2fcd64['body'],{body:_0x3c20ea,quotedMsg:_0x38d518,userId:_0xc0efcb,queueId:_0x511e3d}=_0x2fcd64['body'],_0x24d99a=_0x2fcd64[_0x54134a(0xe1)],_0x6c856f=_0x2fcd64[_0x54134a(0xd5)][_0x54134a(0xb7)],[,_0x105228]=_0x6c856f[_0x54134a(0x91)]('\x20'),_0x5a6769=await Whatsapp_1[_0x54134a(0xa7)][_0x54134a(0x98)]({'where':{'token':_0x105228}}),_0x4817b6=_0x5a6769[_0x54134a(0x8f)];_0x3f42c5[_0x54134a(0xbd)]=_0x3f42c5['number']['replace']('-','')[_0x54134a(0x89)]('\x20','');const _0x33df51=Yup[_0x54134a(0xbe)]()[_0x54134a(0xc9)]({'number':Yup[_0x54134a(0x9e)]()[_0x54134a(0xcf)]()[_0x54134a(0xc0)](/^\d+$/,_0x54134a(0xd9))});try{await _0x33df51[_0x54134a(0x93)](_0x3f42c5);}catch(_0x405aac){throw new AppError_1['default'](_0x405aac['message']);}const _0x5d031d=await createContact(_0x5a6769['id'],_0x4817b6,_0x3f42c5['number'],_0xc0efcb,_0x511e3d);return _0x24d99a?await Promise[_0x54134a(0xc8)](_0x24d99a[_0x54134a(0x9c)](async _0x5556b2=>{const _0x408fb4=_0x54134a;await(0x0,SendWhatsAppMedia_1[_0x408fb4(0xa7)])({'body':_0x3c20ea,'media':_0x5556b2,'ticket':_0x5d031d});})):await(0x0,SendWhatsAppMessageAPI_1[_0x54134a(0xa7)])({'body':_0x3c20ea,'whatsappId':_0x5a6769['id'],'contact':_0x5d031d['contact'],'quotedMsg':_0x38d518,'msdelay':_0x94046}),setTimeout(async()=>{const _0x52bb23=_0x54134a,{dateToClient:_0x55191e}=(0x0,useDate_1[_0x52bb23(0xde)])(),_0x8aab66=_0x55191e(new Date()),_0x2f5726=(0x0,moment_1[_0x52bb23(0xa7)])()[_0x52bb23(0xab)]();let _0x5f5075=await ApiUsages_1[_0x52bb23(0xa7)][_0x52bb23(0x98)]({'where':{'dateUsed':_0x8aab66,'companyId':_0x4817b6}});_0x5f5075?_0x24d99a?await Promise[_0x52bb23(0xc8)](_0x24d99a[_0x52bb23(0x9c)](async _0x1b22e4=>{const _0x1bc24e=_0x52bb23;if(_0x1b22e4['mimetype'][_0x1bc24e(0x8e)](_0x1bc24e(0x80)))await _0x5f5075[_0x1bc24e(0xae)]({'usedPDF':_0x5f5075[_0x1bc24e(0xbb)][_0x1bc24e(0xd8)]+0x1,'UsedOnDay':_0x5f5075[_0x1bc24e(0xbb)][_0x1bc24e(0xa6)]+0x1,'updatedAt':_0x2f5726});else{if(_0x1b22e4[_0x1bc24e(0xd7)][_0x1bc24e(0x8e)](_0x1bc24e(0xd4)))await _0x5f5075[_0x1bc24e(0xae)]({'usedImage':_0x5f5075[_0x1bc24e(0xbb)]['usedImage']+0x1,'UsedOnDay':_0x5f5075['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x2f5726});else _0x1b22e4[_0x1bc24e(0xd7)]['includes'](_0x1bc24e(0xd6))?await _0x5f5075[_0x1bc24e(0xae)]({'usedVideo':_0x5f5075[_0x1bc24e(0xbb)][_0x1bc24e(0xc4)]+0x1,'UsedOnDay':_0x5f5075['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x2f5726}):await _0x5f5075[_0x1bc24e(0xae)]({'usedOther':_0x5f5075[_0x1bc24e(0xbb)][_0x1bc24e(0xd3)]+0x1,'UsedOnDay':_0x5f5075[_0x1bc24e(0xbb)]['UsedOnDay']+0x1,'updatedAt':_0x2f5726});}})):await _0x5f5075[_0x52bb23(0xae)]({'usedText':_0x5f5075[_0x52bb23(0xbb)][_0x52bb23(0xc3)]+0x1,'UsedOnDay':_0x5f5075[_0x52bb23(0xbb)][_0x52bb23(0xa6)]+0x1,'updatedAt':_0x2f5726}):(_0x5f5075=await ApiUsages_1[_0x52bb23(0xa7)][_0x52bb23(0xa4)]({'companyId':_0x4817b6,'dateUsed':_0x8aab66}),_0x24d99a?await Promise[_0x52bb23(0xc8)](_0x24d99a[_0x52bb23(0x9c)](async _0x208653=>{const _0x301783=_0x52bb23;if(_0x208653[_0x301783(0xd7)]['includes'](_0x301783(0x80)))await _0x5f5075[_0x301783(0xae)]({'usedPDF':_0x5f5075[_0x301783(0xbb)]['usedPDF']+0x1,'UsedOnDay':_0x5f5075['dataValues'][_0x301783(0xa6)]+0x1,'updatedAt':_0x2f5726});else{if(_0x208653[_0x301783(0xd7)][_0x301783(0x8e)](_0x301783(0xd4)))await _0x5f5075[_0x301783(0xae)]({'usedImage':_0x5f5075[_0x301783(0xbb)]['usedImage']+0x1,'UsedOnDay':_0x5f5075['dataValues'][_0x301783(0xa6)]+0x1,'updatedAt':_0x2f5726});else _0x208653['mimetype'][_0x301783(0x8e)](_0x301783(0xd6))?await _0x5f5075['update']({'usedVideo':_0x5f5075[_0x301783(0xbb)][_0x301783(0xc4)]+0x1,'UsedOnDay':_0x5f5075[_0x301783(0xbb)][_0x301783(0xa6)]+0x1,'updatedAt':_0x2f5726}):await _0x5f5075[_0x301783(0xae)]({'usedOther':_0x5f5075[_0x301783(0xbb)][_0x301783(0xd3)]+0x1,'UsedOnDay':_0x5f5075[_0x301783(0xbb)]['UsedOnDay']+0x1,'updatedAt':_0x2f5726});}})):await _0x5f5075[_0x52bb23(0xae)]({'usedText':_0x5f5075[_0x52bb23(0xbb)][_0x52bb23(0xc3)]+0x1,'UsedOnDay':_0x5f5075[_0x52bb23(0xbb)][_0x52bb23(0xa6)]+0x1,'updatedAt':_0x2f5726}));},0x64),_0x126da7[_0x54134a(0xa8)]({'status':_0x54134a(0xa1)});};exports[a8_0x457a7d(0xa2)]=index;const indexImage=async(_0x387aae,_0x146a99)=>{const _0xeddf47=a8_0x457a7d,_0x255990=_0x387aae[_0xeddf47(0xaf)],{whatsappId:_0x30e7d6}=_0x387aae[_0xeddf47(0xaf)],{msdelay:_0x4f1837}=_0x387aae['body'],_0x40b939=_0x387aae[_0xeddf47(0xaf)][_0xeddf47(0xd0)],_0x368aaf=_0x387aae[_0xeddf47(0xaf)][_0xeddf47(0xac)],_0x49ba02=_0x387aae['headers'][_0xeddf47(0xb7)],[,_0xdaf2b3]=_0x49ba02['split']('\x20'),_0x28a03b=await Whatsapp_1[_0xeddf47(0xa7)]['findOne']({'where':{'token':_0xdaf2b3}}),_0x542cc0=_0x28a03b[_0xeddf47(0x8f)];_0x255990['number']=_0x255990[_0xeddf47(0xbd)][_0xeddf47(0x89)]('-','')[_0xeddf47(0x89)]('\x20','');const _0x5ed6da=Yup[_0xeddf47(0xbe)]()[_0xeddf47(0xc9)]({'number':Yup[_0xeddf47(0x9e)]()['required']()[_0xeddf47(0xc0)](/^\d+$/,_0xeddf47(0xd9))});try{await _0x5ed6da[_0xeddf47(0x93)](_0x255990);}catch(_0x6e5923){throw new AppError_1['default'](_0x6e5923['message']);}const _0x1f757e=await createContact(_0x30e7d6,_0x542cc0,_0x255990['number']);return _0x40b939&&await(0x0,SendWhatsappMediaImage_1[_0xeddf47(0xa7)])({'ticket':_0x1f757e,'url':_0x40b939,'caption':_0x368aaf,'msdelay':_0x4f1837}),setTimeout(async()=>{const _0x325a73=_0xeddf47;await(0x0,UpdateTicketService_1[_0x325a73(0xa7)])({'ticketId':_0x1f757e['id'],'ticketData':{'status':_0x325a73(0x99),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x542cc0});},0x64),setTimeout(async()=>{const _0x5adf4f=_0xeddf47,{dateToClient:_0x3203e6}=(0x0,useDate_1[_0x5adf4f(0xde)])(),_0x2028d6=_0x3203e6(new Date()),_0x2e0d6d=(0x0,moment_1[_0x5adf4f(0xa7)])()[_0x5adf4f(0xab)](),_0x3c39b3=await ApiUsages_1[_0x5adf4f(0xa7)][_0x5adf4f(0x98)]({'where':{'dateUsed':_0x2028d6,'companyId':_0x542cc0}});if(_0x3c39b3)await _0x3c39b3[_0x5adf4f(0xae)]({'usedImage':_0x3c39b3[_0x5adf4f(0xbb)][_0x5adf4f(0xb1)]+0x1,'UsedOnDay':_0x3c39b3[_0x5adf4f(0xbb)][_0x5adf4f(0xa6)]+0x1,'updatedAt':_0x2e0d6d});else{const _0x365726=await ApiUsages_1[_0x5adf4f(0xa7)][_0x5adf4f(0xa4)]({'companyId':_0x542cc0,'dateUsed':_0x2028d6});await _0x365726[_0x5adf4f(0xae)]({'usedImage':_0x365726[_0x5adf4f(0xbb)][_0x5adf4f(0xb1)]+0x1,'UsedOnDay':_0x365726[_0x5adf4f(0xbb)][_0x5adf4f(0xa6)]+0x1,'updatedAt':_0x2e0d6d});}},0x64),_0x146a99[_0xeddf47(0xa8)]({'status':_0xeddf47(0xa1)});};exports[a8_0x457a7d(0xa5)]=indexImage;const checkNumber=async(_0x291269,_0x3f0086)=>{const _0x59db02=a8_0x457a7d,_0x337966=_0x291269[_0x59db02(0xaf)],_0x330cf6=_0x291269[_0x59db02(0xd5)]['authorization'],[,_0x33d376]=_0x330cf6[_0x59db02(0x91)]('\x20'),_0x131f40=await Whatsapp_1[_0x59db02(0xa7)][_0x59db02(0x98)]({'where':{'token':_0x33d376}}),_0x590776=_0x131f40[_0x59db02(0x8f)],_0x2935e4=_0x337966[_0x59db02(0xbd)]['replace']('-','')[_0x59db02(0x89)]('\x20',''),_0x49d75b=await(0x0,GetDefaultWhatsApp_1[_0x59db02(0xa7)])(_0x590776),_0x4993bd=(0x0,wbot_1[_0x59db02(0x8c)])(_0x49d75b['id']),_0x15bffb=createJid(_0x2935e4);try{const [_0x225d23]=await _0x4993bd[_0x59db02(0xba)](_0x15bffb);if(_0x225d23[_0x59db02(0xaa)])return setTimeout(async()=>{const _0x18e7aa=_0x59db02,{dateToClient:_0xea3a38}=(0x0,useDate_1[_0x18e7aa(0xde)])(),_0x67049e=_0xea3a38(new Date()),_0x36ff14=(0x0,moment_1[_0x18e7aa(0xa7)])()[_0x18e7aa(0xab)](),_0x50547c=await ApiUsages_1[_0x18e7aa(0xa7)]['findOne']({'where':{'dateUsed':_0x67049e,'companyId':_0x590776}});if(_0x50547c)await _0x50547c[_0x18e7aa(0xae)]({'usedCheckNumber':_0x50547c['dataValues'][_0x18e7aa(0x9b)]+0x1,'UsedOnDay':_0x50547c[_0x18e7aa(0xbb)][_0x18e7aa(0xa6)]+0x1,'updatedAt':_0x36ff14});else{const _0x3b3191=await ApiUsages_1[_0x18e7aa(0xa7)][_0x18e7aa(0xa4)]({'companyId':_0x590776,'dateUsed':_0x67049e});await _0x3b3191['update']({'usedCheckNumber':_0x3b3191[_0x18e7aa(0xbb)][_0x18e7aa(0x9b)]+0x1,'UsedOnDay':_0x3b3191[_0x18e7aa(0xbb)][_0x18e7aa(0xa6)]+0x1,'updatedAt':_0x36ff14});}},0x64),_0x3f0086[_0x59db02(0xc2)](0xc8)[_0x59db02(0xda)]({'existsInWhatsapp':!![],'number':_0x2935e4,'numberFormatted':_0x225d23['jid']});}catch(_0x351acc){return _0x3f0086[_0x59db02(0xc2)](0x190)['json']({'existsInWhatsapp':![],'number':_0x15bffb,'error':_0x59db02(0xe4)});}};function a8_0x2e28(){const _0xd952bc=['image','headers','video','mimetype','usedPDF','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','json','indexLink','729QHvOgD','__importDefault','useDate','../utils/useDate','__esModule','files','../services/WbotServices/SendWhatsAppMessageLink','4038832wKKGVo','Not\x20exists\x20on\x20Whatsapp','indexWhatsappsId','pdf','../services/WbotServices/CheckIsValidContact','33532KCbZic','__setModuleDefault','../services/WbotServices/GetProfilePicUrl','__createBinding','363664lBEzjb','isInteger','111QTjmOc','replace','../models/Whatsapp','test','getWbot','checkNumber','includes','companyId','../services/TicketServices/FindOrCreateTicketService','split','whatsapp\x20#','validate','parseInt','599568lwmqKH','log','exec','findOne','closed','\x20not\x20found','usedCheckNumber','map','findByPk','string','../services/WbotServices/SendWhatsAppMessageAPI','@s.whatsapp.net','SUCCESS','index','860450sJQeHK','create','indexImage','UsedOnDay','default','send','../helpers/SetTicketMessagesAsRead','exists','format','caption','114790MEqAea','update','body','yup','usedImage','message','user','__importStar','OnWhatsAppDto','../services/SettingServices/ListSettingsService','authorization','../services/WbotServices/CheckNumber','../models/ApiUsages','onWhatsApp','dataValues','1278658TXtKfV','number','object','../services/ContactServices/CreateOrUpdateContactService','matches','req','status','usedText','usedVideo','../errors/AppError','get','defineProperty','all','shape','call','../libs/wbot','whatsapp','contact','../services/TicketServices/ShowTicketService','required','url','28eRfyUj','@g.us','usedOther'];a8_0x2e28=function(){return _0xd952bc;};return a8_0x2e28();}exports[a8_0x457a7d(0x8d)]=checkNumber;const indexWhatsappsId=async(_0x4ddacc,_0x36facb)=>{const _0x3807f7=a8_0x457a7d;return console['log'](_0x3807f7(0xc1),_0x4ddacc),console[_0x3807f7(0x96)](_0x3807f7(0xc1),_0x4ddacc[_0x3807f7(0xb3)]),_0x36facb[_0x3807f7(0xc2)](0xc8)['json']('oi');};exports[a8_0x457a7d(0xe5)]=indexWhatsappsId;