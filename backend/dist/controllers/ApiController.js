'use strict';const a8_0x58fe1e=a8_0x5a06;(function(_0x3c04ae,_0x450e8c){const _0x27d037=a8_0x5a06,_0x4b7964=_0x3c04ae();while(!![]){try{const _0x169210=parseInt(_0x27d037(0xb7))/0x1*(parseInt(_0x27d037(0xb1))/0x2)+-parseInt(_0x27d037(0xcf))/0x3*(parseInt(_0x27d037(0xa2))/0x4)+-parseInt(_0x27d037(0x9b))/0x5+-parseInt(_0x27d037(0x9a))/0x6*(parseInt(_0x27d037(0x91))/0x7)+-parseInt(_0x27d037(0x85))/0x8*(-parseInt(_0x27d037(0x9f))/0x9)+-parseInt(_0x27d037(0x9e))/0xa*(parseInt(_0x27d037(0x9c))/0xb)+parseInt(_0x27d037(0xa1))/0xc;if(_0x169210===_0x450e8c)break;else _0x4b7964['push'](_0x4b7964['shift']());}catch(_0x5f0de6){_0x4b7964['push'](_0x4b7964['shift']());}}}(a8_0x5ab0,0x362b0));var __createBinding=this&&this[a8_0x58fe1e(0x97)]||(Object['create']?function(_0x34717a,_0x586803,_0xcca9fd,_0x1f3ac3){const _0x173498=a8_0x58fe1e;if(_0x1f3ac3===undefined)_0x1f3ac3=_0xcca9fd;var _0x1a2b21=Object['getOwnPropertyDescriptor'](_0x586803,_0xcca9fd);(!_0x1a2b21||('get'in _0x1a2b21?!_0x586803['__esModule']:_0x1a2b21['writable']||_0x1a2b21[_0x173498(0xbb)]))&&(_0x1a2b21={'enumerable':!![],'get':function(){return _0x586803[_0xcca9fd];}}),Object['defineProperty'](_0x34717a,_0x1f3ac3,_0x1a2b21);}:function(_0x1ba011,_0xce3e91,_0x28d891,_0x567054){if(_0x567054===undefined)_0x567054=_0x28d891;_0x1ba011[_0x567054]=_0xce3e91[_0x28d891];}),__setModuleDefault=this&&this[a8_0x58fe1e(0xc6)]||(Object[a8_0x58fe1e(0x82)]?function(_0x506f7b,_0x336a23){const _0x3a2bc3=a8_0x58fe1e;Object[_0x3a2bc3(0xd6)](_0x506f7b,_0x3a2bc3(0xb8),{'enumerable':!![],'value':_0x336a23});}:function(_0x382124,_0x3ad0e3){_0x382124['default']=_0x3ad0e3;}),__importStar=this&&this[a8_0x58fe1e(0x88)]||function(_0x4764aa){const _0x13e035=a8_0x58fe1e;if(_0x4764aa&&_0x4764aa[_0x13e035(0xd7)])return _0x4764aa;var _0x32a3e7={};if(_0x4764aa!=null){for(var _0x170812 in _0x4764aa)if(_0x170812!=='default'&&Object[_0x13e035(0xca)][_0x13e035(0xce)][_0x13e035(0xba)](_0x4764aa,_0x170812))__createBinding(_0x32a3e7,_0x4764aa,_0x170812);}return __setModuleDefault(_0x32a3e7,_0x4764aa),_0x32a3e7;},__importDefault=this&&this[a8_0x58fe1e(0x8a)]||function(_0x748850){return _0x748850&&_0x748850['__esModule']?_0x748850:{'default':_0x748850};};Object[a8_0x58fe1e(0xd6)](exports,a8_0x58fe1e(0xd7),{'value':!![]}),exports['indexWhatsappsId']=exports[a8_0x58fe1e(0xd2)]=exports[a8_0x58fe1e(0xb0)]=exports[a8_0x58fe1e(0xc9)]=exports[a8_0x58fe1e(0x96)]=exports[a8_0x58fe1e(0xaf)]=void 0x0;const Yup=__importStar(require(a8_0x58fe1e(0x7e))),AppError_1=__importDefault(require('../errors/AppError')),GetDefaultWhatsApp_1=__importDefault(require(a8_0x58fe1e(0x8c))),SetTicketMessagesAsRead_1=__importDefault(require('../helpers/SetTicketMessagesAsRead')),Whatsapp_1=__importDefault(require(a8_0x58fe1e(0x7d))),CreateOrUpdateContactService_1=__importDefault(require('../services/ContactServices/CreateOrUpdateContactService')),FindOrCreateTicketService_1=__importDefault(require(a8_0x58fe1e(0xd9))),ShowTicketService_1=__importDefault(require(a8_0x58fe1e(0xb4))),CheckIsValidContact_1=__importDefault(require(a8_0x58fe1e(0xc2))),CheckNumber_1=__importDefault(require(a8_0x58fe1e(0xbf))),GetProfilePicUrl_1=__importDefault(require(a8_0x58fe1e(0x8b))),SendWhatsAppMedia_1=__importDefault(require(a8_0x58fe1e(0xa8))),UpdateTicketService_1=__importDefault(require(a8_0x58fe1e(0x94))),wbot_1=require(a8_0x58fe1e(0xdd)),SendWhatsAppMessageLink_1=__importDefault(require(a8_0x58fe1e(0xc4))),SendWhatsAppMessageAPI_1=__importDefault(require('../services/WbotServices/SendWhatsAppMessageAPI')),SendWhatsappMediaImage_1=__importDefault(require(a8_0x58fe1e(0x7f))),ApiUsages_1=__importDefault(require(a8_0x58fe1e(0xd5))),useDate_1=require(a8_0x58fe1e(0xd8)),moment_1=__importDefault(require(a8_0x58fe1e(0xda))),ListSettingsService_1=__importDefault(require(a8_0x58fe1e(0x99)));class OnWhatsAppDto{constructor(_0x46f837,_0x4a345d){const _0x36af71=a8_0x58fe1e;this[_0x36af71(0xdc)]=_0x46f837,this['exists']=_0x4a345d;}}exports[a8_0x58fe1e(0xaf)]=OnWhatsAppDto;const createContact=async(_0x10d633,_0x44eb7b,_0x2efde4,_0x427f04,_0xb95dce)=>{const _0x384878=a8_0x58fe1e;await(0x0,CheckIsValidContact_1[_0x384878(0xb8)])(_0x2efde4,_0x44eb7b);const _0x356aa3=await(0x0,CheckNumber_1[_0x384878(0xb8)])(_0x2efde4,_0x44eb7b),_0xd3cc34=await(0x0,GetProfilePicUrl_1[_0x384878(0xb8)])(_0x356aa3,_0x44eb7b),_0xfbdf80=await(0x0,ListSettingsService_1['default'])({'companyId':_0x44eb7b}),_0x5229bc=_0x356aa3,_0x53775f={'name':''+_0x5229bc,'number':_0x5229bc,'profilePicUrl':_0xd3cc34,'isGroup':![],'companyId':_0x44eb7b},_0x54f0d3=await(0x0,CreateOrUpdateContactService_1[_0x384878(0xb8)])(_0x53775f);let _0x19ab00;if(_0x10d633===undefined)_0x19ab00=await(0x0,GetDefaultWhatsApp_1[_0x384878(0xb8)])(_0x44eb7b);else{_0x19ab00=await Whatsapp_1[_0x384878(0xb8)][_0x384878(0xab)](_0x10d633);if(_0x19ab00===null)throw new AppError_1[(_0x384878(0xb8))](_0x384878(0x89)+_0x10d633+_0x384878(0xdb));}const {ticket:_0x2b21d5,isCreated:_0x73a62d}=await(0x0,FindOrCreateTicketService_1[_0x384878(0xb8)])(_0x54f0d3,_0x19ab00,0x0,_0x44eb7b,_0xb95dce,_0x427f04,null,'whatsapp',null,![],_0xfbdf80),_0x47d295=await(0x0,ShowTicketService_1[_0x384878(0xb8)])(_0x2b21d5['id'],_0x44eb7b);return(0x0,SetTicketMessagesAsRead_1[_0x384878(0xb8)])(_0x47d295),_0x47d295;};function formatBRNumber(_0x19b946){const _0x56dea3=a8_0x58fe1e,_0x19ab8e=new RegExp(/^(\d{2})(\d{2})\d{1}(\d{8})$/);if(_0x19ab8e[_0x56dea3(0xc8)](_0x19b946)){const _0x7fc86b=_0x19ab8e[_0x56dea3(0xb6)](_0x19b946);if(_0x7fc86b&&_0x7fc86b[0x1]==='55'&&Number['isInteger'](Number['parseInt'](_0x7fc86b[0x2]))){const _0x43b668=Number[_0x56dea3(0xc3)](_0x7fc86b[0x2]);if(_0x43b668<0x1f)return _0x7fc86b[0x0];else{if(_0x43b668>=0x1f)return _0x7fc86b[0x1]+_0x7fc86b[0x2]+_0x7fc86b[0x3];}}}else return _0x19b946;}function createJid(_0x1197a8){const _0x20146f=a8_0x58fe1e;if(_0x1197a8[_0x20146f(0xb2)]('@g.us')||_0x1197a8[_0x20146f(0xb2)](_0x20146f(0x8e)))return formatBRNumber(_0x1197a8);return _0x1197a8['includes']('-')?_0x1197a8+'@g.us':formatBRNumber(_0x1197a8)+'@s.whatsapp.net';}const indexLink=async(_0x50251d,_0x2a436e)=>{const _0x3bdab7=a8_0x58fe1e,_0xa48f9a=_0x50251d['body'],{whatsappId:_0x373cd9}=_0x50251d[_0x3bdab7(0xcb)],{msdelay:_0xce847c}=_0x50251d[_0x3bdab7(0xcb)],_0x21ff5e=_0x50251d[_0x3bdab7(0xcb)]['url'],_0x37ec81=_0x50251d[_0x3bdab7(0xcb)][_0x3bdab7(0xde)],_0x3a63de=_0x50251d[_0x3bdab7(0x98)][_0x3bdab7(0x79)],[,_0x1387af]=_0x3a63de[_0x3bdab7(0x92)]('\x20'),_0x8d5a84=await Whatsapp_1['default'][_0x3bdab7(0x7a)]({'where':{'token':_0x1387af}}),_0x5cedd2=_0x8d5a84['companyId'];_0xa48f9a[_0x3bdab7(0xa5)]=_0xa48f9a['number']['replace']('-','')[_0x3bdab7(0xb5)]('\x20','');const _0x552d76=Yup[_0x3bdab7(0xbd)]()[_0x3bdab7(0x8f)]({'number':Yup['string']()[_0x3bdab7(0x7b)]()[_0x3bdab7(0xb3)](/^\d+$/,'Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.')});try{await _0x552d76[_0x3bdab7(0xd0)](_0xa48f9a);}catch(_0x4a5aac){throw new AppError_1[(_0x3bdab7(0xb8))](_0x4a5aac['message']);}const _0x16850f=await createContact(_0x373cd9,_0x5cedd2,_0xa48f9a[_0x3bdab7(0xa5)]);return await(0x0,SendWhatsAppMessageLink_1[_0x3bdab7(0xb8)])({'whatsappId':_0x373cd9,'contact':_0x16850f[_0x3bdab7(0xcc)],'url':_0x21ff5e,'caption':_0x37ec81,'msdelay':_0xce847c}),setTimeout(async()=>{const _0x194360=_0x3bdab7,{dateToClient:_0x23eb2b}=(0x0,useDate_1['useDate'])(),_0x583afb=_0x23eb2b(new Date()),_0x2a34e5=(0x0,moment_1['default'])()[_0x194360(0xbe)](),_0x5ccb7=await ApiUsages_1[_0x194360(0xb8)][_0x194360(0x7a)]({'where':{'dateUsed':_0x583afb,'companyId':_0x5cedd2}});if(_0x5ccb7)await _0x5ccb7[_0x194360(0x86)]({'usedPDF':_0x5ccb7[_0x194360(0xa6)][_0x194360(0x80)]+0x1,'UsedOnDay':_0x5ccb7['dataValues'][_0x194360(0xa3)]+0x1,'updatedAt':_0x2a34e5});else{const _0x2b198a=await ApiUsages_1[_0x194360(0xb8)][_0x194360(0x82)]({'companyId':_0x5cedd2,'dateUsed':_0x583afb});await _0x2b198a[_0x194360(0x86)]({'usedPDF':_0x2b198a[_0x194360(0xa6)][_0x194360(0x80)]+0x1,'UsedOnDay':_0x2b198a[_0x194360(0xa6)][_0x194360(0xa3)]+0x1,'updatedAt':_0x2a34e5});}},0x64),_0x2a436e['send']({'status':'SUCCESS'});};exports['indexLink']=indexLink;const index=async(_0x50970c,_0x174b66)=>{const _0x3bbba5=a8_0x58fe1e,_0x2f5040=_0x50970c[_0x3bbba5(0xcb)],{whatsappId:_0x3b1189}=_0x50970c['body'],{msdelay:_0x5a129a}=_0x50970c[_0x3bbba5(0xcb)],{body:_0x54f2d1,quotedMsg:_0xd9d7e2,userId:_0x1b55f0,queueId:_0x280a51}=_0x50970c[_0x3bbba5(0xcb)],_0xc87af9=_0x50970c[_0x3bbba5(0xc7)],_0x2370a5=_0x50970c[_0x3bbba5(0x98)][_0x3bbba5(0x79)],[,_0x218ab8]=_0x2370a5[_0x3bbba5(0x92)]('\x20'),_0x3552f4=await Whatsapp_1[_0x3bbba5(0xb8)]['findOne']({'where':{'token':_0x218ab8}}),_0x1fb31b=_0x3552f4[_0x3bbba5(0xc5)];_0x2f5040[_0x3bbba5(0xa5)]=_0x2f5040[_0x3bbba5(0xa5)][_0x3bbba5(0xb5)]('-','')['replace']('\x20','');const _0x18420b=Yup[_0x3bbba5(0xbd)]()['shape']({'number':Yup[_0x3bbba5(0xa0)]()[_0x3bbba5(0x7b)]()[_0x3bbba5(0xb3)](/^\d+$/,_0x3bbba5(0x8d))});try{await _0x18420b['validate'](_0x2f5040);}catch(_0x160824){throw new AppError_1['default'](_0x160824[_0x3bbba5(0x95)]);}const _0x3b1651=await createContact(_0x3552f4['id'],_0x1fb31b,_0x2f5040[_0x3bbba5(0xa5)],_0x1b55f0,_0x280a51);return _0xc87af9?await Promise['all'](_0xc87af9[_0x3bbba5(0xac)](async _0x1856c3=>{const _0x26bf0a=_0x3bbba5;await(0x0,SendWhatsAppMedia_1[_0x26bf0a(0xb8)])({'body':_0x54f2d1,'media':_0x1856c3,'ticket':_0x3b1651});})):await(0x0,SendWhatsAppMessageAPI_1[_0x3bbba5(0xb8)])({'body':_0x54f2d1,'whatsappId':_0x3552f4['id'],'contact':_0x3b1651[_0x3bbba5(0xcc)],'quotedMsg':_0xd9d7e2,'msdelay':_0x5a129a}),setTimeout(async()=>{const _0x3b2faf=_0x3bbba5,{dateToClient:_0xf80264}=(0x0,useDate_1['useDate'])(),_0x161cb2=_0xf80264(new Date()),_0x11488d=(0x0,moment_1['default'])()[_0x3b2faf(0xbe)]();let _0x4a2b53=await ApiUsages_1[_0x3b2faf(0xb8)][_0x3b2faf(0x7a)]({'where':{'dateUsed':_0x161cb2,'companyId':_0x1fb31b}});_0x4a2b53?_0xc87af9?await Promise[_0x3b2faf(0xb9)](_0xc87af9[_0x3b2faf(0xac)](async _0xa340a1=>{const _0x43356e=_0x3b2faf;if(_0xa340a1[_0x43356e(0xa4)][_0x43356e(0xb2)](_0x43356e(0x87)))await _0x4a2b53['update']({'usedPDF':_0x4a2b53[_0x43356e(0xa6)]['usedPDF']+0x1,'UsedOnDay':_0x4a2b53['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x11488d});else{if(_0xa340a1[_0x43356e(0xa4)]['includes']('image'))await _0x4a2b53[_0x43356e(0x86)]({'usedImage':_0x4a2b53[_0x43356e(0xa6)][_0x43356e(0xc0)]+0x1,'UsedOnDay':_0x4a2b53[_0x43356e(0xa6)][_0x43356e(0xa3)]+0x1,'updatedAt':_0x11488d});else _0xa340a1[_0x43356e(0xa4)][_0x43356e(0xb2)](_0x43356e(0xad))?await _0x4a2b53[_0x43356e(0x86)]({'usedVideo':_0x4a2b53[_0x43356e(0xa6)][_0x43356e(0xc1)]+0x1,'UsedOnDay':_0x4a2b53['dataValues'][_0x43356e(0xa3)]+0x1,'updatedAt':_0x11488d}):await _0x4a2b53[_0x43356e(0x86)]({'usedOther':_0x4a2b53[_0x43356e(0xa6)]['usedOther']+0x1,'UsedOnDay':_0x4a2b53[_0x43356e(0xa6)]['UsedOnDay']+0x1,'updatedAt':_0x11488d});}})):await _0x4a2b53['update']({'usedText':_0x4a2b53[_0x3b2faf(0xa6)]['usedText']+0x1,'UsedOnDay':_0x4a2b53['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x11488d}):(_0x4a2b53=await ApiUsages_1[_0x3b2faf(0xb8)][_0x3b2faf(0x82)]({'companyId':_0x1fb31b,'dateUsed':_0x161cb2}),_0xc87af9?await Promise[_0x3b2faf(0xb9)](_0xc87af9['map'](async _0x588b96=>{const _0xf259b2=_0x3b2faf;if(_0x588b96[_0xf259b2(0xa4)][_0xf259b2(0xb2)](_0xf259b2(0x87)))await _0x4a2b53[_0xf259b2(0x86)]({'usedPDF':_0x4a2b53['dataValues'][_0xf259b2(0x80)]+0x1,'UsedOnDay':_0x4a2b53[_0xf259b2(0xa6)]['UsedOnDay']+0x1,'updatedAt':_0x11488d});else{if(_0x588b96[_0xf259b2(0xa4)][_0xf259b2(0xb2)]('image'))await _0x4a2b53[_0xf259b2(0x86)]({'usedImage':_0x4a2b53[_0xf259b2(0xa6)][_0xf259b2(0xc0)]+0x1,'UsedOnDay':_0x4a2b53[_0xf259b2(0xa6)][_0xf259b2(0xa3)]+0x1,'updatedAt':_0x11488d});else _0x588b96['mimetype'][_0xf259b2(0xb2)](_0xf259b2(0xad))?await _0x4a2b53[_0xf259b2(0x86)]({'usedVideo':_0x4a2b53[_0xf259b2(0xa6)]['usedVideo']+0x1,'UsedOnDay':_0x4a2b53[_0xf259b2(0xa6)]['UsedOnDay']+0x1,'updatedAt':_0x11488d}):await _0x4a2b53['update']({'usedOther':_0x4a2b53[_0xf259b2(0xa6)][_0xf259b2(0x93)]+0x1,'UsedOnDay':_0x4a2b53[_0xf259b2(0xa6)]['UsedOnDay']+0x1,'updatedAt':_0x11488d});}})):await _0x4a2b53['update']({'usedText':_0x4a2b53[_0x3b2faf(0xa6)]['usedText']+0x1,'UsedOnDay':_0x4a2b53[_0x3b2faf(0xa6)]['UsedOnDay']+0x1,'updatedAt':_0x11488d}));},0x64),_0x174b66[_0x3bbba5(0x9d)]({'status':'SUCCESS'});};function a8_0x5a06(_0x23f537,_0x1b3ef8){const _0x5ab0fc=a8_0x5ab0();return a8_0x5a06=function(_0x5a0641,_0x5b25eb){_0x5a0641=_0x5a0641-0x79;let _0x3ad79e=_0x5ab0fc[_0x5a0641];return _0x3ad79e;},a8_0x5a06(_0x23f537,_0x1b3ef8);}exports[a8_0x58fe1e(0xc9)]=index;const indexImage=async(_0x4b9206,_0x33599f)=>{const _0x41a360=a8_0x58fe1e,_0x45cb89=_0x4b9206[_0x41a360(0xcb)],{whatsappId:_0x7aa8a7}=_0x4b9206[_0x41a360(0xcb)],{msdelay:_0x2bdd68}=_0x4b9206['body'],_0x47eabd=_0x4b9206['body']['url'],_0x89b1b2=_0x4b9206[_0x41a360(0xcb)][_0x41a360(0xde)],_0x52ea92=_0x4b9206['headers'][_0x41a360(0x79)],[,_0xce038d]=_0x52ea92[_0x41a360(0x92)]('\x20'),_0x55739e=await Whatsapp_1[_0x41a360(0xb8)]['findOne']({'where':{'token':_0xce038d}}),_0x239055=_0x55739e[_0x41a360(0xc5)];_0x45cb89[_0x41a360(0xa5)]=_0x45cb89[_0x41a360(0xa5)][_0x41a360(0xb5)]('-','')['replace']('\x20','');const _0x511b6e=Yup[_0x41a360(0xbd)]()[_0x41a360(0x8f)]({'number':Yup[_0x41a360(0xa0)]()['required']()['matches'](/^\d+$/,_0x41a360(0x8d))});try{await _0x511b6e['validate'](_0x45cb89);}catch(_0x3f262a){throw new AppError_1[(_0x41a360(0xb8))](_0x3f262a[_0x41a360(0x95)]);}const _0x347337=await createContact(_0x7aa8a7,_0x239055,_0x45cb89[_0x41a360(0xa5)]);return _0x47eabd&&await(0x0,SendWhatsappMediaImage_1['default'])({'ticket':_0x347337,'url':_0x47eabd,'caption':_0x89b1b2,'msdelay':_0x2bdd68}),setTimeout(async()=>{const _0x45e80c=_0x41a360;await(0x0,UpdateTicketService_1[_0x45e80c(0xb8)])({'ticketId':_0x347337['id'],'ticketData':{'status':_0x45e80c(0xbc),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x239055});},0x64),setTimeout(async()=>{const _0xb12b55=_0x41a360,{dateToClient:_0x9db64f}=(0x0,useDate_1[_0xb12b55(0xcd)])(),_0x10e211=_0x9db64f(new Date()),_0x174485=(0x0,moment_1[_0xb12b55(0xb8)])()['format'](),_0x51c9fa=await ApiUsages_1[_0xb12b55(0xb8)][_0xb12b55(0x7a)]({'where':{'dateUsed':_0x10e211,'companyId':_0x239055}});if(_0x51c9fa)await _0x51c9fa[_0xb12b55(0x86)]({'usedImage':_0x51c9fa[_0xb12b55(0xa6)][_0xb12b55(0xc0)]+0x1,'UsedOnDay':_0x51c9fa['dataValues'][_0xb12b55(0xa3)]+0x1,'updatedAt':_0x174485});else{const _0x1cf45b=await ApiUsages_1[_0xb12b55(0xb8)][_0xb12b55(0x82)]({'companyId':_0x239055,'dateUsed':_0x10e211});await _0x1cf45b[_0xb12b55(0x86)]({'usedImage':_0x1cf45b[_0xb12b55(0xa6)]['usedImage']+0x1,'UsedOnDay':_0x1cf45b['dataValues'][_0xb12b55(0xa3)]+0x1,'updatedAt':_0x174485});}},0x64),_0x33599f[_0x41a360(0x9d)]({'status':_0x41a360(0xae)});};exports['indexImage']=indexImage;function a8_0x5ab0(){const _0x4170dc=['findByPk','map','video','SUCCESS','OnWhatsAppDto','indexImage','4ZhTEuP','includes','matches','../services/TicketServices/ShowTicketService','replace','exec','148891vVXUoy','default','all','call','configurable','closed','object','format','../services/WbotServices/CheckNumber','usedImage','usedVideo','../services/WbotServices/CheckIsValidContact','parseInt','../services/WbotServices/SendWhatsAppMessageLink','companyId','__setModuleDefault','files','test','index','prototype','body','contact','useDate','hasOwnProperty','3bWnLqk','validate','Not\x20exists\x20on\x20Whatsapp','checkNumber','json','status','../models/ApiUsages','defineProperty','__esModule','../utils/useDate','../services/TicketServices/FindOrCreateTicketService','moment','\x20not\x20found','jid','../libs/wbot','caption','authorization','findOne','required','req','../models/Whatsapp','yup','../services/WbotServices/SendWhatsappMediaImage','usedPDF','usedCheckNumber','create','exists','log','4120Gjyfcx','update','pdf','__importStar','whatsapp\x20#','__importDefault','../services/WbotServices/GetProfilePicUrl','../helpers/GetDefaultWhatsApp','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','@s.whatsapp.net','shape','user','2426207rYgtrt','split','usedOther','../services/TicketServices/UpdateTicketService','message','indexLink','__createBinding','headers','../services/SettingServices/ListSettingsService','6tyeTbS','423005kpxmuC','14762SeriZA','send','1170aPTSoe','4338dkeetZ','string','3757020cWRTsq','196036MPsmFd','UsedOnDay','mimetype','number','dataValues','indexWhatsappsId','../services/WbotServices/SendWhatsAppMedia','getWbot','onWhatsApp'];a8_0x5ab0=function(){return _0x4170dc;};return a8_0x5ab0();}const checkNumber=async(_0x4f6e1e,_0x59b49e)=>{const _0x537689=a8_0x58fe1e,_0x560664=_0x4f6e1e['body'],_0x21965d=_0x4f6e1e[_0x537689(0x98)]['authorization'],[,_0x5b01ad]=_0x21965d['split']('\x20'),_0x54055c=await Whatsapp_1[_0x537689(0xb8)][_0x537689(0x7a)]({'where':{'token':_0x5b01ad}}),_0x51cc8b=_0x54055c[_0x537689(0xc5)],_0x56a55b=_0x560664['number']['replace']('-','')[_0x537689(0xb5)]('\x20',''),_0x20aa7e=await(0x0,GetDefaultWhatsApp_1['default'])(_0x51cc8b),_0x1ed4ea=(0x0,wbot_1[_0x537689(0xa9)])(_0x20aa7e['id']),_0x5b2b64=createJid(_0x56a55b);try{const [_0x2b78b0]=await _0x1ed4ea[_0x537689(0xaa)](_0x5b2b64);if(_0x2b78b0[_0x537689(0x83)])return setTimeout(async()=>{const _0xc3f355=_0x537689,{dateToClient:_0x3b3db5}=(0x0,useDate_1[_0xc3f355(0xcd)])(),_0x2d6b39=_0x3b3db5(new Date()),_0x5305a9=(0x0,moment_1[_0xc3f355(0xb8)])()[_0xc3f355(0xbe)](),_0x5c374c=await ApiUsages_1['default'][_0xc3f355(0x7a)]({'where':{'dateUsed':_0x2d6b39,'companyId':_0x51cc8b}});if(_0x5c374c)await _0x5c374c[_0xc3f355(0x86)]({'usedCheckNumber':_0x5c374c[_0xc3f355(0xa6)][_0xc3f355(0x81)]+0x1,'UsedOnDay':_0x5c374c[_0xc3f355(0xa6)][_0xc3f355(0xa3)]+0x1,'updatedAt':_0x5305a9});else{const _0x3dd063=await ApiUsages_1[_0xc3f355(0xb8)][_0xc3f355(0x82)]({'companyId':_0x51cc8b,'dateUsed':_0x2d6b39});await _0x3dd063[_0xc3f355(0x86)]({'usedCheckNumber':_0x3dd063[_0xc3f355(0xa6)][_0xc3f355(0x81)]+0x1,'UsedOnDay':_0x3dd063[_0xc3f355(0xa6)][_0xc3f355(0xa3)]+0x1,'updatedAt':_0x5305a9});}},0x64),_0x59b49e[_0x537689(0xd4)](0xc8)[_0x537689(0xd3)]({'existsInWhatsapp':!![],'number':_0x56a55b,'numberFormatted':_0x2b78b0[_0x537689(0xdc)]});}catch(_0x3ce501){return _0x59b49e['status'](0x190)[_0x537689(0xd3)]({'existsInWhatsapp':![],'number':_0x5b2b64,'error':_0x537689(0xd1)});}};exports[a8_0x58fe1e(0xd2)]=checkNumber;const indexWhatsappsId=async(_0x426623,_0xf1dda)=>{const _0x40d52d=a8_0x58fe1e;return console[_0x40d52d(0x84)](_0x40d52d(0x7c),_0x426623),console[_0x40d52d(0x84)](_0x40d52d(0x7c),_0x426623[_0x40d52d(0x90)]),_0xf1dda['status'](0xc8)[_0x40d52d(0xd3)]('oi');};exports[a8_0x58fe1e(0xa7)]=indexWhatsappsId;