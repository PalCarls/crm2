'use strict';const a8_0x175b73=a8_0x4c35;(function(_0x42c992,_0x16e8a0){const _0x4dd319=a8_0x4c35,_0x344837=_0x42c992();while(!![]){try{const _0x11629c=parseInt(_0x4dd319(0x199))/0x1*(-parseInt(_0x4dd319(0x193))/0x2)+-parseInt(_0x4dd319(0x16f))/0x3+-parseInt(_0x4dd319(0x168))/0x4+parseInt(_0x4dd319(0x18b))/0x5+-parseInt(_0x4dd319(0x188))/0x6*(parseInt(_0x4dd319(0x177))/0x7)+parseInt(_0x4dd319(0x18e))/0x8+-parseInt(_0x4dd319(0x195))/0x9*(-parseInt(_0x4dd319(0x196))/0xa);if(_0x11629c===_0x16e8a0)break;else _0x344837['push'](_0x344837['shift']());}catch(_0xe24d5d){_0x344837['push'](_0x344837['shift']());}}}(a8_0x553f,0xdfe6f));var __createBinding=this&&this['__createBinding']||(Object[a8_0x175b73(0x17c)]?function(_0x455e04,_0x3bc2a4,_0x1b35fe,_0x2777ed){const _0x15f091=a8_0x175b73;if(_0x2777ed===undefined)_0x2777ed=_0x1b35fe;var _0x5f07ed=Object[_0x15f091(0x17e)](_0x3bc2a4,_0x1b35fe);(!_0x5f07ed||(_0x15f091(0x180)in _0x5f07ed?!_0x3bc2a4[_0x15f091(0x157)]:_0x5f07ed[_0x15f091(0x16c)]||_0x5f07ed[_0x15f091(0x163)]))&&(_0x5f07ed={'enumerable':!![],'get':function(){return _0x3bc2a4[_0x1b35fe];}}),Object[_0x15f091(0x18f)](_0x455e04,_0x2777ed,_0x5f07ed);}:function(_0x4aef9a,_0x18f796,_0x27473a,_0xe29123){if(_0xe29123===undefined)_0xe29123=_0x27473a;_0x4aef9a[_0xe29123]=_0x18f796[_0x27473a];}),__setModuleDefault=this&&this[a8_0x175b73(0x16d)]||(Object['create']?function(_0x57ff13,_0x21ef82){const _0x4b185b=a8_0x175b73;Object[_0x4b185b(0x18f)](_0x57ff13,_0x4b185b(0x1a1),{'enumerable':!![],'value':_0x21ef82});}:function(_0x57f71d,_0x401cb5){const _0x4f3cb8=a8_0x175b73;_0x57f71d[_0x4f3cb8(0x1a1)]=_0x401cb5;}),__importStar=this&&this[a8_0x175b73(0x1b5)]||function(_0x1981ff){const _0x4db8cb=a8_0x175b73;if(_0x1981ff&&_0x1981ff[_0x4db8cb(0x157)])return _0x1981ff;var _0xedc71={};if(_0x1981ff!=null){for(var _0x26cb28 in _0x1981ff)if(_0x26cb28!==_0x4db8cb(0x1a1)&&Object[_0x4db8cb(0x160)][_0x4db8cb(0x162)][_0x4db8cb(0x16b)](_0x1981ff,_0x26cb28))__createBinding(_0xedc71,_0x1981ff,_0x26cb28);}return __setModuleDefault(_0xedc71,_0x1981ff),_0xedc71;},__importDefault=this&&this[a8_0x175b73(0x1b4)]||function(_0x146166){const _0x5e65e3=a8_0x175b73;return _0x146166&&_0x146166[_0x5e65e3(0x157)]?_0x146166:{'default':_0x146166};};Object[a8_0x175b73(0x18f)](exports,'__esModule',{'value':!![]}),exports[a8_0x175b73(0x175)]=exports[a8_0x175b73(0x161)]=exports[a8_0x175b73(0x1a8)]=exports[a8_0x175b73(0x17a)]=exports[a8_0x175b73(0x1aa)]=exports[a8_0x175b73(0x169)]=void 0x0;const Yup=__importStar(require(a8_0x175b73(0x1b8))),AppError_1=__importDefault(require(a8_0x175b73(0x158))),GetDefaultWhatsApp_1=__importDefault(require(a8_0x175b73(0x156))),SetTicketMessagesAsRead_1=__importDefault(require(a8_0x175b73(0x1b0))),Whatsapp_1=__importDefault(require(a8_0x175b73(0x18a))),CreateOrUpdateContactService_1=__importDefault(require('../services/ContactServices/CreateOrUpdateContactService')),FindOrCreateTicketService_1=__importDefault(require(a8_0x175b73(0x15c))),ShowTicketService_1=__importDefault(require('../services/TicketServices/ShowTicketService')),CheckIsValidContact_1=__importDefault(require('../services/WbotServices/CheckIsValidContact')),CheckNumber_1=__importDefault(require(a8_0x175b73(0x16e))),GetProfilePicUrl_1=__importDefault(require(a8_0x175b73(0x19e))),SendWhatsAppMedia_1=__importDefault(require(a8_0x175b73(0x174))),UpdateTicketService_1=__importDefault(require(a8_0x175b73(0x1a4))),wbot_1=require('../libs/wbot'),SendWhatsAppMessageLink_1=__importDefault(require(a8_0x175b73(0x155))),SendWhatsAppMessageAPI_1=__importDefault(require('../services/WbotServices/SendWhatsAppMessageAPI')),SendWhatsappMediaImage_1=__importDefault(require(a8_0x175b73(0x1ba))),ApiUsages_1=__importDefault(require(a8_0x175b73(0x183))),useDate_1=require(a8_0x175b73(0x166)),moment_1=__importDefault(require(a8_0x175b73(0x1ab))),CompaniesSettings_1=__importDefault(require('../models/CompaniesSettings'));class OnWhatsAppDto{constructor(_0x4a8cba,_0x1baa79){const _0x461b7d=a8_0x175b73;this['jid']=_0x4a8cba,this[_0x461b7d(0x176)]=_0x1baa79;}}exports[a8_0x175b73(0x169)]=OnWhatsAppDto;const createContact=async(_0x4cf22c,_0x42eb7a,_0x3472a2,_0x428361,_0x480626)=>{const _0x3ff5e3=a8_0x175b73;await(0x0,CheckIsValidContact_1[_0x3ff5e3(0x1a1)])(_0x3472a2,_0x42eb7a);const _0x1391f8=await(0x0,CheckNumber_1['default'])(_0x3472a2,_0x42eb7a),_0x5799b5=await(0x0,GetProfilePicUrl_1[_0x3ff5e3(0x1a1)])(_0x1391f8,_0x42eb7a),_0x14ab12=_0x1391f8,_0x56474f={'name':''+_0x14ab12,'number':_0x14ab12,'profilePicUrl':_0x5799b5,'isGroup':![],'companyId':_0x42eb7a},_0x473b9d=await(0x0,CreateOrUpdateContactService_1[_0x3ff5e3(0x1a1)])(_0x56474f),_0x4996d3=await CompaniesSettings_1[_0x3ff5e3(0x1a1)][_0x3ff5e3(0x1bb)]({'where':{'companyId':_0x42eb7a}});let _0x51baae;if(_0x4cf22c===undefined)_0x51baae=await(0x0,GetDefaultWhatsApp_1[_0x3ff5e3(0x1a1)])(_0x42eb7a);else{_0x51baae=await Whatsapp_1['default'][_0x3ff5e3(0x165)](_0x4cf22c);if(_0x51baae===null)throw new AppError_1['default'](_0x3ff5e3(0x17d)+_0x4cf22c+_0x3ff5e3(0x15a));}const {ticket:_0x70b651,isCreated:_0x1d1fa9}=await(0x0,FindOrCreateTicketService_1['default'])(_0x473b9d,_0x51baae,0x0,_0x42eb7a,_0x480626,_0x428361,null,_0x3ff5e3(0x1b1),null,![],_0x4996d3),_0x1f5a6c=await(0x0,ShowTicketService_1[_0x3ff5e3(0x1a1)])(_0x70b651['id'],_0x42eb7a);return(0x0,SetTicketMessagesAsRead_1[_0x3ff5e3(0x1a1)])(_0x1f5a6c),_0x1f5a6c;};function formatBRNumber(_0x1a71c3){const _0xb425ac=a8_0x175b73,_0x16deba=new RegExp(/^(\d{2})(\d{2})\d{1}(\d{8})$/);if(_0x16deba[_0xb425ac(0x171)](_0x1a71c3)){const _0x53086a=_0x16deba[_0xb425ac(0x179)](_0x1a71c3);if(_0x53086a&&_0x53086a[0x1]==='55'&&Number['isInteger'](Number[_0xb425ac(0x1a6)](_0x53086a[0x2]))){const _0x3296da=Number[_0xb425ac(0x1a6)](_0x53086a[0x2]);if(_0x3296da<0x1f)return _0x53086a[0x0];else{if(_0x3296da>=0x1f)return _0x53086a[0x1]+_0x53086a[0x2]+_0x53086a[0x3];}}}else return _0x1a71c3;}function createJid(_0x126d7b){const _0x14d03d=a8_0x175b73;if(_0x126d7b[_0x14d03d(0x15b)](_0x14d03d(0x1ac))||_0x126d7b[_0x14d03d(0x15b)](_0x14d03d(0x191)))return formatBRNumber(_0x126d7b);return _0x126d7b[_0x14d03d(0x15b)]('-')?_0x126d7b+_0x14d03d(0x1ac):formatBRNumber(_0x126d7b)+_0x14d03d(0x191);}const indexLink=async(_0x981d85,_0x1c3f40)=>{const _0x425b2a=a8_0x175b73,_0x202487=_0x981d85[_0x425b2a(0x1b6)],{whatsappId:_0x595afe}=_0x981d85[_0x425b2a(0x1b6)],{msdelay:_0x1b019d}=_0x981d85[_0x425b2a(0x1b6)],_0x5c3509=_0x981d85[_0x425b2a(0x1b6)][_0x425b2a(0x182)],_0x35b919=_0x981d85[_0x425b2a(0x1b6)][_0x425b2a(0x18c)],_0x30edcf=_0x981d85[_0x425b2a(0x19b)][_0x425b2a(0x198)],[,_0x4b11bc]=_0x30edcf['split']('\x20'),_0x3d6a1c=await Whatsapp_1[_0x425b2a(0x1a1)][_0x425b2a(0x1bb)]({'where':{'token':_0x4b11bc}}),_0x564f20=_0x3d6a1c['companyId'];_0x202487[_0x425b2a(0x164)]=_0x202487['number'][_0x425b2a(0x16a)]('-','')['replace']('\x20','');const _0x2c41cc=Yup['object']()[_0x425b2a(0x172)]({'number':Yup[_0x425b2a(0x184)]()[_0x425b2a(0x185)]()[_0x425b2a(0x19c)](/^\d+$/,_0x425b2a(0x170))});try{await _0x2c41cc['validate'](_0x202487);}catch(_0x4d3f0e){throw new AppError_1['default'](_0x4d3f0e['message']);}const _0x27442e=await createContact(_0x595afe,_0x564f20,_0x202487[_0x425b2a(0x164)]);return await(0x0,SendWhatsAppMessageLink_1[_0x425b2a(0x1a1)])({'whatsappId':_0x595afe,'contact':_0x27442e[_0x425b2a(0x189)],'url':_0x5c3509,'caption':_0x35b919,'msdelay':_0x1b019d}),setTimeout(async()=>{const _0x39ebea=_0x425b2a,{dateToClient:_0x53c203}=(0x0,useDate_1[_0x39ebea(0x17f)])(),_0x2b880a=_0x53c203(new Date()),_0x21f588=(0x0,moment_1[_0x39ebea(0x1a1)])()[_0x39ebea(0x1b3)](),_0x18d0e0=await ApiUsages_1[_0x39ebea(0x1a1)]['findOne']({'where':{'dateUsed':_0x2b880a,'companyId':_0x564f20}});if(_0x18d0e0)await _0x18d0e0[_0x39ebea(0x17b)]({'usedPDF':_0x18d0e0[_0x39ebea(0x159)]['usedPDF']+0x1,'UsedOnDay':_0x18d0e0[_0x39ebea(0x159)][_0x39ebea(0x19d)]+0x1,'updatedAt':_0x21f588});else{const _0x1a97b9=await ApiUsages_1[_0x39ebea(0x1a1)][_0x39ebea(0x17c)]({'companyId':_0x564f20,'dateUsed':_0x2b880a});await _0x1a97b9[_0x39ebea(0x17b)]({'usedPDF':_0x1a97b9[_0x39ebea(0x159)]['usedPDF']+0x1,'UsedOnDay':_0x1a97b9['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x21f588});}},0x64),_0x1c3f40[_0x425b2a(0x1a2)]({'status':_0x425b2a(0x1af)});};exports['indexLink']=indexLink;function a8_0x4c35(_0x378071,_0xf35b8){const _0x553fa3=a8_0x553f();return a8_0x4c35=function(_0x4c3537,_0x19dd57){_0x4c3537=_0x4c3537-0x155;let _0x38f383=_0x553fa3[_0x4c3537];return _0x38f383;},a8_0x4c35(_0x378071,_0xf35b8);}const index=async(_0x5efe9a,_0x252567)=>{const _0xdbeb64=a8_0x175b73,_0x32d3de=_0x5efe9a[_0xdbeb64(0x1b6)],{whatsappId:_0x534156}=_0x5efe9a['body'],{msdelay:_0x46b6a1}=_0x5efe9a[_0xdbeb64(0x1b6)],{body:_0x3a04a0,quotedMsg:_0x55b892,userId:_0x35a47a,queueId:_0x2a2f6a}=_0x5efe9a[_0xdbeb64(0x1b6)],_0x25025f=_0x5efe9a[_0xdbeb64(0x19f)],_0x5cf3f0=_0x5efe9a[_0xdbeb64(0x19b)][_0xdbeb64(0x198)],[,_0x224713]=_0x5cf3f0[_0xdbeb64(0x19a)]('\x20'),_0x4bb90c=await Whatsapp_1[_0xdbeb64(0x1a1)]['findOne']({'where':{'token':_0x224713}}),_0x22d79a=_0x4bb90c[_0xdbeb64(0x15e)];_0x32d3de[_0xdbeb64(0x164)]=_0x32d3de[_0xdbeb64(0x164)]['replace']('-','')[_0xdbeb64(0x16a)]('\x20','');const _0xfe0a68=Yup['object']()[_0xdbeb64(0x172)]({'number':Yup['string']()[_0xdbeb64(0x185)]()['matches'](/^\d+$/,_0xdbeb64(0x170))});try{await _0xfe0a68[_0xdbeb64(0x167)](_0x32d3de);}catch(_0x315ddf){throw new AppError_1['default'](_0x315ddf[_0xdbeb64(0x15f)]);}const _0x377f4d=await createContact(_0x4bb90c['id'],_0x22d79a,_0x32d3de['number'],_0x35a47a,_0x2a2f6a);return _0x25025f?await Promise[_0xdbeb64(0x190)](_0x25025f[_0xdbeb64(0x1ae)](async _0x1b1c74=>{const _0x49aa2=_0xdbeb64;await(0x0,SendWhatsAppMedia_1[_0x49aa2(0x1a1)])({'body':_0x3a04a0,'media':_0x1b1c74,'ticket':_0x377f4d,'isForwarded':![]});})):await(0x0,SendWhatsAppMessageAPI_1[_0xdbeb64(0x1a1)])({'body':_0x3a04a0,'whatsappId':_0x4bb90c['id'],'contact':_0x377f4d[_0xdbeb64(0x189)],'quotedMsg':_0x55b892,'msdelay':_0x46b6a1}),setTimeout(async()=>{const _0xf81254=_0xdbeb64,{dateToClient:_0x454559}=(0x0,useDate_1[_0xf81254(0x17f)])(),_0x4306ed=_0x454559(new Date()),_0x25d9bc=(0x0,moment_1[_0xf81254(0x1a1)])()[_0xf81254(0x1b3)]();let _0x204408=await ApiUsages_1[_0xf81254(0x1a1)][_0xf81254(0x1bb)]({'where':{'dateUsed':_0x4306ed,'companyId':_0x22d79a}});_0x204408?_0x25025f?await Promise[_0xf81254(0x190)](_0x25025f[_0xf81254(0x1ae)](async _0x103e13=>{const _0x5189c1=_0xf81254;if(_0x103e13['mimetype'][_0x5189c1(0x15b)](_0x5189c1(0x181)))await _0x204408[_0x5189c1(0x17b)]({'usedPDF':_0x204408['dataValues']['usedPDF']+0x1,'UsedOnDay':_0x204408['dataValues'][_0x5189c1(0x19d)]+0x1,'updatedAt':_0x25d9bc});else{if(_0x103e13[_0x5189c1(0x1b9)][_0x5189c1(0x15b)](_0x5189c1(0x187)))await _0x204408[_0x5189c1(0x17b)]({'usedImage':_0x204408[_0x5189c1(0x159)][_0x5189c1(0x173)]+0x1,'UsedOnDay':_0x204408[_0x5189c1(0x159)][_0x5189c1(0x19d)]+0x1,'updatedAt':_0x25d9bc});else _0x103e13['mimetype'][_0x5189c1(0x15b)](_0x5189c1(0x1b7))?await _0x204408['update']({'usedVideo':_0x204408[_0x5189c1(0x159)]['usedVideo']+0x1,'UsedOnDay':_0x204408[_0x5189c1(0x159)]['UsedOnDay']+0x1,'updatedAt':_0x25d9bc}):await _0x204408[_0x5189c1(0x17b)]({'usedOther':_0x204408[_0x5189c1(0x159)][_0x5189c1(0x15d)]+0x1,'UsedOnDay':_0x204408[_0x5189c1(0x159)][_0x5189c1(0x19d)]+0x1,'updatedAt':_0x25d9bc});}})):await _0x204408[_0xf81254(0x17b)]({'usedText':_0x204408[_0xf81254(0x159)][_0xf81254(0x18d)]+0x1,'UsedOnDay':_0x204408[_0xf81254(0x159)][_0xf81254(0x19d)]+0x1,'updatedAt':_0x25d9bc}):(_0x204408=await ApiUsages_1['default']['create']({'companyId':_0x22d79a,'dateUsed':_0x4306ed}),_0x25025f?await Promise['all'](_0x25025f[_0xf81254(0x1ae)](async _0x261e48=>{const _0x4c0636=_0xf81254;if(_0x261e48[_0x4c0636(0x1b9)]['includes'](_0x4c0636(0x181)))await _0x204408[_0x4c0636(0x17b)]({'usedPDF':_0x204408['dataValues'][_0x4c0636(0x1a0)]+0x1,'UsedOnDay':_0x204408[_0x4c0636(0x159)][_0x4c0636(0x19d)]+0x1,'updatedAt':_0x25d9bc});else{if(_0x261e48['mimetype'][_0x4c0636(0x15b)](_0x4c0636(0x187)))await _0x204408[_0x4c0636(0x17b)]({'usedImage':_0x204408['dataValues'][_0x4c0636(0x173)]+0x1,'UsedOnDay':_0x204408[_0x4c0636(0x159)][_0x4c0636(0x19d)]+0x1,'updatedAt':_0x25d9bc});else _0x261e48[_0x4c0636(0x1b9)][_0x4c0636(0x15b)](_0x4c0636(0x1b7))?await _0x204408[_0x4c0636(0x17b)]({'usedVideo':_0x204408[_0x4c0636(0x159)][_0x4c0636(0x1b2)]+0x1,'UsedOnDay':_0x204408[_0x4c0636(0x159)][_0x4c0636(0x19d)]+0x1,'updatedAt':_0x25d9bc}):await _0x204408[_0x4c0636(0x17b)]({'usedOther':_0x204408[_0x4c0636(0x159)][_0x4c0636(0x15d)]+0x1,'UsedOnDay':_0x204408['dataValues'][_0x4c0636(0x19d)]+0x1,'updatedAt':_0x25d9bc});}})):await _0x204408[_0xf81254(0x17b)]({'usedText':_0x204408[_0xf81254(0x159)]['usedText']+0x1,'UsedOnDay':_0x204408[_0xf81254(0x159)][_0xf81254(0x19d)]+0x1,'updatedAt':_0x25d9bc}));},0x64),_0x252567[_0xdbeb64(0x1a2)]({'status':_0xdbeb64(0x1af)});};exports[a8_0x175b73(0x17a)]=index;const indexImage=async(_0x45d484,_0x47ca73)=>{const _0x3712bf=a8_0x175b73,_0x52c82a=_0x45d484[_0x3712bf(0x1b6)],{whatsappId:_0x4ab708}=_0x45d484[_0x3712bf(0x1b6)],{msdelay:_0x588acb}=_0x45d484['body'],_0x47ee43=_0x45d484[_0x3712bf(0x1b6)][_0x3712bf(0x182)],_0x345eb4=_0x45d484[_0x3712bf(0x1b6)][_0x3712bf(0x18c)],_0x410a78=_0x45d484['headers'][_0x3712bf(0x198)],[,_0x438364]=_0x410a78[_0x3712bf(0x19a)]('\x20'),_0x40847f=await Whatsapp_1['default'][_0x3712bf(0x1bb)]({'where':{'token':_0x438364}}),_0x29b089=_0x40847f['companyId'];_0x52c82a['number']=_0x52c82a['number'][_0x3712bf(0x16a)]('-','')[_0x3712bf(0x16a)]('\x20','');const _0xeafc0a=Yup['object']()[_0x3712bf(0x172)]({'number':Yup[_0x3712bf(0x184)]()[_0x3712bf(0x185)]()[_0x3712bf(0x19c)](/^\d+$/,_0x3712bf(0x170))});try{await _0xeafc0a[_0x3712bf(0x167)](_0x52c82a);}catch(_0x39c793){throw new AppError_1[(_0x3712bf(0x1a1))](_0x39c793[_0x3712bf(0x15f)]);}const _0xe1915=await createContact(_0x4ab708,_0x29b089,_0x52c82a[_0x3712bf(0x164)]);return _0x47ee43&&await(0x0,SendWhatsappMediaImage_1[_0x3712bf(0x1a1)])({'ticket':_0xe1915,'url':_0x47ee43,'caption':_0x345eb4,'msdelay':_0x588acb}),setTimeout(async()=>{const _0x16ee34=_0x3712bf;await(0x0,UpdateTicketService_1[_0x16ee34(0x1a1)])({'ticketId':_0xe1915['id'],'ticketData':{'status':_0x16ee34(0x194),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x29b089});},0x64),setTimeout(async()=>{const _0x315f73=_0x3712bf,{dateToClient:_0x562c9b}=(0x0,useDate_1['useDate'])(),_0x4acfaa=_0x562c9b(new Date()),_0xc6a9e7=(0x0,moment_1[_0x315f73(0x1a1)])()['format'](),_0x199c08=await ApiUsages_1[_0x315f73(0x1a1)][_0x315f73(0x1bb)]({'where':{'dateUsed':_0x4acfaa,'companyId':_0x29b089}});if(_0x199c08)await _0x199c08[_0x315f73(0x17b)]({'usedImage':_0x199c08[_0x315f73(0x159)][_0x315f73(0x173)]+0x1,'UsedOnDay':_0x199c08[_0x315f73(0x159)][_0x315f73(0x19d)]+0x1,'updatedAt':_0xc6a9e7});else{const _0x33f107=await ApiUsages_1['default'][_0x315f73(0x17c)]({'companyId':_0x29b089,'dateUsed':_0x4acfaa});await _0x33f107[_0x315f73(0x17b)]({'usedImage':_0x33f107[_0x315f73(0x159)]['usedImage']+0x1,'UsedOnDay':_0x33f107[_0x315f73(0x159)][_0x315f73(0x19d)]+0x1,'updatedAt':_0xc6a9e7});}},0x64),_0x47ca73[_0x3712bf(0x1a2)]({'status':_0x3712bf(0x1af)});};exports[a8_0x175b73(0x1a8)]=indexImage;const checkNumber=async(_0x19b7ff,_0x4ba14a)=>{const _0x47a9d2=a8_0x175b73,_0x2dfbe4=_0x19b7ff[_0x47a9d2(0x1b6)],_0x5a4ec3=_0x19b7ff[_0x47a9d2(0x19b)][_0x47a9d2(0x198)],[,_0x45cb43]=_0x5a4ec3[_0x47a9d2(0x19a)]('\x20'),_0x2c3efe=await Whatsapp_1['default'][_0x47a9d2(0x1bb)]({'where':{'token':_0x45cb43}}),_0x30aca8=_0x2c3efe['companyId'],_0x59c777=_0x2dfbe4[_0x47a9d2(0x164)][_0x47a9d2(0x16a)]('-','')['replace']('\x20',''),_0x279648=await(0x0,GetDefaultWhatsApp_1['default'])(_0x30aca8),_0x3a5855=(0x0,wbot_1[_0x47a9d2(0x186)])(_0x279648['id']),_0x11cdf6=createJid(_0x59c777);try{const [_0x297e29]=await _0x3a5855[_0x47a9d2(0x1a3)](_0x11cdf6);if(_0x297e29[_0x47a9d2(0x176)])return setTimeout(async()=>{const _0x4800e2=_0x47a9d2,{dateToClient:_0xa885a7}=(0x0,useDate_1[_0x4800e2(0x17f)])(),_0x5dd6f0=_0xa885a7(new Date()),_0x52b0ec=(0x0,moment_1[_0x4800e2(0x1a1)])()['format'](),_0x4e87ef=await ApiUsages_1['default'][_0x4800e2(0x1bb)]({'where':{'dateUsed':_0x5dd6f0,'companyId':_0x30aca8}});if(_0x4e87ef)await _0x4e87ef['update']({'usedCheckNumber':_0x4e87ef[_0x4800e2(0x159)][_0x4800e2(0x197)]+0x1,'UsedOnDay':_0x4e87ef[_0x4800e2(0x159)][_0x4800e2(0x19d)]+0x1,'updatedAt':_0x52b0ec});else{const _0x14cf75=await ApiUsages_1['default']['create']({'companyId':_0x30aca8,'dateUsed':_0x5dd6f0});await _0x14cf75[_0x4800e2(0x17b)]({'usedCheckNumber':_0x14cf75[_0x4800e2(0x159)]['usedCheckNumber']+0x1,'UsedOnDay':_0x14cf75['dataValues'][_0x4800e2(0x19d)]+0x1,'updatedAt':_0x52b0ec});}},0x64),_0x4ba14a[_0x47a9d2(0x1a9)](0xc8)[_0x47a9d2(0x1a7)]({'existsInWhatsapp':!![],'number':_0x59c777,'numberFormatted':_0x297e29[_0x47a9d2(0x192)]});}catch(_0x39be28){return _0x4ba14a[_0x47a9d2(0x1a9)](0x190)['json']({'existsInWhatsapp':![],'number':_0x11cdf6,'error':_0x47a9d2(0x178)});}};function a8_0x553f(){const _0x417ff4=['companyId','message','prototype','checkNumber','hasOwnProperty','configurable','number','findByPk','../utils/useDate','validate','6987968UJkxUu','OnWhatsAppDto','replace','call','writable','__setModuleDefault','../services/WbotServices/CheckNumber','4047306mIQXQx','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','test','shape','usedImage','../services/WbotServices/SendWhatsAppMedia','indexWhatsappsId','exists','1343804FlsKkS','Not\x20exists\x20on\x20Whatsapp','exec','index','update','create','whatsapp\x20#','getOwnPropertyDescriptor','useDate','get','pdf','url','../models/ApiUsages','string','required','getWbot','image','42osJtiC','contact','../models/Whatsapp','7787305IeFEPU','caption','usedText','8031424qZBxKY','defineProperty','all','@s.whatsapp.net','jid','32kIokVH','closed','2052CmAnqM','128110NyyyIz','usedCheckNumber','authorization','7831TyqEjx','split','headers','matches','UsedOnDay','../services/WbotServices/GetProfilePicUrl','files','usedPDF','default','send','onWhatsApp','../services/TicketServices/UpdateTicketService','req','parseInt','json','indexImage','status','indexLink','moment','@g.us','log','map','SUCCESS','../helpers/SetTicketMessagesAsRead','whatsapp','usedVideo','format','__importDefault','__importStar','body','video','yup','mimetype','../services/WbotServices/SendWhatsappMediaImage','findOne','../services/WbotServices/SendWhatsAppMessageLink','../helpers/GetDefaultWhatsApp','__esModule','../errors/AppError','dataValues','\x20not\x20found','includes','../services/TicketServices/FindOrCreateTicketService','usedOther'];a8_0x553f=function(){return _0x417ff4;};return a8_0x553f();}exports[a8_0x175b73(0x161)]=checkNumber;const indexWhatsappsId=async(_0x2e8988,_0x4f2d87)=>{const _0x1de76d=a8_0x175b73;return console[_0x1de76d(0x1ad)]('req',_0x2e8988),console['log'](_0x1de76d(0x1a5),_0x2e8988['user']),_0x4f2d87[_0x1de76d(0x1a9)](0xc8)['json']('oi');};exports[a8_0x175b73(0x175)]=indexWhatsappsId;