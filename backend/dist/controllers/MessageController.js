'use strict';function a23_0x53e4(_0xd1b2cd,_0x25f105){const _0x260ac9=a23_0x260a();return a23_0x53e4=function(_0x53e47a,_0x3e8848){_0x53e47a=_0x53e47a-0x126;let _0x5d8369=_0x260ac9[_0x53e47a];return _0x5d8369;},a23_0x53e4(_0xd1b2cd,_0x25f105);}const a23_0x1a3b34=a23_0x53e4;(function(_0xef07c7,_0x3974f2){const _0x36b55a=a23_0x53e4,_0x5a6d36=_0xef07c7();while(!![]){try{const _0x5c985c=-parseInt(_0x36b55a(0x15a))/0x1*(-parseInt(_0x36b55a(0x144))/0x2)+-parseInt(_0x36b55a(0x127))/0x3*(-parseInt(_0x36b55a(0x15d))/0x4)+parseInt(_0x36b55a(0x18e))/0x5+parseInt(_0x36b55a(0x167))/0x6+-parseInt(_0x36b55a(0x19b))/0x7+-parseInt(_0x36b55a(0x1a7))/0x8+parseInt(_0x36b55a(0x191))/0x9*(parseInt(_0x36b55a(0x131))/0xa);if(_0x5c985c===_0x3974f2)break;else _0x5a6d36['push'](_0x5a6d36['shift']());}catch(_0x593338){_0x5a6d36['push'](_0x5a6d36['shift']());}}}(a23_0x260a,0xe714f));var __createBinding=this&&this[a23_0x1a3b34(0x1a2)]||(Object[a23_0x1a3b34(0x16a)]?function(_0x2b6fea,_0x19fd17,_0x41f11d,_0x1c42a){const _0x14bc2d=a23_0x1a3b34;if(_0x1c42a===undefined)_0x1c42a=_0x41f11d;var _0x5e5eea=Object[_0x14bc2d(0x168)](_0x19fd17,_0x41f11d);(!_0x5e5eea||(_0x14bc2d(0x16e)in _0x5e5eea?!_0x19fd17[_0x14bc2d(0x162)]:_0x5e5eea[_0x14bc2d(0x178)]||_0x5e5eea[_0x14bc2d(0x1a6)]))&&(_0x5e5eea={'enumerable':!![],'get':function(){return _0x19fd17[_0x41f11d];}}),Object[_0x14bc2d(0x17a)](_0x2b6fea,_0x1c42a,_0x5e5eea);}:function(_0x1a63d8,_0x5225d9,_0x4b112d,_0x413c31){if(_0x413c31===undefined)_0x413c31=_0x4b112d;_0x1a63d8[_0x413c31]=_0x5225d9[_0x4b112d];}),__setModuleDefault=this&&this[a23_0x1a3b34(0x161)]||(Object[a23_0x1a3b34(0x16a)]?function(_0x3db846,_0x21ba0c){const _0x191e09=a23_0x1a3b34;Object[_0x191e09(0x17a)](_0x3db846,'default',{'enumerable':!![],'value':_0x21ba0c});}:function(_0x31e604,_0xcbfac3){_0x31e604['default']=_0xcbfac3;}),__importStar=this&&this['__importStar']||function(_0x3e0d13){const _0x5da94c=a23_0x1a3b34;if(_0x3e0d13&&_0x3e0d13[_0x5da94c(0x162)])return _0x3e0d13;var _0xb5a9ce={};if(_0x3e0d13!=null){for(var _0x2b6710 in _0x3e0d13)if(_0x2b6710!=='default'&&Object[_0x5da94c(0x13e)][_0x5da94c(0x148)][_0x5da94c(0x192)](_0x3e0d13,_0x2b6710))__createBinding(_0xb5a9ce,_0x3e0d13,_0x2b6710);}return __setModuleDefault(_0xb5a9ce,_0x3e0d13),_0xb5a9ce;},__importDefault=this&&this[a23_0x1a3b34(0x12f)]||function(_0xc8a7d5){const _0x5dab45=a23_0x1a3b34;return _0xc8a7d5&&_0xc8a7d5[_0x5dab45(0x162)]?_0xc8a7d5:{'default':_0xc8a7d5};};Object['defineProperty'](exports,a23_0x1a3b34(0x162),{'value':!![]}),exports[a23_0x1a3b34(0x186)]=exports[a23_0x1a3b34(0x160)]=exports[a23_0x1a3b34(0x1a8)]=exports['forwardMessage']=exports[a23_0x1a3b34(0x133)]=exports[a23_0x1a3b34(0x180)]=exports[a23_0x1a3b34(0x15b)]=void 0x0;const AppError_1=__importDefault(require(a23_0x1a3b34(0x18a))),SetTicketMessagesAsRead_1=__importDefault(require(a23_0x1a3b34(0x15e))),socket_1=require('../libs/socket'),Message_1=__importDefault(require('../models/Message')),Queue_1=__importDefault(require(a23_0x1a3b34(0x13c))),User_1=__importDefault(require(a23_0x1a3b34(0x19d))),Whatsapp_1=__importDefault(require(a23_0x1a3b34(0x12b))),jsonwebtoken_1=require(a23_0x1a3b34(0x151)),auth_1=__importDefault(require(a23_0x1a3b34(0x181))),path_1=__importDefault(require('path')),lodash_1=require(a23_0x1a3b34(0x16d)),ListMessagesService_1=__importDefault(require(a23_0x1a3b34(0x173))),ShowTicketService_1=__importDefault(require(a23_0x1a3b34(0x1a4))),DeleteWhatsAppMessage_1=__importDefault(require(a23_0x1a3b34(0x19c))),SendWhatsAppMedia_1=__importDefault(require('../services/WbotServices/SendWhatsAppMedia')),SendWhatsAppMessage_1=__importDefault(require('../services/WbotServices/SendWhatsAppMessage')),CreateMessageService_1=__importDefault(require('../services/MessageServices/CreateMessageService')),sendFacebookMessageMedia_1=__importDefault(require(a23_0x1a3b34(0x1a5))),sendFacebookMessage_1=__importDefault(require(a23_0x1a3b34(0x17c))),ShowPlanCompanyService_1=__importDefault(require(a23_0x1a3b34(0x17e))),ListMessagesServiceAll_1=__importDefault(require('../services/MessageServices/ListMessagesServiceAll')),ShowContactService_1=__importDefault(require(a23_0x1a3b34(0x156))),FindOrCreateTicketService_1=__importDefault(require(a23_0x1a3b34(0x183))),UpdateTicketService_1=__importDefault(require(a23_0x1a3b34(0x176))),ShowMessageService_1=__importStar(require(a23_0x1a3b34(0x18c))),CompaniesSettings_1=__importDefault(require(a23_0x1a3b34(0x189))),index=async(_0x510b41,_0x4f7f33)=>{const _0x2f6d27=a23_0x1a3b34,{ticketId:_0x27db5e}=_0x510b41[_0x2f6d27(0x165)],{pageNumber:_0x56608a,selectedQueues:_0x90f6e4}=_0x510b41[_0x2f6d27(0x12a)],{companyId:_0x33e393,profile:_0x4c96f8}=_0x510b41[_0x2f6d27(0x1a3)];let _0x990eef=[];const _0x3c3d93=await User_1['default'][_0x2f6d27(0x145)](_0x510b41['user']['id'],{'include':[{'model':Queue_1[_0x2f6d27(0x166)],'as':_0x2f6d27(0x12c)}]});_0x90f6e4?_0x990eef=JSON[_0x2f6d27(0x157)](_0x90f6e4):_0x3c3d93[_0x2f6d27(0x12c)][_0x2f6d27(0x128)](_0x51bdae=>{const _0x1d8ebf=_0x2f6d27;_0x990eef[_0x1d8ebf(0x187)](_0x51bdae['id']);});const {count:_0x3d4e66,messages:_0x43504c,ticket:_0x509f6f,hasMore:_0x204f67}=await(0x0,ListMessagesService_1[_0x2f6d27(0x166)])({'pageNumber':_0x56608a,'ticketId':_0x27db5e,'companyId':_0x33e393,'queues':_0x990eef,'user':_0x3c3d93});return _0x509f6f[_0x2f6d27(0x13d)]===_0x2f6d27(0x18d)&&(0x0,SetTicketMessagesAsRead_1[_0x2f6d27(0x166)])(_0x509f6f),_0x4f7f33[_0x2f6d27(0x14d)]({'count':_0x3d4e66,'messages':_0x43504c,'ticket':_0x509f6f,'hasMore':_0x204f67});};exports['index']=index;function obterNomeEExtensaoDoArquivo(_0x5def22){const _0x242b94=a23_0x1a3b34;var _0x253826=new URL(_0x5def22),_0xb0dd2f=_0x253826[_0x242b94(0x196)],_0x12c868=_0xb0dd2f[_0x242b94(0x13f)]('/')[_0x242b94(0x140)](),_0x1a2519=_0x12c868['split']('.'),_0x11ca7e=_0x1a2519[0x0],_0xb2cabc=_0x1a2519[0x1];return _0x11ca7e+'.'+_0xb2cabc;}const store=async(_0x28f42d,_0x252d0c)=>{const _0x31f129=a23_0x1a3b34,{ticketId:_0x1aa93d}=_0x28f42d[_0x31f129(0x165)],{body:_0x41364f,quotedMsg:_0x24d666,isPrivate:_0xf7225b,vCard:_0x3fadec}=_0x28f42d[_0x31f129(0x185)],_0x55bb18=_0x28f42d[_0x31f129(0x130)],{companyId:_0x2cf8b0}=_0x28f42d[_0x31f129(0x1a3)],_0x379bae=await(0x0,ShowTicketService_1[_0x31f129(0x166)])(_0x1aa93d,_0x2cf8b0);_0x379bae[_0x31f129(0x13d)]==='whatsapp'&&(0x0,SetTicketMessagesAsRead_1[_0x31f129(0x166)])(_0x379bae);try{if(_0x55bb18)await Promise['all'](_0x55bb18[_0x31f129(0x126)](async _0x1552f9=>{const _0x24d441=_0x31f129;_0x379bae[_0x24d441(0x13d)]==='whatsapp'&&await(0x0,SendWhatsAppMedia_1[_0x24d441(0x166)])({'media':_0x1552f9,'ticket':_0x379bae,'body':'','isPrivate':/\u200d/['test'](_0x41364f),'isForwarded':![]});if(_0x379bae[_0x24d441(0x13d)]===_0x24d441(0x182)||_0x379bae[_0x24d441(0x13d)]===_0x24d441(0x136))try{await(0x0,sendFacebookMessageMedia_1['default'])({'media':_0x1552f9,'ticket':_0x379bae});}catch(_0x2baeb1){console[_0x24d441(0x1a0)](_0x2baeb1);}}));else{_0x379bae[_0x31f129(0x13d)]===_0x31f129(0x18d)&&!_0xf7225b&&await(0x0,SendWhatsAppMessage_1[_0x31f129(0x166)])({'body':_0x41364f,'ticket':_0x379bae,'quotedMsg':_0x24d666,'isPrivate':_0xf7225b,'vCard':_0x3fadec});if(_0x379bae[_0x31f129(0x13d)]===_0x31f129(0x18d)&&_0xf7225b){const _0x434b6b={'wid':_0x31f129(0x198)+_0x379bae[_0x31f129(0x15f)][_0x31f129(0x197)]()[_0x31f129(0x172)]('\x20',''),'ticketId':_0x379bae['id'],'contactId':undefined,'body':_0x41364f,'fromMe':!![],'mediaType':!(0x0,lodash_1[_0x31f129(0x194)])(_0x3fadec)?_0x31f129(0x155):_0x31f129(0x163),'read':!![],'quotedMsgId':null,'ack':0x2,'remoteJid':_0x379bae[_0x31f129(0x16f)]?.[_0x31f129(0x138)],'participant':null,'dataJson':null,'ticketTrakingId':null,'isPrivate':_0xf7225b};await(0x0,CreateMessageService_1[_0x31f129(0x166)])({'messageData':_0x434b6b,'companyId':_0x379bae[_0x31f129(0x175)]});}(_0x379bae[_0x31f129(0x13d)]===_0x31f129(0x182)||_0x379bae[_0x31f129(0x13d)]===_0x31f129(0x136))&&await(0x0,sendFacebookMessage_1[_0x31f129(0x166)])({'body':_0x41364f,'ticket':_0x379bae,'quotedMsg':_0x24d666});}return _0x252d0c[_0x31f129(0x186)]();}catch(_0x2a7c2){return console[_0x31f129(0x1a0)](_0x2a7c2),_0x252d0c[_0x31f129(0x177)](0x190)[_0x31f129(0x14d)]({'error':_0x2a7c2[_0x31f129(0x132)]});}};exports[a23_0x1a3b34(0x180)]=store;const forwardmessage=async(_0x2dea8e,_0x55deb7)=>{const _0x4aa138=a23_0x1a3b34,_0x262e8f=_0x2dea8e['headers'][_0x4aa138(0x18f)],[,_0x52dd11]=_0x262e8f['split']('\x20'),_0x1c7cf2=(0x0,jsonwebtoken_1[_0x4aa138(0x12e)])(_0x52dd11,auth_1[_0x4aa138(0x166)][_0x4aa138(0x13a)]),{id:_0x14c5fa}=_0x2dea8e[_0x4aa138(0x1a3)],_0x100429=await User_1[_0x4aa138(0x166)]['findByPk'](_0x14c5fa),{currentContacts:_0x20570e,message:_0x4105d5,signMessage:_0x402adb}=_0x2dea8e[_0x4aa138(0x185)],{companyId:_0x3bea9f}=_0x4105d5,_0x48c0b3=await CompaniesSettings_1['default']['findOne']({'where':{'companyId':_0x3bea9f}}),_0x533731=_0x4105d5['quotedMsgId'];let _0xadc571;return _0x20570e['map'](async _0x15fd1e=>{const _0x3236cd=_0x4aa138,_0x4b99c4=await(0x0,ShowContactService_1[_0x3236cd(0x166)])(_0x15fd1e['id'],_0x4105d5[_0x3236cd(0x175)]),_0x19f1a3=await(0x0,ShowTicketService_1[_0x3236cd(0x166)])(_0x4105d5[_0x3236cd(0x141)],_0x4105d5['companyId']),{ticket:_0x5251fa,isCreated:_0x36fb08}=await(0x0,FindOrCreateTicketService_1[_0x3236cd(0x166)])(_0x4b99c4,_0x19f1a3?.['whatsapp'],0x0,_0x19f1a3[_0x3236cd(0x175)],_0x19f1a3[_0x3236cd(0x19a)],_0x100429['id'],_0x4b99c4[_0x3236cd(0x149)]?_0x4b99c4:null,_0x3236cd(0x18d),null,!![],_0x48c0b3),_0x3b6ba2={'status':_0x5251fa[_0x3236cd(0x149)]?_0x3236cd(0x17d):_0x3236cd(0x12d),'userId':_0x100429['id'],'queueId':_0x19f1a3[_0x3236cd(0x19a)]};await(0x0,UpdateTicketService_1[_0x3236cd(0x166)])({'ticketData':_0x3b6ba2,'ticketId':_0x5251fa['id'],'companyId':_0x5251fa[_0x3236cd(0x175)]});if(_0x19f1a3[_0x3236cd(0x13d)]===_0x3236cd(0x18d)){if(_0x4105d5[_0x3236cd(0x14a)]){_0xadc571=_0x3236cd(0x152);const _0x3a0c59=_0x4105d5[_0x3236cd(0x14a)][_0x3236cd(0x172)](':'+process[_0x3236cd(0x1a1)][_0x3236cd(0x154)],''),_0x308789=obterNomeEExtensaoDoArquivo(_0x3a0c59),_0x470a07=path_1[_0x3236cd(0x166)]['join'](__dirname,'..','..','..',_0x3236cd(0x15c),_0x3236cd(0x134)),_0x264dd6=path_1[_0x3236cd(0x166)][_0x3236cd(0x146)](_0x470a07,'company'+_0x19f1a3[_0x3236cd(0x175)],_0x308789),_0x13c94c={'fieldname':'medias','originalname':_0x308789,'encoding':_0x3236cd(0x153),'mimetype':_0x4105d5['mediaType'],'filename':_0x308789,'path':_0x264dd6};await(0x0,SendWhatsAppMedia_1['default'])({'media':_0x13c94c,'ticket':_0x5251fa,'body':_0xadc571,'isForwarded':![]});}else _0x402adb?_0xadc571=_0x3236cd(0x147)+_0x100429[_0x3236cd(0x129)]+'*\x0a\x0a'+_0x4105d5[_0x3236cd(0x185)]:_0xadc571=''+_0x4105d5[_0x3236cd(0x185)],await(0x0,SendWhatsAppMessage_1[_0x3236cd(0x166)])({'body':_0xadc571,'ticket':_0x5251fa,'quotedMsg':_0x533731});}}),_0x55deb7[_0x4aa138(0x14d)](_0x4aa138(0x169));};exports[a23_0x1a3b34(0x133)]=forwardmessage;const forwardMessage=async(_0x1d37e3,_0x116ba1)=>{const _0x332c08=a23_0x1a3b34;console[_0x332c08(0x1a0)](_0x332c08(0x19e));const {quotedMsg:_0x8b500,signMessage:_0x2f483d,messageId:_0x400953,contactId:_0x3c84af}=_0x1d37e3[_0x332c08(0x185)],{id:_0x227b16,companyId:_0x38a375}=_0x1d37e3[_0x332c08(0x1a3)],_0x5e5a86=await User_1[_0x332c08(0x166)][_0x332c08(0x145)](_0x227b16);if(!_0x400953||!_0x3c84af)return _0x116ba1[_0x332c08(0x177)](0xc8)[_0x332c08(0x186)](_0x332c08(0x199));const _0x1b3218=await(0x0,ShowMessageService_1['default'])(_0x400953),_0x4ce979=await(0x0,ShowContactService_1[_0x332c08(0x166)])(_0x3c84af,_0x38a375);if(!_0x1b3218)return _0x116ba1[_0x332c08(0x177)](0x194)['send'](_0x332c08(0x190));if(!_0x4ce979)return _0x116ba1[_0x332c08(0x177)](0x194)['send'](_0x332c08(0x14f));const _0x108be4=await CompaniesSettings_1[_0x332c08(0x166)]['findOne']({'where':{'companyId':_0x38a375}}),_0x5e0155=await(0x0,ShowMessageService_1[_0x332c08(0x19f)])(_0x1b3218);if(!_0x5e0155)return _0x116ba1[_0x332c08(0x177)](0x194)[_0x332c08(0x186)]('Whatsapp\x20from\x20message\x20not\x20found');const _0xfbc614=await(0x0,ShowTicketService_1[_0x332c08(0x166)])(_0x1b3218[_0x332c08(0x141)],_0x1b3218['companyId']),{ticket:_0x42b333}=await(0x0,FindOrCreateTicketService_1[_0x332c08(0x166)])(_0x4ce979,_0xfbc614?.[_0x332c08(0x18d)],0x0,_0xfbc614[_0x332c08(0x175)],_0xfbc614[_0x332c08(0x19a)],_0x5e5a86['id'],_0x4ce979[_0x332c08(0x149)]?_0x4ce979:null,_0x332c08(0x18d),null,!![],_0x108be4);let _0x54113d;(0x0,lodash_1[_0x332c08(0x194)])(_0x42b333?.[_0x332c08(0x19a)])?_0x54113d={'status':_0x42b333[_0x332c08(0x149)]?_0x332c08(0x17d):'open','userId':_0x5e5a86['id'],'queueId':_0xfbc614[_0x332c08(0x19a)]}:_0x54113d={'status':_0x42b333[_0x332c08(0x149)]?_0x332c08(0x17d):_0x332c08(0x12d),'userId':_0x5e5a86['id']};await(0x0,UpdateTicketService_1[_0x332c08(0x166)])({'ticketData':_0x54113d,'ticketId':_0x42b333['id'],'companyId':_0x42b333[_0x332c08(0x175)]});let _0x3742be=_0x1b3218[_0x332c08(0x185)];if(_0x1b3218['mediaType']===_0x332c08(0x1a9)||_0x1b3218[_0x332c08(0x17f)]===_0x332c08(0x163))await(0x0,SendWhatsAppMessage_1[_0x332c08(0x166)])({'body':_0x3742be,'ticket':_0x42b333,'quotedMsg':_0x8b500,'isForwarded':!![]});else{const _0x23e067=_0x1b3218[_0x332c08(0x14a)][_0x332c08(0x172)](':'+process[_0x332c08(0x1a1)][_0x332c08(0x154)],''),_0x53878a=obterNomeEExtensaoDoArquivo(_0x23e067);_0x3742be===_0x53878a&&(_0x3742be='');const _0x1366e5=path_1['default'][_0x332c08(0x146)](__dirname,'..','..','..',_0x332c08(0x15c),_0x332c08(0x134)),_0x1f5ca1=path_1[_0x332c08(0x166)][_0x332c08(0x146)](_0x1366e5,'company'+_0x42b333['companyId'],_0x53878a),_0x1e241c={'fieldname':_0x332c08(0x139),'originalname':_0x53878a,'encoding':'7bit','mimetype':_0x1b3218[_0x332c08(0x17f)],'filename':_0x53878a,'path':_0x1f5ca1};await(0x0,SendWhatsAppMedia_1[_0x332c08(0x166)])({'media':_0x1e241c,'ticket':_0x42b333,'body':_0x3742be,'isForwarded':!![]});}return _0x116ba1[_0x332c08(0x186)]();};exports['forwardMessage']=forwardMessage;function a23_0x260a(){const _0x39b0ee=['add','remoteJid','medias','secret','Essa\x20empresa\x20não\x20tem\x20permissão\x20para\x20usar\x20a\x20API\x20Externa.\x20Entre\x20em\x20contato\x20com\x20o\x20Suporte\x20para\x20verificar\x20nossos\x20planos!','../models/Queue','channel','prototype','split','pop','ticketId','getIO','fromMe','1000692YiZQPk','findByPk','join','*Mensagem\x20encaminhada\x20de\x20','hasOwnProperty','isGroup','mediaUrl','-appMessage','Não\x20foi\x20possível\x20realizar\x20a\x20operação','json','plan','Contact\x20not\x20found','SendMessage','jsonwebtoken','_Encaminhada_','7bit','PORT','contactMessage','../services/ContactServices/ShowContactService','parse','number','isPrivate','3TMBxPZ','index','backend','2010532puNwpK','../helpers/SetTicketMessagesAsRead','updatedAt','allMe','__setModuleDefault','__esModule','extendedTextMessage','company-','params','default','2481780jtaiEE','getOwnPropertyDescriptor','count','create','Não\x20foi\x20possível\x20enviar\x20a\x20mensagem,\x20tente\x20novamente\x20em\x20alguns\x20instantes','emit','lodash','get','contact','dateEnd','destroy','replace','../services/MessageServices/ListMessagesService','headers','companyId','../services/TicketServices/UpdateTicketService','status','writable','update','defineProperty','useExternalApi','../services/FacebookServices/sendFacebookMessage','group','../services/CompanyService/ShowPlanCompanyService','mediaType','store','../config/auth','facebook','../services/TicketServices/FindOrCreateTicketService','O\x20número\x20é\x20obrigatório','body','send','push','keys','../models/CompaniesSettings','../errors/AppError','app','../services/MessageServices/ShowMessageService','whatsapp','1352765cGcVFi','authorization','Message\x20not\x20found','557811ibzYSL','call','Mensagem\x20enviada!','isNil','dateStart','pathname','toString','PVT','MessageId\x20or\x20ContactId\x20not\x20found','queueId','4816140JgYrGt','../services/WbotServices/DeleteWhatsAppMessage','../models/User','>>>>>>>>>>>>>>>>>forwardMessage\x20X<<<<<<<<<<<<<<<<<<<','GetWhatsAppFromMessage','log','env','__createBinding','user','../services/TicketServices/ShowTicketService','../services/FacebookServices/sendFacebookMessageMedia','configurable','10409912vxDBdu','remove','conversation','delete','map','3mInYuJ','forEach','name','query','../models/Whatsapp','queues','open','verify','__importDefault','files','40nTYjfL','message','forwardmessage','public','path','instagram'];a23_0x260a=function(){return _0x39b0ee;};return a23_0x260a();}const remove=async(_0x35eeaf,_0x1d4fc5)=>{const _0x5e43d4=a23_0x1a3b34,{messageId:_0x51bed4}=_0x35eeaf[_0x5e43d4(0x165)],{companyId:_0x5d184d}=_0x35eeaf[_0x5e43d4(0x1a3)],_0x15bc7c=await(0x0,DeleteWhatsAppMessage_1[_0x5e43d4(0x166)])(_0x51bed4),_0x44ec4a=(0x0,socket_1[_0x5e43d4(0x142)])();return _0x15bc7c[_0x5e43d4(0x159)]&&(await Message_1['default'][_0x5e43d4(0x171)]({'where':{'id':_0x15bc7c['id']}}),_0x44ec4a['to'](_0x15bc7c[_0x5e43d4(0x141)][_0x5e43d4(0x197)]())['emit']('company-'+_0x5d184d+'-appMessage',{'action':_0x5e43d4(0x1aa),'message':_0x15bc7c})),_0x44ec4a['to'](_0x15bc7c[_0x5e43d4(0x141)]['toString']())[_0x5e43d4(0x16c)](_0x5e43d4(0x164)+_0x5d184d+_0x5e43d4(0x14b),{'action':_0x5e43d4(0x179),'message':_0x15bc7c}),_0x1d4fc5[_0x5e43d4(0x186)]();};exports[a23_0x1a3b34(0x1a8)]=remove;const allMe=async(_0x34e9c7,_0x2e6fb6)=>{const _0x561a38=a23_0x1a3b34,_0x4ea09e=_0x34e9c7[_0x561a38(0x12a)][_0x561a38(0x195)],_0x791223=_0x34e9c7[_0x561a38(0x12a)][_0x561a38(0x170)],_0xc6d729=_0x34e9c7[_0x561a38(0x12a)][_0x561a38(0x143)],{companyId:_0x246a80}=_0x34e9c7['user'],{count:_0x168e5b}=await(0x0,ListMessagesServiceAll_1[_0x561a38(0x166)])({'companyId':_0x246a80,'fromMe':_0xc6d729,'dateStart':_0x4ea09e,'dateEnd':_0x791223});return _0x2e6fb6['json']({'count':_0x168e5b});};exports[a23_0x1a3b34(0x160)]=allMe;const send=async(_0x35dc0d,_0x972ff7)=>{const _0x5d7adc=a23_0x1a3b34,_0x771e6f=_0x35dc0d[_0x5d7adc(0x185)],_0x49ae80=_0x35dc0d[_0x5d7adc(0x130)];try{const _0x132378=_0x35dc0d[_0x5d7adc(0x174)][_0x5d7adc(0x18f)],[,_0x521dce]=_0x132378[_0x5d7adc(0x13f)]('\x20'),_0x4717dc=await Whatsapp_1[_0x5d7adc(0x166)]['findOne']({'where':{'token':_0x521dce}}),_0x6aada4=_0x4717dc[_0x5d7adc(0x175)],_0x566ce6=await(0x0,ShowPlanCompanyService_1[_0x5d7adc(0x166)])(_0x6aada4),_0x127795=_0x566ce6[_0x5d7adc(0x14e)][_0x5d7adc(0x17b)];if(_0x127795){if(!_0x4717dc)throw new Error(_0x5d7adc(0x14c));if(_0x771e6f[_0x5d7adc(0x158)]===undefined)throw new Error(_0x5d7adc(0x184));const _0xd56542=_0x771e6f['number'],_0x1fb08f=_0x771e6f[_0x5d7adc(0x185)];return _0x49ae80?await Promise['all'](_0x49ae80['map'](async _0x282a28=>{const _0x31dd7b=_0x5d7adc;_0x35dc0d['app'][_0x31dd7b(0x16e)](_0x31dd7b(0x12c))['messageQueue'][_0x31dd7b(0x137)](_0x31dd7b(0x150),{'whatsappId':_0x4717dc['id'],'data':{'number':_0xd56542,'body':_0x282a28['originalname'][_0x31dd7b(0x172)]('/','-'),'mediaPath':_0x282a28[_0x31dd7b(0x135)]}},{'removeOnComplete':!![],'attempts':0x3});})):_0x35dc0d[_0x5d7adc(0x18b)]['get'](_0x5d7adc(0x12c))['messageQueue'][_0x5d7adc(0x137)](_0x5d7adc(0x150),{'whatsappId':_0x4717dc['id'],'data':{'number':_0xd56542,'body':_0x1fb08f}},{'removeOnComplete':!![],'attempts':0x3}),_0x972ff7[_0x5d7adc(0x186)]({'mensagem':_0x5d7adc(0x193)});}return _0x972ff7[_0x5d7adc(0x177)](0x190)['json']({'error':_0x5d7adc(0x13b)});}catch(_0x5ae933){console[_0x5d7adc(0x1a0)](_0x5ae933);if(Object[_0x5d7adc(0x188)](_0x5ae933)['length']===0x0)throw new AppError_1[(_0x5d7adc(0x166))](_0x5d7adc(0x16b));else throw new AppError_1[(_0x5d7adc(0x166))](_0x5ae933['message']);}};exports[a23_0x1a3b34(0x186)]=send;