'use strict';function a22_0x459a(_0x57e653,_0x5d97f3){const _0x10effd=a22_0x10ef();return a22_0x459a=function(_0x459acf,_0x3b8232){_0x459acf=_0x459acf-0xda;let _0x394ff3=_0x10effd[_0x459acf];return _0x394ff3;},a22_0x459a(_0x57e653,_0x5d97f3);}const a22_0x62f413=a22_0x459a;(function(_0x5034fe,_0x126ad8){const _0x3d9bef=a22_0x459a,_0x49487a=_0x5034fe();while(!![]){try{const _0x19e259=parseInt(_0x3d9bef(0x112))/0x1*(-parseInt(_0x3d9bef(0x137))/0x2)+parseInt(_0x3d9bef(0x135))/0x3+parseInt(_0x3d9bef(0x10f))/0x4*(-parseInt(_0x3d9bef(0xf3))/0x5)+-parseInt(_0x3d9bef(0x131))/0x6+-parseInt(_0x3d9bef(0x12e))/0x7*(-parseInt(_0x3d9bef(0x138))/0x8)+parseInt(_0x3d9bef(0x116))/0x9*(parseInt(_0x3d9bef(0xf4))/0xa)+parseInt(_0x3d9bef(0x143))/0xb;if(_0x19e259===_0x126ad8)break;else _0x49487a['push'](_0x49487a['shift']());}catch(_0x3cf113){_0x49487a['push'](_0x49487a['shift']());}}}(a22_0x10ef,0xe5fbb));function a22_0x10ef(){const _0x3ee962=['MessageId\x20or\x20ContactId\x20not\x20found','count','queues','-appMessage','prototype','../config/auth','fromMe','__importStar','../models/Message','files','__importDefault','73492KZLezD','__esModule','7bit','3029hicGLo','configurable','../services/TicketServices/UpdateTicketService','app','65682OEBVEc','findOne','Essa\x20empresa\x20não\x20tem\x20permissão\x20para\x20usar\x20a\x20API\x20Externa.\x20Entre\x20em\x20contato\x20com\x20o\x20Suporte\x20para\x20verificar\x20nossos\x20planos!','messageQueue','secret','companyId','log','forwardMessage','*Mensagem\x20encaminhada\x20de\x20','contactMessage','env','public','authorization','index','update','Não\x20foi\x20possível\x20enviar\x20a\x20mensagem,\x20tente\x20novamente\x20em\x20alguns\x20instantes','hasOwnProperty','group','PVT','../models/Whatsapp','../models/User','open','../services/SettingServices/ListSettingsService','path','7HsBUQN','query','create','325104qiBfSF','body','../models/Queue','__createBinding','1938462XuPLJh','lodash','94pSkkKr','351608DIQqYY','medias','getIO','json','remove','allMe','../services/MessageServices/ShowMessageService','originalname','facebook','destroy','split','11209440yKKuGS','company-','../errors/AppError','>>>>>>>>>>>>>>>>>forwardMessage\x20X<<<<<<<<<<<<<<<<<<<','../services/FacebookServices/sendFacebookMessage','delete','__setModuleDefault','status','channel','headers','get','join','PORT','GetWhatsAppFromMessage','ticketId','../services/TicketServices/FindOrCreateTicketService','toString','all','message','extendedTextMessage','_Encaminhada_','whatsapp','number','quotedMsgId','writable','map','queueId','../services/WbotServices/SendWhatsAppMedia','params','replace','../services/TicketServices/ShowTicketService','call','*\x0a\x0a','Message\x20not\x20found','Whatsapp\x20from\x20message\x20not\x20found','verify','plan','../services/CompanyService/ShowPlanCompanyService','keys','Contact\x20not\x20found','SendMessage','emit','forwardmessage','add','isPrivate','mediaUrl','dateStart','195fNbroD','200KZPvgg','store','company','defineProperty','default','../helpers/SetTicketMessagesAsRead','user','send','mediaType','length','useExternalApi','Mensagem\x20enviada!','instagram','isGroup','backend','name'];a22_0x10ef=function(){return _0x3ee962;};return a22_0x10ef();}var __createBinding=this&&this[a22_0x62f413(0x134)]||(Object[a22_0x62f413(0x130)]?function(_0x13a856,_0x2ff8ca,_0x2d5028,_0x34d715){const _0x3cb2fd=a22_0x62f413;if(_0x34d715===undefined)_0x34d715=_0x2d5028;var _0x1828b4=Object['getOwnPropertyDescriptor'](_0x2ff8ca,_0x2d5028);(!_0x1828b4||(_0x3cb2fd(0x14d)in _0x1828b4?!_0x2ff8ca[_0x3cb2fd(0x110)]:_0x1828b4[_0x3cb2fd(0xdc)]||_0x1828b4[_0x3cb2fd(0x113)]))&&(_0x1828b4={'enumerable':!![],'get':function(){return _0x2ff8ca[_0x2d5028];}}),Object[_0x3cb2fd(0xf7)](_0x13a856,_0x34d715,_0x1828b4);}:function(_0x551a3e,_0x40ea64,_0x363722,_0x16c17a){if(_0x16c17a===undefined)_0x16c17a=_0x363722;_0x551a3e[_0x16c17a]=_0x40ea64[_0x363722];}),__setModuleDefault=this&&this[a22_0x62f413(0x149)]||(Object[a22_0x62f413(0x130)]?function(_0x138f4d,_0x419461){const _0x137a18=a22_0x62f413;Object[_0x137a18(0xf7)](_0x138f4d,'default',{'enumerable':!![],'value':_0x419461});}:function(_0x18ee26,_0x281047){const _0x4719ca=a22_0x62f413;_0x18ee26[_0x4719ca(0xf8)]=_0x281047;}),__importStar=this&&this[a22_0x62f413(0x10b)]||function(_0x3c4410){const _0x84525b=a22_0x62f413;if(_0x3c4410&&_0x3c4410[_0x84525b(0x110)])return _0x3c4410;var _0x4c28f4={};if(_0x3c4410!=null){for(var _0x4a9013 in _0x3c4410)if(_0x4a9013!==_0x84525b(0xf8)&&Object[_0x84525b(0x108)][_0x84525b(0x126)][_0x84525b(0xe3)](_0x3c4410,_0x4a9013))__createBinding(_0x4c28f4,_0x3c4410,_0x4a9013);}return __setModuleDefault(_0x4c28f4,_0x3c4410),_0x4c28f4;},__importDefault=this&&this[a22_0x62f413(0x10e)]||function(_0x22fb05){const _0x2e6bbe=a22_0x62f413;return _0x22fb05&&_0x22fb05[_0x2e6bbe(0x110)]?_0x22fb05:{'default':_0x22fb05};};Object[a22_0x62f413(0xf7)](exports,a22_0x62f413(0x110),{'value':!![]}),exports['send']=exports[a22_0x62f413(0x13d)]=exports[a22_0x62f413(0x13c)]=exports[a22_0x62f413(0x11d)]=exports[a22_0x62f413(0xee)]=exports[a22_0x62f413(0xf5)]=exports[a22_0x62f413(0x123)]=void 0x0;const AppError_1=__importDefault(require(a22_0x62f413(0x145))),SetTicketMessagesAsRead_1=__importDefault(require(a22_0x62f413(0xf9))),socket_1=require('../libs/socket'),Message_1=__importDefault(require(a22_0x62f413(0x10c))),Queue_1=__importDefault(require(a22_0x62f413(0x133))),User_1=__importDefault(require(a22_0x62f413(0x12a))),Whatsapp_1=__importDefault(require(a22_0x62f413(0x129))),jsonwebtoken_1=require('jsonwebtoken'),auth_1=__importDefault(require(a22_0x62f413(0x109))),path_1=__importDefault(require(a22_0x62f413(0x12d))),lodash_1=require(a22_0x62f413(0x136)),ListMessagesService_1=__importDefault(require('../services/MessageServices/ListMessagesService')),ShowTicketService_1=__importDefault(require(a22_0x62f413(0xe2))),DeleteWhatsAppMessage_1=__importDefault(require('../services/WbotServices/DeleteWhatsAppMessage')),SendWhatsAppMedia_1=__importDefault(require(a22_0x62f413(0xdf))),SendWhatsAppMessage_1=__importDefault(require('../services/WbotServices/SendWhatsAppMessage')),CreateMessageService_1=__importDefault(require('../services/MessageServices/CreateMessageService')),sendFacebookMessageMedia_1=__importDefault(require('../services/FacebookServices/sendFacebookMessageMedia')),sendFacebookMessage_1=__importDefault(require(a22_0x62f413(0x147))),ShowPlanCompanyService_1=__importDefault(require(a22_0x62f413(0xe9))),ListMessagesServiceAll_1=__importDefault(require('../services/MessageServices/ListMessagesServiceAll')),ShowContactService_1=__importDefault(require('../services/ContactServices/ShowContactService')),FindOrCreateTicketService_1=__importDefault(require(a22_0x62f413(0x152))),UpdateTicketService_1=__importDefault(require(a22_0x62f413(0x114))),ListSettingsService_1=__importDefault(require(a22_0x62f413(0x12c))),ShowMessageService_1=__importStar(require(a22_0x62f413(0x13e))),index=async(_0x3ff7dd,_0x5c37d2)=>{const _0x2238e1=a22_0x62f413,{ticketId:_0x206a9e}=_0x3ff7dd[_0x2238e1(0xe0)],{pageNumber:_0x166ce1,selectedQueues:_0x4e7991}=_0x3ff7dd['query'],{companyId:_0x1c00ae,profile:_0x53da02}=_0x3ff7dd[_0x2238e1(0xfa)];let _0x5677da=[];const _0x400dfd=await User_1[_0x2238e1(0xf8)]['findByPk'](_0x3ff7dd[_0x2238e1(0xfa)]['id'],{'include':[{'model':Queue_1[_0x2238e1(0xf8)],'as':'queues'}]});_0x4e7991?_0x5677da=JSON['parse'](_0x4e7991):_0x400dfd['queues']['forEach'](_0x3683a3=>{_0x5677da['push'](_0x3683a3['id']);});const {count:_0x55238a,messages:_0x3c751f,ticket:_0x482087,hasMore:_0x2d8bb3}=await(0x0,ListMessagesService_1[_0x2238e1(0xf8)])({'pageNumber':_0x166ce1,'ticketId':_0x206a9e,'companyId':_0x1c00ae,'queues':_0x5677da,'user':_0x400dfd});return _0x482087[_0x2238e1(0x14b)]===_0x2238e1(0x158)&&(0x0,SetTicketMessagesAsRead_1[_0x2238e1(0xf8)])(_0x482087),_0x5c37d2[_0x2238e1(0x13b)]({'count':_0x55238a,'messages':_0x3c751f,'ticket':_0x482087,'hasMore':_0x2d8bb3});};exports['index']=index;function obterNomeEExtensaoDoArquivo(_0x47d19a){var _0x2fe807=new URL(_0x47d19a),_0x1d467a=_0x2fe807['pathname'],_0x30be68=_0x1d467a['split']('/')['pop'](),_0x1945d6=_0x30be68['split']('.'),_0x1c7a86=_0x1945d6[0x0],_0x50ac32=_0x1945d6[0x1];return _0x1c7a86+'.'+_0x50ac32;}const store=async(_0x79149d,_0x4414b3)=>{const _0x1dd303=a22_0x62f413,{ticketId:_0x32ae31}=_0x79149d[_0x1dd303(0xe0)],{body:_0x44648e,quotedMsg:_0x5db754,isPrivate:_0x499d5a,vCard:_0x26fad2}=_0x79149d['body'],_0x1db7fa=_0x79149d[_0x1dd303(0x10d)],{companyId:_0x379b76}=_0x79149d[_0x1dd303(0xfa)],_0x2ee1f0=await(0x0,ShowTicketService_1[_0x1dd303(0xf8)])(_0x32ae31,_0x379b76);_0x2ee1f0['channel']===_0x1dd303(0x158)&&(0x0,SetTicketMessagesAsRead_1[_0x1dd303(0xf8)])(_0x2ee1f0);try{if(_0x1db7fa)await Promise['all'](_0x1db7fa[_0x1dd303(0xdd)](async _0x27142e=>{const _0x2c9f91=_0x1dd303;_0x2ee1f0[_0x2c9f91(0x14b)]==='whatsapp'&&await(0x0,SendWhatsAppMedia_1[_0x2c9f91(0xf8)])({'media':_0x27142e,'ticket':_0x2ee1f0,'body':_0x44648e,'isPrivate':/\u200d/['test'](_0x44648e)});if(_0x2ee1f0['channel']===_0x2c9f91(0x140)||_0x2ee1f0[_0x2c9f91(0x14b)]===_0x2c9f91(0x100))try{await(0x0,sendFacebookMessageMedia_1[_0x2c9f91(0xf8)])({'media':_0x27142e,'ticket':_0x2ee1f0});}catch(_0x24617b){console['log'](_0x24617b);}}));else{_0x2ee1f0[_0x1dd303(0x14b)]===_0x1dd303(0x158)&&!_0x499d5a&&await(0x0,SendWhatsAppMessage_1[_0x1dd303(0xf8)])({'body':_0x44648e,'ticket':_0x2ee1f0,'quotedMsg':_0x5db754,'isPrivate':_0x499d5a,'vCard':_0x26fad2});if(_0x2ee1f0[_0x1dd303(0x14b)]===_0x1dd303(0x158)&&_0x499d5a){const _0x20d64a={'wid':_0x1dd303(0x128)+_0x2ee1f0['updatedAt'][_0x1dd303(0x153)]()[_0x1dd303(0xe1)]('\x20',''),'ticketId':_0x2ee1f0['id'],'contactId':undefined,'body':_0x44648e,'fromMe':!![],'mediaType':!(0x0,lodash_1['isNil'])(_0x26fad2)?_0x1dd303(0x11f):_0x1dd303(0x156),'read':!![],'quotedMsgId':null,'ack':0x2,'remoteJid':_0x2ee1f0['contact']?.['remoteJid'],'participant':null,'dataJson':null,'ticketTrakingId':null,'isPrivate':_0x499d5a};await(0x0,CreateMessageService_1['default'])({'messageData':_0x20d64a,'companyId':_0x2ee1f0[_0x1dd303(0x11b)]});}(_0x2ee1f0['channel']===_0x1dd303(0x140)||_0x2ee1f0[_0x1dd303(0x14b)]===_0x1dd303(0x100))&&await(0x0,sendFacebookMessage_1[_0x1dd303(0xf8)])({'body':_0x44648e,'ticket':_0x2ee1f0,'quotedMsg':_0x5db754});}return _0x4414b3[_0x1dd303(0xfb)]();}catch(_0x38552c){return console[_0x1dd303(0x11c)](_0x38552c),_0x4414b3[_0x1dd303(0x14a)](0x190)['json']({'error':_0x38552c[_0x1dd303(0x155)]});}};exports[a22_0x62f413(0xf5)]=store;const forwardmessage=async(_0x8a49d3,_0x55fe47)=>{const _0x46a927=a22_0x62f413,_0x555994=_0x8a49d3[_0x46a927(0x14c)][_0x46a927(0x122)],[,_0x4ad617]=_0x555994['split']('\x20'),_0x4c70b5=(0x0,jsonwebtoken_1[_0x46a927(0xe7)])(_0x4ad617,auth_1[_0x46a927(0xf8)][_0x46a927(0x11a)]),{id:_0x51a178}=_0x8a49d3[_0x46a927(0xfa)],_0x54b5db=await User_1[_0x46a927(0xf8)]['findByPk'](_0x51a178),{currentContacts:_0x50990b,message:_0x4c7cb1,signMessage:_0x34d2b2}=_0x8a49d3['body'],_0x1b6786=await(0x0,ListSettingsService_1[_0x46a927(0xf8)])({'companyId':_0x4c7cb1[_0x46a927(0x11b)]}),_0x37e9e5=_0x4c7cb1[_0x46a927(0xdb)];let _0x15da4e;return _0x50990b[_0x46a927(0xdd)](async _0x5764f1=>{const _0x34bfbf=_0x46a927,_0x202d46=await(0x0,ShowContactService_1[_0x34bfbf(0xf8)])(_0x5764f1['id'],_0x4c7cb1[_0x34bfbf(0x11b)]),_0x1f425d=await(0x0,ShowTicketService_1[_0x34bfbf(0xf8)])(_0x4c7cb1[_0x34bfbf(0x151)],_0x4c7cb1[_0x34bfbf(0x11b)]),{ticket:_0x3661fa,isCreated:_0x5547df}=await(0x0,FindOrCreateTicketService_1[_0x34bfbf(0xf8)])(_0x202d46,_0x1f425d?.[_0x34bfbf(0x158)],0x0,_0x1f425d['companyId'],_0x1f425d[_0x34bfbf(0xde)],_0x54b5db['id'],_0x202d46[_0x34bfbf(0x101)]?_0x202d46:null,_0x34bfbf(0x158),null,!![],_0x1b6786),_0x2fb6f9={'status':_0x3661fa['isGroup']?_0x34bfbf(0x127):_0x34bfbf(0x12b),'userId':_0x54b5db['id'],'queueId':_0x1f425d['queueId']};await(0x0,UpdateTicketService_1[_0x34bfbf(0xf8)])({'ticketData':_0x2fb6f9,'ticketId':_0x3661fa['id'],'companyId':_0x3661fa['companyId']});if(_0x1f425d[_0x34bfbf(0x14b)]===_0x34bfbf(0x158)){if(_0x4c7cb1[_0x34bfbf(0xf1)]){_0x34d2b2&&(_0x15da4e=_0x34bfbf(0x157));const _0x109441=_0x4c7cb1[_0x34bfbf(0xf1)][_0x34bfbf(0xe1)](':'+process[_0x34bfbf(0x120)]['PORT'],''),_0x238147=obterNomeEExtensaoDoArquivo(_0x109441),_0x24dbbe=path_1[_0x34bfbf(0xf8)]['join'](__dirname,'..','..','..',_0x34bfbf(0x102),_0x34bfbf(0x121)),_0x40fed7=path_1[_0x34bfbf(0xf8)][_0x34bfbf(0x14e)](_0x24dbbe,'company'+_0x1f425d[_0x34bfbf(0x11b)],_0x238147),_0x45d366={'fieldname':_0x34bfbf(0x139),'originalname':_0x238147,'encoding':_0x34bfbf(0x111),'mimetype':_0x4c7cb1['mediaType'],'filename':_0x238147,'path':_0x40fed7};await(0x0,SendWhatsAppMedia_1[_0x34bfbf(0xf8)])({'media':_0x45d366,'ticket':_0x3661fa,'body':_0x15da4e});}else _0x34d2b2?_0x15da4e=_0x34bfbf(0x11e)+_0x54b5db[_0x34bfbf(0x103)]+_0x34bfbf(0xe4)+_0x4c7cb1[_0x34bfbf(0x132)]:_0x15da4e=''+_0x4c7cb1['body'],await(0x0,SendWhatsAppMessage_1['default'])({'body':_0x15da4e,'ticket':_0x3661fa,'quotedMsg':_0x37e9e5});}}),_0x55fe47[_0x46a927(0x13b)](_0x46a927(0x105));};exports[a22_0x62f413(0xee)]=forwardmessage;const forwardMessage=async(_0x5259aa,_0x80ea60)=>{const _0x2641c0=a22_0x62f413;console[_0x2641c0(0x11c)](_0x2641c0(0x146));const {quotedMsg:_0x5975bf,signMessage:_0xd9a5a6,messageId:_0x43a610,contactId:_0x35ce04}=_0x5259aa[_0x2641c0(0x132)],{id:_0x8b482c,companyId:_0x4d2950}=_0x5259aa[_0x2641c0(0xfa)],_0x5793d2=await User_1['default']['findByPk'](_0x8b482c);if(!_0x43a610||!_0x35ce04)return _0x80ea60[_0x2641c0(0x14a)](0xc8)[_0x2641c0(0xfb)](_0x2641c0(0x104));const _0x3caa94=await(0x0,ShowMessageService_1['default'])(_0x43a610),_0x178498=await(0x0,ShowContactService_1['default'])(_0x35ce04,_0x4d2950);if(!_0x3caa94)return _0x80ea60[_0x2641c0(0x14a)](0x194)[_0x2641c0(0xfb)](_0x2641c0(0xe5));if(!_0x178498)return _0x80ea60[_0x2641c0(0x14a)](0x194)['send'](_0x2641c0(0xeb));const _0xcfb94b=await(0x0,ListSettingsService_1[_0x2641c0(0xf8)])({'companyId':_0x3caa94[_0x2641c0(0x11b)]}),_0x1b1f65=await(0x0,ShowMessageService_1[_0x2641c0(0x150)])(_0x3caa94);if(!_0x1b1f65)return _0x80ea60[_0x2641c0(0x14a)](0x194)[_0x2641c0(0xfb)](_0x2641c0(0xe6));const _0x207ff5=await(0x0,ShowTicketService_1['default'])(_0x3caa94[_0x2641c0(0x151)],_0x3caa94[_0x2641c0(0x11b)]),{ticket:_0x237684}=await(0x0,FindOrCreateTicketService_1['default'])(_0x178498,_0x207ff5?.[_0x2641c0(0x158)],0x0,_0x207ff5['companyId'],_0x207ff5['queueId'],_0x5793d2['id'],_0x178498[_0x2641c0(0x101)]?_0x178498:null,_0x2641c0(0x158),null,!![],_0xcfb94b),_0x23a398={'status':_0x237684['isGroup']?_0x2641c0(0x127):'open','userId':_0x5793d2['id'],'queueId':_0x207ff5['queueId']};await(0x0,UpdateTicketService_1[_0x2641c0(0xf8)])({'ticketData':_0x23a398,'ticketId':_0x237684['id'],'companyId':_0x237684[_0x2641c0(0x11b)]});let _0x226fdb='';_0xd9a5a6&&(_0x226fdb='_Encaminhada_');if(_0x3caa94[_0x2641c0(0xfc)]==='conversation'||_0x3caa94['mediaType']==='extendedTextMessage')await(0x0,SendWhatsAppMessage_1['default'])({'body':_0x3caa94[_0x2641c0(0x132)],'ticket':_0x237684,'quotedMsg':_0x5975bf});else{const _0x13d304=_0x3caa94['mediaUrl'][_0x2641c0(0xe1)](':'+process[_0x2641c0(0x120)][_0x2641c0(0x14f)],''),_0x51a5f5=obterNomeEExtensaoDoArquivo(_0x13d304),_0x433ec8=path_1[_0x2641c0(0xf8)][_0x2641c0(0x14e)](__dirname,'..','..','..',_0x2641c0(0x102),_0x2641c0(0x121)),_0x27f9a7=path_1[_0x2641c0(0xf8)][_0x2641c0(0x14e)](_0x433ec8,_0x2641c0(0xf6)+_0x237684[_0x2641c0(0x11b)],_0x51a5f5),_0x25c58d={'fieldname':_0x2641c0(0x139),'originalname':_0x51a5f5,'encoding':_0x2641c0(0x111),'mimetype':_0x3caa94[_0x2641c0(0xfc)],'filename':_0x51a5f5,'path':_0x27f9a7};await(0x0,SendWhatsAppMedia_1[_0x2641c0(0xf8)])({'media':_0x25c58d,'ticket':_0x237684,'body':_0x226fdb});}return _0x80ea60[_0x2641c0(0xfb)]();};exports['forwardMessage']=forwardMessage;const remove=async(_0x28364e,_0x41a933)=>{const _0x3e8322=a22_0x62f413,{messageId:_0x4ddc1e}=_0x28364e['params'],{companyId:_0x2b3aa4}=_0x28364e[_0x3e8322(0xfa)],_0x50ca79=await(0x0,DeleteWhatsAppMessage_1[_0x3e8322(0xf8)])(_0x4ddc1e),_0x29020e=(0x0,socket_1[_0x3e8322(0x13a)])();return _0x50ca79[_0x3e8322(0xf0)]&&(await Message_1[_0x3e8322(0xf8)][_0x3e8322(0x141)]({'where':{'id':_0x50ca79['id']}}),_0x29020e['to'](_0x50ca79[_0x3e8322(0x151)][_0x3e8322(0x153)]())['emit']('company-'+_0x2b3aa4+'-appMessage',{'action':_0x3e8322(0x148),'message':_0x50ca79})),_0x29020e['to'](_0x50ca79[_0x3e8322(0x151)][_0x3e8322(0x153)]())[_0x3e8322(0xed)](_0x3e8322(0x144)+_0x2b3aa4+_0x3e8322(0x107),{'action':_0x3e8322(0x124),'message':_0x50ca79}),_0x41a933[_0x3e8322(0xfb)]();};exports[a22_0x62f413(0x13c)]=remove;const allMe=async(_0x2c3473,_0x40cc36)=>{const _0xdd25a5=a22_0x62f413,_0xcdacbb=_0x2c3473[_0xdd25a5(0x12f)][_0xdd25a5(0xf2)],_0x316caa=_0x2c3473[_0xdd25a5(0x12f)]['dateEnd'],_0x5e62a3=_0x2c3473[_0xdd25a5(0x12f)][_0xdd25a5(0x10a)],{companyId:_0x4ad8ed}=_0x2c3473[_0xdd25a5(0xfa)],{count:_0x319df9}=await(0x0,ListMessagesServiceAll_1[_0xdd25a5(0xf8)])({'companyId':_0x4ad8ed,'fromMe':_0x5e62a3,'dateStart':_0xcdacbb,'dateEnd':_0x316caa});return _0x40cc36[_0xdd25a5(0x13b)]({'count':_0x319df9});};exports[a22_0x62f413(0x13d)]=allMe;const send=async(_0xd9d062,_0xef3a6c)=>{const _0x41b91b=a22_0x62f413,_0x3b3b54=_0xd9d062[_0x41b91b(0x132)],_0xbcb931=_0xd9d062['files'];try{const _0x241f24=_0xd9d062[_0x41b91b(0x14c)][_0x41b91b(0x122)],[,_0x25205c]=_0x241f24[_0x41b91b(0x142)]('\x20'),_0x3c82a2=await Whatsapp_1[_0x41b91b(0xf8)][_0x41b91b(0x117)]({'where':{'token':_0x25205c}}),_0x470863=_0x3c82a2[_0x41b91b(0x11b)],_0x45a1f2=await(0x0,ShowPlanCompanyService_1['default'])(_0x470863),_0x216fe3=_0x45a1f2[_0x41b91b(0xe8)][_0x41b91b(0xfe)];if(_0x216fe3){if(!_0x3c82a2)throw new Error('Não\x20foi\x20possível\x20realizar\x20a\x20operação');if(_0x3b3b54[_0x41b91b(0xda)]===undefined)throw new Error('O\x20número\x20é\x20obrigatório');const _0x10b34d=_0x3b3b54['number'],_0x3a7e86=_0x3b3b54['body'];return _0xbcb931?await Promise[_0x41b91b(0x154)](_0xbcb931[_0x41b91b(0xdd)](async _0x25e487=>{const _0x50ba65=_0x41b91b;_0xd9d062[_0x50ba65(0x115)][_0x50ba65(0x14d)](_0x50ba65(0x106))[_0x50ba65(0x119)][_0x50ba65(0xef)](_0x50ba65(0xec),{'whatsappId':_0x3c82a2['id'],'data':{'number':_0x10b34d,'body':_0x25e487[_0x50ba65(0x13f)][_0x50ba65(0xe1)]('/','-'),'mediaPath':_0x25e487[_0x50ba65(0x12d)]}},{'removeOnComplete':!![],'attempts':0x3});})):_0xd9d062[_0x41b91b(0x115)][_0x41b91b(0x14d)](_0x41b91b(0x106))[_0x41b91b(0x119)][_0x41b91b(0xef)]('SendMessage',{'whatsappId':_0x3c82a2['id'],'data':{'number':_0x10b34d,'body':_0x3a7e86}},{'removeOnComplete':!![],'attempts':0x3}),_0xef3a6c[_0x41b91b(0xfb)]({'mensagem':_0x41b91b(0xff)});}return _0xef3a6c[_0x41b91b(0x14a)](0x190)[_0x41b91b(0x13b)]({'error':_0x41b91b(0x118)});}catch(_0x4dbfd9){console[_0x41b91b(0x11c)](_0x4dbfd9);if(Object[_0x41b91b(0xea)](_0x4dbfd9)[_0x41b91b(0xfd)]===0x0)throw new AppError_1['default'](_0x41b91b(0x125));else throw new AppError_1[(_0x41b91b(0xf8))](_0x4dbfd9[_0x41b91b(0x155)]);}};exports[a22_0x62f413(0xfb)]=send;