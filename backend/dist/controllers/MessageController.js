'use strict';const a23_0x3b0807=a23_0x3d1e;(function(_0x15fccf,_0x28cda7){const _0x2c963c=a23_0x3d1e,_0x25a6fe=_0x15fccf();while(!![]){try{const _0x1ca38e=parseInt(_0x2c963c(0x1eb))/0x1+parseInt(_0x2c963c(0x203))/0x2*(-parseInt(_0x2c963c(0x1c9))/0x3)+parseInt(_0x2c963c(0x1c6))/0x4*(-parseInt(_0x2c963c(0x22e))/0x5)+parseInt(_0x2c963c(0x1ea))/0x6*(parseInt(_0x2c963c(0x22c))/0x7)+-parseInt(_0x2c963c(0x1d3))/0x8+parseInt(_0x2c963c(0x246))/0x9+-parseInt(_0x2c963c(0x224))/0xa*(-parseInt(_0x2c963c(0x227))/0xb);if(_0x1ca38e===_0x28cda7)break;else _0x25a6fe['push'](_0x25a6fe['shift']());}catch(_0x736551){_0x25a6fe['push'](_0x25a6fe['shift']());}}}(a23_0xa891,0x8e9f7));var __createBinding=this&&this[a23_0x3b0807(0x23f)]||(Object[a23_0x3b0807(0x244)]?function(_0x290023,_0x1664a5,_0x594975,_0x49ff95){const _0xb7462e=a23_0x3b0807;if(_0x49ff95===undefined)_0x49ff95=_0x594975;var _0x34a1e0=Object[_0xb7462e(0x1c7)](_0x1664a5,_0x594975);(!_0x34a1e0||(_0xb7462e(0x1dd)in _0x34a1e0?!_0x1664a5[_0xb7462e(0x1e9)]:_0x34a1e0[_0xb7462e(0x215)]||_0x34a1e0[_0xb7462e(0x212)]))&&(_0x34a1e0={'enumerable':!![],'get':function(){return _0x1664a5[_0x594975];}}),Object[_0xb7462e(0x1f4)](_0x290023,_0x49ff95,_0x34a1e0);}:function(_0xda84a8,_0x34d3f7,_0x366831,_0x1f8d9f){if(_0x1f8d9f===undefined)_0x1f8d9f=_0x366831;_0xda84a8[_0x1f8d9f]=_0x34d3f7[_0x366831];}),__setModuleDefault=this&&this[a23_0x3b0807(0x1f5)]||(Object[a23_0x3b0807(0x244)]?function(_0x5f18da,_0xe27b6){const _0x1ab417=a23_0x3b0807;Object['defineProperty'](_0x5f18da,_0x1ab417(0x239),{'enumerable':!![],'value':_0xe27b6});}:function(_0x34cd4c,_0x578a95){_0x34cd4c['default']=_0x578a95;}),__importStar=this&&this[a23_0x3b0807(0x1f1)]||function(_0x535126){const _0x20ed52=a23_0x3b0807;if(_0x535126&&_0x535126[_0x20ed52(0x1e9)])return _0x535126;var _0x224a09={};if(_0x535126!=null){for(var _0x29b540 in _0x535126)if(_0x29b540!==_0x20ed52(0x239)&&Object[_0x20ed52(0x21e)][_0x20ed52(0x1fa)][_0x20ed52(0x1f9)](_0x535126,_0x29b540))__createBinding(_0x224a09,_0x535126,_0x29b540);}return __setModuleDefault(_0x224a09,_0x535126),_0x224a09;},__importDefault=this&&this[a23_0x3b0807(0x1cc)]||function(_0x57fecd){return _0x57fecd&&_0x57fecd['__esModule']?_0x57fecd:{'default':_0x57fecd};};Object[a23_0x3b0807(0x1f4)](exports,a23_0x3b0807(0x1e9),{'value':!![]}),exports['send']=exports[a23_0x3b0807(0x1fc)]=exports['remove']=exports['forwardMessage']=exports[a23_0x3b0807(0x22f)]=exports[a23_0x3b0807(0x1c5)]=exports['index']=void 0x0;const AppError_1=__importDefault(require(a23_0x3b0807(0x247))),SetTicketMessagesAsRead_1=__importDefault(require(a23_0x3b0807(0x202))),socket_1=require(a23_0x3b0807(0x1f6)),Message_1=__importDefault(require('../models/Message')),Queue_1=__importDefault(require(a23_0x3b0807(0x222))),User_1=__importDefault(require(a23_0x3b0807(0x1e4))),Whatsapp_1=__importDefault(require(a23_0x3b0807(0x242))),jsonwebtoken_1=require(a23_0x3b0807(0x22d)),auth_1=__importDefault(require(a23_0x3b0807(0x219))),path_1=__importDefault(require('path')),lodash_1=require(a23_0x3b0807(0x1e5)),ListMessagesService_1=__importDefault(require(a23_0x3b0807(0x22b))),ShowTicketService_1=__importDefault(require('../services/TicketServices/ShowTicketService')),DeleteWhatsAppMessage_1=__importDefault(require(a23_0x3b0807(0x20c))),SendWhatsAppMedia_1=__importDefault(require('../services/WbotServices/SendWhatsAppMedia')),SendWhatsAppMessage_1=__importDefault(require(a23_0x3b0807(0x1ec))),CreateMessageService_1=__importDefault(require('../services/MessageServices/CreateMessageService')),sendFacebookMessageMedia_1=require(a23_0x3b0807(0x1dc)),sendFacebookMessage_1=__importDefault(require(a23_0x3b0807(0x21f))),ShowPlanCompanyService_1=__importDefault(require('../services/CompanyService/ShowPlanCompanyService')),ListMessagesServiceAll_1=__importDefault(require('../services/MessageServices/ListMessagesServiceAll')),ShowContactService_1=__importDefault(require('../services/ContactServices/ShowContactService')),FindOrCreateTicketService_1=__importDefault(require('../services/TicketServices/FindOrCreateTicketService')),UpdateTicketService_1=__importDefault(require(a23_0x3b0807(0x209))),ShowMessageService_1=__importStar(require(a23_0x3b0807(0x240))),CompaniesSettings_1=__importDefault(require(a23_0x3b0807(0x1e3))),index=async(_0x4b92c8,_0x50c8b9)=>{const _0x191223=a23_0x3b0807,{ticketId:_0x334fd6}=_0x4b92c8[_0x191223(0x204)],{pageNumber:_0x5359a0,selectedQueues:_0x4b5f10}=_0x4b92c8[_0x191223(0x1e1)],{companyId:_0x141631,profile:_0x14bd4a}=_0x4b92c8[_0x191223(0x1f0)];let _0x28c7f4=[];const _0x347af3=await User_1[_0x191223(0x239)]['findByPk'](_0x4b92c8[_0x191223(0x1f0)]['id'],{'include':[{'model':Queue_1[_0x191223(0x239)],'as':'queues'}]});_0x4b5f10?_0x28c7f4=JSON[_0x191223(0x211)](_0x4b5f10):_0x347af3[_0x191223(0x237)][_0x191223(0x226)](_0x382c1e=>{const _0xa190a4=_0x191223;_0x28c7f4[_0xa190a4(0x23b)](_0x382c1e['id']);});const {count:_0x154749,messages:_0x321ffe,ticket:_0x1ca28a,hasMore:_0x4e4f2e}=await(0x0,ListMessagesService_1[_0x191223(0x239)])({'pageNumber':_0x5359a0,'ticketId':_0x334fd6,'companyId':_0x141631,'queues':_0x28c7f4,'user':_0x347af3});return _0x1ca28a[_0x191223(0x228)]===_0x191223(0x21d)&&(0x0,SetTicketMessagesAsRead_1[_0x191223(0x239)])(_0x1ca28a),_0x50c8b9[_0x191223(0x23e)]({'count':_0x154749,'messages':_0x321ffe,'ticket':_0x1ca28a,'hasMore':_0x4e4f2e});};exports[a23_0x3b0807(0x214)]=index;function obterNomeEExtensaoDoArquivo(_0x30935d){const _0x3a725c=a23_0x3b0807;var _0x11a4cd=new URL(_0x30935d),_0x56cd98=_0x11a4cd[_0x3a725c(0x1ca)],_0x123f30=_0x56cd98[_0x3a725c(0x231)]('/')[_0x3a725c(0x220)](),_0x4791cc=_0x123f30[_0x3a725c(0x231)]('.'),_0x27929f=_0x4791cc[0x0],_0x51f2f5=_0x4791cc[0x1];return _0x27929f+'.'+_0x51f2f5;}const store=async(_0x2166ae,_0x4849cd)=>{const _0x2a4d36=a23_0x3b0807,{ticketId:_0x5c68a3}=_0x2166ae[_0x2a4d36(0x204)],{body:_0x557e05,quotedMsg:_0x89d5a7,isPrivate:_0x1b6d18,vCard:_0x275676}=_0x2166ae['body'],_0x334efe=_0x2166ae['files'],{companyId:_0x55d38}=_0x2166ae['user'],_0x34f367=await(0x0,ShowTicketService_1[_0x2a4d36(0x239)])(_0x5c68a3,_0x55d38);_0x34f367[_0x2a4d36(0x228)]===_0x2a4d36(0x21d)&&(0x0,SetTicketMessagesAsRead_1[_0x2a4d36(0x239)])(_0x34f367);try{if(_0x334efe)await Promise['all'](_0x334efe[_0x2a4d36(0x1fd)](async(_0x5e0cd9,_0x4d18de)=>{const _0x26a785=_0x2a4d36;_0x34f367[_0x26a785(0x228)]===_0x26a785(0x21d)&&await(0x0,SendWhatsAppMedia_1[_0x26a785(0x239)])({'media':_0x5e0cd9,'ticket':_0x34f367,'body':Array[_0x26a785(0x234)](_0x557e05)?_0x557e05[_0x4d18de]:_0x557e05,'isPrivate':/\u200d/[_0x26a785(0x1df)](_0x557e05),'isForwarded':![]});if(_0x34f367[_0x26a785(0x228)]==='facebook'||_0x34f367['channel']===_0x26a785(0x1ed))try{await(0x0,sendFacebookMessageMedia_1[_0x26a785(0x238)])({'media':_0x5e0cd9,'ticket':_0x34f367});}catch(_0x298bb3){console[_0x26a785(0x23d)](_0x298bb3);}}));else{if(_0x34f367[_0x2a4d36(0x228)]==='whatsapp'&&!_0x1b6d18)await(0x0,SendWhatsAppMessage_1[_0x2a4d36(0x239)])({'body':_0x557e05,'ticket':_0x34f367,'quotedMsg':_0x89d5a7,'vCard':_0x275676});else{if(_0x34f367[_0x2a4d36(0x228)]===_0x2a4d36(0x21d)&&_0x1b6d18){const _0x3ff29c={'wid':_0x2a4d36(0x235)+_0x34f367['updatedAt']['toString']()[_0x2a4d36(0x20e)]('\x20',''),'ticketId':_0x34f367['id'],'contactId':undefined,'body':_0x557e05,'fromMe':!![],'mediaType':!(0x0,lodash_1[_0x2a4d36(0x21c)])(_0x275676)?_0x2a4d36(0x1fb):_0x2a4d36(0x1f2),'read':!![],'quotedMsgId':null,'ack':0x2,'remoteJid':_0x34f367[_0x2a4d36(0x1e2)]?.[_0x2a4d36(0x1d9)],'participant':null,'dataJson':null,'ticketTrakingId':null,'isPrivate':_0x1b6d18};await(0x0,CreateMessageService_1[_0x2a4d36(0x239)])({'messageData':_0x3ff29c,'companyId':_0x34f367[_0x2a4d36(0x1e0)]});}else(_0x34f367[_0x2a4d36(0x228)]==='facebook'||_0x34f367[_0x2a4d36(0x228)]==='instagram')&&await(0x0,sendFacebookMessage_1['default'])({'body':_0x557e05,'ticket':_0x34f367,'quotedMsg':_0x89d5a7});}}return _0x4849cd[_0x2a4d36(0x200)]();}catch(_0x38f57d){return console['log'](_0x38f57d),_0x4849cd[_0x2a4d36(0x248)](0x190)[_0x2a4d36(0x23e)]({'error':_0x38f57d[_0x2a4d36(0x1d2)]});}};exports['store']=store;const forwardmessage=async(_0x377c48,_0xa40f35)=>{const _0x1847b0=a23_0x3b0807,_0x2027b9=_0x377c48[_0x1847b0(0x1f7)][_0x1847b0(0x223)],[,_0xdeea4c]=_0x2027b9[_0x1847b0(0x231)]('\x20'),_0xe416da=(0x0,jsonwebtoken_1[_0x1847b0(0x20a)])(_0xdeea4c,auth_1[_0x1847b0(0x239)][_0x1847b0(0x1c4)]),{id:_0x423d7f}=_0x377c48['user'],_0x55f997=await User_1[_0x1847b0(0x239)][_0x1847b0(0x23c)](_0x423d7f),{currentContacts:_0x1fa885,message:_0x2e4637,signMessage:_0x12f226}=_0x377c48[_0x1847b0(0x230)],{companyId:_0xbf539b}=_0x2e4637,_0x3a55d2=await CompaniesSettings_1['default'][_0x1847b0(0x23a)]({'where':{'companyId':_0xbf539b}}),_0x191fe1=_0x2e4637['quotedMsgId'];let _0x28b6d9;return _0x1fa885['map'](async _0x39f41e=>{const _0x1738e8=_0x1847b0,_0x3a828e=await(0x0,ShowContactService_1[_0x1738e8(0x239)])(_0x39f41e['id'],_0x2e4637[_0x1738e8(0x1e0)]),_0x35623e=await(0x0,ShowTicketService_1[_0x1738e8(0x239)])(_0x2e4637['ticketId'],_0x2e4637['companyId']),{ticket:_0x311bf9,isCreated:_0x8448e0}=await(0x0,FindOrCreateTicketService_1[_0x1738e8(0x239)])(_0x3a828e,_0x35623e?.[_0x1738e8(0x21d)],0x0,_0x35623e[_0x1738e8(0x1e0)],_0x35623e[_0x1738e8(0x216)],_0x55f997['id'],_0x3a828e[_0x1738e8(0x1e8)]?_0x3a828e:null,_0x1738e8(0x21d),null,!![],_0x3a55d2),_0x276294={'status':_0x311bf9[_0x1738e8(0x1e8)]?'group':'open','userId':_0x55f997['id'],'queueId':_0x35623e[_0x1738e8(0x216)]};await(0x0,UpdateTicketService_1[_0x1738e8(0x239)])({'ticketData':_0x276294,'ticketId':_0x311bf9['id'],'companyId':_0x311bf9[_0x1738e8(0x1e0)]});if(_0x35623e[_0x1738e8(0x228)]===_0x1738e8(0x21d)){if(_0x2e4637[_0x1738e8(0x233)]){_0x28b6d9='_Encaminhada_';const _0x40228b=_0x2e4637[_0x1738e8(0x233)][_0x1738e8(0x20e)](':'+process[_0x1738e8(0x1db)][_0x1738e8(0x22a)],''),_0x4e7910=obterNomeEExtensaoDoArquivo(_0x40228b),_0x28e17f=path_1['default'][_0x1738e8(0x1cb)](__dirname,'..','..','..',_0x1738e8(0x217),_0x1738e8(0x1e6)),_0x4eb2fc=path_1[_0x1738e8(0x239)]['join'](_0x28e17f,'company'+_0x35623e[_0x1738e8(0x1e0)],_0x4e7910),_0x263022={'fieldname':'medias','originalname':_0x4e7910,'encoding':_0x1738e8(0x221),'mimetype':_0x2e4637[_0x1738e8(0x225)],'filename':_0x4e7910,'path':_0x4eb2fc};await(0x0,SendWhatsAppMedia_1[_0x1738e8(0x239)])({'media':_0x263022,'ticket':_0x311bf9,'body':_0x28b6d9,'isForwarded':![]});}else _0x12f226?_0x28b6d9='*Mensagem\x20encaminhada\x20de\x20'+_0x55f997[_0x1738e8(0x236)]+_0x1738e8(0x205)+_0x2e4637[_0x1738e8(0x230)]:_0x28b6d9=''+_0x2e4637[_0x1738e8(0x230)],await(0x0,SendWhatsAppMessage_1[_0x1738e8(0x239)])({'body':_0x28b6d9,'ticket':_0x311bf9,'quotedMsg':_0x191fe1});}}),_0xa40f35[_0x1847b0(0x23e)](_0x1847b0(0x1e7));};exports[a23_0x3b0807(0x22f)]=forwardmessage;const forwardMessage=async(_0x2bc85d,_0x3c39d9)=>{const _0x28873c=a23_0x3b0807,{quotedMsg:_0x56802b,signMessage:_0x4c0a5d,messageId:_0x439110,contactId:_0x5a08ab}=_0x2bc85d[_0x28873c(0x230)],{id:_0x65074d,companyId:_0x125042}=_0x2bc85d[_0x28873c(0x1f0)],_0x1d7d5c=await User_1[_0x28873c(0x239)][_0x28873c(0x23c)](_0x65074d);if(!_0x439110||!_0x5a08ab)return _0x3c39d9[_0x28873c(0x248)](0xc8)[_0x28873c(0x200)](_0x28873c(0x1da));const _0x1608fd=await(0x0,ShowMessageService_1['default'])(_0x439110),_0x2d4fc2=await(0x0,ShowContactService_1[_0x28873c(0x239)])(_0x5a08ab,_0x125042);if(!_0x1608fd)return _0x3c39d9[_0x28873c(0x248)](0x194)['send'](_0x28873c(0x20f));if(!_0x2d4fc2)return _0x3c39d9[_0x28873c(0x248)](0x194)['send'](_0x28873c(0x1fe));const _0xcdb73=await CompaniesSettings_1['default'][_0x28873c(0x23a)]({'where':{'companyId':_0x125042}}),_0x37ef98=await(0x0,ShowMessageService_1[_0x28873c(0x1de)])(_0x1608fd);if(!_0x37ef98)return _0x3c39d9[_0x28873c(0x248)](0x194)[_0x28873c(0x200)]('Whatsapp\x20from\x20message\x20not\x20found');const _0x1e2011=await(0x0,ShowTicketService_1[_0x28873c(0x239)])(_0x1608fd['ticketId'],_0x1608fd[_0x28873c(0x1e0)]),{ticket:_0x1d1f84}=await(0x0,FindOrCreateTicketService_1[_0x28873c(0x239)])(_0x2d4fc2,_0x1e2011?.[_0x28873c(0x21d)],0x0,_0x1e2011[_0x28873c(0x1e0)],_0x1e2011[_0x28873c(0x216)],_0x1d7d5c['id'],_0x2d4fc2[_0x28873c(0x1e8)]?_0x2d4fc2:null,_0x28873c(0x21d),null,!![],_0xcdb73);let _0x3e016c;(0x0,lodash_1[_0x28873c(0x21c)])(_0x1d1f84?.['queueId'])?_0x3e016c={'status':_0x1d1f84[_0x28873c(0x1e8)]?'group':'open','userId':_0x1d7d5c['id'],'queueId':_0x1e2011['queueId']}:_0x3e016c={'status':_0x1d1f84['isGroup']?_0x28873c(0x1f3):_0x28873c(0x201),'userId':_0x1d7d5c['id']};await(0x0,UpdateTicketService_1['default'])({'ticketData':_0x3e016c,'ticketId':_0x1d1f84['id'],'companyId':_0x1d1f84[_0x28873c(0x1e0)]});let _0x26aa18=_0x1608fd[_0x28873c(0x230)];if(_0x1608fd['mediaType']===_0x28873c(0x1ef)||_0x1608fd[_0x28873c(0x225)]==='extendedTextMessage')await(0x0,SendWhatsAppMessage_1[_0x28873c(0x239)])({'body':_0x26aa18,'ticket':_0x1d1f84,'quotedMsg':_0x56802b,'isForwarded':_0x1608fd[_0x28873c(0x207)]?![]:!![]});else{const _0xa8ed1=_0x1608fd[_0x28873c(0x233)][_0x28873c(0x20e)](':'+process['env'][_0x28873c(0x22a)],''),_0xe0b1df=obterNomeEExtensaoDoArquivo(_0xa8ed1);_0x26aa18===_0xe0b1df&&(_0x26aa18='');const _0x4ae0be=path_1[_0x28873c(0x239)][_0x28873c(0x1cb)](__dirname,'..','..','..',_0x28873c(0x217),'public'),_0x3c28c5=path_1[_0x28873c(0x239)][_0x28873c(0x1cb)](_0x4ae0be,_0x28873c(0x1cd)+_0x1d1f84['companyId'],_0xe0b1df),_0x3d18f8={'fieldname':'medias','originalname':_0xe0b1df,'encoding':'7bit','mimetype':_0x1608fd['mediaType'],'filename':_0xe0b1df,'path':_0x3c28c5};await(0x0,SendWhatsAppMedia_1[_0x28873c(0x239)])({'media':_0x3d18f8,'ticket':_0x1d1f84,'body':_0x26aa18,'isForwarded':_0x1608fd[_0x28873c(0x207)]?![]:!![]});}return _0x3c39d9[_0x28873c(0x200)]();};exports[a23_0x3b0807(0x206)]=forwardMessage;const remove=async(_0x5289bb,_0x6ccbc1)=>{const _0x385270=a23_0x3b0807,{messageId:_0x1358cb}=_0x5289bb[_0x385270(0x204)],{companyId:_0x3f8b07}=_0x5289bb[_0x385270(0x1f0)],_0x193592=await(0x0,DeleteWhatsAppMessage_1[_0x385270(0x239)])(_0x1358cb),_0x48415a=(0x0,socket_1[_0x385270(0x208)])();return _0x193592[_0x385270(0x229)]&&(await Message_1[_0x385270(0x239)][_0x385270(0x1d0)]({'where':{'id':_0x193592['id']}}),_0x48415a['to'](_0x193592['ticketId'][_0x385270(0x20d)]())[_0x385270(0x1ff)](_0x385270(0x213)+_0x3f8b07+_0x385270(0x20b),{'action':'delete','message':_0x193592})),_0x48415a['to'](_0x193592[_0x385270(0x241)][_0x385270(0x20d)]())[_0x385270(0x1ff)](_0x385270(0x213)+_0x3f8b07+_0x385270(0x20b),{'action':_0x385270(0x1d4),'message':_0x193592}),_0x6ccbc1[_0x385270(0x200)]();};exports['remove']=remove;function a23_0xa891(){const _0x3556c9=['create','dateEnd','7425810ruuwqe','../errors/AppError','status','secret','store','744032bARJNt','getOwnPropertyDescriptor','all','84522KcmETP','pathname','join','__importDefault','company','SendMessage','Mensagem\x20enviada!','destroy','path','message','8067480LKjZTi','update','Essa\x20empresa\x20não\x20tem\x20permissão\x20para\x20usar\x20a\x20API\x20Externa.\x20Entre\x20em\x20contato\x20com\x20o\x20Suporte\x20para\x20verificar\x20nossos\x20planos!','number','O\x20número\x20é\x20obrigatório','plan','remoteJid','MessageId\x20or\x20ContactId\x20not\x20found','env','../services/FacebookServices/sendFacebookMessageMedia','get','GetWhatsAppFromMessage','test','companyId','query','contact','../models/CompaniesSettings','../models/User','lodash','public','count','isGroup','__esModule','198NiqPxH','2281vvUlAA','../services/WbotServices/SendWhatsAppMessage','instagram','dateStart','conversation','user','__importStar','extendedTextMessage','group','defineProperty','__setModuleDefault','../libs/socket','headers','originalname','call','hasOwnProperty','contactMessage','allMe','map','Contact\x20not\x20found','emit','send','open','../helpers/SetTicketMessagesAsRead','14QaCpLQ','params','*\x0a\x0a','forwardMessage','fromMe','getIO','../services/TicketServices/UpdateTicketService','verify','-appMessage','../services/WbotServices/DeleteWhatsAppMessage','toString','replace','Message\x20not\x20found','length','parse','configurable','company-','index','writable','queueId','backend','app','../config/auth','add','files','isNil','whatsapp','prototype','../services/FacebookServices/sendFacebookMessage','pop','7bit','../models/Queue','authorization','5119690TwXTvF','mediaType','forEach','11qHdaXz','channel','isPrivate','PORT','../services/MessageServices/ListMessagesService','135016qURadT','jsonwebtoken','5WEsfuk','forwardmessage','body','split','Não\x20foi\x20possível\x20realizar\x20a\x20operação','mediaUrl','isArray','PVT','name','queues','sendFacebookMessageMedia','default','findOne','push','findByPk','log','json','__createBinding','../services/MessageServices/ShowMessageService','ticketId','../models/Whatsapp','Não\x20foi\x20possível\x20enviar\x20a\x20mensagem,\x20tente\x20novamente\x20em\x20alguns\x20instantes'];a23_0xa891=function(){return _0x3556c9;};return a23_0xa891();}const allMe=async(_0x28a014,_0x31690d)=>{const _0xaca7b9=a23_0x3b0807,_0x4ef97a=_0x28a014[_0xaca7b9(0x1e1)][_0xaca7b9(0x1ee)],_0x4016a5=_0x28a014['query'][_0xaca7b9(0x245)],_0x5d30fe=_0x28a014[_0xaca7b9(0x1e1)][_0xaca7b9(0x207)],{companyId:_0x3a708e}=_0x28a014[_0xaca7b9(0x1f0)],{count:_0x1f6295}=await(0x0,ListMessagesServiceAll_1['default'])({'companyId':_0x3a708e,'fromMe':_0x5d30fe,'dateStart':_0x4ef97a,'dateEnd':_0x4016a5});return _0x31690d[_0xaca7b9(0x23e)]({'count':_0x1f6295});};function a23_0x3d1e(_0x203d4f,_0x17be99){const _0xa89198=a23_0xa891();return a23_0x3d1e=function(_0x3d1e43,_0x182384){_0x3d1e43=_0x3d1e43-0x1c4;let _0x3f0b7a=_0xa89198[_0x3d1e43];return _0x3f0b7a;},a23_0x3d1e(_0x203d4f,_0x17be99);}exports['allMe']=allMe;const send=async(_0x6d7d84,_0xf9d40f)=>{const _0x1e129c=a23_0x3b0807,_0x29efe5=_0x6d7d84[_0x1e129c(0x230)],_0x187c4b=_0x6d7d84[_0x1e129c(0x21b)];try{const _0x115c11=_0x6d7d84[_0x1e129c(0x1f7)][_0x1e129c(0x223)],[,_0x17c550]=_0x115c11['split']('\x20'),_0x1718b2=await Whatsapp_1[_0x1e129c(0x239)][_0x1e129c(0x23a)]({'where':{'token':_0x17c550}}),_0x12dab7=_0x1718b2[_0x1e129c(0x1e0)],_0x55b716=await(0x0,ShowPlanCompanyService_1['default'])(_0x12dab7),_0x25027f=_0x55b716[_0x1e129c(0x1d8)]['useExternalApi'];if(_0x25027f){if(!_0x1718b2)throw new Error(_0x1e129c(0x232));if(_0x29efe5[_0x1e129c(0x1d6)]===undefined)throw new Error(_0x1e129c(0x1d7));const _0x63ff67=_0x29efe5[_0x1e129c(0x1d6)],_0x21e1b1=_0x29efe5[_0x1e129c(0x230)];return _0x187c4b?await Promise[_0x1e129c(0x1c8)](_0x187c4b[_0x1e129c(0x1fd)](async _0x4ada76=>{const _0x3d8d07=_0x1e129c;_0x6d7d84[_0x3d8d07(0x218)]['get'](_0x3d8d07(0x237))['messageQueue'][_0x3d8d07(0x21a)](_0x3d8d07(0x1ce),{'whatsappId':_0x1718b2['id'],'data':{'number':_0x63ff67,'body':_0x4ada76[_0x3d8d07(0x1f8)]['replace']('/','-'),'mediaPath':_0x4ada76[_0x3d8d07(0x1d1)]}},{'removeOnComplete':!![],'attempts':0x3});})):_0x6d7d84['app'][_0x1e129c(0x1dd)]('queues')['messageQueue'][_0x1e129c(0x21a)](_0x1e129c(0x1ce),{'whatsappId':_0x1718b2['id'],'data':{'number':_0x63ff67,'body':_0x21e1b1}},{'removeOnComplete':!![],'attempts':0x3}),_0xf9d40f[_0x1e129c(0x200)]({'mensagem':_0x1e129c(0x1cf)});}return _0xf9d40f[_0x1e129c(0x248)](0x190)['json']({'error':_0x1e129c(0x1d5)});}catch(_0x297c87){console[_0x1e129c(0x23d)](_0x297c87);if(Object['keys'](_0x297c87)[_0x1e129c(0x210)]===0x0)throw new AppError_1['default'](_0x1e129c(0x243));else throw new AppError_1[(_0x1e129c(0x239))](_0x297c87['message']);}};exports[a23_0x3b0807(0x200)]=send;