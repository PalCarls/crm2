<<<<<<< HEAD
'use strict';function a11_0x3859(_0x441700,_0x256643){const _0x1f863b=a11_0x1f86();return a11_0x3859=function(_0x385986,_0x177d8f){_0x385986=_0x385986-0x7c;let _0xe2eb0a=_0x1f863b[_0x385986];return _0xe2eb0a;},a11_0x3859(_0x441700,_0x256643);}const a11_0x16fc26=a11_0x3859;(function(_0xeb88cf,_0xac4420){const _0x4bed23=a11_0x3859,_0x481786=_0xeb88cf();while(!![]){try{const _0x389897=-parseInt(_0x4bed23(0xa5))/0x1+parseInt(_0x4bed23(0xa4))/0x2+parseInt(_0x4bed23(0x99))/0x3*(-parseInt(_0x4bed23(0x97))/0x4)+-parseInt(_0x4bed23(0x94))/0x5*(parseInt(_0x4bed23(0x93))/0x6)+parseInt(_0x4bed23(0xa0))/0x7*(parseInt(_0x4bed23(0x9d))/0x8)+parseInt(_0x4bed23(0xaa))/0x9*(-parseInt(_0x4bed23(0x85))/0xa)+-parseInt(_0x4bed23(0xae))/0xb*(-parseInt(_0x4bed23(0xac))/0xc);if(_0x389897===_0xac4420)break;else _0x481786['push'](_0x481786['shift']());}catch(_0x5c14b9){_0x481786['push'](_0x481786['shift']());}}}(a11_0x1f86,0x9f7ce));var __importDefault=this&&this['__importDefault']||function(_0x4d9ba7){return _0x4d9ba7&&_0x4d9ba7['__esModule']?_0x4d9ba7:{'default':_0x4d9ba7};};Object['defineProperty'](exports,a11_0x16fc26(0x80),{'value':!![]}),exports[a11_0x16fc26(0x89)]=exports[a11_0x16fc26(0x8f)]=exports[a11_0x16fc26(0x96)]=exports[a11_0x16fc26(0x88)]=exports[a11_0x16fc26(0x91)]=exports['update']=exports[a11_0x16fc26(0xa2)]=exports[a11_0x16fc26(0x84)]=void 0x0;const socket_1=require(a11_0x16fc26(0x9a)),CreateService_1=__importDefault(require(a11_0x16fc26(0x95))),ListService_1=__importDefault(require(a11_0x16fc26(0x83))),ShowFromUuidService_1=__importDefault(require('../services/ChatService/ShowFromUuidService')),DeleteService_1=__importDefault(require(a11_0x16fc26(0x9b))),FindMessages_1=__importDefault(require(a11_0x16fc26(0xa9))),UpdateService_1=__importDefault(require(a11_0x16fc26(0x9f))),Chat_1=__importDefault(require(a11_0x16fc26(0x7e))),CreateMessageService_1=__importDefault(require(a11_0x16fc26(0xa1))),User_1=__importDefault(require(a11_0x16fc26(0x98))),ChatUser_1=__importDefault(require(a11_0x16fc26(0x7f))),index=async(_0xb16365,_0x217c1e)=>{const _0x154b51=a11_0x16fc26,{pageNumber:_0x5701ad}=_0xb16365['query'],_0x4aa3cd=+_0xb16365[_0x154b51(0x87)]['id'],{records:_0x33b259,count:_0x30a605,hasMore:_0x5bf2d6}=await(0x0,ListService_1[_0x154b51(0x7d)])({'ownerId':_0x4aa3cd,'pageNumber':_0x5701ad});return _0x217c1e[_0x154b51(0x8a)]({'records':_0x33b259,'count':_0x30a605,'hasMore':_0x5bf2d6});};exports['index']=index;const store=async(_0x5bb3aa,_0x36456a)=>{const _0x5cc045=a11_0x16fc26,{companyId:_0x4be753}=_0x5bb3aa[_0x5cc045(0x87)],_0x2313f9=+_0x5bb3aa['user']['id'],_0x49323b=_0x5bb3aa['body'],_0x4657ef=await(0x0,CreateService_1['default'])({..._0x49323b,'ownerId':_0x2313f9,'companyId':_0x4be753}),_0x1b2270=(0x0,socket_1[_0x5cc045(0x92)])();return _0x4657ef['users'][_0x5cc045(0xad)](_0x3d6982=>{const _0x2bdfbe=_0x5cc045;_0x1b2270[_0x2bdfbe(0x8d)](_0x2bdfbe(0xaf)+_0x4be753+_0x2bdfbe(0x8e)+_0x3d6982['userId'],{'action':_0x2bdfbe(0x7c),'record':_0x4657ef});}),_0x36456a['status'](0xc8)[_0x5cc045(0x8a)](_0x4657ef);};exports[a11_0x16fc26(0xa2)]=store;const update=async(_0x399247,_0x1d4586)=>{const _0x30830a=a11_0x16fc26,{companyId:_0x28efd6}=_0x399247[_0x30830a(0x87)],_0x14e989=_0x399247['body'],{id:_0x5c86b8}=_0x399247[_0x30830a(0xa7)],_0x4b9728=await(0x0,UpdateService_1[_0x30830a(0x7d)])({..._0x14e989,'id':+_0x5c86b8}),_0x107a7b=(0x0,socket_1[_0x30830a(0x92)])();return _0x4b9728[_0x30830a(0x8c)][_0x30830a(0xad)](_0x3aa308=>{const _0x238a9f=_0x30830a;_0x107a7b[_0x238a9f(0x8d)](_0x238a9f(0xaf)+_0x28efd6+_0x238a9f(0x8e)+_0x3aa308['userId'],{'action':_0x238a9f(0xa3),'record':_0x4b9728});}),_0x1d4586[_0x30830a(0x9c)](0xc8)['json'](_0x4b9728);};exports[a11_0x16fc26(0xa3)]=update;const show=async(_0x1d8a81,_0x355489)=>{const _0x3d26d9=a11_0x16fc26,{id:_0x267a0b}=_0x1d8a81['params'],_0x44118d=await(0x0,ShowFromUuidService_1[_0x3d26d9(0x7d)])(_0x267a0b);return _0x355489[_0x3d26d9(0x9c)](0xc8)['json'](_0x44118d);};exports[a11_0x16fc26(0x91)]=show;const remove=async(_0x106a36,_0x282f46)=>{const _0x137104=a11_0x16fc26,{id:_0x12e883}=_0x106a36[_0x137104(0xa7)],{companyId:_0x31dee7}=_0x106a36[_0x137104(0x87)];await(0x0,DeleteService_1[_0x137104(0x7d)])(_0x12e883);const _0x23d11a=(0x0,socket_1[_0x137104(0x92)])();return _0x23d11a[_0x137104(0x8d)]('company-'+_0x31dee7+_0x137104(0x86),{'action':_0x137104(0x8b),'id':_0x12e883}),_0x282f46[_0x137104(0x9c)](0xc8)[_0x137104(0x8a)]({'message':'Chat\x20deleted'});};exports['remove']=remove;const saveMessage=async(_0x3231e0,_0x5eb585)=>{const _0x48f2ef=a11_0x16fc26,{companyId:_0x3ecb1a}=_0x3231e0[_0x48f2ef(0x87)],{message:_0x357201}=_0x3231e0[_0x48f2ef(0x90)],{id:_0x4dd327}=_0x3231e0[_0x48f2ef(0xa7)],_0x2f0286=+_0x3231e0['user']['id'],_0x5e42ee=+_0x4dd327,_0x28b34d=await(0x0,CreateMessageService_1[_0x48f2ef(0x7d)])({'chatId':_0x5e42ee,'senderId':_0x2f0286,'message':_0x357201}),_0x637426=await Chat_1[_0x48f2ef(0x7d)][_0x48f2ef(0xa6)](_0x5e42ee,{'include':[{'model':User_1[_0x48f2ef(0x7d)],'as':_0x48f2ef(0x82)},{'model':ChatUser_1['default'],'as':_0x48f2ef(0x8c)}]}),_0x1f0101=(0x0,socket_1[_0x48f2ef(0x92)])();return _0x1f0101[_0x48f2ef(0x8d)](_0x48f2ef(0xaf)+_0x3ecb1a+'-chat-'+_0x5e42ee,{'action':'new-message','newMessage':_0x28b34d,'chat':_0x637426}),_0x1f0101[_0x48f2ef(0x8d)](_0x48f2ef(0xaf)+_0x3ecb1a+_0x48f2ef(0x86),{'action':_0x48f2ef(0x81),'newMessage':_0x28b34d,'chat':_0x637426}),_0x5eb585[_0x48f2ef(0x8a)](_0x28b34d);};exports[a11_0x16fc26(0x96)]=saveMessage;const checkAsRead=async(_0x24a645,_0x234212)=>{const _0x43400a=a11_0x16fc26,{companyId:_0x52a0d7}=_0x24a645[_0x43400a(0x87)],{userId:_0x316faf}=_0x24a645[_0x43400a(0x90)],{id:_0x4d5da3}=_0x24a645[_0x43400a(0xa7)],_0x2a3a7c=await ChatUser_1[_0x43400a(0x7d)][_0x43400a(0xa8)]({'where':{'chatId':_0x4d5da3,'userId':_0x316faf}});await _0x2a3a7c[_0x43400a(0xa3)]({'unreads':0x0});const _0x361ce8=await Chat_1[_0x43400a(0x7d)][_0x43400a(0xa6)](_0x4d5da3,{'include':[{'model':User_1[_0x43400a(0x7d)],'as':'owner'},{'model':ChatUser_1[_0x43400a(0x7d)],'as':_0x43400a(0x8c)}]}),_0x1be533=(0x0,socket_1[_0x43400a(0x92)])();return _0x1be533[_0x43400a(0x8d)]('company-'+_0x52a0d7+_0x43400a(0x9e)+_0x4d5da3,{'action':_0x43400a(0xa3),'chat':_0x361ce8}),_0x1be533[_0x43400a(0x8d)](_0x43400a(0xaf)+_0x52a0d7+_0x43400a(0x86),{'action':'update','chat':_0x361ce8}),_0x234212[_0x43400a(0x8a)](_0x361ce8);};exports[a11_0x16fc26(0x8f)]=checkAsRead;const messages=async(_0x48104d,_0x10e4f7)=>{const _0x25908c=a11_0x16fc26,{pageNumber:_0x357e69}=_0x48104d[_0x25908c(0xab)],{id:_0x1cc6c0}=_0x48104d[_0x25908c(0xa7)],_0x39ad67=+_0x48104d[_0x25908c(0x87)]['id'],{records:_0x577e0c,count:_0x47fae1,hasMore:_0x3e9c6c}=await(0x0,FindMessages_1[_0x25908c(0x7d)])({'chatId':_0x1cc6c0,'ownerId':_0x39ad67,'pageNumber':_0x357e69});return _0x10e4f7['json']({'records':_0x577e0c,'count':_0x47fae1,'hasMore':_0x3e9c6c});};exports[a11_0x16fc26(0x89)]=messages;function a11_0x1f86(){const _0x4bc387=['getIO','6NRuuTV','1245355zTwSGw','../services/ChatService/CreateService','saveMessage','4rwVylI','../models/User','112551juRFMp','../libs/socket','../services/ChatService/DeleteService','status','1240xBzwrv','-chat-','../services/ChatService/UpdateService','6699BjVfzl','../services/ChatService/CreateMessageService','store','update','475462uZyQsF','414685dDoels','findByPk','params','findOne','../services/ChatService/FindMessages','30267LPNmNr','query','220572PmGYyx','forEach','968IHHbQs','company-','create','default','../models/Chat','../models/ChatUser','__esModule','new-message','owner','../services/ChatService/ListService','index','1930IARPko','-chat','user','remove','messages','json','delete','users','emit','-chat-user-','checkAsRead','body','show'];a11_0x1f86=function(){return _0x4bc387;};return a11_0x1f86();}
=======
'use strict';const a11_0x11faff=a11_0x4e9d;(function(_0x563850,_0x35e6b9){const _0x58bcf0=a11_0x4e9d,_0x437a8f=_0x563850();while(!![]){try{const _0x5108a5=parseInt(_0x58bcf0(0x1ac))/0x1+-parseInt(_0x58bcf0(0x19e))/0x2+-parseInt(_0x58bcf0(0x1b9))/0x3*(-parseInt(_0x58bcf0(0x1a4))/0x4)+parseInt(_0x58bcf0(0x1a0))/0x5+-parseInt(_0x58bcf0(0x1ae))/0x6+-parseInt(_0x58bcf0(0x1c1))/0x7+parseInt(_0x58bcf0(0x1b1))/0x8;if(_0x5108a5===_0x35e6b9)break;else _0x437a8f['push'](_0x437a8f['shift']());}catch(_0x370ec4){_0x437a8f['push'](_0x437a8f['shift']());}}}(a11_0x4266,0xadc51));var __importDefault=this&&this[a11_0x11faff(0x197)]||function(_0x3cb65c){const _0x1868af=a11_0x11faff;return _0x3cb65c&&_0x3cb65c[_0x1868af(0x1b4)]?_0x3cb65c:{'default':_0x3cb65c};};Object[a11_0x11faff(0x195)](exports,a11_0x11faff(0x1b4),{'value':!![]}),exports['messages']=exports[a11_0x11faff(0x1aa)]=exports['saveMessage']=exports[a11_0x11faff(0x199)]=exports[a11_0x11faff(0x198)]=exports['update']=exports[a11_0x11faff(0x1bd)]=exports['index']=void 0x0;const socket_1=require(a11_0x11faff(0x19c)),CreateService_1=__importDefault(require('../services/ChatService/CreateService')),ListService_1=__importDefault(require(a11_0x11faff(0x1bf))),ShowFromUuidService_1=__importDefault(require(a11_0x11faff(0x1ad))),DeleteService_1=__importDefault(require(a11_0x11faff(0x1b2))),FindMessages_1=__importDefault(require(a11_0x11faff(0x1a6))),UpdateService_1=__importDefault(require(a11_0x11faff(0x1a7))),Chat_1=__importDefault(require(a11_0x11faff(0x19b))),CreateMessageService_1=__importDefault(require('../services/ChatService/CreateMessageService')),User_1=__importDefault(require(a11_0x11faff(0x19f))),ChatUser_1=__importDefault(require('../models/ChatUser')),index=async(_0x8f8748,_0x453d65)=>{const _0x5024df=a11_0x11faff,{pageNumber:_0x3e3244}=_0x8f8748[_0x5024df(0x1c2)],_0x57f6d1=+_0x8f8748[_0x5024df(0x1b8)]['id'],{records:_0x1738fb,count:_0x3cbf99,hasMore:_0x51e485}=await(0x0,ListService_1[_0x5024df(0x1af)])({'ownerId':_0x57f6d1,'pageNumber':_0x3e3244});return _0x453d65[_0x5024df(0x1b3)]({'records':_0x1738fb,'count':_0x3cbf99,'hasMore':_0x51e485});};exports[a11_0x11faff(0x1c0)]=index;const store=async(_0x4fb733,_0x2963da)=>{const _0x20d2f5=a11_0x11faff,{companyId:_0xf78873}=_0x4fb733[_0x20d2f5(0x1b8)],_0x16f54e=+_0x4fb733[_0x20d2f5(0x1b8)]['id'],_0x16dde1=_0x4fb733['body'],_0x2ec434=await(0x0,CreateService_1[_0x20d2f5(0x1af)])({..._0x16dde1,'ownerId':_0x16f54e,'companyId':_0xf78873}),_0x52f861=(0x0,socket_1[_0x20d2f5(0x1b7)])();return _0x2ec434['users'][_0x20d2f5(0x19a)](_0x1db881=>{const _0xf2d4f5=_0x20d2f5;_0x52f861[_0xf2d4f5(0x1ba)]('company-'+_0xf78873+_0xf2d4f5(0x1a8)+_0x1db881['userId'],{'action':'create','record':_0x2ec434});}),_0x2963da[_0x20d2f5(0x196)](0xc8)[_0x20d2f5(0x1b3)](_0x2ec434);};exports[a11_0x11faff(0x1bd)]=store;const update=async(_0x1c4288,_0x306b0f)=>{const _0x5d5e9e=a11_0x11faff,{companyId:_0x67ce3f}=_0x1c4288[_0x5d5e9e(0x1b8)],_0x1a85df=_0x1c4288[_0x5d5e9e(0x1a9)],{id:_0x56a314}=_0x1c4288[_0x5d5e9e(0x1b5)],_0x24973e=await(0x0,UpdateService_1['default'])({..._0x1a85df,'id':+_0x56a314}),_0x412cab=(0x0,socket_1[_0x5d5e9e(0x1b7)])();return _0x24973e[_0x5d5e9e(0x1a2)][_0x5d5e9e(0x19a)](_0x4c5c48=>{const _0x57a0fe=_0x5d5e9e;_0x412cab['emit']('company-'+_0x67ce3f+_0x57a0fe(0x1a8)+_0x4c5c48[_0x57a0fe(0x1b6)],{'action':_0x57a0fe(0x1a5),'record':_0x24973e});}),_0x306b0f[_0x5d5e9e(0x196)](0xc8)[_0x5d5e9e(0x1b3)](_0x24973e);};function a11_0x4266(){const _0x1a8c3b=['-chat-','1044428yYrVAX','update','../services/ChatService/FindMessages','../services/ChatService/UpdateService','-chat-user-','body','checkAsRead','Chat\x20deleted','1375463JdluYJ','../services/ChatService/ShowFromUuidService','8251854lcggQo','default','-chat','13232736NrdvXQ','../services/ChatService/DeleteService','json','__esModule','params','userId','getIO','user','6tnhYAg','emit','new-message','findByPk','store','saveMessage','../services/ChatService/ListService','index','5611900qJtvCX','query','defineProperty','status','__importDefault','show','remove','forEach','../models/Chat','../libs/socket','company-','1843936fGjOdQ','../models/User','1294845VbdMrB','owner','users'];a11_0x4266=function(){return _0x1a8c3b;};return a11_0x4266();}exports[a11_0x11faff(0x1a5)]=update;const show=async(_0x20fd32,_0xd55512)=>{const _0x2a1587=a11_0x11faff,{id:_0x4034ee}=_0x20fd32[_0x2a1587(0x1b5)],_0x220846=await(0x0,ShowFromUuidService_1[_0x2a1587(0x1af)])(_0x4034ee);return _0xd55512[_0x2a1587(0x196)](0xc8)[_0x2a1587(0x1b3)](_0x220846);};exports['show']=show;const remove=async(_0x315b5d,_0x16e790)=>{const _0x3259cb=a11_0x11faff,{id:_0x2fcda2}=_0x315b5d[_0x3259cb(0x1b5)],{companyId:_0x2aa146}=_0x315b5d[_0x3259cb(0x1b8)];await(0x0,DeleteService_1[_0x3259cb(0x1af)])(_0x2fcda2);const _0x4d7cf7=(0x0,socket_1[_0x3259cb(0x1b7)])();return _0x4d7cf7[_0x3259cb(0x1ba)](_0x3259cb(0x19d)+_0x2aa146+_0x3259cb(0x1b0),{'action':'delete','id':_0x2fcda2}),_0x16e790[_0x3259cb(0x196)](0xc8)['json']({'message':_0x3259cb(0x1ab)});};exports[a11_0x11faff(0x199)]=remove;const saveMessage=async(_0x5a3147,_0x5217d7)=>{const _0x3474af=a11_0x11faff,{companyId:_0x479070}=_0x5a3147[_0x3474af(0x1b8)],{message:_0x1ed5d4}=_0x5a3147['body'],{id:_0x523a6c}=_0x5a3147[_0x3474af(0x1b5)],_0x630f9f=+_0x5a3147[_0x3474af(0x1b8)]['id'],_0x205d71=+_0x523a6c,_0xa2c4fd=await(0x0,CreateMessageService_1[_0x3474af(0x1af)])({'chatId':_0x205d71,'senderId':_0x630f9f,'message':_0x1ed5d4}),_0x1130af=await Chat_1[_0x3474af(0x1af)][_0x3474af(0x1bc)](_0x205d71,{'include':[{'model':User_1[_0x3474af(0x1af)],'as':_0x3474af(0x1a1)},{'model':ChatUser_1[_0x3474af(0x1af)],'as':'users'}]}),_0x1cbe6c=(0x0,socket_1[_0x3474af(0x1b7)])();return _0x1cbe6c[_0x3474af(0x1ba)]('company-'+_0x479070+'-chat-'+_0x205d71,{'action':_0x3474af(0x1bb),'newMessage':_0xa2c4fd,'chat':_0x1130af}),_0x1cbe6c[_0x3474af(0x1ba)](_0x3474af(0x19d)+_0x479070+'-chat',{'action':_0x3474af(0x1bb),'newMessage':_0xa2c4fd,'chat':_0x1130af}),_0x5217d7['json'](_0xa2c4fd);};exports[a11_0x11faff(0x1be)]=saveMessage;const checkAsRead=async(_0x24cbe9,_0x5db9d4)=>{const _0x1a607a=a11_0x11faff,{companyId:_0x19955b}=_0x24cbe9[_0x1a607a(0x1b8)],{userId:_0x4b9e58}=_0x24cbe9[_0x1a607a(0x1a9)],{id:_0x45b355}=_0x24cbe9['params'],_0x550fc3=await ChatUser_1[_0x1a607a(0x1af)]['findOne']({'where':{'chatId':_0x45b355,'userId':_0x4b9e58}});await _0x550fc3[_0x1a607a(0x1a5)]({'unreads':0x0});const _0x1ab994=await Chat_1[_0x1a607a(0x1af)][_0x1a607a(0x1bc)](_0x45b355,{'include':[{'model':User_1[_0x1a607a(0x1af)],'as':_0x1a607a(0x1a1)},{'model':ChatUser_1[_0x1a607a(0x1af)],'as':_0x1a607a(0x1a2)}]}),_0x291adf=(0x0,socket_1[_0x1a607a(0x1b7)])();return _0x291adf[_0x1a607a(0x1ba)]('company-'+_0x19955b+_0x1a607a(0x1a3)+_0x45b355,{'action':_0x1a607a(0x1a5),'chat':_0x1ab994}),_0x291adf['emit'](_0x1a607a(0x19d)+_0x19955b+'-chat',{'action':_0x1a607a(0x1a5),'chat':_0x1ab994}),_0x5db9d4[_0x1a607a(0x1b3)](_0x1ab994);};exports[a11_0x11faff(0x1aa)]=checkAsRead;function a11_0x4e9d(_0x2e87f3,_0x372acc){const _0x426671=a11_0x4266();return a11_0x4e9d=function(_0x4e9d7a,_0x58e23b){_0x4e9d7a=_0x4e9d7a-0x195;let _0x510187=_0x426671[_0x4e9d7a];return _0x510187;},a11_0x4e9d(_0x2e87f3,_0x372acc);}const messages=async(_0x19ccd6,_0x254c21)=>{const _0x2be8e2=a11_0x11faff,{pageNumber:_0x5d9847}=_0x19ccd6[_0x2be8e2(0x1c2)],{id:_0x2acec6}=_0x19ccd6[_0x2be8e2(0x1b5)],_0x50b0d2=+_0x19ccd6[_0x2be8e2(0x1b8)]['id'],{records:_0x4d7351,count:_0x3ac25b,hasMore:_0x49121a}=await(0x0,FindMessages_1[_0x2be8e2(0x1af)])({'chatId':_0x2acec6,'ownerId':_0x50b0d2,'pageNumber':_0x5d9847});return _0x254c21[_0x2be8e2(0x1b3)]({'records':_0x4d7351,'count':_0x3ac25b,'hasMore':_0x49121a});};exports['messages']=messages;
>>>>>>> ab722bfbcf394d74dd0b99a984c0dcf6ffbcff7f
