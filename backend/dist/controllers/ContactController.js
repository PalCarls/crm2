'use strict';const a15_0x477a98=a15_0x3fa7;(function(_0x41de58,_0x431dec){const _0x3ea30b=a15_0x3fa7,_0x245728=_0x41de58();while(!![]){try{const _0x7f1b7c=-parseInt(_0x3ea30b(0xd0))/0x1*(parseInt(_0x3ea30b(0xa2))/0x2)+-parseInt(_0x3ea30b(0xab))/0x3+parseInt(_0x3ea30b(0xe5))/0x4*(parseInt(_0x3ea30b(0xd5))/0x5)+parseInt(_0x3ea30b(0xa4))/0x6+-parseInt(_0x3ea30b(0xd7))/0x7*(parseInt(_0x3ea30b(0x9b))/0x8)+parseInt(_0x3ea30b(0xe2))/0x9+parseInt(_0x3ea30b(0xe7))/0xa;if(_0x7f1b7c===_0x431dec)break;else _0x245728['push'](_0x245728['shift']());}catch(_0x2ef4ad){_0x245728['push'](_0x245728['shift']());}}}(a15_0x388c,0x41d65));var __createBinding=this&&this['__createBinding']||(Object[a15_0x477a98(0xcd)]?function(_0x1e6596,_0x109655,_0x233abe,_0x32808a){const _0x5853f6=a15_0x477a98;if(_0x32808a===undefined)_0x32808a=_0x233abe;var _0xa94359=Object[_0x5853f6(0xce)](_0x109655,_0x233abe);(!_0xa94359||(_0x5853f6(0xcc)in _0xa94359?!_0x109655[_0x5853f6(0xe8)]:_0xa94359[_0x5853f6(0xa5)]||_0xa94359[_0x5853f6(0xc2)]))&&(_0xa94359={'enumerable':!![],'get':function(){return _0x109655[_0x233abe];}}),Object[_0x5853f6(0xb6)](_0x1e6596,_0x32808a,_0xa94359);}:function(_0x597061,_0x161765,_0x4e4b32,_0x1c6e97){if(_0x1c6e97===undefined)_0x1c6e97=_0x4e4b32;_0x597061[_0x1c6e97]=_0x161765[_0x4e4b32];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x536169,_0x551662){const _0x438ec6=a15_0x477a98;Object['defineProperty'](_0x536169,_0x438ec6(0x9d),{'enumerable':!![],'value':_0x551662});}:function(_0xe857e9,_0x448769){_0xe857e9['default']=_0x448769;}),__importStar=this&&this[a15_0x477a98(0xaa)]||function(_0x5a35ab){const _0x9595c2=a15_0x477a98;if(_0x5a35ab&&_0x5a35ab['__esModule'])return _0x5a35ab;var _0x4da3f9={};if(_0x5a35ab!=null){for(var _0x20bd1 in _0x5a35ab)if(_0x20bd1!==_0x9595c2(0x9d)&&Object['prototype'][_0x9595c2(0xdf)][_0x9595c2(0xc4)](_0x5a35ab,_0x20bd1))__createBinding(_0x4da3f9,_0x5a35ab,_0x20bd1);}return __setModuleDefault(_0x4da3f9,_0x5a35ab),_0x4da3f9;},__importDefault=this&&this['__importDefault']||function(_0x10ab56){const _0x5b89e0=a15_0x477a98;return _0x10ab56&&_0x10ab56[_0x5b89e0(0xe8)]?_0x10ab56:{'default':_0x10ab56};};Object[a15_0x477a98(0xb6)](exports,'__esModule',{'value':!![]}),exports[a15_0x477a98(0xa7)]=exports['getContactVcard']=exports[a15_0x477a98(0xca)]=exports[a15_0x477a98(0xb3)]=exports[a15_0x477a98(0xba)]=exports[a15_0x477a98(0xe0)]=exports[a15_0x477a98(0xb9)]=exports['remove']=exports[a15_0x477a98(0xbb)]=exports[a15_0x477a98(0xb0)]=exports['store']=exports[a15_0x477a98(0xcf)]=exports[a15_0x477a98(0xc7)]=exports[a15_0x477a98(0xb5)]=void 0x0;const Yup=__importStar(require('yup')),socket_1=require('../libs/socket'),lodash_1=require('lodash'),ListContactsService_1=__importDefault(require(a15_0x477a98(0xdb))),CreateContactService_1=__importDefault(require(a15_0x477a98(0xdc))),ShowContactService_1=__importDefault(require(a15_0x477a98(0xbf))),UpdateContactService_1=__importDefault(require(a15_0x477a98(0xae))),DeleteContactService_1=__importDefault(require(a15_0x477a98(0xad))),GetContactService_1=__importDefault(require(a15_0x477a98(0xd3))),CheckNumber_1=__importDefault(require(a15_0x477a98(0xac))),CheckIsValidContact_1=__importDefault(require('../services/WbotServices/CheckIsValidContact')),GetProfilePicUrl_1=__importDefault(require(a15_0x477a98(0xde))),AppError_1=__importDefault(require(a15_0x477a98(0xc1))),SimpleListService_1=__importDefault(require(a15_0x477a98(0xe3))),ToggleAcceptAudioContactService_1=__importDefault(require(a15_0x477a98(0xa8))),BlockUnblockContactService_1=__importDefault(require('../services/ContactServices/BlockUnblockContactService')),ImportContactsService_1=require(a15_0x477a98(0xc8)),NumberSimpleListService_1=__importDefault(require(a15_0x477a98(0xbd))),CreateOrUpdateContactServiceForImport_1=__importDefault(require(a15_0x477a98(0xdd))),FindContactTags_1=__importDefault(require(a15_0x477a98(0xda))),importXls=async(_0x48e3a7,_0x31c469)=>{const _0x5336a2=a15_0x477a98,{companyId:_0x3e1b71}=_0x48e3a7[_0x5336a2(0xc9)],{number:_0x35efdb,name:_0x9940e3,email:_0x3045f0}=_0x48e3a7[_0x5336a2(0x9e)],_0x5d34d7=_0x35efdb[_0x5336a2(0xd8)](/[^\d.-]+/g,'');console['log'](_0x5336a2(0xe4),_0x5d34d7),console[_0x5336a2(0xb8)](_0x5336a2(0xb4),_0x9940e3);const _0x485f41=await(0x0,CheckNumber_1[_0x5336a2(0x9d)])(_0x5d34d7,_0x3e1b71);console[_0x5336a2(0xb8)]('60',_0x485f41);const _0x3c6cb9=await(0x0,GetProfilePicUrl_1['default'])(_0x485f41,_0x3e1b71),_0x126ef3={'name':''+_0x9940e3,'number':_0x485f41,'profilePicUrl':_0x3c6cb9,'isGroup':![],'email':_0x3045f0,'companyId':_0x3e1b71},_0x483f11=await(0x0,CreateOrUpdateContactServiceForImport_1[_0x5336a2(0x9d)])(_0x126ef3),_0x3cb18a=(0x0,socket_1[_0x5336a2(0xd4)])();return _0x3cb18a[_0x5336a2(0xbe)](_0x5336a2(0xa6)+_0x3e1b71+'-contact',{'action':_0x5336a2(0xcd),'contact':_0x483f11}),_0x31c469[_0x5336a2(0xb1)](0xc8)[_0x5336a2(0xa9)](_0x483f11);};exports[a15_0x477a98(0xb5)]=importXls;const index=async(_0x29b3c3,_0x19d698)=>{const _0x47579a=a15_0x477a98,{searchParam:_0x2fe701,pageNumber:_0x5dbf32,contactTag:_0x20342d,isGroup:_0x27c45a}=_0x29b3c3[_0x47579a(0xa0)],{companyId:_0x386e9a}=_0x29b3c3[_0x47579a(0xc9)];let _0x264a4f=[];_0x20342d&&(_0x264a4f=JSON['parse'](_0x20342d));const {contacts:_0x31f29a,count:_0x34569e,hasMore:_0x5f4000}=await(0x0,ListContactsService_1[_0x47579a(0x9d)])({'searchParam':_0x2fe701,'pageNumber':_0x5dbf32,'companyId':_0x386e9a,'tagsIds':_0x264a4f,'isGroup':_0x27c45a});return _0x19d698[_0x47579a(0xa9)]({'contacts':_0x31f29a,'count':_0x34569e,'hasMore':_0x5f4000});};function a15_0x3fa7(_0xa4dfb4,_0x51c341){const _0x388ce1=a15_0x388c();return a15_0x3fa7=function(_0x3fa759,_0x580be3){_0x3fa759=_0x3fa759-0x9b;let _0x2480db=_0x388ce1[_0x3fa759];return _0x2480db;},a15_0x3fa7(_0xa4dfb4,_0x51c341);}exports[a15_0x477a98(0xc7)]=index;const getContact=async(_0x3f6e72,_0x596394)=>{const _0x55929f=a15_0x477a98,{name:_0x70911e,number:_0x5e87c5}=_0x3f6e72['body'],{companyId:_0x142c9f}=_0x3f6e72[_0x55929f(0xc9)],_0x1262a7=await(0x0,GetContactService_1[_0x55929f(0x9d)])({'name':_0x70911e,'number':_0x5e87c5,'companyId':_0x142c9f});return _0x596394[_0x55929f(0xb1)](0xc8)[_0x55929f(0xa9)](_0x1262a7);};exports['getContact']=getContact;const store=async(_0x368ba9,_0x1ae548)=>{const _0x1d750c=a15_0x477a98,{companyId:_0x49aff1}=_0x368ba9['user'],_0x29460e=_0x368ba9['body'],_0x3ebbeb=_0x29460e['number'];_0x29460e[_0x1d750c(0xaf)]=_0x29460e[_0x1d750c(0xaf)]['replace']('-','')[_0x1d750c(0xd8)]('\x20','');const _0x332d4d=Yup[_0x1d750c(0xea)]()[_0x1d750c(0xd9)]({'name':Yup[_0x1d750c(0xb7)]()[_0x1d750c(0xa3)](),'number':Yup[_0x1d750c(0xb7)]()[_0x1d750c(0xa3)]()[_0x1d750c(0xc6)](/^\d+$/,_0x1d750c(0x9c))});try{await _0x332d4d[_0x1d750c(0x9f)](_0x29460e);}catch(_0x5d6d77){throw new AppError_1['default'](_0x5d6d77[_0x1d750c(0xd2)]);}const _0xe765fc=await(0x0,CheckNumber_1[_0x1d750c(0x9d)])(_0x29460e[_0x1d750c(0xaf)],_0x49aff1),_0x584b4e=await(0x0,CreateContactService_1[_0x1d750c(0x9d)])({..._0x29460e,'number':_0xe765fc,'companyId':_0x49aff1}),_0x318b9f=(0x0,socket_1[_0x1d750c(0xd4)])();return _0x318b9f['emit'](_0x1d750c(0xa6)+_0x49aff1+_0x1d750c(0xc0),{'action':_0x1d750c(0xcd),'contact':_0x584b4e}),_0x1ae548['status'](0xc8)[_0x1d750c(0xa9)](_0x584b4e);};exports['store']=store;const show=async(_0x2913c3,_0x50a59f)=>{const _0xacf098=a15_0x477a98,{contactId:_0xae3161}=_0x2913c3[_0xacf098(0xe1)],{companyId:_0x26cab6}=_0x2913c3['user'],_0x2b72b8=await(0x0,ShowContactService_1[_0xacf098(0x9d)])(_0xae3161,_0x26cab6);return _0x50a59f['status'](0xc8)[_0xacf098(0xa9)](_0x2b72b8);};exports['show']=show;const update=async(_0x443ef0,_0x36855b)=>{const _0x32665b=a15_0x477a98,_0x22c8c7=_0x443ef0[_0x32665b(0x9e)],{companyId:_0x53a69a}=_0x443ef0[_0x32665b(0xc9)],_0x1c5da8=Yup[_0x32665b(0xea)]()[_0x32665b(0xd9)]({'name':Yup[_0x32665b(0xb7)](),'number':Yup[_0x32665b(0xb7)]()[_0x32665b(0xc6)](/^\d+$/,_0x32665b(0x9c))});try{await _0x1c5da8[_0x32665b(0x9f)](_0x22c8c7);}catch(_0x3e6c5f){throw new AppError_1[(_0x32665b(0x9d))](_0x3e6c5f['message']);}await(0x0,CheckIsValidContact_1[_0x32665b(0x9d)])(_0x22c8c7[_0x32665b(0xaf)],_0x53a69a);const _0x3e989b=await(0x0,CheckNumber_1[_0x32665b(0x9d)])(_0x22c8c7[_0x32665b(0xaf)],_0x53a69a),_0x25d93e=_0x3e989b;_0x22c8c7[_0x32665b(0xaf)]=_0x25d93e;const {contactId:_0x216c47}=_0x443ef0[_0x32665b(0xe1)],_0x25b918=await(0x0,UpdateContactService_1[_0x32665b(0x9d)])({'contactData':_0x22c8c7,'contactId':_0x216c47,'companyId':_0x53a69a}),_0x53e3b1=(0x0,socket_1['getIO'])();return _0x53e3b1['emit'](_0x32665b(0xa6)+_0x53a69a+'-contact',{'action':_0x32665b(0xbb),'contact':_0x25b918}),_0x36855b['status'](0xc8)[_0x32665b(0xa9)](_0x25b918);};exports['update']=update;const remove=async(_0xf3db4b,_0xb999e4)=>{const _0x574e4b=a15_0x477a98,{contactId:_0x40311b}=_0xf3db4b[_0x574e4b(0xe1)],{companyId:_0x3968b4}=_0xf3db4b['user'];await(0x0,ShowContactService_1[_0x574e4b(0x9d)])(_0x40311b,_0x3968b4),await(0x0,DeleteContactService_1[_0x574e4b(0x9d)])(_0x40311b);const _0x2f9f63=(0x0,socket_1['getIO'])();return _0x2f9f63['emit']('company-'+_0x3968b4+_0x574e4b(0xc0),{'action':_0x574e4b(0xa1),'contactId':_0x40311b}),_0xb999e4['status'](0xc8)[_0x574e4b(0xa9)]({'message':'Contact\x20deleted'});};exports[a15_0x477a98(0xc3)]=remove;const list=async(_0x5910fe,_0xb88a2)=>{const _0x1b95da=a15_0x477a98,{name:_0xba13ba}=_0x5910fe[_0x1b95da(0xa0)],{companyId:_0x11440c}=_0x5910fe['user'],_0x191583=await(0x0,SimpleListService_1[_0x1b95da(0x9d)])({'name':_0xba13ba,'companyId':_0x11440c});return _0xb88a2['json'](_0x191583);};exports[a15_0x477a98(0xb9)]=list;const toggleAcceptAudio=async(_0x126173,_0xcc254b)=>{const _0x5d68b3=a15_0x477a98;var {contactId:_0x4184ca}=_0x126173[_0x5d68b3(0xe1)];const {companyId:_0x2ddd52}=_0x126173['user'],_0x5bda3f=await(0x0,ToggleAcceptAudioContactService_1[_0x5d68b3(0x9d)])({'contactId':_0x4184ca}),_0x517a1d=(0x0,socket_1['getIO'])();return _0x517a1d[_0x5d68b3(0xbe)](_0x5d68b3(0xa6)+_0x2ddd52+_0x5d68b3(0xc0),{'action':_0x5d68b3(0xbb),'contact':_0x5bda3f}),_0xcc254b[_0x5d68b3(0xb1)](0xc8)[_0x5d68b3(0xa9)](_0x5bda3f);};exports[a15_0x477a98(0xe0)]=toggleAcceptAudio;const blockUnblock=async(_0x1bc5c6,_0x36752f)=>{const _0x1d70a7=a15_0x477a98;var {contactId:_0x186f3d}=_0x1bc5c6[_0x1d70a7(0xe1)];const {companyId:_0x41f8da}=_0x1bc5c6[_0x1d70a7(0xc9)],{active:_0x610237}=_0x1bc5c6[_0x1d70a7(0x9e)],_0x78ec63=await(0x0,BlockUnblockContactService_1[_0x1d70a7(0x9d)])({'contactId':_0x186f3d,'companyId':_0x41f8da,'active':_0x610237}),_0x52fd3b=(0x0,socket_1[_0x1d70a7(0xd4)])();return _0x52fd3b[_0x1d70a7(0xbe)]('company-'+_0x41f8da+_0x1d70a7(0xc0),{'action':_0x1d70a7(0xbb),'contact':_0x78ec63}),_0x36752f[_0x1d70a7(0xb1)](0xc8)[_0x1d70a7(0xa9)](_0x78ec63);};exports['blockUnblock']=blockUnblock;const upload=async(_0x487066,_0x50b1a9)=>{const _0x28b361=a15_0x477a98,_0x125dad=_0x487066['files'],_0x3cbc54=(0x0,lodash_1['head'])(_0x125dad),{companyId:_0x5235da}=_0x487066[_0x28b361(0xc9)],_0x7fb181=await(0x0,ImportContactsService_1[_0x28b361(0xbc)])(_0x5235da,_0x3cbc54),_0x26210f=(0x0,socket_1['getIO'])();return _0x26210f[_0x28b361(0xbe)]('company-'+_0x5235da+_0x28b361(0xc0),{'action':_0x28b361(0xb2),'records':_0x7fb181}),_0x50b1a9[_0x28b361(0xb1)](0xc8)[_0x28b361(0xa9)](_0x7fb181);};exports[a15_0x477a98(0xb3)]=upload;const getContactProfileURL=async(_0x3d2e7f,_0x37fe84)=>{const _0x4fb5c2=a15_0x477a98,{number:_0x5b3a9e}=_0x3d2e7f[_0x4fb5c2(0xe1)],{companyId:_0x23b4a2}=_0x3d2e7f[_0x4fb5c2(0xc9)];if(_0x5b3a9e){const _0x33ffbf=await(0x0,CheckNumber_1[_0x4fb5c2(0x9d)])(_0x5b3a9e,_0x23b4a2),_0x3ba8f4=await(0x0,GetProfilePicUrl_1[_0x4fb5c2(0x9d)])(_0x33ffbf,_0x23b4a2),_0x766e07=await(0x0,NumberSimpleListService_1[_0x4fb5c2(0x9d)])({'number':_0x33ffbf,'companyId':_0x23b4a2});let _0x455dd6;return _0x766e07[_0x4fb5c2(0xc5)]>0x0?_0x455dd6={'contactId':_0x766e07[0x0]['id'],'profilePicUrl':_0x3ba8f4}:_0x455dd6={'contactId':0x0,'profilePicUrl':_0x3ba8f4},_0x37fe84[_0x4fb5c2(0xb1)](0xc8)[_0x4fb5c2(0xa9)](_0x455dd6);}};exports[a15_0x477a98(0xca)]=getContactProfileURL;function a15_0x388c(){const _0x1e6f94=['validate','query','delete','31966XxZBxI','required','1578774DlmTkA','writable','company-','getContactTags','../services/ContactServices/ToggleAcceptAudioContactService','json','__importStar','98622kztjGQ','../services/WbotServices/CheckNumber','../services/ContactServices/DeleteContactService','../services/ContactServices/UpdateContactService','number','show','status','reload','upload','name>\x20','importXls','defineProperty','string','log','list','blockUnblock','update','ImportContactsService','../services/ContactServices/NumberSimpleListService','emit','../services/ContactServices/ShowContactService','-contact','../errors/AppError','configurable','remove','call','length','matches','index','../services/ContactServices/ImportContactsService','user','getContactProfileURL','getContactVcard','get','create','getOwnPropertyDescriptor','getContact','27BPUgqe','substr','message','../services/ContactServices/GetContactService','getIO','349075JQXFOZ','menor\x2030','21eOdNAe','replace','shape','../services/ContactServices/FindContactTags','../services/ContactServices/ListContactsService','../services/ContactServices/CreateContactService','../services/ContactServices/CreateOrUpdateContactServiceForImport','../services/WbotServices/GetProfilePicUrl','hasOwnProperty','toggleAcceptAudio','params','771642enLRGW','../services/ContactServices/SimpleListService','simpleNumber>\x20','24WyCRMo','@s.whatsapp.net','4082840eslxjz','__esModule','toString','object','1178552bRGzTS','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','default','body'];a15_0x388c=function(){return _0x1e6f94;};return a15_0x388c();}const getContactVcard=async(_0x1bd85c,_0x457bb9)=>{const _0x172228=a15_0x477a98,{name:_0x5c1680,number:_0x49a540}=_0x1bd85c[_0x172228(0xa0)],{companyId:_0x173189}=_0x1bd85c[_0x172228(0xc9)];let _0x2be273=_0x49a540;const _0x50a8ab=_0x2be273[_0x172228(0xe9)]()['substr'](0x0,0x2),_0x6d3712=_0x2be273['toString']()[_0x172228(0xd1)](0x2,0x2),_0x5df1f2=_0x2be273[_0x172228(0xe9)]()['substr'](-0x8,0x8);if(_0x6d3712<='30'&&_0x50a8ab==='55')console[_0x172228(0xb8)](_0x172228(0xd6)),_0x2be273=_0x50a8ab+_0x6d3712+0x9+_0x5df1f2+'@s.whatsapp.net';else _0x6d3712>'30'&&_0x50a8ab==='55'?(console[_0x172228(0xb8)]('maior\x2030'),_0x2be273=_0x50a8ab+_0x6d3712+_0x5df1f2+_0x172228(0xe6)):_0x2be273=_0x49a540+_0x172228(0xe6);console['log'](_0x2be273);const _0x45645c=await(0x0,GetContactService_1[_0x172228(0x9d)])({'name':_0x5c1680,'number':_0x49a540,'companyId':_0x173189});return _0x457bb9['status'](0xc8)[_0x172228(0xa9)](_0x45645c);};exports[a15_0x477a98(0xcb)]=getContactVcard;const getContactTags=async(_0xfe51fe,_0x46d688)=>{const _0x5ded46=a15_0x477a98,{contactId:_0x508131}=_0xfe51fe[_0x5ded46(0xe1)],_0x5e3e6a=await(0x0,FindContactTags_1[_0x5ded46(0x9d)])({'contactId':_0x508131});let _0x43273b=![];return _0x5e3e6a[_0x5ded46(0xc5)]>0x0&&(_0x43273b=!![]),_0x46d688[_0x5ded46(0xb1)](0xc8)['json']({'tags':_0x43273b});};exports[a15_0x477a98(0xa7)]=getContactTags;