'use strict';const a41_0x38395d=a41_0x35ca;function a41_0x1187(){const _0x49af39=['page','forEach','VERIFY_TOKEN','send','334888EOHtCd','hub.verify_token','12376809zsvXPY','8SFQGWa','../models/Whatsapp','hub.challenge','query','json','9620770jNRFRS','index','object','whaticket','instagram','33NMsrFx','findOne','env','entry','default','1048081siwuml','defineProperty','3343114GgwEZc','9XaCSQT','__esModule','hub.mode','9547950GZDQVN','status','handleMessage','EVENT_RECEIVED','subscribe','624KVqBZp','webHook','Forbidden','129710YSWwgC'];a41_0x1187=function(){return _0x49af39;};return a41_0x1187();}(function(_0x339897,_0x2f5168){const _0x4e826d=a41_0x35ca,_0x74c36c=_0x339897();while(!![]){try{const _0x5d392e=parseInt(_0x4e826d(0x12b))/0x1+parseInt(_0x4e826d(0x12d))/0x2+-parseInt(_0x4e826d(0x12e))/0x3*(parseInt(_0x4e826d(0x13e))/0x4)+-parseInt(_0x4e826d(0x131))/0x5+-parseInt(_0x4e826d(0x136))/0x6*(-parseInt(_0x4e826d(0x139))/0x7)+-parseInt(_0x4e826d(0x141))/0x8*(-parseInt(_0x4e826d(0x140))/0x9)+parseInt(_0x4e826d(0x121))/0xa*(-parseInt(_0x4e826d(0x126))/0xb);if(_0x5d392e===_0x2f5168)break;else _0x74c36c['push'](_0x74c36c['shift']());}catch(_0x49d224){_0x74c36c['push'](_0x74c36c['shift']());}}}(a41_0x1187,0xee07c));var __importDefault=this&&this['__importDefault']||function(_0x3ac05c){const _0x162753=a41_0x35ca;return _0x3ac05c&&_0x3ac05c[_0x162753(0x12f)]?_0x3ac05c:{'default':_0x3ac05c};};Object[a41_0x38395d(0x12c)](exports,a41_0x38395d(0x12f),{'value':!![]}),exports[a41_0x38395d(0x137)]=exports[a41_0x38395d(0x122)]=void 0x0;const Whatsapp_1=__importDefault(require(a41_0x38395d(0x11d))),facebookMessageListener_1=require('../services/FacebookServices/facebookMessageListener'),index=async(_0x25ad9a,_0x2e4af8)=>{const _0x50c309=a41_0x38395d,_0x34c7cc=process[_0x50c309(0x128)][_0x50c309(0x13c)]||_0x50c309(0x124),_0x27e6f4=_0x25ad9a[_0x50c309(0x11f)][_0x50c309(0x130)],_0x3da82e=_0x25ad9a['query'][_0x50c309(0x13f)],_0x1e587f=_0x25ad9a[_0x50c309(0x11f)][_0x50c309(0x11e)];if(_0x27e6f4&&_0x3da82e){if(_0x27e6f4===_0x50c309(0x135)&&_0x3da82e===_0x34c7cc)return _0x2e4af8['status'](0xc8)[_0x50c309(0x13d)](_0x1e587f);}return _0x2e4af8[_0x50c309(0x132)](0x193)[_0x50c309(0x120)]({'message':_0x50c309(0x138)});};function a41_0x35ca(_0x2fb14e,_0x9d359c){const _0x1187e4=a41_0x1187();return a41_0x35ca=function(_0x35cac3,_0x26ded4){_0x35cac3=_0x35cac3-0x11d;let _0x543a56=_0x1187e4[_0x35cac3];return _0x543a56;},a41_0x35ca(_0x2fb14e,_0x9d359c);}exports[a41_0x38395d(0x122)]=index;const webHook=async(_0x5bd775,_0x3982a1)=>{const _0x2bd885=a41_0x38395d;try{const {body:_0x2d959a}=_0x5bd775;if(_0x2d959a[_0x2bd885(0x123)]==='page'||_0x2d959a[_0x2bd885(0x123)]===_0x2bd885(0x125)){let _0x2bc8f0;return _0x2d959a[_0x2bd885(0x123)]===_0x2bd885(0x13a)?_0x2bc8f0='facebook':_0x2bc8f0=_0x2bd885(0x125),_0x2d959a[_0x2bd885(0x129)]?.[_0x2bd885(0x13b)](async _0x7b8d0f=>{const _0x30bd92=_0x2bd885,_0x3039a9=await Whatsapp_1[_0x30bd92(0x12a)][_0x30bd92(0x127)]({'where':{'facebookPageUserId':_0x7b8d0f['id'],'channel':_0x2bc8f0}});_0x3039a9&&_0x7b8d0f['messaging']?.[_0x30bd92(0x13b)](_0x4f02d5=>{const _0x1e50dd=_0x30bd92;(0x0,facebookMessageListener_1[_0x1e50dd(0x133)])(_0x3039a9,_0x4f02d5,_0x2bc8f0,_0x3039a9['companyId']);});}),_0x3982a1[_0x2bd885(0x132)](0xc8)[_0x2bd885(0x120)]({'message':_0x2bd885(0x134)});}return _0x3982a1[_0x2bd885(0x132)](0x194)[_0x2bd885(0x120)]({'message':_0x2d959a});}catch(_0x452934){return _0x3982a1['status'](0x1f4)[_0x2bd885(0x120)]({'message':_0x452934});}};exports[a41_0x38395d(0x137)]=webHook;