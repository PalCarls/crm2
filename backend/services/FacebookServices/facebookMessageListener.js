'use strict';function a431_0x425e(_0x57d648,_0x3511fe){const _0xdf69ba=a431_0xdf69();return a431_0x425e=function(_0x425eff,_0x27b661){_0x425eff=_0x425eff-0x17e;let _0x365b05=_0xdf69ba[_0x425eff];return _0x365b05;},a431_0x425e(_0x57d648,_0x3511fe);}const a431_0x1f0aa8=a431_0x425e;(function(_0xf0503f,_0x3e21ed){const _0x51cf32=a431_0x425e,_0x5b3d9e=_0xf0503f();while(!![]){try{const _0x1fed07=-parseInt(_0x51cf32(0x196))/0x1+-parseInt(_0x51cf32(0x1e6))/0x2*(-parseInt(_0x51cf32(0x1a0))/0x3)+parseInt(_0x51cf32(0x1db))/0x4*(parseInt(_0x51cf32(0x198))/0x5)+-parseInt(_0x51cf32(0x188))/0x6*(-parseInt(_0x51cf32(0x18e))/0x7)+-parseInt(_0x51cf32(0x1bb))/0x8*(-parseInt(_0x51cf32(0x1e2))/0x9)+parseInt(_0x51cf32(0x1af))/0xa*(-parseInt(_0x51cf32(0x1ca))/0xb)+-parseInt(_0x51cf32(0x1ab))/0xc*(parseInt(_0x51cf32(0x1ac))/0xd);if(_0x1fed07===_0x3e21ed)break;else _0x5b3d9e['push'](_0x5b3d9e['shift']());}catch(_0x2958d4){_0x5b3d9e['push'](_0x5b3d9e['shift']());}}}(a431_0xdf69,0x8112a));var __importDefault=this&&this['__importDefault']||function(_0x5c2e6e){const _0x339b8a=a431_0x425e;return _0x5c2e6e&&_0x5c2e6e[_0x339b8a(0x181)]?_0x5c2e6e:{'default':_0x5c2e6e};};Object['defineProperty'](exports,a431_0x1f0aa8(0x181),{'value':!![]}),exports[a431_0x1f0aa8(0x1a5)]=exports[a431_0x1f0aa8(0x187)]=exports['verifyMessage']=void 0x0;const fs_1=require('fs'),fs_2=__importDefault(require('fs')),axios_1=__importDefault(require(a431_0x1f0aa8(0x1be))),moment_1=__importDefault(require(a431_0x1f0aa8(0x192))),path_1=require('path'),CreateOrUpdateContactService_1=__importDefault(require(a431_0x1f0aa8(0x18a))),CreateMessageService_1=__importDefault(require('../MessageServices/CreateMessageService')),FindOrCreateTicketService_1=__importDefault(require('../TicketServices/FindOrCreateTicketService')),graphAPI_1=require(a431_0x1f0aa8(0x1aa)),Whatsapp_1=__importDefault(require(a431_0x1f0aa8(0x1c8))),UpdateTicketService_1=__importDefault(require(a431_0x1f0aa8(0x1cb))),Debounce_1=require(a431_0x1f0aa8(0x182)),ShowWhatsAppService_1=__importDefault(require('../WhatsappService/ShowWhatsAppService')),Mustache_1=__importDefault(require('../../helpers/Mustache')),Queue_1=__importDefault(require(a431_0x1f0aa8(0x1e3))),Chatbot_1=__importDefault(require(a431_0x1f0aa8(0x18d))),Message_1=__importDefault(require(a431_0x1f0aa8(0x1d8))),ChatbotListenerFacebook_1=require(a431_0x1f0aa8(0x185)),ListSettingsService_1=__importDefault(require('../SettingServices/ListSettingsService')),lodash_1=require(a431_0x1f0aa8(0x189)),FindOrCreateATicketTrakingService_1=__importDefault(require(a431_0x1f0aa8(0x17e))),wbotMessageListener_1=require('../WbotServices/wbotMessageListener'),verifyContact=async(_0x505311,_0x3b9409,_0x59933b)=>{const _0x31ccf8=a431_0x1f0aa8;if(!_0x505311)return null;const _0x472f0c={'name':_0x505311?.[_0x31ccf8(0x1a2)]||_0x505311?.[_0x31ccf8(0x191)]+'\x20'+_0x505311?.[_0x31ccf8(0x1b6)],'number':_0x505311['id'],'profilePicUrl':'','isGroup':![],'companyId':_0x59933b,'channel':_0x3b9409},_0x884fca=(0x0,CreateOrUpdateContactService_1[_0x31ccf8(0x1b3)])(_0x472f0c);return _0x884fca;},verifyMessage=async(_0x321f53,_0x1accac,_0x52100b,_0x48e493)=>{const _0x47dd1d=a431_0x1f0aa8,_0x5af891=await verifyQuotedMessage(_0x321f53),_0x561c9a={'wid':_0x321f53[_0x47dd1d(0x195)]||_0x321f53[_0x47dd1d(0x1d0)],'ticketId':_0x52100b['id'],'contactId':_0x321f53[_0x47dd1d(0x1e4)]?undefined:_0x48e493['id'],'body':_0x321f53[_0x47dd1d(0x1b4)]||_0x1accac,'fromMe':_0x321f53[_0x47dd1d(0x1e4)],'read':_0x321f53?.[_0x47dd1d(0x1e4)],'quotedMsgId':_0x5af891?.['id'],'ack':0x3,'dataJson':JSON[_0x47dd1d(0x1c7)](_0x321f53)};await(0x0,CreateMessageService_1[_0x47dd1d(0x1b3)])({'messageData':_0x561c9a,'companyId':_0x52100b[_0x47dd1d(0x193)]}),await _0x52100b['update']({'lastMessage':_0x321f53[_0x47dd1d(0x1b4)]});};exports[a431_0x1f0aa8(0x1a3)]=verifyMessage;const verifyMessageMedia=async(_0x1d73f7,_0x5bd3b7,_0x4a5adc)=>{const _0x58f1e1=a431_0x1f0aa8,{data:_0x3a49f8}=await axios_1[_0x58f1e1(0x1b3)][_0x58f1e1(0x1d3)](_0x1d73f7[_0x58f1e1(0x1e5)][0x0][_0x58f1e1(0x17f)]['url'],{'responseType':_0x58f1e1(0x1b1)}),{fileTypeFromBuffer:_0x56aee1}=await eval('const _0x234e5f = _0x58f1e1;import(_0x234e5f(447));'),_0x2b800c=await _0x56aee1(_0x3a49f8),_0x3d5535=new Date()[_0x58f1e1(0x1ae)]()+'.'+_0x2b800c[_0x58f1e1(0x1a6)],_0x463038='public/company'+_0x5bd3b7[_0x58f1e1(0x193)];!fs_2['default'][_0x58f1e1(0x1dc)](_0x463038)&&(fs_2['default'][_0x58f1e1(0x190)](_0x463038),fs_2[_0x58f1e1(0x1b3)][_0x58f1e1(0x183)](_0x463038,0x1ff));(0x0,fs_1[_0x58f1e1(0x1a8)])((0x0,path_1['join'])(__dirname,'..','..','..',_0x463038,_0x3d5535),_0x3a49f8,'base64');const _0x1afd3a={'wid':_0x1d73f7[_0x58f1e1(0x195)],'ticketId':_0x5bd3b7['id'],'contactId':_0x1d73f7[_0x58f1e1(0x1e4)]?undefined:_0x4a5adc['id'],'body':_0x1d73f7[_0x58f1e1(0x1b4)]||_0x3d5535,'fromMe':_0x1d73f7[_0x58f1e1(0x1e4)],'mediaType':_0x1d73f7['attachments'][0x0]['type'],'mediaUrl':_0x3d5535,'read':_0x1d73f7['is_echo'],'quotedMsgId':null,'ack':0x3,'dataJson':JSON['stringify'](_0x1d73f7)};await(0x0,CreateMessageService_1[_0x58f1e1(0x1b3)])({'messageData':_0x1afd3a,'companyId':_0x5bd3b7[_0x58f1e1(0x193)]}),await _0x5bd3b7['update']({'lastMessage':_0x1d73f7[_0x58f1e1(0x1b4)]});};exports[a431_0x1f0aa8(0x187)]=verifyMessageMedia;const verifyQuotedMessage=async _0xa9ee3b=>{const _0x58b96d=a431_0x1f0aa8;if(!_0xa9ee3b)return null;const _0x3c9724=_0xa9ee3b?.[_0x58b96d(0x1d1)]?.[_0x58b96d(0x195)];if(!_0x3c9724)return null;const _0x380140=await Message_1[_0x58b96d(0x1b3)]['findOne']({'where':{'id':_0x3c9724}});if(!_0x380140)return null;return _0x380140;},handleMessage=async(_0x478586,_0x45eed6,_0x2804a1,_0x324a43)=>{const _0x34e074=a431_0x1f0aa8;try{if(_0x45eed6[_0x34e074(0x1cf)]){let _0x8569d4,_0xd02c95=null;const _0x2c3f47=_0x45eed6['sender']['id'],_0x346570=_0x45eed6[_0x34e074(0x19e)]['id'],{message:_0x428a37}=_0x45eed6,_0x4c41b1=_0x428a37[_0x34e074(0x1e4)];let _0x5b6afa=_0x428a37[_0x34e074(0x1b4)];if(_0x4c41b1){if(/\u200e/[_0x34e074(0x1c2)](_0x428a37[_0x34e074(0x1b4)]))return;_0x8569d4=await(0x0,graphAPI_1[_0x34e074(0x1d9)])(_0x346570,_0x478586['facebookUserToken']);}else _0x8569d4=await(0x0,graphAPI_1[_0x34e074(0x1d9)])(_0x2c3f47,_0x478586['facebookUserToken']);const _0x2e55f5=await verifyContact(_0x8569d4,_0x2804a1,_0x324a43),_0x1ed942=_0x4c41b1?0x0:0x1,_0x446ca2=await Whatsapp_1[_0x34e074(0x1b3)][_0x34e074(0x18f)]({'where':{'facebookPageUserId':_0x478586[_0x34e074(0x19a)]},'include':[{'model':Queue_1[_0x34e074(0x1b3)],'as':_0x34e074(0x1d7),'attributes':['id',_0x34e074(0x1a2),'color','greetingMessage'],'include':[{'model':Chatbot_1[_0x34e074(0x1b3)],'as':_0x34e074(0x1b7),'attributes':['id',_0x34e074(0x1a2),'greetingMessage']}]}],'order':[[_0x34e074(0x1d7),'id',_0x34e074(0x1c0)],[_0x34e074(0x1d7),_0x34e074(0x1b7),'id',_0x34e074(0x1c0)]]}),_0x3e582b=await(0x0,ListSettingsService_1['default'])({'companyId':_0x324a43}),_0x3db0ce=_0x3e582b[_0x34e074(0x1b8)](_0x10299f=>_0x10299f[_0x34e074(0x1a4)]===_0x34e074(0x19c)),_0x5cd1fa=_0x3e582b['find'](_0x3825f9=>_0x3825f9[_0x34e074(0x1a4)]==='lgpdMessage'),_0x98d788=_0x3e582b['find'](_0x37fed8=>_0x37fed8[_0x34e074(0x1a4)]===_0x34e074(0x1da)),_0x4ac5ce=_0x3e582b[_0x34e074(0x1b8)](_0x141a32=>_0x141a32[_0x34e074(0x1a4)]===_0x34e074(0x1dd)),{ticket:_0x21a6d4}=await(0x0,FindOrCreateTicketService_1['default'])(_0x2e55f5,_0x446ca2,_0x1ed942,_0x324a43,0x0,0x0,null,_0x2804a1,null,![],_0x3e582b);_0xd02c95=_0x21a6d4;const _0x33288f=await(0x0,FindOrCreateATicketTrakingService_1[_0x34e074(0x1b3)])({'ticketId':_0xd02c95['id'],'companyId':_0x324a43,'whatsappId':_0x446ca2?.['id']});if(_0x446ca2['farewellMessage']&&(0x0,Mustache_1['default'])(_0x446ca2[_0x34e074(0x1a7)],_0xd02c95)===_0x428a37['text'])return;await _0xd02c95[_0x34e074(0x1c6)]({'lastMessage':_0x428a37[_0x34e074(0x1b4)]});try{if(!_0x4c41b1){if(_0xd02c95[_0x34e074(0x19b)]==='nps'&&_0x33288f!==null&&(0x0,wbotMessageListener_1[_0x34e074(0x1cd)])(_0x33288f)){if(!isNaN(parseFloat(_0x5b6afa))){(0x0,wbotMessageListener_1['handleRating'])(parseFloat(_0x5b6afa),_0xd02c95,_0x33288f),await _0x33288f[_0x34e074(0x1c6)]({'ratingAt':(0x0,moment_1[_0x34e074(0x1b3)])()['toDate'](),'finishedAt':(0x0,moment_1[_0x34e074(0x1b3)])()[_0x34e074(0x197)](),'rated':!![]});return;}else{if(_0xd02c95[_0x34e074(0x1ad)]<_0x446ca2[_0x34e074(0x1c9)]){let _0x2d0707='‎Opção\x20inválida,\x20tente\x20novamente.\x0a';const _0x1f0478=await(0x0,graphAPI_1[_0x34e074(0x1df)])(_0x2e55f5[_0x34e074(0x1d2)],_0x2d0707,_0xd02c95[_0x34e074(0x186)][_0x34e074(0x180)]);await(0x0,exports[_0x34e074(0x1a3)])(_0x1f0478,_0x2d0707,_0xd02c95,_0x2e55f5);let _0x2801af='‎'+_0x446ca2[_0x34e074(0x1b9)]+'\x0a';const _0x222d7e=await(0x0,graphAPI_1[_0x34e074(0x1df)])(_0x2e55f5[_0x34e074(0x1d2)],_0x2801af,_0xd02c95[_0x34e074(0x186)][_0x34e074(0x180)]);await(0x0,exports[_0x34e074(0x1a3)])(_0x1f0478,_0x2801af,_0xd02c95,_0x2e55f5),await _0xd02c95[_0x34e074(0x1c6)]({'amountUseBotQueuesNPS':_0xd02c95[_0x34e074(0x1ad)]+0x1});}return;}}if(!(0x0,lodash_1['isNil'])(_0x3db0ce['value'])&&_0x3db0ce[_0x34e074(0x1c1)]===_0x34e074(0x1c5)){if(_0xd02c95[_0x34e074(0x19b)]==='lgpd'&&(0x0,lodash_1[_0x34e074(0x184)])(_0xd02c95[_0x34e074(0x1c3)])&&!(0x0,lodash_1['isNil'])(_0xd02c95['lgpdSendMessageAt'])){let _0x308b8d=null;!isNaN(parseFloat(_0x5b6afa))&&(_0x308b8d=parseFloat(_0x5b6afa));if(!Number[_0x34e074(0x1e1)](_0x308b8d)&&Number['isInteger'](_0x308b8d)&&!(0x0,lodash_1[_0x34e074(0x1b5)])(_0x308b8d)&&_0x308b8d>0x0){if(_0x308b8d===0x1)await _0x2e55f5['update']({'lgpdAcceptedAt':(0x0,moment_1['default'])()[_0x34e074(0x197)]()}),await _0xd02c95[_0x34e074(0x1c6)]({'lgpdAcceptedAt':(0x0,moment_1['default'])()[_0x34e074(0x197)](),'amountUsedBotQueues':0x0});else{if(_0x308b8d===0x2){if(_0x446ca2[_0x34e074(0x1b0)]!==''&&_0x446ca2['complationMessage']!==undefined){const _0xf227e2=await(0x0,graphAPI_1[_0x34e074(0x1df)])(_0x2e55f5['number'],'‎'+_0x446ca2[_0x34e074(0x1b0)],_0xd02c95['getSession'][_0x34e074(0x180)]);(0x0,exports['verifyMessage'])(_0xf227e2,'‎'+_0x446ca2[_0x34e074(0x1b0)],_0xd02c95,_0x2e55f5);}await _0xd02c95['update']({'status':_0x34e074(0x1d5),'amountUsedBotQueues':0x0}),await _0x33288f[_0x34e074(0x1e0)];return;}else _0xd02c95[_0x34e074(0x1b2)]<_0x446ca2[_0x34e074(0x1c4)]&&await _0xd02c95[_0x34e074(0x1c6)]({'amountUsedBotQueues':_0xd02c95[_0x34e074(0x1b2)]+0x1,'lgpdSendMessageAt':null});}}else _0xd02c95[_0x34e074(0x1b2)]<_0x446ca2[_0x34e074(0x1c4)]&&await _0xd02c95[_0x34e074(0x1c6)]({'amountUsedBotQueues':_0xd02c95[_0x34e074(0x1b2)]+0x1,'lgpdSendMessageAt':null});}if((_0x2e55f5[_0x34e074(0x1c3)]===null||_0x4ac5ce[_0x34e074(0x1c1)]===_0x34e074(0x1c5))&&!_0x2e55f5[_0x34e074(0x18b)]&&(_0xd02c95[_0x34e074(0x19b)]===_0x34e074(0x19f)&&(0x0,lodash_1[_0x34e074(0x184)])(_0xd02c95[_0x34e074(0x1a1)]))&&_0xd02c95[_0x34e074(0x1b2)]<=_0x446ca2['maxUseBotQueues']&&!(0x0,lodash_1[_0x34e074(0x184)])(_0x5cd1fa[_0x34e074(0x1c1)])&&!(0x0,lodash_1[_0x34e074(0x184)])(_0x98d788[_0x34e074(0x1c1)])){_0x428a37['attachments']?await(0x0,exports['verifyMessageMedia'])(_0x428a37,_0xd02c95,_0x2e55f5):await(0x0,exports[_0x34e074(0x1a3)])(_0x428a37,_0x428a37[_0x34e074(0x1b4)],_0xd02c95,_0x2e55f5);if(_0x5cd1fa[_0x34e074(0x1c1)]!==undefined&&_0x5cd1fa[_0x34e074(0x1c1)]!==''){const _0x108e34=(0x0,Mustache_1[_0x34e074(0x1b3)])('‎'+_0x5cd1fa[_0x34e074(0x1c1)],_0xd02c95),_0x2a0ed6=await(0x0,graphAPI_1['sendText'])(_0x2e55f5[_0x34e074(0x1d2)],_0x108e34,_0xd02c95[_0x34e074(0x186)][_0x34e074(0x180)]);(0x0,exports['verifyMessage'])(_0x2a0ed6,_0x108e34,_0xd02c95,_0x2e55f5);}if(_0x98d788[_0x34e074(0x1c1)]!==undefined&&_0x98d788[_0x34e074(0x1c1)]!==''){const _0x54f659=(0x0,Mustache_1['default'])('‎'+_0x98d788[_0x34e074(0x1c1)],_0xd02c95),_0x17bd85=await(0x0,graphAPI_1[_0x34e074(0x1df)])(_0x2e55f5[_0x34e074(0x1d2)],_0x54f659,_0xd02c95[_0x34e074(0x186)][_0x34e074(0x180)]);(0x0,exports[_0x34e074(0x1a3)])(_0x17bd85,_0x54f659,_0xd02c95,_0x2e55f5);};const _0x2e9eb8=(0x0,Mustache_1['default'])(_0x34e074(0x194),_0xd02c95),_0x2c6e2f=await(0x0,graphAPI_1[_0x34e074(0x1df)])(_0x2e55f5[_0x34e074(0x1d2)],_0x2e9eb8,_0xd02c95['getSession'][_0x34e074(0x180)]);(0x0,exports[_0x34e074(0x1a3)])(_0x2c6e2f,_0x2e9eb8,_0xd02c95,_0x2e55f5),await _0xd02c95['update']({'lgpdSendMessageAt':(0x0,moment_1['default'])()['toDate'](),'amountUsedBotQueues':_0xd02c95[_0x34e074(0x1b2)]+0x1}),await _0xd02c95[_0x34e074(0x19d)]();return;};if(!(0x0,lodash_1[_0x34e074(0x184)])(_0xd02c95[_0x34e074(0x1a1)])&&(0x0,lodash_1[_0x34e074(0x184)])(_0xd02c95['lgpdAcceptedAt']))return;}}}catch(_0x3f83fa){throw new Error(_0x3f83fa);console[_0x34e074(0x1bd)](_0x3f83fa);}_0x428a37[_0x34e074(0x1e5)]?await(0x0,exports[_0x34e074(0x187)])(_0x428a37,_0xd02c95,_0x2e55f5):await(0x0,exports['verifyMessage'])(_0x428a37,_0x428a37[_0x34e074(0x1b4)],_0xd02c95,_0x2e55f5),!_0xd02c95[_0x34e074(0x1cc)]&&!_0x4c41b1&&!_0xd02c95['userId']&&_0x446ca2['queues'][_0x34e074(0x1bc)]>=0x1&&await verifyQueue(_0x446ca2,_0x428a37,_0xd02c95,_0x2e55f5),_0xd02c95[_0x34e074(0x1cc)]&&_0xd02c95[_0x34e074(0x1d4)]&&(!_0xd02c95['user']&&await(0x0,ChatbotListenerFacebook_1[_0x34e074(0x18c)])(_0xd02c95['queueId'],_0x446ca2,_0xd02c95,_0x2e55f5,_0x428a37));}return;}catch(_0x341cf8){throw new Error(_0x341cf8);}};exports[a431_0x1f0aa8(0x1a5)]=handleMessage;const verifyQueue=async(_0x34493d,_0x1e3398,_0xd28099,_0xe14d93)=>{const _0x3ff646=a431_0x1f0aa8,{queues:_0x54df07,greetingMessage:_0x385c5c}=await(0x0,ShowWhatsAppService_1[_0x3ff646(0x1b3)])(_0x34493d['id'],_0xd28099[_0x3ff646(0x193)]);if(_0x54df07[_0x3ff646(0x1bc)]===0x1){await(0x0,UpdateTicketService_1[_0x3ff646(0x1b3)])({'ticketData':{'queueId':_0x54df07[0x0]['id']},'ticketId':_0xd28099['id'],'companyId':_0xd28099['companyId']});return;}let _0x5f30d1='';if(_0xd28099[_0x3ff646(0x19b)]!=='lgpd')_0x5f30d1=_0x1e3398[_0x3ff646(0x1b4)];else{if(!(0x0,lodash_1[_0x3ff646(0x184)])(_0xd28099[_0x3ff646(0x1c3)]))await _0xd28099['update']({'status':_0x3ff646(0x1a9)});await _0xd28099[_0x3ff646(0x19d)]();}const _0x31747b=_0x54df07[+_0x5f30d1-0x1];if(_0x31747b){await(0x0,UpdateTicketService_1[_0x3ff646(0x1b3)])({'ticketData':{'queueId':_0x31747b['id']},'ticketId':_0xd28099['id'],'companyId':_0xd28099['companyId']});if(_0x31747b[_0x3ff646(0x1b7)]['length']>0x0){let _0x219c33='';_0x31747b[_0x3ff646(0x1b7)][_0x3ff646(0x1ba)]((_0x179ec9,_0x5476d9)=>{const _0x3c2199=_0x3ff646;_0x219c33+='['+(_0x5476d9+0x1)+_0x3c2199(0x1ce)+_0x179ec9[_0x3c2199(0x1a2)]+'\x0a';});const _0x56fc03=(0x0,Mustache_1[_0x3ff646(0x1b3)])('‎'+_0x31747b[_0x3ff646(0x199)]+'\x0a\x0a'+_0x219c33+'\x0a*#*\x20Voltar\x20para\x20o\x20menu\x20principal',_0xd28099);return(0x0,graphAPI_1['sendText'])(_0xe14d93[_0x3ff646(0x1d2)],(0x0,Mustache_1[_0x3ff646(0x1b3)])(_0x56fc03,_0xd28099),_0xd28099[_0x3ff646(0x1d6)][_0x3ff646(0x180)]),await(0x0,exports[_0x3ff646(0x1a3)])(_0x1e3398,_0x56fc03,_0xd28099,_0xe14d93);}if(!_0x31747b[_0x3ff646(0x1b7)][_0x3ff646(0x1bc)]){const _0x3b9cea=(0x0,Mustache_1['default'])('‎'+_0x31747b[_0x3ff646(0x199)],_0xd28099);return(0x0,graphAPI_1['sendText'])(_0xe14d93['number'],(0x0,Mustache_1[_0x3ff646(0x1b3)])(_0x3b9cea,_0xd28099),_0xd28099[_0x3ff646(0x1d6)][_0x3ff646(0x180)]),await(0x0,exports[_0x3ff646(0x1a3)])(_0x1e3398,_0x3b9cea,_0xd28099,_0xe14d93);}}else{let _0x3ba5a8='';_0x54df07[_0x3ff646(0x1ba)]((_0xd0c8e1,_0x1902a5)=>{_0x3ba5a8+='['+(_0x1902a5+0x1)+']\x20-\x20'+_0xd0c8e1['name']+'\x0a';});const _0x3b0abb=(0x0,Mustache_1[_0x3ff646(0x1b3)])('‎'+_0x385c5c+'\x0a\x0a'+_0x3ba5a8,_0xd28099),_0x1c3064=(0x0,Debounce_1[_0x3ff646(0x1de)])(async()=>{const _0x39eacd=_0x3ff646;return(0x0,graphAPI_1['sendText'])(_0xe14d93[_0x39eacd(0x1d2)],(0x0,Mustache_1['default'])(_0x3b0abb,_0xd28099),_0xd28099[_0x39eacd(0x1d6)][_0x39eacd(0x180)]),(0x0,exports[_0x39eacd(0x1a3)])(_0x1e3398,_0x3b0abb,_0xd28099,_0xe14d93);},0xbb8,_0xd28099['id']);_0x1c3064();}};function a431_0xdf69(){const _0x420961=['verifyRating',']\x20-\x20','message','message_id','reply_to','number','get','queueId','closed','whatsapp','queues','../../models/Message','profilePsid','lgpdLink','2228CGbyYD','existsSync','lgpdConsent','debounce','sendText','destroy','isNaN','82503DCkjdl','../../models/Queue','is_echo','attachments','344ICiaTF','../TicketServices/FindOrCreateATicketTrakingService','payload','facebookUserToken','__esModule','../../helpers/Debounce','chmodSync','isNil','../WbotServices/ChatbotListenerFacebook','getSession','verifyMessageMedia','26742RTVdnx','lodash','../ContactServices/CreateOrUpdateContactService','isGroup','sayChatbot','../../models/Chatbot','1085YMvGEF','findOne','mkdirSync','first_name','moment','companyId','‎Estou\x20ciente\x20sobre\x20o\x20tratamento\x20dos\x20meus\x20dados\x20pessoais.\x20\x0a\x0a*[1]*\x20Sim\x0a*[2]*\x20Não','mid','113320jQpoKi','toDate','2965FmgXpR','greetingMessage','facebookPageUserId','status','enableLGPD','reload','recipient','lgpd','11058YCgIqA','lgpdSendMessageAt','name','verifyMessage','key','handleMessage','ext','farewellMessage','writeFileSync','pending','./graphAPI','12rbcQyz','20043517aAAKVi','amountUseBotQueuesNPS','getTime','6110wMyXXx','complationMessage','arraybuffer','amountUsedBotQueues','default','text','isNull','last_name','chatbots','find','ratingMessage','forEach','672WLmEHA','length','log','axios','file-type','ASC','value','test','lgpdAcceptedAt','maxUseBotQueues','enabled','update','stringify','../../models/Whatsapp','maxUseBotQueuesNPS','4345JYDhDo','../TicketServices/UpdateTicketService','queue'];a431_0xdf69=function(){return _0x420961;};return a431_0xdf69();}