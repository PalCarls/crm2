'use strict';const a419_0x2cf4cd=a419_0x3acc;function a419_0x42c1(){const _0x173536=['has','map','8616kKRYKg','lodash','push','1507425KUjUcS','replace','defineProperty','número','__esModule','6665330HEWrOI','../../models/Contact','path','utils','121960ZqbeGM','readFile','companyId','email','Nome','values','sheet_to_json','1632505AfvGTd','E-mail','59984vlZtNK','findOrCreate','13DtEmEG','ImportContactsService','e-mail','2790iXUnYS','numero','6IwyfcN','Número','head','default','1643733PFkpTi','Sheets','Numero','__importDefault'];a419_0x42c1=function(){return _0x173536;};return a419_0x42c1();}function a419_0x3acc(_0x37a687,_0x4b575a){const _0x42c1a5=a419_0x42c1();return a419_0x3acc=function(_0x3acc89,_0x51f81f){_0x3acc89=_0x3acc89-0xc8;let _0x284677=_0x42c1a5[_0x3acc89];return _0x284677;},a419_0x3acc(_0x37a687,_0x4b575a);}(function(_0x4191db,_0x20acfe){const _0x3fb007=a419_0x3acc,_0x917aea=_0x4191db();while(!![]){try{const _0x410603=-parseInt(_0x3fb007(0xd3))/0x1*(-parseInt(_0x3fb007(0xd1))/0x2)+-parseInt(_0x3fb007(0xe5))/0x3+-parseInt(_0x3fb007(0xc8))/0x4+parseInt(_0x3fb007(0xcf))/0x5+-parseInt(_0x3fb007(0xd8))/0x6*(parseInt(_0x3fb007(0xdc))/0x7)+parseInt(_0x3fb007(0xe2))/0x8*(-parseInt(_0x3fb007(0xd6))/0x9)+parseInt(_0x3fb007(0xea))/0xa;if(_0x410603===_0x20acfe)break;else _0x917aea['push'](_0x917aea['shift']());}catch(_0x51320f){_0x917aea['push'](_0x917aea['shift']());}}}(a419_0x42c1,0x44abc));var __importDefault=this&&this[a419_0x2cf4cd(0xdf)]||function(_0x5629e6){const _0x19fd46=a419_0x2cf4cd;return _0x5629e6&&_0x5629e6[_0x19fd46(0xe9)]?_0x5629e6:{'default':_0x5629e6};};Object[a419_0x2cf4cd(0xe7)](exports,a419_0x2cf4cd(0xe9),{'value':!![]}),exports[a419_0x2cf4cd(0xd4)]=void 0x0;const lodash_1=require(a419_0x2cf4cd(0xe3)),xlsx_1=__importDefault(require('xlsx')),lodash_2=require(a419_0x2cf4cd(0xe3)),Contact_1=__importDefault(require(a419_0x2cf4cd(0xeb)));async function ImportContactsService(_0x18059d,_0x5341dd){const _0x4b2f09=a419_0x2cf4cd,_0x1b064f=xlsx_1[_0x4b2f09(0xdb)][_0x4b2f09(0xc9)](_0x5341dd?.[_0x4b2f09(0xec)]),_0x10b9ac=(0x0,lodash_1[_0x4b2f09(0xda)])(Object[_0x4b2f09(0xcd)](_0x1b064f[_0x4b2f09(0xdd)])),_0x1b2d80=xlsx_1['default'][_0x4b2f09(0xed)][_0x4b2f09(0xce)](_0x10b9ac,{'header':0x0}),_0x5b1030=_0x1b2d80[_0x4b2f09(0xe1)](_0x2e3551=>{const _0x3edb2b=_0x4b2f09;let _0x2aa288='',_0x547057='',_0x524ee0='';return((0x0,lodash_2['has'])(_0x2e3551,'nome')||(0x0,lodash_2[_0x3edb2b(0xe0)])(_0x2e3551,_0x3edb2b(0xcc)))&&(_0x2aa288=_0x2e3551['nome']||_0x2e3551[_0x3edb2b(0xcc)]),((0x0,lodash_2[_0x3edb2b(0xe0)])(_0x2e3551,'numero')||(0x0,lodash_2['has'])(_0x2e3551,_0x3edb2b(0xe8))||(0x0,lodash_2[_0x3edb2b(0xe0)])(_0x2e3551,'Numero')||(0x0,lodash_2[_0x3edb2b(0xe0)])(_0x2e3551,_0x3edb2b(0xd9)))&&(_0x547057=_0x2e3551[_0x3edb2b(0xd7)]||_0x2e3551[_0x3edb2b(0xe8)]||_0x2e3551[_0x3edb2b(0xde)]||_0x2e3551['Número'],_0x547057=(''+_0x547057)[_0x3edb2b(0xe6)](/\D/g,'')),((0x0,lodash_2[_0x3edb2b(0xe0)])(_0x2e3551,_0x3edb2b(0xcb))||(0x0,lodash_2[_0x3edb2b(0xe0)])(_0x2e3551,_0x3edb2b(0xd5))||(0x0,lodash_2[_0x3edb2b(0xe0)])(_0x2e3551,'Email')||(0x0,lodash_2[_0x3edb2b(0xe0)])(_0x2e3551,_0x3edb2b(0xd0)))&&(_0x524ee0=_0x2e3551[_0x3edb2b(0xcb)]||_0x2e3551[_0x3edb2b(0xd5)]||_0x2e3551['Email']||_0x2e3551[_0x3edb2b(0xd0)]),{'name':_0x2aa288,'number':_0x547057,'email':_0x524ee0,'companyId':_0x18059d};}),_0x5e0c74=[];for(const _0xd3222b of _0x5b1030){const [_0x2764b9,_0x5af8b4]=await Contact_1[_0x4b2f09(0xdb)][_0x4b2f09(0xd2)]({'where':{'number':''+_0xd3222b['number'],'companyId':_0xd3222b[_0x4b2f09(0xca)]},'defaults':_0xd3222b});_0x5af8b4&&_0x5e0c74[_0x4b2f09(0xe4)](_0x2764b9);}return _0x5e0c74;}exports[a419_0x2cf4cd(0xd4)]=ImportContactsService;