'use strict';const a516_0x26f316=a516_0x50ae;(function(_0x9863cf,_0x1517c6){const _0x1ec63c=a516_0x50ae,_0x1018c6=_0x9863cf();while(!![]){try{const _0x1a59bf=parseInt(_0x1ec63c(0x96))/0x1*(parseInt(_0x1ec63c(0x98))/0x2)+parseInt(_0x1ec63c(0x8a))/0x3+-parseInt(_0x1ec63c(0x83))/0x4+parseInt(_0x1ec63c(0x95))/0x5+parseInt(_0x1ec63c(0x80))/0x6*(parseInt(_0x1ec63c(0x9a))/0x7)+-parseInt(_0x1ec63c(0x89))/0x8*(-parseInt(_0x1ec63c(0x99))/0x9)+-parseInt(_0x1ec63c(0x8c))/0xa;if(_0x1a59bf===_0x1517c6)break;else _0x1018c6['push'](_0x1018c6['shift']());}catch(_0x5c97f5){_0x1018c6['push'](_0x1018c6['shift']());}}}(a516_0xaa9d,0xd5ce4));var __importDefault=this&&this[a516_0x26f316(0x81)]||function(_0x185696){const _0x5bf1f8=a516_0x26f316;return _0x185696&&_0x185696[_0x5bf1f8(0x97)]?_0x185696:{'default':_0x185696};};function a516_0x50ae(_0x52fa18,_0x54b057){const _0xaa9d7=a516_0xaa9d();return a516_0x50ae=function(_0x50aec2,_0x1445f4){_0x50aec2=_0x50aec2-0x80;let _0x464859=_0xaa9d7[_0x50aec2];return _0x464859;},a516_0x50ae(_0x52fa18,_0x54b057);}Object['defineProperty'](exports,a516_0x26f316(0x97),{'value':!![]});const AppError_1=__importDefault(require('../../errors/AppError')),GetDefaultWhatsApp_1=__importDefault(require(a516_0x26f316(0x9b))),GetDefaultWhatsAppByUser_1=__importDefault(require('../../helpers/GetDefaultWhatsAppByUser')),Ticket_1=__importDefault(require('../../models/Ticket')),ShowContactService_1=__importDefault(require(a516_0x26f316(0x85))),socket_1=require(a516_0x26f316(0x8b)),ShowWhatsAppService_1=__importDefault(require(a516_0x26f316(0x90))),CheckContactOpenTickets_1=__importDefault(require(a516_0x26f316(0x88))),CreateTicketService=async({contactId:_0x2088aa,status:_0x1dbeba,userId:_0x3b9811,queueId:_0x1a2565,companyId:_0x4391c0,whatsappId:_0x53ce68})=>{const _0x6983de=a516_0x26f316,_0x55cbb0=(0x0,socket_1[_0x6983de(0x8f)])();console[_0x6983de(0x82)](_0x2088aa,_0x1dbeba,_0x3b9811,_0x1a2565,_0x4391c0,_0x53ce68);let _0x4b693c;_0x53ce68!==undefined&&_0x53ce68!==null&&_0x53ce68!==''&&(_0x4b693c=await(0x0,ShowWhatsAppService_1[_0x6983de(0x84)])(_0x53ce68,_0x4391c0));let _0x5a5bbd=await(0x0,GetDefaultWhatsAppByUser_1['default'])(_0x3b9811);_0x4b693c&&(_0x5a5bbd=_0x4b693c);if(!_0x5a5bbd)_0x5a5bbd=await(0x0,GetDefaultWhatsApp_1[_0x6983de(0x84)])(_0x4391c0);await(0x0,CheckContactOpenTickets_1[_0x6983de(0x84)])(_0x2088aa,_0x5a5bbd['id']);const {isGroup:_0x4125c3}=await(0x0,ShowContactService_1['default'])(_0x2088aa,_0x4391c0),[{id:_0x3e3f3e}]=await Ticket_1[_0x6983de(0x84)]['findOrCreate']({'where':{'contactId':_0x2088aa,'companyId':_0x4391c0,'whatsappId':_0x5a5bbd['id']},'defaults':{'contactId':_0x2088aa,'companyId':_0x4391c0,'status':_0x1dbeba,'whatsappId':_0x5a5bbd['id'],'isGroup':_0x4125c3,'userId':_0x3b9811,'isBot':!![]}});await Ticket_1['default'][_0x6983de(0x8e)]({'companyId':_0x4391c0,'queueId':_0x1a2565,'userId':_0x3b9811,'status':_0x4125c3?_0x6983de(0x94):'open','isBot':!![]},{'where':{'id':_0x3e3f3e}});const _0x2ee01b=await Ticket_1['default']['findByPk'](_0x3e3f3e,{'include':[_0x6983de(0x93),_0x6983de(0x91)]});if(!_0x2ee01b)throw new AppError_1[(_0x6983de(0x84))](_0x6983de(0x87));return _0x55cbb0['to'](_0x2ee01b[_0x6983de(0x92)])['to'](_0x6983de(0x8d))['to'](_0x3e3f3e['toString']())['emit']('company-'+_0x4391c0+_0x6983de(0x86),{'action':_0x6983de(0x8e),'ticket':_0x2ee01b}),_0x2ee01b;};exports[a516_0x26f316(0x84)]=CreateTicketService;function a516_0xaa9d(){const _0x418419=['default','../ContactServices/ShowContactService','-ticket','ERR_CREATING_TICKET','../../helpers/CheckContactOpenTickets','144CsQrob','2088192BZRJRR','../../libs/socket','35726900WTafar','notification','update','getIO','../WhatsappService/ShowWhatsAppService','queue','status','contact','group','7477400ONEcjM','397StMLjE','__esModule','8350jtQUMy','203292iOdSaZ','16751ABBQsd','../../helpers/GetDefaultWhatsApp','3786LqCcnC','__importDefault','log','5268592zrOFfi'];a516_0xaa9d=function(){return _0x418419;};return a516_0xaa9d();}