'use strict';function a454_0x45a3(){const _0x59993b=['default','status','ticketImported','../../models/Ticket','queueId','ticketId','-appMessage','isPrivate','544006FMWjZP','ERR_CREATING_MESSAGE','getIO','defineProperty','9365azQDiR','PVT','quotedMsg','contact','2433438nWOAbN','create','ticket','emit','__esModule','3371872LdlPbO','223480SsHJTr','../../models/Message','3320032MRnflw','update','1004QQQfWD','notification','1435038HrJRVF','toString','__importDefault','wid','company-','findOne','../../libs/socket'];a454_0x45a3=function(){return _0x59993b;};return a454_0x45a3();}const a454_0x5929b7=a454_0x24a3;function a454_0x24a3(_0x4dd545,_0x585c65){const _0x45a3a3=a454_0x45a3();return a454_0x24a3=function(_0x24a341,_0x28187f){_0x24a341=_0x24a341-0xe5;let _0x45dbdd=_0x45a3a3[_0x24a341];return _0x45dbdd;},a454_0x24a3(_0x4dd545,_0x585c65);}(function(_0x438b80,_0x3cd643){const _0x180aa8=a454_0x24a3,_0x33257f=_0x438b80();while(!![]){try{const _0x451338=parseInt(_0x180aa8(0xf4))/0x1+-parseInt(_0x180aa8(0xe6))/0x2+-parseInt(_0x180aa8(0xfa))/0x3+parseInt(_0x180aa8(0xf8))/0x4*(parseInt(_0x180aa8(0xea))/0x5)+parseInt(_0x180aa8(0xee))/0x6+-parseInt(_0x180aa8(0xf3))/0x7+parseInt(_0x180aa8(0xf6))/0x8;if(_0x451338===_0x3cd643)break;else _0x33257f['push'](_0x33257f['shift']());}catch(_0x362678){_0x33257f['push'](_0x33257f['shift']());}}}(a454_0x45a3,0x44e17));var __importDefault=this&&this[a454_0x5929b7(0xfc)]||function(_0x26f259){const _0x2f3088=a454_0x5929b7;return _0x26f259&&_0x26f259[_0x2f3088(0xf2)]?_0x26f259:{'default':_0x26f259};};Object[a454_0x5929b7(0xe9)](exports,a454_0x5929b7(0xf2),{'value':!![]});const socket_1=require(a454_0x5929b7(0x100)),Message_1=__importDefault(require(a454_0x5929b7(0xf5))),Ticket_1=__importDefault(require(a454_0x5929b7(0x104))),CreateMessageService=async({messageData:_0x296269,companyId:_0x9a7f9a})=>{const _0x420f56=a454_0x5929b7;await Message_1['default']['upsert']({..._0x296269,'companyId':_0x9a7f9a});const _0x29a6da=await Message_1[_0x420f56(0x101)][_0x420f56(0xff)]({'where':{'wid':_0x296269[_0x420f56(0xfd)],'companyId':_0x9a7f9a},'include':[_0x420f56(0xed),{'model':Ticket_1['default'],'as':_0x420f56(0xf0),'include':['contact','queue']},{'model':Message_1[_0x420f56(0x101)],'as':_0x420f56(0xec),'include':[_0x420f56(0xed)]}]});_0x29a6da['ticket'][_0x420f56(0x105)]!==null&&_0x29a6da[_0x420f56(0x105)]===null&&await _0x29a6da[_0x420f56(0xf7)]({'queueId':_0x29a6da[_0x420f56(0xf0)][_0x420f56(0x105)]});_0x29a6da[_0x420f56(0xe5)]&&await _0x29a6da[_0x420f56(0xf7)]({'wid':_0x420f56(0xeb)+_0x29a6da['id']});if(!_0x29a6da)throw new Error(_0x420f56(0xe7));const _0x2711e5=(0x0,socket_1[_0x420f56(0xe8)])();return!_0x296269?.[_0x420f56(0x103)]&&_0x2711e5['to'](_0x29a6da[_0x420f56(0x106)][_0x420f56(0xfb)]())['to'](_0x29a6da[_0x420f56(0xf0)][_0x420f56(0x102)])['to'](_0x420f56(0xf9))[_0x420f56(0xf1)](_0x420f56(0xfe)+_0x9a7f9a+_0x420f56(0x107),{'action':_0x420f56(0xef),'message':_0x29a6da,'ticket':_0x29a6da[_0x420f56(0xf0)],'contact':_0x29a6da[_0x420f56(0xf0)]['contact']}),_0x29a6da;};exports['default']=CreateMessageService;