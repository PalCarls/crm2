'use strict';const a374_0x5f44df=a374_0x4f3c;(function(_0x32fe11,_0x132cab){const _0x347e14=a374_0x4f3c,_0x1276a1=_0x32fe11();while(!![]){try{const _0x5a9bd=parseInt(_0x347e14(0x1e2))/0x1*(-parseInt(_0x347e14(0x1df))/0x2)+-parseInt(_0x347e14(0x1ed))/0x3+-parseInt(_0x347e14(0x1ec))/0x4*(parseInt(_0x347e14(0x1da))/0x5)+parseInt(_0x347e14(0x1db))/0x6+parseInt(_0x347e14(0x1e5))/0x7+-parseInt(_0x347e14(0x1dd))/0x8*(-parseInt(_0x347e14(0x1ef))/0x9)+parseInt(_0x347e14(0x1e9))/0xa;if(_0x5a9bd===_0x132cab)break;else _0x1276a1['push'](_0x1276a1['shift']());}catch(_0x1b9584){_0x1276a1['push'](_0x1276a1['shift']());}}}(a374_0x5db2,0x45290));function a374_0x4f3c(_0x1c99c7,_0x192050){const _0x5db2e1=a374_0x5db2();return a374_0x4f3c=function(_0x4f3c68,_0x488233){_0x4f3c68=_0x4f3c68-0x1d7;let _0x3f6596=_0x5db2e1[_0x4f3c68];return _0x3f6596;},a374_0x4f3c(_0x1c99c7,_0x192050);}function a374_0x5db2(){const _0x218adf=['userId','../../models/ChatMessage','2312450yNVfcv','unreads','reload','findAll','7517210lUjsRK','../../models/ChatUser','update','8sgYomR','938682hwMQNI','__importDefault','104292nxOpeB','findByPk','name','../../models/User','create','users','1026385LVtICL','1266450clYHIs','__esModule','48ookXej','../../models/Chat','37468eWjRrr','chat','default','19eeHJIR'];a374_0x5db2=function(){return _0x218adf;};return a374_0x5db2();}var __importDefault=this&&this[a374_0x5f44df(0x1ee)]||function(_0x211c66){const _0x16d79c=a374_0x5f44df;return _0x211c66&&_0x211c66[_0x16d79c(0x1dc)]?_0x211c66:{'default':_0x211c66};};Object['defineProperty'](exports,a374_0x5f44df(0x1dc),{'value':!![]});const Chat_1=__importDefault(require(a374_0x5f44df(0x1de))),ChatMessage_1=__importDefault(require(a374_0x5f44df(0x1e4))),ChatUser_1=__importDefault(require(a374_0x5f44df(0x1ea))),User_1=__importDefault(require(a374_0x5f44df(0x1d7)));async function CreateMessageService({senderId:_0x4f7eeb,chatId:_0x39fffd,message:_0x4e3da2}){const _0x1b0f3d=a374_0x5f44df,_0x28585c=await ChatMessage_1[_0x1b0f3d(0x1e1)][_0x1b0f3d(0x1d8)]({'senderId':_0x4f7eeb,'chatId':_0x39fffd,'message':_0x4e3da2});await _0x28585c[_0x1b0f3d(0x1e7)]({'include':[{'model':User_1[_0x1b0f3d(0x1e1)],'as':'sender','attributes':['id',_0x1b0f3d(0x1f1)]},{'model':Chat_1[_0x1b0f3d(0x1e1)],'as':_0x1b0f3d(0x1e0),'include':[{'model':ChatUser_1['default'],'as':_0x1b0f3d(0x1d9)}]}]});const _0x144625=await User_1[_0x1b0f3d(0x1e1)][_0x1b0f3d(0x1f0)](_0x4f7eeb);await _0x28585c['chat'][_0x1b0f3d(0x1eb)]({'lastMessage':_0x144625[_0x1b0f3d(0x1f1)]+':\x20'+_0x4e3da2});const _0x35fd09=await ChatUser_1[_0x1b0f3d(0x1e1)][_0x1b0f3d(0x1e8)]({'where':{'chatId':_0x39fffd}});for(let _0x51883f of _0x35fd09){_0x51883f[_0x1b0f3d(0x1e3)]===_0x4f7eeb?await _0x51883f[_0x1b0f3d(0x1eb)]({'unreads':0x0}):await _0x51883f['update']({'unreads':_0x51883f[_0x1b0f3d(0x1e6)]+0x1});}return _0x28585c;}exports[a374_0x5f44df(0x1e1)]=CreateMessageService;