'use strict';const a250_0x5f1b9a=a250_0x4464;(function(_0x3178ac,_0x15bea3){const _0x9ce14d=a250_0x4464,_0x46a81f=_0x3178ac();while(!![]){try{const _0x4fab22=-parseInt(_0x9ce14d(0xf8))/0x1+-parseInt(_0x9ce14d(0xec))/0x2+-parseInt(_0x9ce14d(0x109))/0x3+parseInt(_0x9ce14d(0xfe))/0x4*(parseInt(_0x9ce14d(0xed))/0x5)+-parseInt(_0x9ce14d(0xf1))/0x6+parseInt(_0x9ce14d(0x102))/0x7+-parseInt(_0x9ce14d(0x10c))/0x8*(-parseInt(_0x9ce14d(0x10a))/0x9);if(_0x4fab22===_0x15bea3)break;else _0x46a81f['push'](_0x46a81f['shift']());}catch(_0x31ae72){_0x46a81f['push'](_0x46a81f['shift']());}}}(a250_0x3d97,0xf35b5));function a250_0x4464(_0x1cb679,_0x354512){const _0x3d9752=a250_0x3d97();return a250_0x4464=function(_0x446497,_0x4342e4){_0x446497=_0x446497-0xe6;let _0x336bbe=_0x3d9752[_0x446497];return _0x336bbe;},a250_0x4464(_0x1cb679,_0x354512);}var __importDefault=this&&this[a250_0x5f1b9a(0x104)]||function(_0x36cc03){const _0x14d941=a250_0x5f1b9a;return _0x36cc03&&_0x36cc03[_0x14d941(0xe9)]?_0x36cc03:{'default':_0x36cc03};};function a250_0x3d97(){const _0x920b96=['warn','fromMe','whatsapp','defineProperty','notification','4YEkwKN','readMessages','dataJson','logger','11810001MNatug','updateUnread','__importDefault','userId','contacts:','Could\x20not\x20mark\x20messages\x20as\x20read.\x20Maybe\x20whatsapp\x20session\x20disconnected?\x20Err:\x20','log','2287554JsQoQk','767709jKbjaY',':unreads','344ruPYFS','findAll','default','length','__esModule','channel','companyId','3076992xVPENU','3436840WtuTjA','company-','./GetTicketWbot','../libs/socket','11680764qcefRd','key','isBot','status','contactId','update','getIO','797857oXYFWT'];a250_0x3d97=function(){return _0x920b96;};return a250_0x3d97();}Object[a250_0x5f1b9a(0xfc)](exports,'__esModule',{'value':!![]});const cache_1=__importDefault(require('../libs/cache')),socket_1=require(a250_0x5f1b9a(0xf0)),Message_1=__importDefault(require('../models/Message')),logger_1=require('../utils/logger'),GetTicketWbot_1=__importDefault(require(a250_0x5f1b9a(0xef))),SetTicketMessagesAsRead=async _0x14d6a0=>{const _0x3f4417=a250_0x5f1b9a;!_0x14d6a0[_0x3f4417(0xf3)]&&_0x14d6a0[_0x3f4417(0x105)]&&(await _0x14d6a0[_0x3f4417(0xf6)]({'unreadMessages':0x0}),await cache_1['default']['set'](_0x3f4417(0x106)+_0x14d6a0[_0x3f4417(0xf5)]+_0x3f4417(0x10b),'0'));if(_0x14d6a0[_0x3f4417(0xea)]===_0x3f4417(0xfb))try{const _0x26d772=await(0x0,GetTicketWbot_1['default'])(_0x14d6a0),_0x243e59=await Message_1[_0x3f4417(0xe7)][_0x3f4417(0xe6)]({'where':{'ticketId':_0x14d6a0['id'],'fromMe':![],'read':![]},'order':[['createdAt','DESC']]});_0x243e59[_0x3f4417(0xe8)]>0x0&&_0x243e59['forEach'](async _0x5c1e43=>{const _0x14350c=_0x3f4417,_0x1c84bd=JSON['parse'](_0x5c1e43[_0x14350c(0x100)]);_0x1c84bd['key']&&_0x1c84bd['key'][_0x14350c(0xfa)]===![]&&!_0x14d6a0['isBot']&&_0x14d6a0[_0x14350c(0x105)]&&await _0x26d772[_0x14350c(0xff)]([_0x1c84bd[_0x14350c(0xf2)]]);}),!_0x14d6a0[_0x3f4417(0xf3)]&&_0x14d6a0[_0x3f4417(0x105)]&&await Message_1[_0x3f4417(0xe7)]['update']({'read':!![]},{'where':{'ticketId':_0x14d6a0['id'],'read':![]}});}catch(_0xd6791a){console[_0x3f4417(0x108)](_0xd6791a),logger_1[_0x3f4417(0x101)][_0x3f4417(0xf9)](_0x3f4417(0x107)+_0xd6791a);}const _0x23dd35=(0x0,socket_1[_0x3f4417(0xf7)])();_0x23dd35['to'](_0x14d6a0[_0x3f4417(0xf4)])['to'](_0x3f4417(0xfd))['emit'](_0x3f4417(0xee)+_0x14d6a0[_0x3f4417(0xeb)]+'-ticket',{'action':_0x3f4417(0x103),'ticketId':_0x14d6a0['id']});};exports[a250_0x5f1b9a(0xe7)]=SetTicketMessagesAsRead;